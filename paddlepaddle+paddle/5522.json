{"BR": {"BR_id": "5522", "BR_author": "qingqing01", "BRopenT": "2017-11-09T14:07:40Z", "BRcloseT": "2017-11-10T11:53:26Z", "BR_text": {"BRsummary": "The compiling failed with openblas", "BRdescription": "\n Error:\n <denchmark-code>[ 98%] Built target softmax_with_cross_entropy_op\n /home/xxx/.third_party/install/openblas/lib/libopenblas.a(memory.o): In function `openblas_fork_handler':\n memory.c:(.text+0x190): undefined reference to `pthread_atfork'\n </denchmark-code>\n \n From this link <denchmark-link:https://github.com/xianyi/OpenBLAS/wiki/faq>https://github.com/xianyi/OpenBLAS/wiki/faq</denchmark-link>\n  :\n It seems that needs to link the pthread  library:\n \n How to solve undefined reference errors when statically linking against libopenblas.a\n \n \n On Linux, if OpenBLAS was compiled with threading support (USE_THREAD=1 by default), custom programs statically linked against libopenblas.a should also link to the pthread library e.g.:\n \n \n gcc -static -I/opt/OpenBLAS/include -L/opt/OpenBLAS/lib -o my_program my_program.c -lopenblas -lpthread\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "qingqing01", "commentT": "2017-11-09T14:09:19Z", "comment_text": "\n \t\tI encounter the same issue\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "qingqing01", "commentT": "2017-11-09T14:16:02Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/helinwang>@helinwang</denchmark-link>\n  Do we need add openblas ( ) in our teamcity? Since this issue and <denchmark-link:https://github.com/PaddlePaddle/Paddle/issues/5523>#5523</denchmark-link>\n  are both compiled fail with openblas version.\n Current CPU version in teamcity is WITH_MKLDNN=ON WITH_MKLML=ON.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "qingqing01", "commentT": "2017-11-09T19:00:10Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/luotao1>@luotao1</denchmark-link>\n  sure, I can do that. But when I tried the following build command on the develop branch I got:\n <denchmark-code>$ docker run --rm -i -v `pwd`/Paddle:/paddle -e WITH_GPU=OFF -e WITH_AVX=ON -e WITH_TESTING=OFF -e WITH_DEB=ON -e WITH_MKLDNN=OFF -e WITH_MKLML=OFF -e WITH_GOLANG=ON -e PADDLE_VERSION=0.10.0 -e RUN_TEST=OFF paddlepaddle/paddle:latest-dev\n CMake Error at cmake/external/openblas.cmake:118 (IF):\n   if given arguments:\n \n     \"EQUAL\" \"MKLML\"\n \n   Unknown arguments specified\n Call Stack (most recent call first):\n   CMakeLists.txt:123 (include)\n </denchmark-code>\n \n Maybe we need to fix our develop branch first before it is turned on for every pull request CI (or perhaps I did not use the correct command)?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "qingqing01", "commentT": "2017-11-10T02:05:27Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/helinwang>@helinwang</denchmark-link>\n  that is the issue <denchmark-link:https://github.com/PaddlePaddle/Paddle/issues/5523>#5523</denchmark-link>\n  , and I gave a PR <denchmark-link:https://github.com/PaddlePaddle/Paddle/pull/5521>#5521</denchmark-link>\n  , you can help review it.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "qingqing01", "commentT": "2017-11-10T09:59:51Z", "comment_text": "\n \t\tIs this error fixed?  I meet the same problem..\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "qingqing01", "commentT": "2017-11-10T10:06:08Z", "comment_text": "\n \t\tI am working on it, and don't fix it sucessfully.\n The reason caused is <denchmark-link:https://github.com/PaddlePaddle/Paddle/commit/0ede2a731120966dc0171b55eb403b2ec90f8fd8>0ede2a7</denchmark-link>\n   and <denchmark-link:https://github.com/PaddlePaddle/Paddle/pull/5441>#5441</denchmark-link>\n \n If I delete , I can build successfully. But the unit test fails.\n <denchmark-link:https://github.com/reyoung>@reyoung</denchmark-link>\n  can you help to see it as well ?\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "qingqing01", "commentT": "2017-11-10T11:55:58Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/helinwang>@helinwang</denchmark-link>\n  This issue is fixed by <denchmark-link:https://github.com/PaddlePaddle/Paddle/pull/5552>#5552</denchmark-link>\n  , you could add openblas version in the teamcity. Thanks very much!\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "qingqing01", "commentT": "2017-11-10T21:51:53Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/luotao1>@luotao1</denchmark-link>\n  thanks! done.\n \t\t"}}}, "commit": {"commit_id": "23b9bc0a6fcc800c5ad28d02f9c4c5d6f29d6fdd", "commit_author": "dzhwinter", "commitT": "2017-11-10 22:28:11-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "paddle\\operators\\math\\CMakeLists.txt", "file_new_name": "paddle\\operators\\math\\CMakeLists.txt", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "16", "deleted_lines": "16"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\paddle\\v2\\framework\\tests\\test_seq_concat_op.py", "file_new_name": "python\\paddle\\v2\\framework\\tests\\test_seq_concat_op.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "5", "deleted_lines": null}}}}}}