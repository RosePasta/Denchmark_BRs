{"BR": {"BR_id": "1725", "BR_author": "znation", "BRopenT": "2019-04-12T19:00:37Z", "BRcloseT": "2019-04-18T18:17:08Z", "BR_text": {"BRsummary": "Intermittent Python test failure in test_audio_functionality.py", "BRdescription": "\n Repro steps:\n <denchmark-code>pytest test/test_audio_functionality.py\n </denchmark-code>\n \n Expected:\n Passes consistently\n Actual:\n Fails intermittently, see the output here:\n <denchmark-code>\u279c  turicreate git:(master) pytest test/test_audio_functionality.py \n =========================================================================================== test session starts ============================================================================================\n platform darwin -- Python 2.7.10, pytest-3.2.5, py-1.8.0, pluggy-0.4.0\n hypothesis profile 'default' -> database=DirectoryBasedExampleDatabase('/Users/zach/turicreate2/debug/src/unity/python/turicreate/.hypothesis/examples')\n rootdir: /Users/zach/turicreate2/debug/src/unity/python, inifile:\n plugins: hypothesis-3.76.0\n collected 32 items                                                                                                                                                                                          \n \n test/test_audio_functionality.py ........s.......s.......s......F\n \n ================================================================================================= FAILURES =================================================================================================\n ____________________________________________________________________________________ ReuseDeepFeatures.test_simple_case ____________________________________________________________________________________\n \n self = <turicreate.test.test_audio_functionality.ReuseDeepFeatures testMethod=test_simple_case>\n \n     def test_simple_case(self):\n         data = copy(binary_test_data)\n         deep_features = tc.sound_classifier.get_deep_features(data['audio'])\n     \n         # Verify deep features in correct format\n         self.assertTrue(isinstance(deep_features, tc.SArray))\n         self.assertEqual(len(data), len(deep_features))\n         self.assertEqual(deep_features.dtype, list)\n         self.assertEqual(len(deep_features[0]), 3)\n         self.assertTrue(isinstance(deep_features[0][0], np.ndarray))\n         self.assertEqual(deep_features[0][0].dtype, np.float64)\n         self.assertEqual(len(deep_features[0][0]), 12288)\n     \n         # Test helper methods\n         self.assertTrue(tc.sound_classifier._is_audio_data_sarray(data['audio']))\n         self.assertTrue(tc.sound_classifier._is_deep_feature_sarray(deep_features))\n     \n         original_audio_data = data['audio']\n         del data['audio']\n     \n         # Create a model using the deep features\n         data['features'] = deep_features\n         model = tc.sound_classifier.create(data, 'labels', feature='features')\n     \n         # Test predict\n         predictions_from_audio = model.predict(original_audio_data, output_type='probability_vector')\n         predictions_from_deep_features = model.predict(deep_features, output_type='probability_vector')\n         for a, b in zip(predictions_from_audio, predictions_from_deep_features):\n >           self.assertAlmostEqual(list(a), list(b))\n E           TypeError: unsupported operand type(s) for -: 'list' and 'list'\n \n test/test_audio_functionality.py:398: TypeError\n ------------------------------------------------------------------------------------------- Captured stdout call -------------------------------------------------------------------------------------------\n \n Training a custom neural network -\n +------------------------+------------------------+------------------------+\n | Epoch                  | Training Accuracy (%)  | Elapsed Time (seconds) |\n +------------------------+------------------------+------------------------+\n | 0                      | 1.000                  | 0.955                  |\n +------------------------+------------------------+------------------------+\n | 1                      | 1.000                  | 0.962                  |\n +------------------------+------------------------+------------------------+\n | 2                      | 1.000                  | 0.969                  |\n +------------------------+------------------------+------------------------+\n | 3                      | 1.000                  | 0.975                  |\n +------------------------+------------------------+------------------------+\n | 4                      | 1.000                  | 0.982                  |\n +------------------------+------------------------+------------------------+\n | 5                      | 1.000                  | 0.989                  |\n +------------------------+------------------------+------------------------+\n | 6                      | 1.000                  | 0.995                  |\n +------------------------+------------------------+------------------------+\n | 7                      | 1.000                  | 1.002                  |\n +------------------------+------------------------+------------------------+\n | 8                      | 1.000                  | 1.008                  |\n +------------------------+------------------------+------------------------+\n | 9                      | 1.000                  | 1.015                  |\n +------------------------+------------------------+------------------------+\n ============================================================================= 1 failed, 28 passed, 3 skipped in 207.94 seconds =============================================================================\n \u279c  turicreate git:(master) pytest test/test_audio_functionality.py\n =========================================================================================== test session starts ============================================================================================\n platform darwin -- Python 2.7.10, pytest-3.2.5, py-1.8.0, pluggy-0.4.0\n hypothesis profile 'default' -> database=DirectoryBasedExampleDatabase('/Users/zach/turicreate2/debug/src/unity/python/turicreate/.hypothesis/examples')\n rootdir: /Users/zach/turicreate2/debug/src/unity/python, inifile:\n plugins: hypothesis-3.76.0\n collected 32 items                                                                                                                                                                                          \n \n test/test_audio_functionality.py ........s.......s.......s.......\n \n ================================================================================== 29 passed, 3 skipped in 288.04 seconds ==================================================================================\n \u279c  turicreate git:(master)\n </denchmark-code>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "1f502ae90e12613276908180f7b406a4b3008784", "commit_author": "Toby Roseman", "commitT": "2019-04-18 11:17:07-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\unity\\python\\turicreate\\test\\test_audio_functionality.py", "file_new_name": "src\\unity\\python\\turicreate\\test\\test_audio_functionality.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "448,454,455,461,462,463", "deleted_lines": "448,454,460", "method_info": {"method_name": "test_simple_case", "method_params": "self", "method_startline": "420", "method_endline": "470"}}}}}}}