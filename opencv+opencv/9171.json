{"BR": {"BR_id": "9171", "BR_author": "StefanBruens", "BRopenT": "2017-07-16T13:58:17Z", "BRcloseT": "2020-02-03T18:44:19Z", "BR_text": {"BRsummary": "highgui/window_QT.cpp erroneously includes glx.h on GLES plattforms", "BRdescription": "\n <denchmark-h:h5>System information (version)</denchmark-h>\n \n \n OpenCV => 3.2\n Operating System / Platform => Linux\n Compiler => GCC7\n \n <denchmark-h:h5>Detailed description</denchmark-h>\n \n After\n <denchmark-link:https://github.com/opencv/opencv/commit/3bf16da92d1cb42d429e9a81a3a0abd5cf3360a7>3bf16da</denchmark-link>\n , which\n adresses <denchmark-link:https://github.com/opencv/opencv/issues/6471>#6471</denchmark-link>\n ,\n GL/glx.h is included on all LINUX plattforms, which is wrong for a number of reasons:\n \n GL_PERSPECTIVE_CORRECTION_HINT is defined in GL/gl.h, not glx.h, the latter just includes the former\n GL/gl.h is a Desktop GL header, and should not be included on GLES plattforms\n GL/gl.h is already included via QtOpenGL -> QtGui/qopengl.h on desktop plattforms\n \n Including both GLES and GL headers leads to compilation errors on 32bit GLES plattforms, as it causes\n conflicting type declarations:\n <denchmark-code>[  729s] In file included from /usr/include/GL/gl.h:2060:0,\n [  729s]                  from /usr/include/GL/glx.h:32,\n [  729s]                  from /home/abuild/rpmbuild/BUILD/opencv-3.2.0/modules/highgui/src/window_QT.cpp:59:\n [  729s] /usr/include/GL/glext.h:468:19: error: conflicting declaration 'typedef ptrdiff_t GLsizeiptr'\n [  729s]  typedef ptrdiff_t GLsizeiptr;\n [  729s]                    ^~~~~~~~~~\n [  729s] In file included from /usr/include/qt5/QtGui/qopengl.h:107:0,\n [  729s]                  from /usr/include/qt5/QtGui/QtGui:43,\n [  729s]                  from /usr/include/qt5/QtOpenGL/QtOpenGLDepends:4,\n [  729s]                  from /usr/include/qt5/QtOpenGL/QtOpenGL:3,\n [  729s]                  from /home/abuild/rpmbuild/BUILD/opencv-3.2.0/modules/highgui/src/window_QT.h:46,\n [  729s]                  from /home/abuild/rpmbuild/BUILD/opencv-3.2.0/modules/highgui/src/window_QT.cpp:47:\n [  729s] /usr/include/GLES3/gl3.h:73:25: note: previous declaration as 'typedef khronos_ssize_t GLsizeiptr'\n [  729s]  typedef khronos_ssize_t GLsizeiptr;\n </denchmark-code>\n \n GL_PERSPECTIVE_CORRECTION_HINT does not exist in GLES 2.0/3.x, and has been deprecated in OpenGL 3.0 core profiles.\n <denchmark-h:h5>Steps to reproduce</denchmark-h>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "StefanBruens", "commentT": "2020-02-03T18:37:30Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/alalek>@alalek</denchmark-link>\n , <denchmark-link:https://github.com/StefanBruens>@StefanBruens</denchmark-link>\n , should we close it?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "StefanBruens", "commentT": "2020-02-03T18:44:19Z", "comment_text": "\n \t\tWith the two patches merged it should be fixed.\n \t\t"}}}, "commit": {"commit_id": "f05d5888c9c37302e0a0eebf7e7eca65017ebf5f", "commit_author": "StefanBruens", "commitT": "2020-02-02 16:29:04+03:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "modules\\highgui\\src\\window_QT.cpp", "file_new_name": "modules\\highgui\\src\\window_QT.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "3232,3234", "deleted_lines": null, "method_info": {"method_name": "OpenGlViewPort::initializeGL", "method_params": "", "method_startline": "3230", "method_endline": "3235"}}}}}}}