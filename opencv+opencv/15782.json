{"BR": {"BR_id": "15782", "BR_author": "132ikl", "BRopenT": "2019-10-25T22:58:02Z", "BRcloseT": "2019-11-23T10:42:26Z", "BR_text": {"BRsummary": "cv2.VideoCapture(device) blocks indefinitely if device is in use", "BRdescription": "\n <denchmark-h:h3>System information (version)</denchmark-h>\n \n \n OpenCV => 4.1.2\n Operating System / Platform => Arch Linux\n Compiler => GCC 9.2.0\n \n <denchmark-h:h5>Detailed description</denchmark-h>\n \n When creating a  object, if the device is in use then the call will block until the device is released. This doesn't seem to the intended behavior, due to the existent of the  method and multiple answers to questions which seem to indicate this was not always the behavior: <denchmark-link:https://answers.opencv.org/question/16166/how-to-check-if-webcam-is-busy/>1</denchmark-link>\n  <denchmark-link:https://answers.opencv.org/question/199259/how-to-check-if-camera-is-opened-by-any-application/>2</denchmark-link>\n  <denchmark-link:https://stackoverflow.com/a/48049952>3</denchmark-link>\n  <denchmark-link:https://stackoverflow.com/a/44786906>4</denchmark-link>\n  <denchmark-link:https://stackoverflow.com/a/10472231>5</denchmark-link>\n \n <denchmark-h:h5>Steps to reproduce</denchmark-h>\n \n <denchmark-code>Python 3.7.4 (default, Oct  4 2019, 06:57:26)\n [GCC 9.2.0] on linux\n Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n >>> import cv2\n >>> print(cv2.__version__)\n 4.1.2\n >>> x = cv2.VideoCapture(0)\n [ WARN:0] global /build/opencv/src/opencv-4.1.2/modules/videoio/src/cap_gstreamer.cpp (933) open OpenCV | GStreamer warning: Cannot query video position: status=0, value=-1, duration=-1\n >>> y = cv2.VideoCapture(0)\n [ WARN:0] global /build/opencv/src/opencv-4.1.2/modules/videoio/src/cap_gstreamer.cpp (1756) handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src1 reported: Device '/dev/video0' is busy\n [ WARN:0] global /build/opencv/src/opencv-4.1.2/modules/videoio/src/cap_gstreamer.cpp (886) open OpenCV | GStreamer warning: unable to start pipeline\n [ WARN:0] global /build/opencv/src/opencv-4.1.2/modules/videoio/src/cap_gstreamer.cpp (480) isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created\n \n (blocks until original camera released)\n </denchmark-code>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "373160ce0042f9db10481479b4a23a47bbe0150e", "commit_author": "Vadim Levin", "commitT": "2019-11-23 01:10:16+03:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "modules\\videoio\\src\\cap_v4l.cpp", "file_new_name": "modules\\videoio\\src\\cap_v4l.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1987,1989", "deleted_lines": null, "method_info": {"method_name": "cvCreateCameraCapture_V4L", "method_params": "index", "method_startline": "1983", "method_endline": "1993"}}, "hunk_1": {"Ismethod": 1, "added_lines": "484,485", "deleted_lines": null, "method_info": {"method_name": "cv::CvCaptureCAM_V4L::autosetup_capture_mode_v4l2", "method_params": "", "method_startline": "479", "method_endline": "516"}}, "hunk_2": {"Ismethod": 1, "added_lines": "864,866,867,868,870,871,872,873,874,875,876,877,878", "deleted_lines": null, "method_info": {"method_name": "cv::CvCaptureCAM_V4L::tryIoctl", "method_params": "ioctlCode,parameter,failIfBusy,attempts", "method_startline": "864", "method_endline": "899"}}, "hunk_3": {"Ismethod": 1, "added_lines": "864,866,867,868,870,871,872,873,874,875,876,877,878", "deleted_lines": "860,863", "method_info": {"method_name": "cv::CvCaptureCAM_V4L::tryIoctl", "method_params": "ioctlCode,parameter", "method_startline": "860", "method_endline": "884"}}, "hunk_4": {"Ismethod": 1, "added_lines": "410,412", "deleted_lines": "409,412", "method_info": {"method_name": "cv::CvCaptureCAM_V4L::try_palette_v4l2", "method_params": "", "method_startline": "401", "method_endline": "414"}}, "hunk_5": {"Ismethod": 1, "added_lines": "642,643,644", "deleted_lines": "640", "method_info": {"method_name": "cv::CvCaptureCAM_V4L::initCapture", "method_params": "", "method_startline": "620", "method_endline": "679"}}}}}}}