{"BR": {"BR_id": "5062", "BR_author": "opencv-pushbot", "BRopenT": "2015-07-27T11:40:11Z", "BRcloseT": "2015-10-06T12:27:19Z", "BR_text": {"BRsummary": "Data race may happen between oclCleanupCallback and Mat::GetUMat()", "BRdescription": "\n Transferred from <denchmark-link:http://code.opencv.org/issues/4468>http://code.opencv.org/issues/4468</denchmark-link>\n \n <denchmark-code>|| Pavel  Vlasov on 2015-07-07 13:33\n || Priority: Normal\n || Affected: branch 'master' (3.0-dev)\n || Category: None\n || Tracker: Bug\n || Difficulty: \n || PR: \n || Platform: Any / Any\n </denchmark-code>\n \n <denchmark-h:h2>Data race may happen between oclCleanupCallback and Mat::GetUMat()</denchmark-h>\n \n <denchmark-code>Case 1: reuse of old src Mat in OCL pipe leads to data race with oclCleanupCallback and can result in asser fail or other undefined behavior.\n \n Case 2: concurent deallocation of UMatData between UMat (oclCleanupCallback) and Mat (stack) deallocators.\n \n See: https://github.com/Itseez/opencv/pull/3799 this pull-request contains tests for both cases.\n </denchmark-code>\n \n <denchmark-h:h2>History</denchmark-h>\n \n <denchmark-h:h5>Alexander Alekhin on 2015-07-07 13:58</denchmark-h>\n \n <denchmark-code>Related issue: http://code.opencv.org/issues/4380\n </denchmark-code>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "8293ed7f9b9cbae0c585f191bc80f1910e92b8f8", "commit_author": "Alexander Alekhin", "commitT": "2015-08-06 13:50:13+03:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "modules\\core\\test\\test_umat.cpp", "file_new_name": "modules\\core\\test\\test_umat.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094", "deleted_lines": null, "method_info": {"method_name": "cvtest::ocl::OCL_TEST", "method_params": "UMat,OCL_ThreadSafe_CleanupCallback_2_VeryLongTest", "method_startline": "1067", "method_endline": "1094"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064", "deleted_lines": null, "method_info": {"method_name": "cvtest::ocl::OCL_TEST", "method_params": "UMat,OCL_ThreadSafe_CleanupCallback_1_VeryLongTest", "method_startline": "1032", "method_endline": "1064"}}}}}}}