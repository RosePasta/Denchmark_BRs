<commit id='c69194ec4c8c9674368113aa6044d0db708cd813' author='Yufeng Li' date='2020-03-13 09:28:41-07:00'>
	<dmm_unit complexity='0.21818181818181817' interfacing='0.7909090909090909' size='0.0'></dmm_unit>
	<modification change_type='MODIFY' old_name='onnxruntime\python\tools\quantization\calibrate.py' new_name='onnxruntime\python\tools\quantization\calibrate.py'>
		<file_info nloc='189' complexity='34' token_count='1242'></file_info>
		<method name='augment_graph' parameters='model'>
				<method_info nloc='28' complexity='3' token_count='191' nesting_level='0' start_line='25' end_line='63'></method_info>
			<added_lines>42,43,44,45,47,48,49,53,54,55,56,58,59,60</added_lines>
			<deleted_lines>41,42,44,48,49,51</deleted_lines>
		</method>
		<method name='calculate_quantization_params' parameters='model,quantization_thresholds'>
				<method_info nloc='15' complexity='4' token_count='90' nesting_level='0' start_line='160' end_line='196'></method_info>
			<added_lines>180,182,183,184,191,192,193</added_lines>
			<deleted_lines>188,190,191</deleted_lines>
		</method>
		<method name='main' parameters=''>
				<method_info nloc='50' complexity='2' token_count='283' nesting_level='0' start_line='234' end_line='291'></method_info>
			<added_lines>236,237,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,275,276,278,279,281,282,283,284,285,286,287,288</added_lines>
			<deleted_lines>234</deleted_lines>
		</method>
		<method name='calculate_scale_zeropoint' parameters='node,next_node,rmin,rmax'>
				<method_info nloc='20' complexity='7' token_count='153' nesting_level='0' start_line='130' end_line='157'></method_info>
			<added_lines>151</added_lines>
			<deleted_lines>148,150,157</deleted_lines>
		</method>
		<method name='load_pb_file' parameters='data_file_name,size_limit,samples,channels,height,width'>
				<method_info nloc='21' complexity='7' token_count='163' nesting_level='0' start_line='199' end_line='231'></method_info>
			<added_lines>224,225,227,228,229</added_lines>
			<deleted_lines>200,201,202,222,224,226,227,228</deleted_lines>
		</method>
		<method name='get_intermediate_outputs' parameters='model_path,session,inputs,calib_mode'>
				<method_info nloc='40' complexity='11' token_count='306' nesting_level='0' start_line='69' end_line='127'></method_info>
			<added_lines>84,85,88,89,90,93,94,95,96,97,98,99,100,106,107,108,109,112,113,115,116,117,118,119,120,122,123,124</added_lines>
			<deleted_lines>72,75,78,79,85,88,90,91,92,94,120</deleted_lines>
		</method>
		<modified_lines>
			<added_lines>24,65,67,68,129,159,233,293,295</added_lines>
			<deleted_lines>197</deleted_lines>
		</modified_lines>
	</modification>
	<modification change_type='MODIFY' old_name='onnxruntime\python\tools\quantization\data_preprocess.py' new_name='onnxruntime\python\tools\quantization\data_preprocess.py'>
		<file_info nloc='44' complexity='4' token_count='323'></file_info>
		<method name='preprocess_method1' parameters='image_filepath,height,width'>
				<method_info nloc='7' complexity='1' token_count='79' nesting_level='0' start_line='27' end_line='41'></method_info>
			<added_lines>37,38,40</added_lines>
			<deleted_lines>33,34,36</deleted_lines>
		</method>
		<method name='load_batch' parameters='images_folder,height,width,preprocess_func_name,size_limit'>
				<method_info nloc='5' complexity='1' token_count='15' nesting_level='0' start_line='61' end_line='65'></method_info>
			<added_lines>61,62,63,64,65</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='preprocess_method2' parameters='image_filepath,height,width'>
				<method_info nloc='7' complexity='1' token_count='89' nesting_level='0' start_line='44' end_line='58'></method_info>
			<added_lines>54,55,57</added_lines>
			<deleted_lines>49,51,55</deleted_lines>
		</method>
		<method name='set_preprocess' parameters='preprocess_func_name'>
				<method_info nloc='6' complexity='1' token_count='22' nesting_level='0' start_line='14' end_line='24'></method_info>
			<added_lines>20,21,22,23</added_lines>
			<deleted_lines>19,20</deleted_lines>
		</method>
		<modified_lines>
			<added_lines>13,26,43,81,87,88,89,90</added_lines>
			<deleted_lines>71,77,78</deleted_lines>
		</modified_lines>
	</modification>
	<modification change_type='MODIFY' old_name='onnxruntime\python\tools\quantization\quantize.py' new_name='onnxruntime\python\tools\quantization\quantize.py'>
		<file_info nloc='935' complexity='146' token_count='6309'></file_info>
		<method name='_get_quantized_weight' parameters='self,initializer,qType'>
				<method_info nloc='21' complexity='1' token_count='142' nesting_level='1' start_line='414' end_line='442'></method_info>
			<added_lines>421,422,423,424,425,426,427,428,429,430,433,434,435,436,437,438,439</added_lines>
			<deleted_lines>415,416,417,419,420,425,434,436,438</deleted_lines>
		</method>
		<method name='_handle_other_ops' parameters='self,node,new_nodes_list'>
				<method_info nloc='24' complexity='4' token_count='136' nesting_level='1' start_line='1028' end_line='1064'></method_info>
			<added_lines>1046,1047,1048,1050,1051,1052,1053,1054,1055,1056,1060</added_lines>
			<deleted_lines>1028,1030,1040,1041,1055,1060,1064</deleted_lines>
		</method>
		<method name='_quantize_matmul_integer_ops' parameters='self,node,new_nodes_list'>
				<method_info nloc='37' complexity='5' token_count='255' nesting_level='1' start_line='1182' end_line='1235'></method_info>
			<added_lines>1198,1199,1205,1206,1207,1208,1218,1219,1221,1222,1232,1233,1234</added_lines>
			<deleted_lines>1193,1194,1200,1201,1209,1210,1211</deleted_lines>
		</method>
		<method name='_get_dynamic_input_quantization_params_uint8' parameters='self,input_name,nodes_list'>
				<method_info nloc='2' complexity='1' token_count='9' nesting_level='1' start_line='585' end_line='586'></method_info>
			<added_lines>585,586</added_lines>
			<deleted_lines>586</deleted_lines>
		</method>
		<method name='_update_graph' parameters='self,weight'>
				<method_info nloc='27' complexity='2' token_count='183' nesting_level='1' start_line='375' end_line='412'></method_info>
			<added_lines>383,389,390,391,392,393,394,398,401,402,403,404,405,406,407,409,410</added_lines>
			<deleted_lines>398,399,406,410,412</deleted_lines>
		</method>
		<method name='_handle_activation_ops' parameters='self,node,new_node_list'>
				<method_info nloc='9' complexity='4' token_count='84' nesting_level='1' start_line='1066' end_line='1089'></method_info>
			<added_lines>1071,1076</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='quantize_data' parameters='data,quantize_range,qType'>
				<method_info nloc='18' complexity='4' token_count='172' nesting_level='0' start_line='109' end_line='146'></method_info>
			<added_lines>132,134,135,138,139,140,142,143,144</added_lines>
			<deleted_lines>111,112,114,126</deleted_lines>
		</method>
		<method name='_quantize_inputs' parameters='self,node,indices,new_nodes_list'>
				<method_info nloc='54' complexity='11' token_count='367' nesting_level='1' start_line='945' end_line='1026'></method_info>
			<added_lines>961,962,976,977,978,979,987,988,991,992,994,995,998,999,1000,1008,1009,1010,1012,1013</added_lines>
			<deleted_lines>958,964,968,969,979,981,991,1011,1017,1018</deleted_lines>
		</method>
		<method name='_quantize_matmul' parameters='self,node,new_nodes_list'>
				<method_info nloc='7' complexity='3' token_count='58' nesting_level='1' start_line='1363' end_line='1378'></method_info>
			<added_lines>1370</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='_get_quantized_weight_convolution' parameters='self,initializer,qType'>
				<method_info nloc='45' complexity='4' token_count='325' nesting_level='1' start_line='444' end_line='502'></method_info>
			<added_lines>465,466,467,474,478,479,481,482,483,484,485,486,487,488,489,490,493,494,495,496,497,498,499</added_lines>
			<deleted_lines>452,457,463,464,468,469,473,477,478,480,485,486,490</deleted_lines>
		</method>
		<method name='_quantize_matmul_qlinear_ops' parameters='self,node,new_nodes_list'>
				<method_info nloc='30' complexity='2' token_count='226' nesting_level='1' start_line='1297' end_line='1344'></method_info>
			<added_lines>1311,1312,1332,1333,1334,1335,1339,1340,1341,1343</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='_quantize_convolution_qlinear_ops' parameters='self,node,new_nodes_list'>
				<method_info nloc='40' complexity='5' token_count='287' nesting_level='1' start_line='1237' end_line='1295'></method_info>
			<added_lines>1248,1253,1257,1283,1284,1285,1286,1290,1291,1292,1294</added_lines>
			<deleted_lines>1268,1269,1275</deleted_lines>
		</method>
		<method name='_get_quantize_input_nodes' parameters='self,node,input_index,qType'>
				<method_info nloc='39' complexity='6' token_count='242' nesting_level='1' start_line='710' end_line='765'></method_info>
			<added_lines>713,714,725,729,730,731,732,734,735,738,741,742,744,750,751,752,753,755,759,760,761,762,765</added_lines>
			<deleted_lines>712,714,717,721,724,725,726,728,729,737,739,740,744,746,750,751,754,755,756,762,764</deleted_lines>
		</method>
		<method name='check_opset_version' parameters='org_model,force_fusions'>
				<method_info nloc='23' complexity='5' token_count='81' nesting_level='0' start_line='1381' end_line='1413'></method_info>
			<added_lines>1395,1396,1397,1398,1404,1405,1406,1407</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='__init__' parameters='self,model,per_channel,mode,static,fuse_dynamic_quant,weight_qType,input_qType,quantization_params,nodes_to_quantize'>
				<method_info nloc='3' complexity='1' token_count='23' nesting_level='1' start_line='269' end_line='271'></method_info>
			<added_lines>269,270,271</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='_find_node_by_name' parameters='node_name,graph,new_nodes_list'>
				<method_info nloc='5' complexity='1' token_count='34' nesting_level='0' start_line='210' end_line='222'></method_info>
			<added_lines>219</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='_get_bias_add_nodes' parameters='self,nodes,node,last_output,quantized_bias_name'>
				<method_info nloc='2' complexity='1' token_count='13' nesting_level='1' start_line='767' end_line='768'></method_info>
			<added_lines>767,768</added_lines>
			<deleted_lines>767,768</deleted_lines>
		</method>
		<method name='quantize_model' parameters='self'>
				<method_info nloc='29' complexity='15' token_count='256' nesting_level='1' start_line='300' end_line='339'></method_info>
			<added_lines>306,309,318,320,330,331,332,333,336,337</added_lines>
			<deleted_lines>305,306,321,325,326,336</deleted_lines>
		</method>
		<method name='_get_dynamic_input_quantization_params_int8' parameters='self,input_name,nodes_list'>
				<method_info nloc='2' complexity='1' token_count='9' nesting_level='1' start_line='520' end_line='521'></method_info>
			<added_lines>520,521</added_lines>
			<deleted_lines>521</deleted_lines>
		</method>
		<method name='quantize' parameters='model,per_channel,nbits,quantization_mode,static,force_fusions,symmetric_activation,symmetric_weight,quantization_params,nodes_to_quantize'>
				<method_info nloc='10' complexity='1' token_count='43' nesting_level='0' start_line='1416' end_line='1425'></method_info>
			<added_lines>1416,1417,1418,1419,1420,1421,1422,1423,1424,1425</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='_quantize_bias' parameters='self,node,new_node_list'>
				<method_info nloc='48' complexity='4' token_count='351' nesting_level='1' start_line='875' end_line='943'></method_info>
			<added_lines>880,882,883,884,888,889,891,895,896,897,898,899,900,903,904,905,906,907,913,915,916,919,920,921,922,923,927,928,929,930,931,932,934,935,936,937,938,939,940</added_lines>
			<deleted_lines>876,878,879,883,894,899,918,922</deleted_lines>
		</method>
		<method name='_get_dynamic_input_quantization_params' parameters='self,input_name,nodes_list,qType'>
				<method_info nloc='2' complexity='1' token_count='11' nesting_level='1' start_line='504' end_line='505'></method_info>
			<added_lines>504,505</added_lines>
			<deleted_lines>504</deleted_lines>
		</method>
		<method name='_dynamic_quantize_bias' parameters='self,input_name,weight_scale_name,bias_name,quantized_bias_name,new_node_list'>
				<method_info nloc='2' complexity='1' token_count='15' nesting_level='1' start_line='839' end_line='840'></method_info>
			<added_lines>839,840</added_lines>
			<deleted_lines>840</deleted_lines>
		</method>
		<method name='_update_unsupported_nodes_using_weight' parameters='self,weight,new_nodes_list'>
				<method_info nloc='24' complexity='8' token_count='167' nesting_level='1' start_line='801' end_line='837'></method_info>
			<added_lines>801,809,810,811,812,813,814,822,823,824,825,826,827,828</added_lines>
			<deleted_lines>814,815,816,824,827,829,832</deleted_lines>
		</method>
		<method name='_attribute_to_kwarg' parameters='attribute'>
				<method_info nloc='28' complexity='12' token_count='193' nesting_level='0' start_line='149' end_line='185'></method_info>
			<added_lines>156,157,182,183</added_lines>
			<deleted_lines>151,184</deleted_lines>
		</method>
		<method name='__init__' parameters='self,name,initializer,rmins,rmaxs,zero_points,scales,data,quantized_data,axis,qType'>
				<method_info nloc='11' complexity='1' token_count='39' nesting_level='1' start_line='57' end_line='67'></method_info>
			<added_lines>57,58,59,60,61,62,63,64,65,66</added_lines>
			<deleted_lines>57,61,62,63</deleted_lines>
		</method>
		<method name='find_weight_data' parameters='self,initializer'>
				<method_info nloc='8' complexity='2' token_count='48' nesting_level='1' start_line='341' end_line='352'></method_info>
			<added_lines>349,350,351</added_lines>
			<deleted_lines>342,343,344,348,351,352</deleted_lines>
		</method>
		<method name='__init__' parameters='self,name,new_quantized_name,scale_name,zero_point_name,quantized_value_type,axis,qType'>
				<method_info nloc='8' complexity='1' token_count='27' nesting_level='1' start_line='92' end_line='99'></method_info>
			<added_lines>92,93,94,95,96,97,98</added_lines>
			<deleted_lines></deleted_lines>
		</method>
		<method name='_remove_quantized_weights' parameters='self'>
				<method_info nloc='12' complexity='6' token_count='89' nesting_level='1' start_line='354' end_line='373'></method_info>
			<added_lines>366,367,371,372,373</added_lines>
			<deleted_lines>354,365,366,367,368,371,372</deleted_lines>
		</method>
		<method name='_quantize_convolution_integer_ops' parameters='self,node,new_nodes_list'>
				<method_info nloc='48' complexity='8' token_count='324' nesting_level='1' start_line='1111' end_line='1180'></method_info>
			<added_lines>1137,1138,1144,1145,1149,1150,1151,1152,1162,1163,1165,1166,1176,1177,1178</added_lines>
			<deleted_lines>1114,1115,1135,1136,1140,1142,1169</deleted_lines>
		</method>
		<method name='_quantize_gather_ops' parameters='self,node,new_nodes_list'>
				<method_info nloc='14' complexity='1' token_count='125' nesting_level='1' start_line='1091' end_line='1109'></method_info>
			<added_lines>1095,1099,1100,1101</added_lines>
			<deleted_lines>1091,1095,1097</deleted_lines>
		</method>
		<method name='_get_quantization_params' parameters='self,param_name'>
				<method_info nloc='31' complexity='7' token_count='222' nesting_level='1' start_line='665' end_line='708'></method_info>
			<added_lines>670,672,677,678,679,680,683,684,685,687,688,689,701,702,703,704,705,706</added_lines>
			<deleted_lines>667,668,672,680,681,689,690,691,692,703</deleted_lines>
		</method>
		<modified_lines>
			<added_lines>40,41,46,47,48,49,50,51,72,73,77,78,79,80,81,87,108,187,198,209,224,238,252,267,273,274,275,277,280,283,284,299,514,515,517,518,535,536,537,542,543,544,550,551,552,556,557,558,562,563,564,568,569,570,571,573,574,579,580,581,600,601,602,607,608,609,613,614,615,616,618,619,624,625,630,631,638,639,644,645,651,652,656,657,658,659,660,766,783,784,787,788,789,795,796,797,849,851,852,853,856,857,861,862,865,866,867,868,869,870,873,1027,1380,1415,1482,1483,1484,1485,1491,1492,1493</added_lines>
			<deleted_lines>44,45,51,73,106,108,230,231,233,234,235,237,240,243,258,265,268,277,279,289,290,293,413,509,513,514,516,526,533,538,544,548,549,559,561,566,567,570,571,573,574,587,588,589,596,597,608,612,613,615,617,619,622,629,630,632,636,637,639,640,642,657,660,661,769,773,774,776,777,778,783,800,842,855,857,1090</deleted_lines>
		</modified_lines>
	</modification>
	<modification change_type='MODIFY' old_name='onnxruntime\python\tools\quantization\test_calibrate.py' new_name='onnxruntime\python\tools\quantization\test_calibrate.py'>
		<file_info nloc='117' complexity='9' token_count='1180'></file_info>
		<method name='test_load_pb' parameters='self'>
				<method_info nloc='29' complexity='2' token_count='329' nesting_level='1' start_line='115' end_line='153'></method_info>
			<added_lines>121,129,131,152,153</added_lines>
			<deleted_lines>123,124,128</deleted_lines>
		</method>
		<method name='test_load_batch' parameters='self'>
				<method_info nloc='14' complexity='1' token_count='125' nesting_level='1' start_line='96' end_line='113'></method_info>
			<added_lines>100,101,102,103,104,105,106,108,109,110,111,112,113</added_lines>
			<deleted_lines>100,102</deleted_lines>
		</method>
		<method name='test_augment_graph' parameters='self'>
				<method_info nloc='62' complexity='6' token_count='673' nesting_level='1' start_line='21' end_line='94'></method_info>
			<added_lines>29,30,31,32,34,35,36,37,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,74,75,76,77,78,79,87,88,89</added_lines>
			<deleted_lines>29,31,32,41,42,43,44,45,46,58,59,60,68,79,80,82,83,84,85,92</deleted_lines>
		</method>
		<modified_lines>
			<added_lines>20,114,157</added_lines>
			<deleted_lines>19</deleted_lines>
		</modified_lines>
	</modification>
</commit>
