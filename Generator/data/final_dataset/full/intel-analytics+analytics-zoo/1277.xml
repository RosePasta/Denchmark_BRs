<bug_data>
<bug id='1277' author='shane-huang' open_date='2019-04-12T10:03:53Z' closed_time='2019-04-16T06:42:07Z'>
 	<summary>Keras-style API model load/save issue for resume training</summary>
 	<description>
 
 
 Neither of save or saveModel work with Net.load
 
 model.save + Net.load will lead to NullPointerException from bigdl.utils.serializer.ModuleLoader. The error message does not make any sense to the user.
 save a model usingmodel.saveModel and then load model using Net.load, then call model.fit will lead to an error says "'ZooKerasLayer' object has no attribute 'fit'"
 
 
 
 We should add test case and example for resume training as it's a very common request from customers.  Also, model save and saveModel has no clear documents and user don't know which they should use. It easily cause confusion. We may just keep one of them.
 
 
 	</description>
 	<comments>
 		<comment id='1' author='shane-huang' date='2019-04-12T10:05:04Z'>
 		related to issue &lt;denchmark-link:https://github.com/intel-analytics/analytics-zoo/issues/1004&gt;#1004&lt;/denchmark-link&gt;
 
 		</comment>
 		<comment id='2' author='shane-huang' date='2019-04-15T05:19:55Z'>
 		Any example code for reproducing this?
 I tried with the following snippet, and it works fine:
 &lt;denchmark-code&gt;  input = ZLayer.Input(shape=(5,))
         output = ZLayer.Dense(10)(input)
         zmodel = ZModel(input, output, name="graph1")
         tmp_path = "/tmp/aaa" 
         # zmodel.saveModel(tmp_path, None, True)
         model_reloaded = Net.load(tmp_path)
 &lt;/denchmark-code&gt;
 
 		</comment>
 		<comment id='3' author='shane-huang' date='2019-04-15T06:39:35Z'>
 		Probably Net.load in Python doesn't gives an instance of KerasNet and thus can't call fit?
 		</comment>
 		<comment id='4' author='shane-huang' date='2019-04-15T07:07:16Z'>
 		Emmm... Just checked that Net.load returns a KerasNet and should have fit method...
 		</comment>
 		<comment id='5' author='shane-huang' date='2019-04-16T06:42:07Z'>
 		fixed.
 		</comment>
 	</comments>
 </bug>
<commit id='90984c46e8b24ce8dfd4848c9316324b94960baf' author='li,zhichao' date='2019-04-16 14:40:12+08:00'>
 	<dmm_unit complexity='1.0' interfacing='0.8307692307692308' size='1.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='pyzoo\test\zoo\pipeline\api\keras\test_net.py' new_name='pyzoo\test\zoo\pipeline\api\keras\test_net.py'>
 		<file_info nloc='108' complexity='10' token_count='1073'></file_info>
 		<method name='test_save_load_Sequential' parameters='self'>
 				<method_info nloc='12' complexity='1' token_count='111' nesting_level='1' start_line='76' end_line='87'></method_info>
 			<added_lines>76,77,78,79,80,81,82,83,84,85,86,87</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='test_save_load_Model' parameters='self'>
 				<method_info nloc='12' complexity='1' token_count='124' nesting_level='1' start_line='63' end_line='74'></method_info>
 			<added_lines>63,70,71,72,73,74</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='test_deprecated_save' parameters='self'>
 				<method_info nloc='6' complexity='1' token_count='59' nesting_level='1' start_line='56' end_line='61'></method_info>
 			<added_lines>56,57,58,59,60,61</added_lines>
 			<deleted_lines>59</deleted_lines>
 		</method>
 		<method name='test_load' parameters='self'>
 				<method_info nloc='9' complexity='1' token_count='88' nesting_level='1' start_line='89' end_line='97'></method_info>
 			<added_lines>89,90,91,92,93,94,95</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>24,62,75</added_lines>
 			<deleted_lines>55,62</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='pyzoo\zoo\pipeline\api\keras\engine\topology.py' new_name='pyzoo\zoo\pipeline\api\keras\engine\topology.py'>
 		<file_info nloc='271' complexity='65' token_count='1783'></file_info>
 		<method name='saveModel' parameters='self,modelPath,weightPath,over_write'>
 				<method_info nloc='4' complexity='1' token_count='37' nesting_level='1' start_line='33' end_line='45'></method_info>
 			<added_lines>33,34,35,36,37,38,39,40,41,42,43,44,45</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='save' parameters='self,path,over_write'>
 				<method_info nloc='2' complexity='1' token_count='16' nesting_level='1' start_line='30' end_line='31'></method_info>
 			<added_lines>30,31</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>32,46</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='pyzoo\zoo\pipeline\api\net.py' new_name='pyzoo\zoo\pipeline\api\net.py'>
 		<file_info nloc='767' complexity='154' token_count='5841'></file_info>
 		<method name='from_jvalue' parameters='jvalue,bigdl_type'>
 				<method_info nloc='3' complexity='1' token_count='31' nesting_level='1' start_line='155' end_line='157'></method_info>
 			<added_lines>155,156,157</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='load' parameters='model_path,weight_path,bigdl_type'>
 				<method_info nloc='3' complexity='1' token_count='35' nesting_level='1' start_line='172' end_line='184'></method_info>
 			<added_lines>184</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='get_python_class' parameters='self'>
 				<method_info nloc='10' complexity='2' token_count='98' nesting_level='1' start_line='121' end_line='136'></method_info>
 			<added_lines>121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='_get_py_name' parameters='self,jclass_name'>
 				<method_info nloc='7' complexity='3' token_count='33' nesting_level='1' start_line='138' end_line='144'></method_info>
 			<added_lines>138,139,140,141,142,143,144</added_lines>
 			<deleted_lines>138</deleted_lines>
 		</method>
 		<method name='_load_ppackage_by_jpackage' parameters='self,jpackage_name'>
 				<method_info nloc='4' complexity='2' token_count='27' nesting_level='1' start_line='146' end_line='149'></method_info>
 			<added_lines>146,147,148,149</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,jvalue,bigdl_type'>
 				<method_info nloc='5' complexity='1' token_count='28' nesting_level='1' start_line='115' end_line='119'></method_info>
 			<added_lines>115,116,117,118,119</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>27,113,114,120,137,145,150,151,153,154,158</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
