<bug_data>
<bug id='1717' author='myungjoo' open_date='2019-10-01T10:49:31Z' closed_time='2019-10-02T06:46:01Z'>
 	<summary>[UnitTest FAIL] Parallel CAPI issue not fixed.</summary>
 	<description>
 We definitely need to re-enable unit-test in aarch64/Tizen builds.
 &lt;denchmark-code&gt;$ gbs build -A aarch64 --define "unit_test 1"
 ...
 [  164s] [       OK ] nnstreamer_capi_singleshot.benchmark_time (1464 ms)
 [  164s] [ RUN      ] nnstreamer_capi_singleshot.invoke_03
 [  164s] [       OK ] nnstreamer_capi_singleshot.invoke_03 (63 ms)
 [  164s] [ RUN      ] nnstreamer_capi_singleshot.failure_01_n
 [  164s] [       OK ] nnstreamer_capi_singleshot.failure_01_n (87 ms)
 [  164s] [ RUN      ] nnstreamer_capi_singleshot.invoke_timeout
 [  168s] [       OK ] nnstreamer_capi_singleshot.invoke_timeout (3910 ms)
 [  168s] [ RUN      ] nnstreamer_capi_singleshot.parallel_runs
 [  171s] ../tests/tizen_capi/unittest_tizen_capi.cpp:1947: Failure
 [  171s]       Expected: status
 [  171s]       Which is: -1073741823
 [  171s] To be equal to: ML_ERROR_NONE
 [  171s]       Which is: 0
 [  171s] ../tests/tizen_capi/unittest_tizen_capi.cpp:1948: Failure
 [  171s] Value of: output != NULL
 [  171s]   Actual: false
 [  171s] Expected: true
 [  171s] ../tests/tizen_capi/unittest_tizen_capi.cpp:1947: Failure
 [  171s]       Expected: status
 [  171s]       Which is: -1073741823
 [  171s] To be equal to: ML_ERROR_NONE
 [  171s]       Which is: 0
 ...
 [  284s] [  FAILED  ] nnstreamer_capi_singleshot.parallel_runs (116530 ms)
 [  284s] [ RUN      ] nnstreamer_capi_singleshot.close_while_running
 [  286s] [       OK ] nnstreamer_capi_singleshot.close_while_running (1349 ms)
 [  286s] [----------] 8 tests from nnstreamer_capi_singleshot (126154 ms total)
 [  286s] 
 [  286s] [----------] Global test environment tear-down
 [  286s] [==========] 31 tests from 8 test cases ran. (133220 ms total)
 [  286s] [  PASSED  ] 30 tests.
 [  286s] [  FAILED  ] 1 test, listed below:
 [  286s] [  FAILED  ] nnstreamer_capi_singleshot.parallel_runs
 [  286s] 
 [  286s]  1 FAILED TEST
 [  286s] error: Bad exit status from /var/tmp/rpm-tmp.gMCjmT (%build)
 
 &lt;/denchmark-code&gt;
 
 	</description>
 	<comments>
 		<comment id='1' author='myungjoo' date='2019-10-01T10:49:32Z'>
 		 : Thank you for posting issue &lt;denchmark-link:https://github.com/nnstreamer/nnstreamer/issues/1717&gt;#1717&lt;/denchmark-link&gt;
 . The person in charge will reply soon.
 		</comment>
 		<comment id='2' author='myungjoo' date='2019-10-02T01:59:57Z'>
 		This fail on the aarch64 is not from the nnstreamer single API implementations. This is due to the slow tensorflow-lite.
 &lt;denchmark-code&gt;$ gbs build -A aarch64 --define "unit_test 1"
 ...
 [  119s] [ RUN      ] nnstreamer_capi_singleshot.benchmark_time
 [  121s] ** (-0:23218): WARNING **: Time to open single = 7792.000000 us
 [  121s] ** (-0:23218): WARNING **: Time to invoke single = 1395038.000000 us
 [  121s] ** (-0:23218): WARNING **: Time to close single = 54969.000000 us
 [  121s] [       OK ] nnstreamer_capi_singleshot.benchmark_time (1534 ms)
 ...
 &lt;/denchmark-code&gt;
 
 &lt;denchmark-code&gt;$ gbs build -A x86_64 --define "unit_test 1"
 ...
 [  129s] [ RUN      ] nnstreamer_capi_singleshot.benchmark_time
 [  129s] ** (unittest_tizen_capi:32383): WARNING **: Time to open single = 718.000000 us
 [  129s] ** (unittest_tizen_capi:32383): WARNING **: Time to invoke single = 55428.000000 us
 [  129s] ** (unittest_tizen_capi:32383): WARNING **: Time to close single = 51088.000000 us
 [  129s] [       OK ] nnstreamer_capi_singleshot.benchmark_time (169 ms)
 ...
 &lt;/denchmark-code&gt;
 
 nnstreamer_capi_singleshot.benchmark_time runs a NN model once and times it. The time consumed by aarch64 test case does not fit in the timeout values set, causing the error of TIZEN_ERROR_TIMED_OUT or -1073741823.
 I will check the tensorflow-lite build script in tizen.
 		</comment>
 		<comment id='3' author='myungjoo' date='2019-10-02T02:03:25Z'>
 		I will try &lt;denchmark-link:https://github.com/nnsuite/ubuntuport-tensorflow/pull/4&gt;nnsuite/ubuntuport-tensorflow#4&lt;/denchmark-link&gt;
  and &lt;denchmark-link:https://github.com/nnsuite/ubuntuport-tensorflow/pull/5&gt;nnsuite/ubuntuport-tensorflow#5&lt;/denchmark-link&gt;
  in the tizen build script, they might help.
 		</comment>
 		<comment id='4' author='myungjoo' date='2019-10-02T03:24:57Z'>
 		
 This is due to the slow tensorflow-lite.
 
 The API and the test cases should be robust against high latency of neural networks.
 		</comment>
 	</comments>
 </bug>
<commit id='4e113182d7f41ea6a23bea4249c0b9dd98b009e0' author='Parichay Kapoor' date='2019-10-02 15:17:38+09:00'>
 	<dmm_unit complexity='0.9090909090909091' interfacing='1.0' size='0.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='tests\tizen_capi\unittest_tizen_capi.cpp' new_name='tests\tizen_capi\unittest_tizen_capi.cpp'>
 		<file_info nloc='1481' complexity='95' token_count='10524'></file_info>
 		<method name='TEST' parameters='nnstreamer_capi_singleshot,benchmark_time'>
 				<method_info nloc='72' complexity='4' token_count='517' nesting_level='0' start_line='1448' end_line='1538'></method_info>
 			<added_lines>1512,1513,1514</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='single_shot_loop_test' parameters='arg'>
 				<method_info nloc='58' complexity='14' token_count='360' nesting_level='0' start_line='1910' end_line='1981'></method_info>
 			<added_lines>1917,1960,1961,1962,1963,1964,1965,1967</added_lines>
 			<deleted_lines>1942,1943,1944,1945,1947,1948</deleted_lines>
 		</method>
 		<method name='TEST' parameters='nnstreamer_capi_singleshot,close_while_running'>
 				<method_info nloc='26' complexity='3' token_count='163' nesting_level='0' start_line='2122' end_line='2162'></method_info>
 			<added_lines>2142</added_lines>
 			<deleted_lines>2123</deleted_lines>
 		</method>
 		<method name='TEST' parameters='nnstreamer_capi_singleshot,invoke_04'>
 				<method_info nloc='122' complexity='5' token_count='948' nesting_level='0' start_line='1645' end_line='1802'></method_info>
 			<added_lines>1764,1765,1766</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='TEST' parameters='nnstreamer_capi_singleshot,invoke_01'>
 				<method_info nloc='90' complexity='3' token_count='692' nesting_level='0' start_line='1254' end_line='1371'></method_info>
 			<added_lines>1354,1355,1356</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='TEST' parameters='nnstreamer_capi_singleshot,parallel_runs'>
 				<method_info nloc='34' complexity='6' token_count='261' nesting_level='0' start_line='2067' end_line='2115'></method_info>
 			<added_lines>2088,2097,2098</added_lines>
 			<deleted_lines>2069,2078,2079</deleted_lines>
 		</method>
 		<method name='TEST' parameters='nnstreamer_capi_singleshot,invoke_timeout'>
 				<method_info nloc='50' complexity='4' token_count='339' nesting_level='0' start_line='1987' end_line='2060'></method_info>
 			<added_lines>2043,2044,2046</added_lines>
 			<deleted_lines>2024,2025,2027</deleted_lines>
 		</method>
 		<method name='TEST' parameters='nnstreamer_capi_singleshot,invoke_03'>
 				<method_info nloc='69' complexity='5' token_count='545' nesting_level='0' start_line='1545' end_line='1638'></method_info>
 			<added_lines>1610,1611,1612</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='TEST' parameters='nnstreamer_capi_singleshot,invoke_02'>
 				<method_info nloc='50' complexity='3' token_count='338' nesting_level='0' start_line='1377' end_line='1442'></method_info>
 			<added_lines>1427,1428,1429</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>17,18</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
