<bug_data>
<bug id='234' author='gpengzhi' open_date='2019-10-15T04:07:38Z' closed_time='2019-11-21T03:55:51Z'>
 	<summary>A (potential bug) in data module</summary>
 	<description>
 Run seq2seq_attn example.
 python prepare_data.py --data toy_copy
 
 python seq2seq_attn.py --config-model config_model --config-data config_toy_copy
 Have the following error. I believe there was no such error before.
 &lt;denchmark-code&gt;step=0, loss=36.4250
 step=50, loss=22.1697
 step=100, loss=13.6045
 step=150, loss=6.7436
 step=200, loss=4.6603
 step=250, loss=2.5102
 step=300, loss=0.2983
 Traceback (most recent call last):
   File "seq2seq_attn.py", line 180, in &lt;module&gt;
     main()
   File "seq2seq_attn.py", line 166, in main
     _train_epoch()
   File "seq2seq_attn.py", line 131, in _train_epoch
     for batch in data_iterator:
   File "/Users/pengzhi.gao/Desktop/my_git/texar-pytorch/texar/torch/data/data/data_iterators.py", line 426, in __next__
     not self.dataset.hparams.allow_smaller_final_batch):
 AttributeError: '_SPDataLoaderIter' object has no attribute 'dataset'
 &lt;/denchmark-code&gt;
 
 	</description>
 	<comments>
 		<comment id='1' author='gpengzhi' date='2019-10-15T04:10:15Z'>
 		Could you confirm which PyTorch version you're using? _SPDataLoaderIter is something we defined but only exists in PyTorch versions 1.2+, and it should be tested thoroughly in unit tests (SP stands for "single process" so it's indeed the most trivial case).
 		</comment>
 		<comment id='2' author='gpengzhi' date='2019-10-15T04:13:25Z'>
 		Hmm, it's probably a compatibility issue with PyTorch 1.3. They've renamed variables in their data modules so everything is private and dataset became _dataset.
 &lt;denchmark-link:https://github.com/pytorch/pytorch/blob/30d9316f35cb1acab67e680ddc48279d84c7c6fe/torch/utils/data/dataloader.py#L302&gt;https://github.com/pytorch/pytorch/blob/30d9316f35cb1acab67e680ddc48279d84c7c6fe/torch/utils/data/dataloader.py#L302&lt;/denchmark-link&gt;
 
 I'm planning on rewriting the core code of data module so I might as well fix it with &lt;denchmark-link:https://github.com/asyml/texar-pytorch/issues/225&gt;#225&lt;/denchmark-link&gt;
 .
 		</comment>
 		<comment id='3' author='gpengzhi' date='2019-10-15T04:44:34Z'>
 		Ah, I see. I think it is a compatibility issue with PyTorch 1.3.0.
 		</comment>
 	</comments>
 </bug>
<commit id='53d8eade02ae8d578fad1250dd95130ddc20a3b8' author='Pengzhi Gao' date='2019-11-20 22:55:50-05:00'>
 	<dmm_unit complexity='1.0' interfacing='1.0' size='1.0'></dmm_unit>
 	<modification change_type='ADD' old_name='None' new_name='.codecov.yml'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 	</modification>
 	<modification change_type='MODIFY' old_name='.travis.yml' new_name='.travis.yml'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>14,23,24,30,40,41,44,47</added_lines>
 			<deleted_lines>27,37,38,41,44</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='README.md' new_name='README.md'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>116</added_lines>
 			<deleted_lines>116</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='requirements.txt' new_name='requirements.txt'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>1</added_lines>
 			<deleted_lines>1</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='setup.py' new_name='setup.py'>
 		<file_info nloc='55' complexity='0' token_count='147'></file_info>
 		<modified_lines>
 			<added_lines>43</added_lines>
 			<deleted_lines>43</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='texar\torch\data\data\__init__.py' new_name='texar\torch\data\data\__init__.py'>
 		<file_info nloc='13' complexity='0' token_count='121'></file_info>
 		<modified_lines>
 			<added_lines>25</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='texar\torch\data\data\data_iterators.py' new_name='texar\torch\data\data\data_iterators.py'>
 		<file_info nloc='538' complexity='81' token_count='2486'></file_info>
 		<method name='_iterator_unknown_size' parameters='self'>
 				<method_info nloc='8' complexity='1' token_count='14' nesting_level='1' start_line='87' end_line='94'></method_info>
 			<added_lines>91,92,93,94</added_lines>
 			<deleted_lines>87,88,89,90,91,92,93,94</deleted_lines>
 		</method>
 		<method name='__len__' parameters='self'>
 				<method_info nloc='4' complexity='2' token_count='22' nesting_level='1' start_line='125' end_line='128'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>125,126,127,128</deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,int,None,None'>
 				<method_info nloc='2' complexity='1' token_count='34' nesting_level='1' start_line='283' end_line='284'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>283,284</deleted_lines>
 		</method>
 		<method name='__iter__' parameters='self'>
 				<method_info nloc='20' complexity='6' token_count='151' nesting_level='1' start_line='96' end_line='123'></method_info>
 			<added_lines>96</added_lines>
 			<deleted_lines>96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123</deleted_lines>
 		</method>
 		<method name='_iterator_given_size' parameters='self,size'>
 				<method_info nloc='11' complexity='4' token_count='110' nesting_level='1' start_line='205' end_line='216'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>205,206,207,208,209,210,211,212,213,214,215,216</deleted_lines>
 		</method>
 		<method name='reset_batch' parameters='self'>
 				<method_info nloc='5' complexity='1' token_count='11' nesting_level='1' start_line='244' end_line='248'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>244,245,246,247,248</deleted_lines>
 		</method>
 		<method name='add_example' parameters='self,Example'>
 				<method_info nloc='13' complexity='1' token_count='15' nesting_level='1' start_line='250' end_line='262'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>250,251,252,253,254,255,256,257,258,259,260,261,262</deleted_lines>
 		</method>
 		<method name='_iterator_given_size' parameters='self,int'>
 				<method_info nloc='8' complexity='1' token_count='18' nesting_level='1' start_line='78' end_line='85'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>78,79,80,81,82,83,84,85</deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,Any,bool,None'>
 				<method_info nloc='2' complexity='1' token_count='29' nesting_level='1' start_line='167' end_line='168'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>167,168</deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,Any,int'>
 				<method_info nloc='3' complexity='1' token_count='31' nesting_level='1' start_line='201' end_line='203'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>201,202,203</deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,Any,SamplerBase'>
 				<method_info nloc='2' complexity='1' token_count='25' nesting_level='1' start_line='320' end_line='321'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>320,321</deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,Any'>
 				<method_info nloc='4' complexity='1' token_count='32' nesting_level='1' start_line='72' end_line='76'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>72,73,74,75,76</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>21,30,31,32,95</added_lines>
 			<deleted_lines>21,22,28,40,41,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,77,86,95,124,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,204,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,249,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,395,396,397</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='texar\torch\data\data\data_iterators_test.py' new_name='texar\torch\data\data\data_iterators_test.py'>
 		<file_info nloc='326' complexity='46' token_count='2610'></file_info>
 		<method name='test_non_lazy_loading' parameters='self'>
 				<method_info nloc='9' complexity='2' token_count='54' nesting_level='1' start_line='67' end_line='75'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>67,68,69,70,71,72,73,74,75</deleted_lines>
 		</method>
 		<method name='_test_data' parameters='self,DatasetBase,bool,bool'>
 				<method_info nloc='3' complexity='1' token_count='21' nesting_level='1' start_line='46' end_line='48'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>46,47,48</deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,int,str,str,bool'>
 				<method_info nloc='2' complexity='1' token_count='23' nesting_level='2' start_line='27' end_line='28'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>27,28</deleted_lines>
 		</method>
 		<method name='test_lazy_loading' parameters='self'>
 				<method_info nloc='6' complexity='1' token_count='61' nesting_level='1' start_line='77' end_line='82'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>77,78,79,80,81,82</deleted_lines>
 		</method>
 		<method name='setUp' parameters='self'>
 				<method_info nloc='3' complexity='1' token_count='17' nesting_level='1' start_line='41' end_line='43'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>41,42,43</deleted_lines>
 		</method>
 		<method name='test_known_size' parameters='self'>
 				<method_info nloc='5' complexity='1' token_count='53' nesting_level='1' start_line='61' end_line='65'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>61,62,63,64,65</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>8,14,16,19</added_lines>
 			<deleted_lines>8,14,16,17,20,21,22,23,24,25,26,29,30,31,32,33,34,35,36,37,38,39,40,44,45,49,50,51,52,53,54,55,56,57,58,59,60,66,76</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='ADD' old_name='None' new_name='texar\torch\data\data\data_iterators_utils.py'>
 		<file_info nloc='116' complexity='32' token_count='478'></file_info>
 	</modification>
 	<modification change_type='ADD' old_name='None' new_name='texar\torch\data\data\sampler.py'>
 		<file_info nloc='260' complexity='41' token_count='1195'></file_info>
 	</modification>
 	<modification change_type='ADD' old_name='None' new_name='texar\torch\data\data\sampler_test.py'>
 		<file_info nloc='66' complexity='7' token_count='481'></file_info>
 	</modification>
 </commit>
</bug_data>
