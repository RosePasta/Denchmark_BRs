<bug_data>
<bug id='3687' author='youben11' open_date='2020-06-10T09:45:26Z' closed_time='2020-06-18T12:36:28Z'>
 	<summary>Rank to Worker_ID translation should be linked to a specific CrypTen computation</summary>
 	<description>
 &lt;denchmark-h:h2&gt;Description&lt;/denchmark-h&gt;
 
 Server workers are intended to run multiple queries from client in parallel. Starting multiple CrypTen computation on the same worker at a time should be possible, however, due to the current way of storing the rank-to-worker-id translation, starting a new computation will overwrite the old translation dictionary and lead to undefined behavior.
 &lt;denchmark-h:h2&gt;How to Reproduce&lt;/denchmark-h&gt;
 
 
 Start a server worker supporting CrypTen messages
 Start two consecutive and long CrypTen computations with different workers involved
 
 &lt;denchmark-h:h2&gt;Expected Behavior&lt;/denchmark-h&gt;
 
 Running parallel CrypTen computation should work normally as if they were run sequentially.
 &lt;denchmark-h:h2&gt;Additional Context&lt;/denchmark-h&gt;
 
 Also see &lt;denchmark-link:https://github.com/OpenMined/PySyft/issues/3516&gt;#3516&lt;/denchmark-link&gt;
 
 	</description>
 	<comments>
 	</comments>
 </bug>
<commit id='db61f12afe51b3a216c53db80813b8d8ac378055' author='Ayoub Benaissa' date='2020-06-17 14:58:26+01:00'>
 	<dmm_unit complexity='1.0' interfacing='0.96' size='0.12'></dmm_unit>
 	<modification change_type='MODIFY' old_name='syft\frameworks\crypten\__init__.py' new_name='syft\frameworks\crypten\__init__.py'>
 		<file_info nloc='40' complexity='7' token_count='197'></file_info>
 		<method name='load' parameters='str,int,kwargs'>
 				<method_info nloc='12' complexity='3' token_count='103' nesting_level='0' start_line='41' end_line='58'></method_info>
 			<added_lines>43,44,45,46</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='get_worker_from_rank' parameters='int,int'>
 				<method_info nloc='21' complexity='4' token_count='67' nesting_level='0' start_line='16' end_line='38'></method_info>
 			<added_lines>16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>6,7,8,9,10,11,12,13,14,15,39</added_lines>
 			<deleted_lines>9</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='syft\frameworks\crypten\context.py' new_name='syft\frameworks\crypten\context.py'>
 		<file_info nloc='107' complexity='22' token_count='750'></file_info>
 		<method name='_launch' parameters='func,rank,world_size,master_addr,master_port,queue,func_args,func_kwargs'>
 				<method_info nloc='2' complexity='1' token_count='17' nesting_level='0' start_line='15' end_line='16'></method_info>
 			<added_lines>16</added_lines>
 			<deleted_lines>16</deleted_lines>
 		</method>
 		<method name='_new_party' parameters='func,rank,world_size,master_addr,master_port,func_args,func_kwargs'>
 				<method_info nloc='7' complexity='1' token_count='59' nesting_level='0' start_line='37' end_line='43'></method_info>
 			<added_lines>41</added_lines>
 			<deleted_lines>37,41</deleted_lines>
 		</method>
 		<method name='run_party' parameters='cid,func,rank,world_size,master_addr,master_port,func_args,func_kwargs'>
 				<method_info nloc='12' complexity='3' token_count='79' nesting_level='0' start_line='50' end_line='78'></method_info>
 			<added_lines>50,54,68</added_lines>
 			<deleted_lines>63</deleted_lines>
 		</method>
 		<method name='decorator.wrapper' parameters='args,kwargs'>
 				<method_info nloc='51' complexity='14' token_count='361' nesting_level='2' start_line='106' end_line='194'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>133,134,192,193</deleted_lines>
 		</method>
 		<method name='decorator' parameters='func'>
 				<method_info nloc='4' complexity='1' token_count='16' nesting_level='1' start_line='104' end_line='196'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>133,134,192,193</deleted_lines>
 		</method>
 		<method name='_launch' parameters='cid,func,rank,world_size,master_addr,master_port,queue,func_args,func_kwargs'>
 				<method_info nloc='2' complexity='1' token_count='19' nesting_level='0' start_line='15' end_line='16'></method_info>
 			<added_lines>16</added_lines>
 			<deleted_lines>16</deleted_lines>
 		</method>
 		<method name='run_party' parameters='func,rank,world_size,master_addr,master_port,func_args,func_kwargs'>
 				<method_info nloc='12' complexity='3' token_count='75' nesting_level='0' start_line='46' end_line='73'></method_info>
 			<added_lines>50,54,68</added_lines>
 			<deleted_lines>46,63</deleted_lines>
 		</method>
 		<method name='_new_party' parameters='cid,func,rank,world_size,master_addr,master_port,func_args,func_kwargs'>
 				<method_info nloc='7' complexity='1' token_count='63' nesting_level='0' start_line='41' end_line='47'></method_info>
 			<added_lines>41,45</added_lines>
 			<deleted_lines>41,46</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>18,19,20,21</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='syft\frameworks\crypten\message_handler.py' new_name='syft\frameworks\crypten\message_handler.py'>
 		<file_info nloc='61' complexity='8' token_count='397'></file_info>
 		<method name='run_crypten_party_jail' parameters='self,CryptenInitJail'>
 				<method_info nloc='15' complexity='2' token_count='121' nesting_level='1' start_line='57' end_line='87'></method_info>
 			<added_lines>68,69,70,71,78,81,82,83,84,85,86</added_lines>
 			<deleted_lines>69,76,79,82,85</deleted_lines>
 		</method>
 		<method name='_current_rank' parameters='self,rank_to_worker_id'>
 				<method_info nloc='7' complexity='3' token_count='37' nesting_level='1' start_line='89' end_line='96'></method_info>
 			<added_lines>89,92</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='run_crypten_party_plan' parameters='self,CryptenInitPlan'>
 				<method_info nloc='21' complexity='1' token_count='114' nesting_level='1' start_line='26' end_line='55'></method_info>
 			<added_lines>37,38,39,40,48,51,52,53,54</added_lines>
 			<deleted_lines>44,52,55</deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,object_store,worker'>
 				<method_info nloc='4' complexity='1' token_count='37' nesting_level='1' start_line='22' end_line='25'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>25</deleted_lines>
 		</method>
 		<method name='get_worker_from_rank' parameters='BaseWorker,int'>
 				<method_info nloc='3' complexity='1' token_count='34' nesting_level='0' start_line='16' end_line='18'></method_info>
 			<added_lines></added_lines>
 			<deleted_lines>16,17,18</deleted_lines>
 		</method>
 		<method name='_current_rank' parameters='self'>
 				<method_info nloc='7' complexity='3' token_count='39' nesting_level='1' start_line='82' end_line='89'></method_info>
 			<added_lines>82,83,84,85,86,89</added_lines>
 			<deleted_lines>82,85</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>1,7</added_lines>
 			<deleted_lines>1,8,11,19,20</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='test\crypten\test_context.py' new_name='test\crypten\test_context.py'>
 		<file_info nloc='142' complexity='18' token_count='1165'></file_info>
 		<method name='test_run_party' parameters=''>
 				<method_info nloc='6' complexity='1' token_count='48' nesting_level='0' start_line='182' end_line='191'></method_info>
 			<added_lines>189</added_lines>
 			<deleted_lines>189</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines></added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
