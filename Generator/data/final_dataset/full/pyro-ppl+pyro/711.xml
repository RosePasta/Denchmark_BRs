<bug_data>
<bug id='711' author='neerajprad' open_date='2018-01-26T03:46:17Z' closed_time='2018-02-23T20:01:46Z'>
 	<summary>DMM example returns NAN on Pyro dev</summary>
 	<description>
 While refactoring to move to PyTorch distributions, I noticed that the dmm.py example has been throwing warnings after one epoch when it starts encountering NANs at multiple sites.
 This is on the current  branch with Pytorch . &lt;denchmark-link:https://github.com/martinjankowiak&gt;@martinjankowiak&lt;/denchmark-link&gt;
  - Could you help take a look at what's happening?
 
 /Users/npradhan/miniconda2/envs/pytorch/bin/python /Users/npradhan/workspace/pyro_dev/pyro/examples/dmm/dmm.py
 Namespace(annealing_epochs=1000, beta1=0.96, beta2=0.999, checkpoint_freq=0, clip_norm=20.0, cuda=False, iaf_dim=100, learning_rate=0.0004, load_model='', load_opt='', log='dmm.log', lr_decay=0.99996, mini_batch_size=20, minimum_annealing_factor=0.1, num_epochs=5000, num_iafs=0, rnn_dropout_rate=0.1, save_model='', save_opt='', weight_decay=0.6)
 N_train_data: 229     avg. training seq. length: 60.29    N_mini_batches: 12
 [training epoch 0000]  61.6189 				(dt = 16.419 sec)
 /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_70'
   warnings.warn("Encountered NAN log_pdf at site '{}'".format(name))
 /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_71'
   warnings.warn("Encountered NAN log_pdf at site '{}'".format(name))
 /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_73'
   warnings.warn("Encountered NAN log_pdf at site '{}'".format(name))
 /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_74'
   warnings.warn("Encountered NAN log_pdf at site '{}'".format(name))
 /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_75'
 
 
 	</description>
 	<comments>
 		<comment id='1' author='neerajprad' date='2018-02-22T15:15:44Z'>
 		&lt;denchmark-link:https://github.com/neerajprad&gt;@neerajprad&lt;/denchmark-link&gt;
  Could you please check again if this is still an issue? The script runs well to me. I use Pytorch commit . FYI I got NaN at log_pdf many times due to parameters of some distributions get wrong values (for example: sigma &lt; 0 for normal distribution). Maybe there are some bugs at distributions at the time you faced this problem.
 		</comment>
 		<comment id='2' author='neerajprad' date='2018-02-23T20:01:46Z'>
 		Closing as resolved, we can reopen if it happens again
 		</comment>
 	</comments>
 </bug>
<commit id='8db897244589e95e2cc6917d4613267a077cdb6c' author='Neeraj Pradhan' date='2018-01-31 17:31:30-08:00'>
 	<dmm_unit complexity='0.5' interfacing='0.5' size='0.5'></dmm_unit>
 	<modification change_type='MODIFY' old_name='pyro\distributions\transformed_distribution.py' new_name='pyro\distributions\transformed_distribution.py'>
 		<file_info nloc='160' complexity='27' token_count='938'></file_info>
 		<method name='shape' parameters='self,args,kwargs'>
 				<method_info nloc='2' complexity='1' token_count='24' nesting_level='1' start_line='58' end_line='59'></method_info>
 			<added_lines>58,59</added_lines>
 			<deleted_lines>58</deleted_lines>
 		</method>
 		<method name='batch_shape' parameters='self,args,kwargs'>
 				<method_info nloc='2' complexity='1' token_count='24' nesting_level='1' start_line='61' end_line='62'></method_info>
 			<added_lines>61</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='batch_shape' parameters='self,x,args,kwargs'>
 				<method_info nloc='2' complexity='1' token_count='28' nesting_level='1' start_line='58' end_line='59'></method_info>
 			<added_lines>58,59</added_lines>
 			<deleted_lines>58</deleted_lines>
 		</method>
 		<method name='batch_log_det_jacobian' parameters='self,y,args,kwargs'>
 				<method_info nloc='10' complexity='3' token_count='71' nesting_level='1' start_line='236' end_line='248'></method_info>
 			<added_lines>248</added_lines>
 			<deleted_lines>245</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>60</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='tests\test_examples.py' new_name='tests\test_examples.py'>
 		<file_info nloc='49' complexity='15' token_count='377'></file_info>
 		<method name='discover_examples' parameters=''>
 				<method_info nloc='27' complexity='11' token_count='191' nesting_level='0' start_line='15' end_line='44'></method_info>
 			<added_lines>33,34,39,40</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines></added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
