<bug_data>
<bug id='101' author='tscode' open_date='2018-11-10T12:09:39Z' closed_time='2019-01-05T02:08:28Z'>
 	<summary>grad doesn't work on trivial identity</summary>
 	<description>
 I am on the official julia 1.0.1 release with all packages up-to-date.
 The following returns nothing,
 using AutoGrad
 y = Param(1.)
 f(x) = x
 d = @diff f(y)
 grad(d, y) # returns nothing
 while this works:
 f(x) = 1x
 d = @diff f(y)
 grad(d, y) # returns 1.
 	</description>
 	<comments>
 		<comment id='1' author='tscode' date='2018-11-10T12:54:38Z'>
 		Okay I found another problem with broadcasting of user-defined functions that may be related:
 y = Param([1.,2.])
 f(x) = 1x
 d = @diff sum(f.(y))
 grad(d, y) # returns nothing
 In contrast, it works with predefined functions:
 d = @diff sum(sin.(y))
 grad(d, y) # returns something reasonable
 		</comment>
 		<comment id='2' author='tscode' date='2018-11-10T13:00:38Z'>
 		nothing is used interchangably with 0 in AutoGrad results to avoid creating
 large 0 arrays.
 &lt;denchmark-link:#&gt;…&lt;/denchmark-link&gt;
 
 
 On Sat, Nov 10, 2018 at 7:54 AM tscode ***@***.***&gt; wrote:
  Okay I found another problem with broadcasting of user-defined functions
  that may be related:
 
  y = Param([1.,2.])f(x) = 1x
  d = @diff sum(f.(y))grad(d, y) # returns nothing
 
  In contrast, it works with predefined functions:
 
  d = @diff sum(sin.(y))grad(d, y) # returns something reasonable
 
  —
  You are receiving this because you are subscribed to this thread.
  Reply to this email directly, view it on GitHub
  &lt;#101 (comment)&gt;,
  or mute the thread
  &lt;https://github.com/notifications/unsubscribe-auth/ABvNphMCKtqeB_k9XyrGZYK7J09jJdp9ks5utsyPgaJpZM4YX9W8&gt;
  .
 
 
 
 		</comment>
 		<comment id='3' author='tscode' date='2018-11-10T13:18:50Z'>
 		Okay, but I expect the gradient of the identity x -&gt; x to be 1, and not 0. So it should not return nothing, if I understood your comment correctly?
 		</comment>
 		<comment id='4' author='tscode' date='2018-11-10T13:56:39Z'>
 		That is correct, I’ll see what’s wrong...
 &lt;denchmark-link:#&gt;…&lt;/denchmark-link&gt;
 
 
 On Sat, Nov 10, 2018 at 8:18 AM tscode ***@***.***&gt; wrote:
  Okay, but I expect the gradient of the identity x -&gt; x to be 1, and not
  0. So it should not return nothing, if I understood your comment correctly?
 
  —
  You are receiving this because you commented.
 
 
  Reply to this email directly, view it on GitHub
  &lt;#101 (comment)&gt;,
  or mute the thread
  &lt;https://github.com/notifications/unsubscribe-auth/ABvNpg5xrERQ6kwpPH6o1KK7ULCKqLwIks5uttI6gaJpZM4YX9W8&gt;
  .
 
 
 
 		</comment>
 		<comment id='5' author='tscode' date='2018-11-11T22:17:37Z'>
 		The first example failed because I did not handle the case where the differentiated function just returns one of the parameter inputs. It should be fixed in the latest master.
 The second example failed because AutoGrad does not yet support broadcasting arbitrary functions, only some primitives. I added code that throws an error reflecting this instead of silently failing.
 		</comment>
 		<comment id='6' author='tscode' date='2018-11-14T19:21:25Z'>
 		The issue of supporting custom broadcasting also came up in Knet: &lt;denchmark-link:https://github.com/denizyuret/Knet.jl/issues/342&gt;denizyuret/Knet.jl#342&lt;/denchmark-link&gt;
 
 I am leaving this issue open: custom broadcasting used to work in Julia 0.6, maybe we can find a simple fix for 1.0 as well.
 		</comment>
 	</comments>
 </bug>
<commit id='94eca8d0d8c956b766545458c83beaaf1d552741' author='Deniz Yuret' date='2018-11-11 17:17:13-05:00'>
 	<dmm_unit complexity='None' interfacing='None' size='None'></dmm_unit>
 	<modification change_type='MODIFY' old_name='src\core.jl' new_name='src\core.jl'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>55,87</added_lines>
 			<deleted_lines>86</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='test\core.jl' new_name='test\core.jl'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>38,39,40,41,42,43,44</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='test\linearalgebra.jl' new_name='test\linearalgebra.jl'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>50,51,52,58,59</added_lines>
 			<deleted_lines>50,51,52,58,59</deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
