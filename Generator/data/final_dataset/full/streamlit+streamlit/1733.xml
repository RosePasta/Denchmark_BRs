<bug_data>
<bug id='1733' author='SimonBiggs' open_date='2020-07-20T00:49:35Z' closed_time='2020-09-08T19:26:39Z'>
 	<summary>Undocumented breaking change in multiselect default parameter</summary>
 	<description>
 &lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;
 
 In the most recent streamlit version the default parameter in multiselect now expects a list instead of a string. I couldn't find this breaking change documented within the changelog
 Happy to give more info if needed, just let me know.
 	</description>
 	<comments>
 		<comment id='1' author='SimonBiggs' date='2020-07-25T09:44:59Z'>
 		Hi &lt;denchmark-link:https://github.com/SimonBiggs&gt;@SimonBiggs&lt;/denchmark-link&gt;
  ,
 Do you know what version of streamlit you were using when st.multiselect was working the way you saw it work before?
 According to git, this section of code (or at least, its docstring) was written back in Sept 2019:
 &lt;denchmark-code&gt;5bd586469 lib/streamlit/DeltaGenerator.py                (Matteo                        2019-09-27 17:37:50 -0700 1856)         default: [str] or None
 &lt;/denchmark-code&gt;
 
 Let me know any other information you might have that could help here...
 		</comment>
 		<comment id='2' author='SimonBiggs' date='2020-07-25T14:55:33Z'>
 		Yup, running the following
 &lt;denchmark-code&gt;pip install streamlit==0.59.0; python -c "import streamlit as st; print(st.multiselect('boo', [1,2], 1))"
 &lt;/denchmark-code&gt;
 
 Gives:
 &lt;denchmark-code&gt;...
 Successfully installed streamlit-0.59.0
 [1]
 &lt;/denchmark-code&gt;
 
 Running
 &lt;denchmark-code&gt;pip install streamlit==0.60.0; python -c "import streamlit as st; print(st.multiselect('boo', [1,2], 1))"
 &lt;/denchmark-code&gt;
 
 Gives:
 &lt;denchmark-code&gt;...
 Successfully installed streamlit-0.60.0
 Traceback (most recent call last):
   File "&lt;string&gt;", line 1, in &lt;module&gt;
   File "/home/simon/.pyenv/versions/3.7.8/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 122, in wrapped_method
     return dg._enqueue_new_element_delta(marshall_element, delta_type, last_index)
   File "/home/simon/.pyenv/versions/3.7.8/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 367, in _enqueue_new_element_delta
     rv = marshall_element(msg.delta.new_element)
   File "/home/simon/.pyenv/versions/3.7.8/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 120, in marshall_element
     return method(dg, element, *args, **kwargs)
   File "/home/simon/.pyenv/versions/3.7.8/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 1744, in multiselect
     indices = _check_and_convert_to_indices(options, default)
   File "/home/simon/.pyenv/versions/3.7.8/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 1734, in _check_and_convert_to_indices
     default_values = list(default_values)
 TypeError: 'int' object is not iterable
 &lt;/denchmark-code&gt;
 
 		</comment>
 		<comment id='3' author='SimonBiggs' date='2020-07-25T23:15:39Z'>
 		Similar bug reported &lt;denchmark-link:https://discuss.streamlit.io/t/streamlit-0-58-0-to-0-63-0-multiselect/4513/2&gt;on the forum&lt;/denchmark-link&gt;
  so we can come back to the user on resolution :
 
 I upgrade my streamlit app from 0.58.0 to 0.63.0,
 and I noticed that the default parameter for the multiselect() has changed.
 With streamlit 0.63.0, the default parmeter need to be an list (and not a string like in 0.58.0).
 If you update your app, don’t be surprised if you read :
 TypeError: 'int' object is not iterable
 
 		</comment>
 		<comment id='4' author='SimonBiggs' date='2020-07-25T23:28:54Z'>
 		Also, more confusingly:
 &lt;denchmark-h:hr&gt;&lt;/denchmark-h&gt;
 
 &lt;denchmark-code&gt;pip install streamlit==0.59.0; python -c "import streamlit as st; print(st.multiselect('boo', ['simon', 's', 'i', 'm', 'o', 'n'], 'simon'))"
 &lt;/denchmark-code&gt;
 
 gives:
 &lt;denchmark-code&gt;Successfully installed streamlit-0.59.0
 ['simon']
 &lt;/denchmark-code&gt;
 
 &lt;denchmark-h:hr&gt;&lt;/denchmark-h&gt;
 
 and
 &lt;denchmark-code&gt;pip install streamlit==0.60.0; python -c "import streamlit as st; print(st.multiselect('boo', ['simon', 's', 'i', 'm', 'o', 'n'], 'simon'))"
 &lt;/denchmark-code&gt;
 
 gives:
 &lt;denchmark-code&gt;Successfully installed streamlit-0.60.0
 ['s', 'i', 'm', 'o', 'n']
 &lt;/denchmark-code&gt;
 
 		</comment>
 		<comment id='5' author='SimonBiggs' date='2020-07-26T10:08:33Z'>
 		There was indeed a change between 0.59.0 and 0.60.0 on multiselect. Here's the related PR &lt;denchmark-link:https://github.com/streamlit/streamlit/pull/1401&gt;#1401&lt;/denchmark-link&gt;
 .
 Before the change, if the default parameter was just a value like an int or a string, it was put inside a new list internally: [default_options]. After the change the function tries to cast it to a list list(default_options). This explains why you have an error when you pass a single int, and why your string is splitted in letters.
 		</comment>
 		<comment id='6' author='SimonBiggs' date='2020-07-26T11:02:03Z'>
 		
 Before the change, if the default parameter was just a value like an int or a string, it was put inside a new list internally: [default_options]. After the change the function tries to cast it to a list list(default_options). This explains why you have an error when you pass a single int, and why your string is splitted in letters.
 
 Yeah, that does. I would certainly vote for adjusting it so that default="simon" is considered to be the same as default=["simon"] as opposed to default=["s", "i", "m", "o", "n"]
 Likely also worth writing this as a test case to make sure this doesn't slip through again...
 		</comment>
 		<comment id='7' author='SimonBiggs' date='2020-07-30T18:34:32Z'>
 		Thanks for all of the detailed information &lt;denchmark-link:https://github.com/SimonBiggs&gt;@SimonBiggs&lt;/denchmark-link&gt;
  -- I agree we should have a test around this.  Sorry for the bother!  Really appreciate all your time and attention on this one.
 		</comment>
 		<comment id='8' author='SimonBiggs' date='2020-07-30T22:04:27Z'>
 		No need to be sorry :). Thanks for the brilliant tool. That's one of the
 benefits of an open source community. People can look at the code and
 provide explicit actionable feedback.
 &lt;denchmark-link:#&gt;…&lt;/denchmark-link&gt;
 
 
 On Fri, 31 Jul 2020, 4:34 am Naomi Most, ***@***.***&gt; wrote:
  Thanks for all of the detailed information @SimonBiggs
  &lt;https://github.com/SimonBiggs&gt; -- I agree we should have a test around
  this. Sorry for the bother! Really appreciate all your time and attention
  on this one.
 
  —
  You are receiving this because you were mentioned.
  Reply to this email directly, view it on GitHub
  &lt;#1733 (comment)&gt;,
  or unsubscribe
  &lt;https://github.com/notifications/unsubscribe-auth/ABSBK62N73MEMEF52CPDEGDR6G4MPANCNFSM4PBWOVSA&gt;
  .
 
 
 
 		</comment>
 		<comment id='9' author='SimonBiggs' date='2020-07-31T05:39:03Z'>
 		Marked as "bughancement" because this could be fixed in one of two ways:
 
 
 put a test around the behavior as @SimonBiggs suggested, and ensure it works as expected per Simon's example cases.
 
 
 nudge the API so that it is possible to use either a string or a list as the default parameter.  (And of course, the tests.)
 
 
 		</comment>
 		<comment id='10' author='SimonBiggs' date='2020-09-08T19:26:39Z'>
 		We've fixed this now to work successfully with a test to hopefully avoid the issue in the future. Thanks to everyone who pointed this out!
 		</comment>
 		<comment id='11' author='SimonBiggs' date='2020-09-08T21:19:26Z'>
 		Thanks &lt;denchmark-link:https://github.com/kmcgrady&gt;@kmcgrady&lt;/denchmark-link&gt;
  :)
 		</comment>
 	</comments>
 </bug>
<commit id='fb09655d7db1406c550cc76f14c16800a5fd343f' author='Ken McGrady' date='2020-09-08 12:25:53-07:00'>
 	<dmm_unit complexity='None' interfacing='None' size='None'></dmm_unit>
 	<modification change_type='MODIFY' old_name='lib\streamlit\elements\multiselect.py' new_name='lib\streamlit\elements\multiselect.py'>
 		<file_info nloc='35' complexity='16' token_count='266'></file_info>
 		<method name='multiselect._check_and_convert_to_indices' parameters='options,default_values'>
 				<method_info nloc='18' complexity='11' token_count='99' nesting_level='2' start_line='57' end_line='80'></method_info>
 			<added_lines>69</added_lines>
 			<deleted_lines>69</deleted_lines>
 		</method>
 		<method name='multiselect' parameters='dg,label,options,default,format_func,key'>
 				<method_info nloc='13' complexity='5' token_count='133' nesting_level='1' start_line='8' end_line='92'></method_info>
 			<added_lines>69</added_lines>
 			<deleted_lines>69</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines></added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='lib\tests\streamlit\multiselect_test.py' new_name='lib\tests\streamlit\multiselect_test.py'>
 		<file_info nloc='91' complexity='9' token_count='990'></file_info>
 		<modified_lines>
 			<added_lines>117</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
