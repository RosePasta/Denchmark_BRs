<bug_data>
<bug id='17893' author='sxjscience' open_date='2020-03-23T19:52:15Z' closed_time='2020-04-15T23:12:30Z'>
 	<summary>[Bug][Numpy] Wrong gradient of np.where</summary>
 	<description>
 &lt;denchmark-h:h2&gt;Description&lt;/denchmark-h&gt;
 
 Example 1: Using np.where(array, array, scalar)
 import mxnet as mx
 mx.npx.set_np()
 
 a = mx.np.array([1, 0, 1])
 b = mx.np.array([2, 3, 4])
 
 b.attach_grad()
 
 with mx.autograd.record():
     c = mx.np.where(a, b, -1)
     c.backward()
 print(b.grad)
 Output: [0. 1. 0.]
 Example 2: Using np.where(array, array, array)
 import mxnet as mx
 mx.npx.set_np()
 
 a = mx.np.array([1, 0, 1])
 b = mx.np.array([2, 3, 4])
 
 b.attach_grad()
 
 with mx.autograd.record():
     c = mx.np.where(a, b, mx.np.array([-1, -1, -1]))
     c.backward()
 print(b.grad)
 Output: [1. 0. 1.]
 The second one is correct.
 	</description>
 	<comments>
 		<comment id='1' author='sxjscience' date='2020-03-24T06:16:39Z'>
 		&lt;denchmark-link:https://github.com/hgt312&gt;@hgt312&lt;/denchmark-link&gt;
  I think that there might be some issue in the backward + scalar case of where: 
 
 		</comment>
 		<comment id='2' author='sxjscience' date='2020-03-24T08:43:26Z'>
 		Fixed in &lt;denchmark-link:https://github.com/apache/incubator-mxnet/pull/17899&gt;#17899&lt;/denchmark-link&gt;
 
 		</comment>
 	</comments>
 </bug>
<commit id='57c785a0a92041cdd2f1d8888aa5b78f84cf4f73' author='Huang, Guangtai' date='2020-04-10 00:00:34-07:00'>
 	<dmm_unit complexity='1.0' interfacing='1.0' size='0.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='src\operator\numpy\np_where_op-inl.h' new_name='src\operator\numpy\np_where_op-inl.h'>
 		<file_info nloc='363' complexity='48' token_count='4068'></file_info>
 		<method name='mxnet::op::NumpyWhereScalarOpBackward' parameters='attrs,ctx,inputs,req,outputs'>
 				<method_info nloc='64' complexity='8' token_count='789' nesting_level='2' start_line='327' end_line='396'></method_info>
 			<added_lines>372,374,383</added_lines>
 			<deleted_lines>372,374,383</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>326</added_lines>
 			<deleted_lines>326</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='tests\python\unittest\test_numpy_op.py' new_name='tests\python\unittest\test_numpy_op.py'>
 		<file_info nloc='7446' complexity='1781' token_count='82642'></file_info>
 		<method name='test_np_lognormal_grad' parameters=''>
 				<method_info nloc='38' complexity='5' token_count='369' nesting_level='0' start_line='3809' end_line='3854'></method_info>
 			<added_lines>3839</added_lines>
 			<deleted_lines>3839</deleted_lines>
 		</method>
 		<method name='test_np_flipud_fliplr' parameters=''>
 				<method_info nloc='40' complexity='9' token_count='309' nesting_level='0' start_line='6509' end_line='6558'></method_info>
 			<added_lines>6516</added_lines>
 			<deleted_lines>6516</deleted_lines>
 		</method>
 		<method name='test_np_quantile' parameters=''>
 				<method_info nloc='41' complexity='11' token_count='496' nesting_level='0' start_line='7630' end_line='7686'></method_info>
 			<added_lines>7675,7683</added_lines>
 			<deleted_lines>7675,7683</deleted_lines>
 		</method>
 		<method name='test_np_insert' parameters=''>
 				<method_info nloc='85' complexity='15' token_count='1262' nesting_level='0' start_line='2738' end_line='2846'></method_info>
 			<added_lines>2744,2747,2817,2838,2845</added_lines>
 			<deleted_lines>2744,2747,2817,2838,2845</deleted_lines>
 		</method>
 		<method name='test_np_pad' parameters=''>
 				<method_info nloc='40' complexity='10' token_count='472' nesting_level='0' start_line='7285' end_line='7338'></method_info>
 			<added_lines>7293</added_lines>
 			<deleted_lines>7293</deleted_lines>
 		</method>
 		<method name='test_np_random_rayleigh' parameters=''>
 				<method_info nloc='25' complexity='5' token_count='244' nesting_level='0' start_line='4085' end_line='4118'></method_info>
 			<added_lines>4100</added_lines>
 			<deleted_lines>4100</deleted_lines>
 		</method>
 		<method name='test_np_matmul' parameters=''>
 				<method_info nloc='69' complexity='8' token_count='730' nesting_level='0' start_line='425' end_line='555'></method_info>
 			<added_lines>472,534</added_lines>
 			<deleted_lines>472,534</deleted_lines>
 		</method>
 		<method name='test_np_clip' parameters=''>
 				<method_info nloc='53' complexity='11' token_count='458' nesting_level='0' start_line='3566' end_line='3633'></method_info>
 			<added_lines>3590</added_lines>
 			<deleted_lines>3590</deleted_lines>
 		</method>
 		<method name='test_np_ediff1d' parameters=''>
 				<method_info nloc='70' complexity='9' token_count='613' nesting_level='0' start_line='7806' end_line='7915'></method_info>
 			<added_lines>7904</added_lines>
 			<deleted_lines>7904</deleted_lines>
 		</method>
 		<method name='test_np_linalg_norm' parameters=''>
 				<method_info nloc='90' complexity='27' token_count='1200' nesting_level='0' start_line='4689' end_line='4803'></method_info>
 			<added_lines>4759</added_lines>
 			<deleted_lines>4759</deleted_lines>
 		</method>
 		<method name='test_np_diag_indices_from' parameters=''>
 				<method_info nloc='26' complexity='7' token_count='320' nesting_level='0' start_line='8590' end_line='8622'></method_info>
 			<added_lines>8604</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='test_npx_constraint_check' parameters=''>
 				<method_info nloc='23' complexity='5' token_count='188' nesting_level='0' start_line='3673' end_line='3709'></method_info>
 			<added_lines>3678,3685,3695</added_lines>
 			<deleted_lines>3678,3685,3695</deleted_lines>
 		</method>
 		<method name='test_np_matmul.matmul_backward' parameters='a,b'>
 				<method_info nloc='23' complexity='2' token_count='238' nesting_level='1' start_line='433' end_line='484'></method_info>
 			<added_lines>472</added_lines>
 			<deleted_lines>472</deleted_lines>
 		</method>
 		<method name='test_np_percentile' parameters=''>
 				<method_info nloc='43' complexity='11' token_count='542' nesting_level='0' start_line='7691' end_line='7749'></method_info>
 			<added_lines>7701,7738,7746</added_lines>
 			<deleted_lines>7701,7738,7746</deleted_lines>
 		</method>
 		<method name='test_np_where' parameters=''>
 				<method_info nloc='47' complexity='5' token_count='743' nesting_level='0' start_line='8423' end_line='8479'></method_info>
 			<added_lines>8466,8467,8468,8469,8470,8471,8472,8473,8474,8475,8476,8477,8478,8479</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>8480</added_lines>
 			<deleted_lines>8589</deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
