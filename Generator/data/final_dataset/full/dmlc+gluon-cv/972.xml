<bug_data>
<bug id='972' author='MenglingD' open_date='2019-10-03T10:18:33Z' closed_time='2020-07-30T04:02:13Z'>
 	<summary>unable to setting the root for get_model in ssd</summary>
 	<description>
 
 mxnet-version: 1.6.0
 os: ubuntu18.04
 python: 3.6.8
 
 It is seem that the argument of  in  in &lt;denchmark-link:https://github.com/dmlc/gluon-cv/blob/c2f6aa15af55dd33fe8af691e685fee5bc2ed9c6/gluoncv/model_zoo/model_zoo.py#L243&gt;gluoncv/model_zoo/model_zoo.py#L243&lt;/denchmark-link&gt;
  for ssd is not work, after the  is set to :
 547         net = get_model(net_name, pretrained_base=True,
 548                         norm_layer=gluon.nn.BatchNorm,
 549                         root=os.path.join(args.data_root, 'models'))
 As debugging into the call stack of get_model, I find out that the 'root' argument in kwargs of ssd_300_vgg16_atrous_coco  is extracted by the inner invoking of get_ssd, and the call of SSD in get_ssd are missed the root argument and set the default value: os.path.join('~', '.mxnet', 'models') on it:
 the  is ok in here: &lt;denchmark-link:https://github.com/dmlc/gluon-cv/blob/master/gluoncv/model_zoo/ssd/presets.py#L73&gt;gluoncv/model_zoo/ssd/presets.py:73&lt;/denchmark-link&gt;
 :
 55 def ssd_300_vgg16_atrous_coco(pretrained=False, pretrained_base=True, **kwargs):
 ...    ...
 73     net = get_ssd('vgg16_atrous', 300, features=vgg16_atrous_300, filters=None,                                                   
 74                   sizes=[21, 45, 99, 153, 207, 261, 315],                                                                         
 75                   ratios=[[1, 2, 0.5]] + [[1, 2, 0.5, 3, 1.0/3]] * 3 + [[1, 2, 0.5]] * 2,                                         
 76                   steps=[8, 16, 32, 64, 100, 300],                                                                                
 77                   classes=classes, dataset='coco', pretrained=pretrained,                                                         78                   pretrained_base=pretrained_base, **kwargs)
 but in here, the  is extracted from the  arguments and not be passed to :
 &lt;denchmark-link:https://github.com/dmlc/gluon-cv/blob/master/gluoncv/model_zoo/ssd/ssd.py#L331&gt;gluoncv/model_zoo/ssdssd.py:331&lt;/denchmark-link&gt;
 
 331 def get_ssd(name, base_size, features, filters, sizes, ratios, steps, classes,                                                    
 332             dataset, pretrained=False, pretrained_base=True, ctx=mx.cpu(), 
 333             root=os.path.join('~', '.mxnet', 'models'), **kwargs):
 ...     ...
 391     net = SSD(base_name, base_size, features, filters, sizes, ratios, steps,                                                                             
 392               pretrained=pretrained_base, classes=classes, ctx=ctx, **kwargs)                                                                                           
 393     if pretrained:                                                                                                                                           
 394         from ..model_store import get_model_file                                                                                                                      
 395         full_name = '_'.join(('ssd', str(base_size), name, dataset))                                                                                               
 396         net.load_parameters(get_model_file(full_name, tag=pretrained, root=root), ctx=ctx)                                        
 397     return net
 Theoretically, the 'root' argument is not only indicating the path of parameters for pretrained model but also for pretrained_base model. So is that is a bug, or some incorrect operation by me. Please let me know, and thank you for your attention.
 	</description>
 	<comments>
 		<comment id='1' author='MenglingD' date='2019-10-07T04:14:25Z'>
 		The current logic will make sure you get the pretrained full model from the path you specified, but seems like the pretrained_base model are not getting the correct root. Sounds like a bug to me and I will fix it.
 		</comment>
 		<comment id='2' author='MenglingD' date='2020-07-21T13:15:52Z'>
 		Was this fixed ?
 		</comment>
 		<comment id='3' author='MenglingD' date='2020-07-22T18:05:45Z'>
 		&lt;denchmark-link:https://github.com/zewelor&gt;@zewelor&lt;/denchmark-link&gt;
  Yes, let me know if it persists
 		</comment>
 		<comment id='4' author='MenglingD' date='2020-07-23T10:34:29Z'>
 		I've faced this bug after:
 &lt;denchmark-code&gt;model_zoo.get_model("deeplab_resnet101_coco", root='/tmp/', pretrained=True)
 &lt;/denchmark-code&gt;
 
 It resulted in:
 &lt;denchmark-code&gt;Downloading /root/.mxnet/models/resnet101_v1s-bd93a83c.zip from https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/models/resnet101_v1s-bd93a83c.zip...                        
 Downloading /tmp/deeplab_resnet101_coco-ed817f76.zip from https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/models/deeplab_resnet101_coco-ed817f76.zip...   
 &lt;/denchmark-code&gt;
 
 		</comment>
 	</comments>
 </bug>
<commit id='4d8f5c77f7d78fa4a11ebb7a21cc3104a5f87868' author='Joshua Z. Zhang' date='2020-07-29 21:02:12-07:00'>
 	<dmm_unit complexity='None' interfacing='None' size='None'></dmm_unit>
 	<modification change_type='MODIFY' old_name='gluoncv\model_zoo\deeplabv3.py' new_name='gluoncv\model_zoo\deeplabv3.py'>
 		<file_info nloc='412' complexity='27' token_count='1798'></file_info>
 		<modified_lines>
 			<added_lines>45,112,211,212,213</added_lines>
 			<deleted_lines>111</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='gluoncv\model_zoo\deeplabv3_plus.py' new_name='gluoncv\model_zoo\deeplabv3_plus.py'>
 		<file_info nloc='259' complexity='17' token_count='2054'></file_info>
 		<modified_lines>
 			<added_lines>43,272,273,274</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='gluoncv\model_zoo\deeplabv3b_plus.py' new_name='gluoncv\model_zoo\deeplabv3b_plus.py'>
 		<file_info nloc='244' complexity='17' token_count='1919'></file_info>
 		<modified_lines>
 			<added_lines>39,40,242,243,244</added_lines>
 			<deleted_lines>39</deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
