<bug_data>
<bug id='3713' author='fizban99' open_date='2019-05-09T13:22:52Z' closed_time='2019-05-11T13:48:41Z'>
 	<summary>"illegal type for path parameter" on Linux when using CLI train</summary>
 	<description>
 &lt;denchmark-h:h2&gt;How to reproduce the behaviour&lt;/denchmark-h&gt;
 
 After running the train CLI tool, I get an error on Linux:
 &lt;denchmark-code&gt;File "[...]/lib/python3.5/site-packages/spacy/cli/train.py", line 382, in _collate_best_model
     shutil.copytree(output_path / "model-final", best_dest)
   File "[...]/lib/python3.5/shutil.py", line 309, in copytree
     names = os.listdir(src)
 TypeError: argument should be string, bytes or integer, not PosixPath
 Exception ignored in: &lt;bound method GoldCorpus.__del__ of &lt;spacy.gold.GoldCorpus object at 0x7f6e53d262b0&gt;&gt;
 Traceback (most recent call last):
   File "gold.pyx", line 116, in spacy.gold.GoldCorpus.__del__
   File "[...]/lib/python3.5/shutil.py", line 471, in rmtree
     onerror(os.lstat, path, sys.exc_info())
   File "[...]/lib/python3.5/shutil.py", line 469, in rmtree
     orig_st = os.lstat(path)
 TypeError: lstat: illegal type for path parameter
 
 &lt;/denchmark-code&gt;
 
 It looks like in lines 381-382 of train.py copytree is used with a PosixPath and it fails on Linux.
 &lt;denchmark-code&gt;    best_dest = output_path / "model-best"
     shutil.copytree(output_path / "model-final", best_dest)
 &lt;/denchmark-code&gt;
 
 This works fine on Windows. Shouldn't the paths be coerced to string with str()?
 &lt;denchmark-h:h2&gt;Your Environment&lt;/denchmark-h&gt;
 
 
 Platform: Linux-4.4.0-145-generic-x86_64-with-centos-7.6.1810-Core
 spaCy version: 2.1.3
 Python version: 3.5.5
 
 	</description>
 	<comments>
 		<comment id='1' author='fizban99' date='2019-05-10T23:47:32Z'>
 		Thanks. I've been testing this on 3.6, where the standard library supports PosixPath objects. A PR would be welcome.
 		</comment>
 		<comment id='2' author='fizban99' date='2019-05-13T08:26:05Z'>
 		Thank you. You are right. I had 3.7 on Windows.
 I tried the new version of the train.py file modified by Ines and, although the model-best version is created, I still get the following:
 &lt;denchmark-code&gt;Exception ignored in: &lt;bound method GoldCorpus.__del__ of &lt;spacy.gold.GoldCorpus object at 0x7f08792459e8&gt;&gt;
 Traceback (most recent call last):
   File "gold.pyx", line 116, in spacy.gold.GoldCorpus.__del__
   File "[...]/lib/python3.5/shutil.py", line 471, in rmtree
     onerror(os.lstat, path, sys.exc_info())
   File "[...]/lib/python3.5/shutil.py", line 469, in rmtree
     orig_st = os.lstat(path)
 TypeError: lstat: illegal type for path parameter
 &lt;/denchmark-code&gt;
 
 		</comment>
 		<comment id='3' author='fizban99' date='2019-05-14T13:45:33Z'>
 		Strangely, I do not get that error anymore...
 		</comment>
 		<comment id='4' author='fizban99' date='2019-06-13T16:40:08Z'>
 		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
 		</comment>
 	</comments>
 </bug>
<commit id='6b3a79ac963bae3545628e12ed2b5367cd0103eb' author='Ines Montani' date='2019-05-11 15:48:35+02:00'>
 	<dmm_unit complexity='1.0' interfacing='0.0' size='0.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='spacy\cli\train.py' new_name='spacy\cli\train.py'>
 		<file_info nloc='434' complexity='33' token_count='2943'></file_info>
 		<method name='_collate_best_model' parameters='meta,output_path,components'>
 				<method_info nloc='16' complexity='4' token_count='132' nesting_level='0' start_line='422' end_line='437'></method_info>
 			<added_lines>427,429,430,431,432</added_lines>
 			<deleted_lines>426,428,429</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>19</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
