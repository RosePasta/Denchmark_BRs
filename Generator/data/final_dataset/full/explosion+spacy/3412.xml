<bug_data>
<bug id='3412' author='sarim-zafar' open_date='2019-03-15T20:05:59Z' closed_time='2019-10-21T10:04:47Z'>
 	<summary>most_similar() not working</summary>
 	<description>
 &lt;denchmark-h:h2&gt;How to reproduce the behaviour&lt;/denchmark-h&gt;
 
 import spacy
 nlp = spacy.load('en_core_web_lg')
 nlp.vocab.vectors.most_similar(nlp('cats').vector.reshape(1,300))
 returns following
 (array([], dtype=uint64), array([0], dtype=int32), array([nan], dtype=float32))
 While computing the results i get the following warning
 /anaconda3/envs/deep/lib/python3.6/site-packages/ipykernel_launcher.py:1: RuntimeWarning: divide by zero encountered in true_divide """Entry point for launching an IPython kernel. /anaconda3/envs/deep/lib/python3.6/site-packages/ipykernel_launcher.py:1: RuntimeWarning: invalid value encountered in true_divide """Entry point for launching an IPython kernel. /anaconda3/envs/deep/lib/python3.6/site-packages/numpy/core/_methods.py:28: RuntimeWarning: invalid value encountered in reduce return umr_maximum(a, axis, None, out, keepdims, initial)
 &lt;denchmark-h:h2&gt;Info about spaCy and Enviroment&lt;/denchmark-h&gt;
 
 
 spaCy version: 2.1.0a13
 Platform: Darwin-18.2.0-x86_64-i386-64bit
 Python version: 3.6.8
 Models: en_core_web_lg, xx_ent_wiki_sm, xx
 Environment Information: Anaconda
 
 	</description>
 	<comments>
 		<comment id='1' author='sarim-zafar' date='2019-03-17T19:11:24Z'>
 		Hi &lt;denchmark-link:https://github.com/ines&gt;@ines&lt;/denchmark-link&gt;
 , any idea what I should do fix it?. Is there any version you recommend I roll back to in which this feature works?
 		</comment>
 		<comment id='2' author='sarim-zafar' date='2019-03-20T20:36:35Z'>
 		&lt;denchmark-link:https://github.com/emiguevara&gt;@emiguevara&lt;/denchmark-link&gt;
  but i am not using a GPU, its a plain MacBook
 		</comment>
 		<comment id='3' author='sarim-zafar' date='2019-03-23T19:56:49Z'>
 		&lt;denchmark-link:https://github.com/ines&gt;@ines&lt;/denchmark-link&gt;
  any kind of response would be appreciated
 		</comment>
 		<comment id='4' author='sarim-zafar' date='2019-04-08T18:54:44Z'>
 		The problem seems to be with the nlp.vocab.vectors.data. The first row is all zeros, so normalizing the vectors for cosine distance does a divide by zero.
 &lt;denchmark-code&gt;In [1]: import spacy                                                                                                
 
 In [2]: nlp = spacy.load('en_core_web_lg')                                                                          
 
 In [3]: nlp.vocab.vectors.data                                                                                      
 Out[3]: 
 array([[ 0.       ,  0.       ,  0.       , ...,  0.       ,  0.       ,
          0.       ],
        [ 0.012001 ,  0.20751  , -0.12578  , ...,  0.13871  , -0.36049  ,
         -0.035    ],
        [-0.082752 ,  0.67204  , -0.14987  , ..., -0.1918   , -0.37846  ,
         -0.06589  ],
        ...,
        [ 0.42247  , -0.28522  , -0.38661  , ...,  0.27521  ,  0.23623  ,
         -0.72113  ],
        [ 0.47918  , -0.32734  , -0.23593  , ..., -0.19494  , -0.065226 ,
         -0.36282  ],
        [-0.63354  , -0.1503   , -0.36161  , ...,  0.26216  , -0.12094  ,
          0.0038262]], dtype=float32)
 &lt;/denchmark-code&gt;
 
 I think it might be the OOV vector?
 		</comment>
 		<comment id='5' author='sarim-zafar' date='2019-04-13T22:53:03Z'>
 		Just a side note:
 It works fine with en_core_web_md model
 		</comment>
 		<comment id='6' author='sarim-zafar' date='2019-11-20T10:54:46Z'>
 		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
 		</comment>
 	</comments>
 </bug>
<commit id='d5d55312b2c5184ec96f8f073eab1b045b441fe4' author='Sofie Van Landeghem' date='2019-10-21 12:04:46+02:00'>
 	<dmm_unit complexity='1.0' interfacing='1.0' size='1.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='spacy\tests\regression\test_issue3001-3500.py' new_name='spacy\tests\regression\test_issue3001-3500.py'>
 		<file_info nloc='268' complexity='22' token_count='2093'></file_info>
 		<method name='test_issue3412' parameters=''>
 				<method_info nloc='5' complexity='1' token_count='94' nesting_level='0' start_line='297' end_line='301'></method_info>
 			<added_lines>297,298,299,300,301</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>18,302,303</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='spacy\vectors.pyx' new_name='spacy\vectors.pyx'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>324,325,326,333,334,335</added_lines>
 			<deleted_lines>324,331</deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
