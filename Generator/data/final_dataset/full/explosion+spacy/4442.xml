<bug_data>
<bug id='4442' author='ewaldatsensentia' open_date='2019-10-14T23:15:00Z' closed_time='2019-10-16T11:40:19Z'>
 	<summary>EntityRuler does not support LENGTH type patterns in 2.2.1; worked in 2.1.8</summary>
 	<description>
 &lt;denchmark-h:h2&gt;How to reproduce the behaviour&lt;/denchmark-h&gt;
 
 import spacy
 from spacy.pipeline import EntityRuler
 nlp =  spacy.load('en_core_web_md')
 ruler = EntityRuler(nlp, validate=True, overwrite_ents=True)
 patterns = [{"label":"MYCODE", "pattern":[{"LENGTH":5,"SHAPE":"dddd"}]}]
 ruler.add_patterns(patterns)
 &lt;denchmark-h:h2&gt;Result&lt;/denchmark-h&gt;
 
 ValueError                                Traceback (most recent call last)
  in 
 4 ruler = EntityRuler(nlp, validate=True, overwrite_ents=True)
 5 patterns = [{"label":"MYCODE", "pattern":[{"LENGTH":5,"SHAPE":"dddd"}]}]
 ----&gt; 6 ruler.add_patterns(patterns)
 ~\Anaconda3\lib\site-packages\spacy\pipeline\entityruler.py in add_patterns(self, patterns)
 200                     raise ValueError(Errors.E097.format(pattern=pattern))
 201             for label, patterns in self.token_patterns.items():
 --&gt; 202                 self.matcher.add(label, None, *patterns)
 203             for label, patterns in self.phrase_patterns.items():
 204                 self.phrase_matcher.add(label, None, *patterns)
 matcher.pyx in spacy.matcher.matcher.Matcher.add()
 matcher.pyx in spacy.matcher.matcher._preprocess_pattern()
 matcher.pyx in spacy.matcher.matcher._get_attr_values()
 ValueError: [E153] The value type int is not supported for token patterns. Please use the option validate=True with Matcher, PhraseMatcher, or EntityRuler for more details.
 &lt;denchmark-h:h2&gt;Your Environment&lt;/denchmark-h&gt;
 
 
 spaCy version: 2.2.1
 Platform: Windows-10-10.0.18362-SP0
 Python version: 3.7.3
 
 	</description>
 	<comments>
 		<comment id='1' author='ewaldatsensentia' date='2019-10-15T00:19:12Z'>
 		Thanks for the report! The validation added in 2.2 was a bit overzealous here and hopefully should be fixed in the next minor release. I think the following workaround should work in the meanwhile:
 &lt;denchmark-code&gt;[{"LENGTH": {"==": 5}}]
 &lt;/denchmark-code&gt;
 
 		</comment>
 		<comment id='2' author='ewaldatsensentia' date='2019-10-15T00:34:02Z'>
 		Thank you for the workaround.
 		</comment>
 		<comment id='3' author='ewaldatsensentia' date='2019-11-15T11:54:36Z'>
 		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
 		</comment>
 	</comments>
 </bug>
<commit id='275c9ad872a87c4ba131987656be4861617d3d90' author='adrianeboyd' date='2019-10-16 13:40:18+02:00'>
 	<dmm_unit complexity='None' interfacing='None' size='None'></dmm_unit>
 	<modification change_type='MODIFY' old_name='spacy\matcher\matcher.pyx' new_name='spacy\matcher\matcher.pyx'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>661</added_lines>
 			<deleted_lines>661</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='spacy\tests\matcher\test_pattern_validation.py' new_name='spacy\tests\matcher\test_pattern_validation.py'>
 		<file_info nloc='56' complexity='7' token_count='709'></file_info>
 		<modified_lines>
 			<added_lines>23,27,28,33</added_lines>
 			<deleted_lines>15,18,19</deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
