<bug_data>
<bug id='3150' author='xrmx' open_date='2019-01-12T16:38:31Z' closed_time='2019-01-16T12:46:34Z'>
 	<summary>Doc.print_tree(flat=True) broken in spacy 2.0.18</summary>
 	<description>
 &lt;denchmark-h:h2&gt;How to reproduce the behaviour&lt;/denchmark-h&gt;
 
 &lt;denchmark-code&gt;$ python
 Python 3.7.2 (default, Jan  3 2019, 02:55:40) 
 [GCC 8.2.0] on linux
 Type "help", "copyright", "credits" or "license" for more information.
 &gt;&gt;&gt; import spacy
 &gt;&gt;&gt; nlp = spacy.load('en_core_web_sm')
 &gt;&gt;&gt; doc = nlp('Alice ate the pizza')
 &gt;&gt;&gt; doc.print_tree(flat=True)
 Traceback (most recent call last):
   File "&lt;stdin&gt;", line 1, in &lt;module&gt;
   File "doc.pyx", line 983, in spacy.tokens.doc.Doc.print_tree
   File "/venv/lib/python3.7/site-packages/spacy/tokens/printers.py", line 74, in parse_tree
     for sent in doc_clone.sents]
   File "/venv/lib/python3.7/site-packages/spacy/tokens/printers.py", line 74, in &lt;listcomp&gt;
     for sent in doc_clone.sents]
   File "/venv/lib/python3.7/site-packages/spacy/tokens/printers.py", line 41, in POS_tree
     subtree["modifiers"].append(POS_tree(c))
 KeyError: 'modifiers'
 &lt;/denchmark-code&gt;
 
 doc.print_tree() is the following:
 &lt;denchmark-code&gt;[{'NE': '',
   'POS_coarse': 'VERB',
   'POS_fine': 'VBD',
   'arc': 'ROOT',
   'lemma': 'eat',
   'modifiers': [{'NE': '',
                  'POS_coarse': 'PROPN',
                  'POS_fine': 'NNP',
                  'arc': 'nsubj',
                  'lemma': 'alice',
                  'modifiers': [],
                  'word': 'Alice'},
                 {'NE': '',
                  'POS_coarse': 'NOUN',
                  'POS_fine': 'NN',
                  'arc': 'dobj',
                  'lemma': 'pizza',
                  'modifiers': [{'NE': '',
                                 'POS_coarse': 'DET',
                                 'POS_fine': 'DT',
                                 'arc': 'det',
                                 'lemma': 'the',
                                 'modifiers': [],
                                 'word': 'the'}],
                  'word': 'pizza'}],
   'word': 'ate'}]
 &lt;/denchmark-code&gt;
 
 &lt;denchmark-h:h2&gt;Your Environment&lt;/denchmark-h&gt;
 
 
 spaCy version: 2.0.18
 Platform: Linux-4.19.0-1-amd64-x86_64-with-debian-buster-sid
 Python version: 3.7.2
 Models: en_core_web_sm
 
 	</description>
 	<comments>
 		<comment id='1' author='xrmx' date='2019-01-12T19:28:03Z'>
 		When the argument flat = True, the key "modifiers" of the dict containing the tree is deleted. I guess putting an if statement in the function POS_tree could fixed the issue.
 def POS_tree(root, light=False, flat=False):
     """Helper: generate a POS tree for a root token. The doc must have
     `merge_ents(doc)` ran on it.
     """
     subtree = format_POS(root, light=light, flat=flat)
     if not flat:
         for c in root.children:
             subtree["modifiers"].append(POS_tree(c))
     return subtree
 If  the solution is approved, I can submit a small PR.
 		</comment>
 		<comment id='2' author='xrmx' date='2019-01-13T23:42:42Z'>
 		Yes, a PR would be nice!
 One thing to note re : At the moment, we've deprecated  for , because  will introduce a new  method that's also used for training and will output data that exactly matches spaCy's new training format (see &lt;denchmark-link:https://github.com/explosion/spaCy/issues/2928&gt;#2928&lt;/denchmark-link&gt;
 ).
 However, Doc.to_json won't actually cover everything that Doc.print_tree covered, so maybe we do want to bring that one back. I'm not 100% sure if people actually use it much, or whether it makes more sense for users to build their own logic that's more specific to their application.
 		</comment>
 		<comment id='3' author='xrmx' date='2019-02-15T13:22:43Z'>
 		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
 		</comment>
 	</comments>
 </bug>
<commit id='214c2ec2631a5d9d7ae15885c0b7644cbb95b474' author='mauryaland' date='2019-01-14 23:47:05+01:00'>
 	<dmm_unit complexity='1.0' interfacing='0.0' size='1.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='spacy\tokens\printers.py' new_name='spacy\tokens\printers.py'>
 		<file_info nloc='37' complexity='11' token_count='316'></file_info>
 		<method name='POS_tree' parameters='root,light,flat'>
 				<method_info nloc='6' complexity='3' token_count='53' nesting_level='0' start_line='35' end_line='43'></method_info>
 			<added_lines>40,41,42</added_lines>
 			<deleted_lines>40,41</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines></added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
