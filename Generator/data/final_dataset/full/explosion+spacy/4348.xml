<bug_data>
<bug id='4348' author='AbhayGodbole' open_date='2019-10-01T06:28:31Z' closed_time='2019-10-02T02:04:11Z'>
 	<summary>Getting IndexError: list index out of range</summary>
 	<description>
 Hi
 I am trying to train the new NER model.  Getting following error while calling " nlp.update(texts, annotations, sgd=optimizer, drop=0.35,
 losses=losses)"
 &lt;denchmark-code&gt;INFO : Created blank 'en' model
 ERROR : Unable to process 
 Error = list index out of range
 Traceback (most recent call last):
   File "..\entityextractor\model.py", line 84, in trainModel
     losses=losses)
   File "c:\abhay\ai\ris-auditsupport\virris-auditsupport\lib\site-packages\spacy\language.py", line 475, in update
     proc.update(docs, golds, sgd=get_grads, losses=losses, **kwargs)
   File "nn_parser.pyx", line 418, in spacy.syntax.nn_parser.Parser.update
   File "_parser_model.pyx", line 214, in spacy.syntax._parser_model.ParserModel.begin_update
   File "_parser_model.pyx", line 262, in spacy.syntax._parser_model.ParserStepModel.__init__
   File "c:\abhay\ai\ris-auditsupport\virris-auditsupport\lib\site-packages\thinc\neural\_classes\feed_forward.py", line 46, in begin_update
     X, inc_layer_grad = layer.begin_update(X, drop=drop)
   File "c:\abhay\ai\ris-auditsupport\virris-auditsupport\lib\site-packages\thinc\api.py", line 295, in begin_update
     X, bp_layer = layer.begin_update(layer.ops.flatten(seqs_in, pad=pad), drop=drop)
   File "ops.pyx", line 113, in thinc.neural.ops.Ops.flatten
 IndexError: list index out of range
 In [ ]:
 &lt;/denchmark-code&gt;
 
 I am following a standard process, which worked for my earlier project.
 
 I have .tsv annotated fie, which currently have only one Entity annotated and rest is marked as "O"
 converting this tsv to json
 converting this json to spacy required format.
 passing this file to train the model.
 
 Looks like, there is some issue with the data, which I am not able to figure out, as if I provide my previous json, its working fine.
 Please help
 &lt;denchmark-h:h2&gt;Info about spaCy&lt;/denchmark-h&gt;
 
 
 spaCy version: 2.1.8
 Platform: Windows-10-10.0.16299-SP0
 Python version: 3.7.1
 
 	</description>
 	<comments>
 		<comment id='1' author='AbhayGodbole' date='2019-10-01T06:53:43Z'>
 		Thanks for the report! We'll look into this. Just a quick question: are you training on GPU or CPU?
 		</comment>
 		<comment id='2' author='AbhayGodbole' date='2019-10-01T07:24:05Z'>
 		I am training on CPU
 		</comment>
 		<comment id='3' author='AbhayGodbole' date='2019-10-02T02:04:11Z'>
 		Hi
 It got solved. The issue was in Data. There were multiple full stops as part of the tokens like:
 .  O
 .  O
 .  O
 So it might be generating blank sentences while converting this to Json. When I removed this multiple occurrences, the error got fixed.
 In same use case I have one problem, which I will open another ticket for. This can be closed.
 		</comment>
 		<comment id='4' author='AbhayGodbole' date='2019-10-02T10:59:57Z'>
 		Hi &lt;denchmark-link:https://github.com/AbhayGodbole&gt;@AbhayGodbole&lt;/denchmark-link&gt;
  - happy to hear you got it solved. A recent patch to spaCy now should also prevent this error from happening (it will automatically ignore empty batches). Thanks again for the helpful report!
 		</comment>
 		<comment id='5' author='AbhayGodbole' date='2019-10-02T12:47:20Z'>
 		Great!  Thanks for the update
 		</comment>
 		<comment id='6' author='AbhayGodbole' date='2019-11-01T12:54:28Z'>
 		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
 		</comment>
 	</comments>
 </bug>
<commit id='9d3ce7cba237361fd9f442f3b02abfa464eac666' author='Sofie Van Landeghem' date='2019-10-02 12:50:47+02:00'>
 	<dmm_unit complexity='1.0' interfacing='1.0' size='1.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='spacy\pipeline\pipes.pyx' new_name='spacy\pipeline\pipes.pyx'>
 		<file_info nloc='None' complexity='None' token_count='None'></file_info>
 		<modified_lines>
 			<added_lines>457,458,459,460,474,475,476,978,979,980,991,992,993</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='spacy\tests\regression\test_issue3001-3500.py' new_name='spacy\tests\regression\test_issue3001-3500.py'>
 		<file_info nloc='262' complexity='21' token_count='1992'></file_info>
 		<method name='test_issue3456' parameters=''>
 				<method_info nloc='5' complexity='1' token_count='38' nesting_level='0' start_line='321' end_line='326'></method_info>
 			<added_lines>321,322,323,324,325,326</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>327,328</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='ADD' old_name='None' new_name='spacy\tests\regression\test_issue4348.py'>
 		<file_info nloc='15' complexity='3' token_count='142'></file_info>
 	</modification>
 </commit>
</bug_data>
