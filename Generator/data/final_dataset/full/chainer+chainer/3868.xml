<bug_data>
<bug id='3868' author='niboshi' open_date='2017-11-14T08:04:27Z' closed_time='2017-12-14T05:00:01Z'>
 	<summary>VariableNode's dtype mismatch if Variable.data is manually assigned</summary>
 	<description>
 If Variable.data is assigned manually, node.dtype and node.data.dtype can indicate different values.
 This has caused "Dtype of data and grad mismatch" error in gradient_check.check_double_backward.
 &lt;denchmark-h:h3&gt;Code&lt;/denchmark-h&gt;
 
 &lt;denchmark-code&gt;import chainer
 import numpy
 from chainer import functions as F
 
 x = chainer.Variable(numpy.array([3, 2], dtype=numpy.float32))
 y = F.sin(x)
 x.data = numpy.array([4, 2], dtype=numpy.float64)
 
 print(x.node.dtype)
 print(x.node.data.dtype)
 &lt;/denchmark-code&gt;
 
 &lt;denchmark-h:h3&gt;Output&lt;/denchmark-h&gt;
 
 &lt;denchmark-code&gt;float64                                             
 float32
 &lt;/denchmark-code&gt;
 
 Current master: &lt;denchmark-link:https://github.com/chainer/chainer/commit/5683281c854fd2e47b68a3461b8e3e7e3c69f227&gt;5683281&lt;/denchmark-link&gt;
 
 	</description>
 	<comments>
 	</comments>
 </bug>
<commit id='d97c8eb9d4feb3199520c51e0360269ed12c6d5f' author='Yuya Unno' date='2017-12-14 14:00:35+09:00'>
 	<dmm_unit complexity='1.0' interfacing='1.0' size='1.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='chainer\variable.py' new_name='chainer\variable.py'>
 		<file_info nloc='747' complexity='222' token_count='4156'></file_info>
 		<method name='array' parameters='self,d'>
 				<method_info nloc='3' complexity='1' token_count='23' nesting_level='1' start_line='615' end_line='617'></method_info>
 			<added_lines>617</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<method name='data' parameters='self,d'>
 				<method_info nloc='3' complexity='1' token_count='18' nesting_level='1' start_line='261' end_line='263'></method_info>
 			<added_lines>263</added_lines>
 			<deleted_lines>263</deleted_lines>
 		</method>
 		<method name='_set_data_type' parameters='self,d'>
 				<method_info nloc='7' complexity='2' token_count='38' nesting_level='1' start_line='386' end_line='392'></method_info>
 			<added_lines>386</added_lines>
 			<deleted_lines>386</deleted_lines>
 		</method>
 		<method name='__init__' parameters='self,variable,name,kwargs'>
 				<method_info nloc='11' complexity='1' token_count='56' nesting_level='1' start_line='160' end_line='171'></method_info>
 			<added_lines>171</added_lines>
 			<deleted_lines>171</deleted_lines>
 		</method>
 		<method name='_update_data_info' parameters='self,d'>
 				<method_info nloc='9' complexity='3' token_count='51' nesting_level='1' start_line='386' end_line='396'></method_info>
 			<added_lines>386,394,395,396</added_lines>
 			<deleted_lines>386</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>397,635</added_lines>
 			<deleted_lines>613,631</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='tests\chainer_tests\test_variable.py' new_name='tests\chainer_tests\test_variable.py'>
 		<file_info nloc='1233' complexity='245' token_count='11584'></file_info>
 		<method name='test_variable_data_assign' parameters='self'>
 				<method_info nloc='12' complexity='1' token_count='140' nesting_level='1' start_line='727' end_line='738'></method_info>
 			<added_lines>727,728,729,730,731,732,733,734,735,736,737,738</added_lines>
 			<deleted_lines></deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines>725,726,739,740</added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
