<bug_data>
<bug id='523' author='mariusgarbowski' open_date='2020-07-19T09:53:27Z' closed_time='2020-10-10T00:03:01Z'>
 	<summary>Error for Int64Dtype: TypeError with pd.NA</summary>
 	<description>
 Describe the bug
 I am trying to profile a DataFrame which contains pd.NA in dtype=Int64 Columns (pandas nullable integer). After installing the newest pre-version &lt;denchmark-link:https://github.com/pandas-profiling/pandas-profiling/issues/502&gt;#502&lt;/denchmark-link&gt;
  there has been no issue with the dtype in general. Unfortunately, there seems to be a problem with the pd.NAs.
 The very strange part is (regarding the example below):
 In Jupyter Notebook on Windows it neither works with any dataframe containing pd.NAs, e.g. data = [pd.NA, 123124] (only two values).
 BUT: if I dismiss the first value from data, i.e. 1871248 -&gt; data = [12522551, 1489260, 6657093,
 pd.NA, pd.NA, pd.NA, pd.NA, pd.NA, 1489260, pd.NA, 2468576] , it surprisingly works on the linux server version (???)
 To Reproduce
 pip install --pre -U pandas-profiling
 from pandas_profiling import ProfileReport
 import pandas as pd
 
 data = [1871248, 12522551, 1489260, 6657093,
         pd.NA, pd.NA, pd.NA, pd.NA, pd.NA, 1489260, pd.NA, 2468576]
 df = pd.DataFrame({'id': data}, dtype=pd.Int64Dtype())
 profile_report = ProfileReport(df, title='Test Report')
 filename = "test_report.html"
 profile_report.to_file(filename)
 Output when running in Jupyter notebook in Windows and linux server:
 &lt;denchmark-code&gt;Summarize dataset: 20%
 3/15 [00:00&lt;00:00, 41.21it/s, Calculate pearson correlation]
 
 ---------------------------------------------------------------------------
 TypeError                                 Traceback (most recent call last)
 &lt;ipython-input-3-2ece5c6bfb94&gt; in &lt;module&gt;
       7 profile_report = ProfileReport(df, title='Test Report')
       8 filename = "test_report.html"
 ----&gt; 9 profile_report.to_file(filename)
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas_profiling\profile_report.py in to_file(self, output_file, silent)
     254                 create_html_assets(output_file)
     255 
 --&gt; 256             data = self.to_html()
     257 
     258             if output_file.suffix != ".html":
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas_profiling\profile_report.py in to_html(self)
     357 
     358         """
 --&gt; 359         return self.html
     360 
     361     def to_json(self) -&gt; str:
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas_profiling\profile_report.py in html(self)
     177     def html(self):
     178         if self._html is None:
 --&gt; 179             self._html = self._render_html()
     180         return self._html
     181 
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas_profiling\profile_report.py in _render_html(self)
     284         from pandas_profiling.report.presentation.flavours import HTMLReport
     285 
 --&gt; 286         report = self.report
     287 
     288         disable_progress_bar = not config["progress_bar"].get(bool)
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas_profiling\profile_report.py in report(self)
     171     def report(self):
     172         if self._report is None:
 --&gt; 173             self._report = get_report_structure(self.description_set)
     174         return self._report
     175 
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas_profiling\profile_report.py in description_set(self)
     152     def description_set(self):
     153         if self._description_set is None:
 --&gt; 154             self._description_set = describe_df(self.title, self.df, self._sample)
     155         return self._description_set
     156 
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas_profiling\model\describe.py in describe(title, df, sample)
      82         for correlation_name in correlation_names:
      83             pbar.set_postfix_str(f"Calculate {correlation_name} correlation")
 ---&gt; 84             correlations[correlation_name] = calculate_correlation(
      85                 df, variables, correlation_name
      86             )
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas_profiling\model\correlations.py in calculate_correlation(df, variables, correlation_name)
     129     if correlation_name in ["pearson", "spearman", "kendall"]:
     130         try:
 --&gt; 131             correlation = df.corr(method=correlation_name)
     132 
     133         except (ValueError, AssertionError) as e:
 
 ~\Miniconda3\envs\reana\lib\site-packages\pandas\core\frame.py in corr(self, method, min_periods)
    7464 
    7465         if method == "pearson":
 -&gt; 7466             correl = libalgos.nancorr(ensure_float64(mat), minp=min_periods)
    7467         elif method == "spearman":
    7468             correl = libalgos.nancorr_spearman(ensure_float64(mat), minp=min_periods)
 
 pandas\_libs\algos_common_helper.pxi in pandas._libs.algos.ensure_float64()
 
 TypeError: float() argument must be a string or a number, not 'NAType'
 &lt;/denchmark-code&gt;
 
 Version information:
 
 Python version: Linux 3.8.2 , Windows: 3.8.2
 Environment: Linux: Console via SSH in PyCharm, Windows: Jupyter Notebook in Chrome
 pip:
 
 Click to expand Version information
 
 Linux:
 astropy==4.0.1.post1
 attrs==19.3.0
 backcall==0.1.0
 bleach==3.1.4
 certifi==2020.4.5.1
 chardet==3.0.4
 colorama==0.4.3
 confuse==1.3.0
 cycler==0.10.0
 decorator==4.4.2
 defusedxml==0.6.0
 entrypoints==0.3
 htmlmin==0.1.12
 idna==2.10
 ImageHash==4.1.0
 importlib-metadata==1.5.0
 ipykernel==5.1.4
 ipython==7.13.0
 ipython-genutils==0.2.0
 ipywidgets==7.5.1
 jedi==0.17.0
 Jinja2==2.11.2
 joblib==0.16.0
 jsonschema==3.2.0
 jupyter==1.0.0
 jupyter-client==6.1.3
 jupyter-console==6.1.0
 jupyter-core==4.6.3
 kiwisolver==1.2.0
 llvmlite==0.33.0
 MarkupSafe==1.1.1
 matplotlib==3.2.1
 missingno==0.4.2
 mistune==0.8.4
 mkl-fft==1.0.15
 mkl-random==1.1.0
 mkl-service==2.3.0
 nbconvert==5.6.1
 nbformat==5.0.6
 networkx==2.4
 notebook==6.0.3
 numba==0.50.1
 numpy==1.18.1
 ordered-set==4.0.1
 pandas==1.0.5
 pandas-profiling==2.9.0rc1
 pandocfilters==1.4.2
 parso==0.7.0
 phik==0.10.0
 pickleshare==0.7.5
 Pillow==7.2.0
 prometheus-client==0.7.1
 prompt-toolkit==3.0.4
 Pygments==2.6.1
 PyLaTeX==1.3.2
 pyparsing==2.4.7
 pyrsistent==0.16.0
 python-dateutil==2.8.1
 pytz==2020.1
 PyWavelets==1.1.1
 pywin32==227
 pywinpty==0.5.7
 PyYAML==5.3.1
 pyzmq==18.1.1
 qtconsole==4.7.4
 QtPy==1.9.0
 requests==2.24.0
 scipy==1.5.1
 seaborn==0.10.1
 Send2Trash==1.5.0
 sip==4.19.13
 six==1.14.0
 tangled-up-in-unicode==0.0.6
 terminado==0.8.3
 testpath==0.4.4
 tornado==6.0.4
 tqdm==4.48.0
 traitlets==4.3.3
 urllib3==1.25.9
 visions==0.4.4
 wcwidth==0.1.9
 webencodings==0.5.1
 widgetsnbextension==3.5.1
 wincertstore==0.2
 xlrd==1.2.0
 zipp==3.1.0
 
 Windows:
 astropy==4.0.1.post1
 attrs==19.3.0
 backcall==0.1.0
 bleach==3.1.4
 certifi==2020.4.5.1
 chardet==3.0.4
 colorama==0.4.3
 confuse==1.3.0
 cycler==0.10.0
 decorator==4.4.2
 defusedxml==0.6.0
 entrypoints==0.3
 htmlmin==0.1.12
 idna==2.10
 ImageHash==4.1.0
 importlib-metadata==1.5.0
 ipykernel==5.1.4
 ipython==7.13.0
 ipython-genutils==0.2.0
 ipywidgets==7.5.1
 jedi==0.17.0
 Jinja2==2.11.2
 joblib==0.16.0
 jsonschema==3.2.0
 jupyter==1.0.0
 jupyter-client==6.1.3
 jupyter-console==6.1.0
 jupyter-core==4.6.3
 kiwisolver==1.2.0
 llvmlite==0.33.0
 MarkupSafe==1.1.1
 matplotlib==3.2.1
 missingno==0.4.2
 mistune==0.8.4
 mkl-fft==1.0.15
 mkl-random==1.1.0
 mkl-service==2.3.0
 nbconvert==5.6.1
 nbformat==5.0.6
 networkx==2.4
 notebook==6.0.3
 numba==0.50.1
 numpy==1.18.1
 ordered-set==4.0.1
 pandas==1.0.5
 pandas-profiling==2.9.0rc1
 pandocfilters==1.4.2
 parso==0.7.0
 phik==0.10.0
 pickleshare==0.7.5
 Pillow==7.2.0
 prometheus-client==0.7.1
 prompt-toolkit==3.0.4
 Pygments==2.6.1
 PyLaTeX==1.3.2
 pyparsing==2.4.7
 pyrsistent==0.16.0
 python-dateutil==2.8.1
 pytz==2020.1
 PyWavelets==1.1.1
 pywin32==227
 pywinpty==0.5.7
 PyYAML==5.3.1
 pyzmq==18.1.1
 qtconsole==4.7.4
 QtPy==1.9.0
 requests==2.24.0
 scipy==1.5.1
 seaborn==0.10.1
 Send2Trash==1.5.0
 sip==4.19.13
 six==1.14.0
 tangled-up-in-unicode==0.0.6
 terminado==0.8.3
 testpath==0.4.4
 tornado==6.0.4
 tqdm==4.48.0
 traitlets==4.3.3
 urllib3==1.25.9
 visions==0.4.4
 wcwidth==0.1.9
 webencodings==0.5.1
 widgetsnbextension==3.5.1
 wincertstore==0.2
 xlrd==1.2.0
 zipp==3.1.0 &gt;&gt;&gt;
 
 Additional context
 
 	</description>
 	<comments>
 		<comment id='1' author='mariusgarbowski' date='2020-08-02T19:22:43Z'>
 		Thanks for taking the time to report this issue. After researching the cause, we found that it's a combination of two: a bug in pandas &lt; 1.1 [1] and a design decision in how pd.NAN works in the boolean context.
 PR &lt;denchmark-link:https://github.com/pandas-profiling/pandas-profiling/pull/533&gt;#533&lt;/denchmark-link&gt;
  ensures that pandas-profiling works with .
 [1] &lt;denchmark-link:https://github.com/pandas-dev/pandas/issues/33803&gt;pandas-dev/pandas#33803&lt;/denchmark-link&gt;
 
 		</comment>
 		<comment id='2' author='mariusgarbowski' date='2020-10-02T00:02:52Z'>
 		Stale issue
 		</comment>
 	</comments>
 </bug>
<commit id='00bdeafee8f896ba5365f933563433794de6b8fd' author='Simon Brugman' date='2020-08-24 23:32:36+02:00'>
 	<dmm_unit complexity='1.0' interfacing='0.9473684210526315' size='0.0'></dmm_unit>
 	<modification change_type='MODIFY' old_name='src\pandas_profiling\model\correlations.py' new_name='src\pandas_profiling\model\correlations.py'>
 		<file_info nloc='179' complexity='6' token_count='986'></file_info>
 		<modified_lines>
 			<added_lines>133</added_lines>
 			<deleted_lines>133</deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='MODIFY' old_name='src\pandas_profiling\visualisation\plot.py' new_name='src\pandas_profiling\visualisation\plot.py'>
 		<file_info nloc='229' complexity='26' token_count='1310'></file_info>
 		<method name='scatter_pairwise' parameters='series1,series2,x_label,y_label'>
 				<method_info nloc='28' complexity='2' token_count='141' nesting_level='0' start_line='245' end_line='275'></method_info>
 			<added_lines>268,269,272,274</added_lines>
 			<deleted_lines>270,272</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines></added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 	<modification change_type='ADD' old_name='None' new_name='tests\issues\test_issue523.py'>
 		<file_info nloc='28' complexity='1' token_count='125'></file_info>
 	</modification>
 	<modification change_type='MODIFY' old_name='tests\unit\test_dataset_schema.py' new_name='tests\unit\test_dataset_schema.py'>
 		<file_info nloc='31' complexity='5' token_count='184'></file_info>
 		<method name='test_dataset_schema' parameters=''>
 				<method_info nloc='20' complexity='4' token_count='115' nesting_level='0' start_line='6' end_line='30'></method_info>
 			<added_lines>29</added_lines>
 			<deleted_lines>29</deleted_lines>
 		</method>
 		<modified_lines>
 			<added_lines></added_lines>
 			<deleted_lines></deleted_lines>
 		</modified_lines>
 	</modification>
 </commit>
</bug_data>
