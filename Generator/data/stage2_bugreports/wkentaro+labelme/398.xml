<bug id='398' author='dawin2015' open_date='2019-05-14T04:06:24Z' closed_time='2019-08-28T11:44:07Z'>
	<summary>An error occurred while aiming at the boundary</summary>
	<description>
Traceback (most recent call last):
File "D:\ProgramData\Anaconda3\lib\site-packages\labelme-3.14.1-py3.6.egg\labelme\widgets\canvas.py", line 216, in mouseMoveEvent
self.boundedMoveVertex(pos)
File "D:\ProgramData\Anaconda3\lib\site-packages\labelme-3.14.1-py3.6.egg\labelme\widgets\canvas.py", line 415, in boundedMoveVertex
pos = self.intersectionPoint(point, pos)
File "D:\ProgramData\Anaconda3\lib\site-packages\labelme-3.14.1-py3.6.egg\labelme\widgets\canvas.py", line 560, in intersectionPoint
d, i, (x, y) = min(self.intersectingEdges((x1, y1), (x2, y2), points))
ValueError: min() arg is an empty sequence
	</description>
	<comments>
		<comment id='1' author='dawin2015' date='2019-05-24T06:46:07Z'>
		I got the same error too
		</comment>
		<comment id='2' author='dawin2015' date='2019-05-30T05:42:27Z'>
		me too
		</comment>
		<comment id='3' author='dawin2015' date='2019-06-03T11:49:52Z'>
		how to solve it ?
		</comment>
		<comment id='4' author='dawin2015' date='2019-06-03T11:50:27Z'>
		
I got the same error too

Have you solved this problem?
		</comment>
		<comment id='5' author='dawin2015' date='2019-06-03T12:05:51Z'>
		I will fix this within this month, after finishing current work close to deadline.
		</comment>
		<comment id='6' author='dawin2015' date='2019-06-03T12:08:19Z'>
		
I will fix this within this month, after finishing current work close to deadline.

Ok , I hope that you can help me
		</comment>
		<comment id='7' author='dawin2015' date='2019-06-03T13:04:45Z'>
		
I will fix this within this month, after finishing current work close to deadline.

Can I have your QQ number, I have some questions to ask you ,thank you so much
		</comment>
		<comment id='8' author='dawin2015' date='2019-07-03T21:45:46Z'>
		Sorry for late, but I can't reproduce with the current master branch. Could you specify more detail about how to reproduce, or give me instruction video/gif ?
		</comment>
		<comment id='9' author='dawin2015' date='2019-07-05T10:15:55Z'>
		It seems to appear spontaneously while drawing polygons close to the boundary side of the working space. You may reproduce it by making an edit to any polygons and flying the cursor over close to this boundary while holding a point edge.
		</comment>
		<comment id='10' author='dawin2015' date='2019-07-08T08:23:42Z'>
		
Sorry for late, but I can't reproduce with the current master branch. Could you specify more detail about how to reproduce, or give me instruction video/gif ?

&lt;denchmark-link:https://take.ms/uJHgg&gt;video&lt;/denchmark-link&gt;

labelme 3.16.1
		</comment>
		<comment id='11' author='dawin2015' date='2019-07-08T17:04:23Z'>
		&lt;denchmark-link:https://github.com/iliakri&gt;@iliakri&lt;/denchmark-link&gt;
 Thanks, I'll look to fix this.
		</comment>
		<comment id='12' author='dawin2015' date='2019-07-08T17:07:47Z'>
		Hmm, I still cannot reproduce this problem. Could you tell me which version of QT are you using? &lt;denchmark-link:https://github.com/iliakri&gt;@iliakri&lt;/denchmark-link&gt;

&lt;denchmark-code&gt;% pip list | grep -i qt
PyQt5                  5.12.2    
PyQt5-sip              4.19.17   
QtPy                   1.7.1     
&lt;/denchmark-code&gt;

		</comment>
		<comment id='13' author='dawin2015' date='2019-07-09T03:13:44Z'>
		I also encounter this problem. when the dot is near the boundary of window, but I didn't get the error message.... The program just shut down, and my works are missing.
		</comment>
		<comment id='14' author='dawin2015' date='2019-07-09T03:23:40Z'>
		&lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;

i guess this bug only occur on windows lol.
		</comment>
		<comment id='15' author='dawin2015' date='2019-07-09T08:17:31Z'>
		
Hmm, I still cannot reproduce this problem. Could you tell me which version of QT are you using? @iliakri
% pip list | grep -i qt
PyQt5                  5.12.2    
PyQt5-sip              4.19.17   
QtPy                   1.7.1     


&lt;denchmark-code&gt;pip list | findstr -i qt
PyQt5              5.12.2
PyQt5-sip          4.19.17
&lt;/denchmark-code&gt;

win10 v1809
		</comment>
		<comment id='16' author='dawin2015' date='2019-07-10T01:19:08Z'>
		I have the same problem here. I try it on both mac os and windows and I get the same problem. Just like &lt;denchmark-link:https://github.com/iliakri&gt;@iliakri&lt;/denchmark-link&gt;
 video.  ValueError: min() arg is an empty sequence
		</comment>
		<comment id='17' author='dawin2015' date='2019-07-11T13:53:45Z'>
		I have the same problem here. Not sure why yet. But it seems downgrading to 3.5 works for now.
		</comment>
		<comment id='18' author='dawin2015' date='2019-07-12T22:59:28Z'>
		
I have the same problem here. I try it on both mac os and windows and I get the same problem. Just like @iliakri video. ValueError: min() arg is an empty sequence

That’s good to know. Then I can reproduce on my macOS.
		</comment>
		<comment id='19' author='dawin2015' date='2019-07-13T23:42:32Z'>
		Hmm, I can't reproduce on my macOS (Mojave).
		</comment>
		<comment id='20' author='dawin2015' date='2019-07-19T01:12:04Z'>
		&lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;
 Hi , I upload the test image and annotation json file to google cloud.
-1007.png
-1007.json
-test.png(visualize)
You can edit the right bottom corner of the test label(square) to the right boundary. And the error comes out.
&lt;denchmark-link:https://drive.google.com/open?id=1ifs3CqqdYbjrXdkGrZ9UJHCZe-uI2sDB&gt;https://drive.google.com/open?id=1ifs3CqqdYbjrXdkGrZ9UJHCZe-uI2sDB&lt;/denchmark-link&gt;

		</comment>
		<comment id='21' author='dawin2015' date='2019-07-22T05:59:31Z'>
		I also have the same problem. Although 3.5.0 works, but 3.5.1 does not work for me.
		</comment>
		<comment id='22' author='dawin2015' date='2019-07-23T21:30:44Z'>
		Hey everyone, I rolled back to version 3.5.0 and it works again. I just executed "pip install labelme==3.5.0" and the boundaries worked again.
		</comment>
		<comment id='23' author='dawin2015' date='2019-07-25T01:17:57Z'>
		
Hey everyone, I rolled back to version 3.5.0 and it works again. I just executed "pip install labelme==3.5.0" and the boundaries worked again.

Thanks. It works for me, but down version has no auto save. I will continue using the version 3.16.1
		</comment>
		<comment id='24' author='dawin2015' date='2019-07-31T11:04:53Z'>
		The issue is in the method "intersectingEdges(self, point1, point2, points)" in canvas.py. It does not yield any point sometimes when making point or segmentation on boundary of the image.
		</comment>
		<comment id='25' author='dawin2015' date='2019-07-31T11:49:03Z'>
		
The issue is in the method "intersectingEdges(self, point1, point2, points)" in canvas.py. It does not yield any point sometimes when making point or segmentation on boundary of the image.

Changing the body of the method "intersectionPoint(self, p1, p2)" in canvas.py to the following can fix the crashing problem:
`def intersectionPoint(self, p1, p2):
&lt;denchmark-code&gt;    # Cycle through each image edge in clockwise fashion,
    # and find the one intersecting the current line segment.
    # http://paulbourke.net/geometry/lineline2d/
    size = self.pixmap.size()
    points = [(0, 0),
              (size.width() - 1, 0),
              (size.width() - 1, size.height() - 1),
              (0, size.height() - 1)]
    x1, y1 = p1.x(), p1.y()
    x2, y2 = p2.x(), p2.y()
    try:
        d, i, (x, y) = min(self.intersectingEdges((x1, y1), (x2, y2), points))
        x3, y3 = points[i]
        x4, y4 = points[(i + 1) % 4]
        if (x, y) == (x1, y1):
            # Handle cases where previous point is on one of the edges.
            if x3 == x4:
                return QtCore.QPoint(x3, min(max(0, y2), max(y3, y4)))
            else:  # y3 == y4
                return QtCore.QPoint(min(max(0, x2), max(x3, x4)), y3)
        return QtCore.QPoint(x, y)
    except:
        return QtCore.QPoint(x2, y2)`
&lt;/denchmark-code&gt;

But this is a temporary solution. Also it will allow the user to draw points outside the boundaries of image. So you've to be careful with that.
		</comment>
		<comment id='26' author='dawin2015' date='2019-08-02T10:44:28Z'>
		&lt;denchmark-link:https://github.com/murtazakhan28&gt;@murtazakhan28&lt;/denchmark-link&gt;
 your solution did not work for me. (ubuntu 16, labelme 3.15)
two reasons:
it still crashes sometimes
it lets the user create polygons that are outside the image boundaries, which could cause errors if the user tries to later convert the data.
		</comment>
		<comment id='27' author='dawin2015' date='2019-08-02T10:52:32Z'>
		
@murtazakhan28 your solution did not work for me. (ubuntu 16, labelme 3.15)
two reasons:
it still crashes sometimes
it lets the user create polygons that are outside the image boundaries, which could cause errors if the user tries to later convert the data.

@ottovonzastrow As i mentioned before, yes this sometimes allows user to create points outside the boundaries so you have to be careful about that. But it certainly solves the problem of software crashing for me.
Again, it's a quick hack and not a permanent solution. I'll look into the code in detail and suggest better changes over the weekend since this problem has been bugging me since I've been using this software.
		</comment>
		<comment id='28' author='dawin2015' date='2019-08-14T18:38:41Z'>
		I finally managed to test this on Windows, and I reproduced this problem.
&lt;denchmark-link:https://github.com/wkentaro/labelme/pull/467&gt;#467&lt;/denchmark-link&gt;
 should fix this problem. Please test it once it is merged.
		</comment>
		<comment id='29' author='dawin2015' date='2019-08-14T20:02:23Z'>
		Released 3.16.3, so please test it if it fixed this problem.
&lt;denchmark-code&gt;pip install 'labelme==3.16.3' --no-cache-dir
&lt;/denchmark-code&gt;

		</comment>
		<comment id='30' author='dawin2015' date='2019-08-15T08:59:20Z'>
		I reproduced this problem on labelme 3.16.3
&lt;denchmark-link:https://take.ms/DR2pD&gt;screen&lt;/denchmark-link&gt;

		</comment>
		<comment id='31' author='dawin2015' date='2019-08-15T09:42:05Z'>
		Can you please print the x1, y1, x2, y2, and points? Before the line that raises the error.
		</comment>
		<comment id='32' author='dawin2015' date='2019-08-20T17:46:14Z'>
		I tried everything I can do on boundary, but can’t reproduce..
I tested in the same environment as &lt;denchmark-link:https://github.com/iliakri&gt;@iliakri&lt;/denchmark-link&gt;

		</comment>
		<comment id='33' author='dawin2015' date='2019-08-23T11:16:33Z'>
		Same problem, but hard to reproduce in 3.16.3.
		</comment>
		<comment id='34' author='dawin2015' date='2019-08-23T18:43:20Z'>
		I tried to fix this. Could you please try 3.16.4?
		</comment>
		<comment id='35' author='dawin2015' date='2019-08-24T03:57:50Z'>
		The problem still exists in 3.16.4 version on windows.
I added
print(x1, y1, x2, y2)
before
d, i, (x, y) = min(self.intersectingEdges((x1, y1), (x2, y2), points))
in canvas.py.
The result is below.
&lt;denchmark-link:https://user-images.githubusercontent.com/43477405/63632297-1f8fea80-c666-11e9-9aea-8debf6f824e5.jpg&gt;&lt;/denchmark-link&gt;

And there is a warnning when I start the program.
		</comment>
		<comment id='36' author='dawin2015' date='2019-08-24T13:02:48Z'>
		Oh, this is very helpful.
		</comment>
		<comment id='37' author='dawin2015' date='2019-08-27T14:57:14Z'>
		&lt;denchmark-link:https://github.com/elepherai&gt;@elepherai&lt;/denchmark-link&gt;
 Can you please give me the result of  also?
		</comment>
		<comment id='38' author='dawin2015' date='2019-08-28T01:21:21Z'>
		&lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;

x1,y1,x2,y2: 1279.0 206.0 1279 202.01075268817203
points: [(0, 0), (1279, 0), (1279, 959), (0, 959)]
		</comment>
		<comment id='39' author='dawin2015' date='2019-08-28T05:01:50Z'>
		Can you try the latest one? 3.16.5
		</comment>
		<comment id='40' author='dawin2015' date='2019-08-28T05:52:12Z'>
		&lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;

&lt;denchmark-link:https://user-images.githubusercontent.com/43477405/63829037-ec699600-c99a-11e9-8f32-e715a6b33805.png&gt;&lt;/denchmark-link&gt;

&lt;denchmark-link:https://user-images.githubusercontent.com/43477405/63829003-d4921200-c99a-11e9-8fec-5f7f68c00360.png&gt;&lt;/denchmark-link&gt;

		</comment>
		<comment id='41' author='dawin2015' date='2019-08-28T10:04:37Z'>
		I fixed it in the latest version.
Can you try it?
On Wed, Aug 28, 2019 at 6:52 ElepherAI ***@***.***&gt; wrote:
 &lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;
 &lt;&lt;denchmark-link:https://github.com/wkentaro&gt;https://github.com/wkentaro&lt;/denchmark-link&gt;
&gt;

 [image: image]
 &lt;&lt;denchmark-link:https://user-images.githubusercontent.com/43477405/63829037-ec699600-c99a-11e9-8f32-e715a6b33805.png&gt;https://user-images.githubusercontent.com/43477405/63829037-ec699600-c99a-11e9-8f32-e715a6b33805.png&lt;/denchmark-link&gt;
&gt;

 [image: image]
 &lt;&lt;denchmark-link:https://user-images.githubusercontent.com/43477405/63829003-d4921200-c99a-11e9-8fec-5f7f68c00360.png&gt;https://user-images.githubusercontent.com/43477405/63829003-d4921200-c99a-11e9-8fec-5f7f68c00360.png&lt;/denchmark-link&gt;
&gt;

 —
 You are receiving this because you were mentioned.


 Reply to this email directly, view it on GitHub
 &lt;&lt;denchmark-link:https://github.com/wkentaro/labelme/issues/398&gt;#398&lt;/denchmark-link&gt;
?email_source=notifications&amp;email_token=ABA4LE6OCC66PIHUZAM4W3TQGYHBDA5CNFSM4HMVOOD2YY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOD5J7BZY#issuecomment-525594855&gt;,
 or mute the thread
 &lt;&lt;denchmark-link:https://github.com/notifications/unsubscribe-auth/ABA4LE4JRNTPOI2SUDP3R2TQGYHBDANCNFSM4HMVOODQ&gt;https://github.com/notifications/unsubscribe-auth/ABA4LE4JRNTPOI2SUDP3R2TQGYHBDANCNFSM4HMVOODQ&lt;/denchmark-link&gt;
&gt;
 .

-- 
Kentaro Wada / 和田 健太郎
&lt;denchmark-link:https://wkentaro.com&gt;https://wkentaro.com&lt;/denchmark-link&gt;
 &lt;&lt;denchmark-link:http://wkentaro.com&gt;http://wkentaro.com&lt;/denchmark-link&gt;
&gt;
		</comment>
		<comment id='42' author='dawin2015' date='2019-08-28T11:35:01Z'>
		It works. Thanks! &lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;

		</comment>
		<comment id='43' author='dawin2015' date='2019-08-28T11:44:07Z'>
		Thanks! Probably this issue is fixed now, so I close this.
		</comment>
	</comments>
</bug>