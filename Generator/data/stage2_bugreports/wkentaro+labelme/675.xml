<bug id='675' author='off99555' open_date='2020-06-04T07:25:51Z' closed_time='2020-06-23T04:50:13Z'>
	<summary>[BUG] labelme does not read jpg images</summary>
	<description>
Describe the bug
In version 4.2.9, it still reads the jpg images. But after I upgraded to &gt;=4.3, it stops reading the jpg images. You can see clearly this issue by trying to open an image and in the list of image types, you won't find the jpg in there.
To Reproduce
Steps to reproduce the behavior:

Install labelme 4.3 using pip install labelme==4.3 or any latest version
Try to open the image with Open button.
You will find out that you won't see jpg images.

Expected behavior
The jpg images must be seen.

This is an example of version 4.2.9 (which have jpg type in the list)
&lt;denchmark-link:https://user-images.githubusercontent.com/15215732/84859800-0a25fa00-b098-11ea-8ccd-54f084357cf1.png&gt;&lt;/denchmark-link&gt;

This is version 4.5.1 (does not have jpg in the list)
&lt;denchmark-link:https://user-images.githubusercontent.com/15215732/84859741-f11d4900-b097-11ea-83c0-0925e78d8598.png&gt;&lt;/denchmark-link&gt;

Desktop (please complete the following information):

OS: Windows 10
Labelme Version &gt; 4.3

Additional context
Maybe this is an intended feature because it cannot be a mistake that some guys decided to remove jpg and other extensions from the list. But then why do this? It causes a backward compatibility issue.
	</description>
	<comments>
		<comment id='1' author='off99555' date='2020-06-06T04:08:23Z'>
		I am experiencing the same exact issue. My boss has labeled some images and wants me to label the rest. Now I cannot open the files as they are jpg. I guess I must downgrade to get this to work for now
		</comment>
		<comment id='2' author='off99555' date='2020-06-09T03:38:44Z'>
		Experiencing the same problem ...
		</comment>
		<comment id='3' author='off99555' date='2020-06-15T21:42:27Z'>
		Experiencing the same problem on mac, it does not want to load *.jpg or *.heic
		</comment>
		<comment id='4' author='off99555' date='2020-06-22T01:01:55Z'>
		Can you guys give me the output of below command?
&lt;denchmark-code&gt;ipython

In [1]: from qtpy import QtGui

In [2]: QtGui.QImageReader.supportedImageFormats()
Out[2]:
[PyQt5.QtCore.QByteArray(b'bmp'),
 PyQt5.QtCore.QByteArray(b'cur'),
 PyQt5.QtCore.QByteArray(b'gif'),
 PyQt5.QtCore.QByteArray(b'heic'),
 PyQt5.QtCore.QByteArray(b'heif'),
 PyQt5.QtCore.QByteArray(b'icns'),
 PyQt5.QtCore.QByteArray(b'ico'),
 PyQt5.QtCore.QByteArray(b'jp2'),
 PyQt5.QtCore.QByteArray(b'jpeg'),
 PyQt5.QtCore.QByteArray(b'jpg'),
 PyQt5.QtCore.QByteArray(b'pbm'),
 PyQt5.QtCore.QByteArray(b'pgm'),
 PyQt5.QtCore.QByteArray(b'png'),
 PyQt5.QtCore.QByteArray(b'ppm'),
 PyQt5.QtCore.QByteArray(b'svg'),
 PyQt5.QtCore.QByteArray(b'svgz'),
 PyQt5.QtCore.QByteArray(b'tga'),
 PyQt5.QtCore.QByteArray(b'tif'),
 PyQt5.QtCore.QByteArray(b'tiff'),
 PyQt5.QtCore.QByteArray(b'wbmp'),
 PyQt5.QtCore.QByteArray(b'webp'),
 PyQt5.QtCore.QByteArray(b'xbm'),
 PyQt5.QtCore.QByteArray(b'xpm')]
&lt;/denchmark-code&gt;

on my mac, it gives jpeg as well.
		</comment>
		<comment id='5' author='off99555' date='2020-06-22T10:44:54Z'>
		&lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;

&lt;denchmark-link:https://user-images.githubusercontent.com/15215732/85279032-01765f00-b4b0-11ea-9261-2851e6ceb12f.png&gt;&lt;/denchmark-link&gt;

Here it is. Though the labelme version is 4.2.9
		</comment>
		<comment id='6' author='off99555' date='2020-06-22T14:23:43Z'>
		&lt;denchmark-link:https://user-images.githubusercontent.com/5898766/85298661-aa1ec180-b4a4-11ea-9ad0-2634a45befc7.png&gt;&lt;/denchmark-link&gt;

Here it goes, labelme -V 4.5.0
[ERROR  ] label_file:load_image_file:39 - Failed opening image file: /Users/sakibkurtic/Desktop/Horizontal_Traffic_Sign_Train_Data/0420.jpg
This is detailed error I got.
		</comment>
		<comment id='7' author='off99555' date='2020-06-22T16:32:13Z'>
		
@wkentaro

Here it is. Though the labelme version is 4.2.9

So this issue is probably related to your PyQt5 version or something not labelme version.
Please check the PyQt5 version to see when jpeg will be listed.
		</comment>
		<comment id='8' author='off99555' date='2020-06-22T16:32:36Z'>
		

Here it goes, labelme -V 4.5.0
[ERROR ] label_file:load_image_file:39 - Failed opening image file: /Users/sakibkurtic/Desktop/Horizontal_Traffic_Sign_Train_Data/0420.jpg
This is detailed error I got.

There's jpeg, but still you can't open it?
		</comment>
		<comment id='9' author='off99555' date='2020-06-22T19:20:38Z'>
		


Here it goes, labelme -V 4.5.0
[ERROR ] label_file:load_image_file:39 - Failed opening image file: /Users/sakibkurtic/Desktop/Horizontal_Traffic_Sign_Train_Data/0420.jpg
This is detailed error I got.

There's jpeg, but still you can't open it?

&lt;denchmark-link:https://user-images.githubusercontent.com/5898766/85326780-1cf06280-b4ce-11ea-94ef-e0f8b4538346.png&gt;&lt;/denchmark-link&gt;

Here is the image folder with images. I am able to load images with labelme version 3.5, but any later does not work.
		</comment>
		<comment id='10' author='off99555' date='2020-06-22T19:41:49Z'>
		&lt;denchmark-link:https://github.com/sakibk&gt;@sakibk&lt;/denchmark-link&gt;
 "does not work" means there's no jpeg listed in the OpenFile dialog? as in here? &lt;denchmark-link:https://github.com/wkentaro/labelme/issues/675#issue-630578377&gt;#675 (comment)&lt;/denchmark-link&gt;

		</comment>
		<comment id='11' author='off99555' date='2020-06-22T19:43:22Z'>
		
Here it goes, labelme -V 4.5.0
[ERROR ] label_file:load_image_file:39 - Failed opening image file: /Users/sakibkurtic/Desktop/Horizontal_Traffic_Sign_Train_Data/0420.jpg

If you're talking about this, this seems a different issue, so can you open another issue?
		</comment>
		<comment id='12' author='off99555' date='2020-06-22T21:34:11Z'>
		

@wkentaro

Here it is. Though the labelme version is 4.2.9

So this issue is probably related to your PyQt5 version or something not labelme version.
Please check the PyQt5 version to see when jpeg will be listed.

Following is the version of  when labelme is 4.2.9
&lt;denchmark-link:https://user-images.githubusercontent.com/15215732/85337150-28617f00-b50a-11ea-9c00-2b4f08103606.png&gt;&lt;/denchmark-link&gt;

I also tried to install labelme 4.5.3, I still see the same qtpy version: 1.9.0
I have also reproduced this problem in another person's PC. So this problem is related to the labelme version.
Note that I don't see jpg in the list from Qtpy but I see jpg in the list of file extension in labelme 4.2.9. So the list of extensions that you saw from qtpy above does not match the list from labelme.
I'm suspecting that you are probably not using qtpy in labelme 4.2.9 then later you use it. That's a clue from me.
If the list from Qtpy should match with the list from labelme, then we have found the bug.
		</comment>
		<comment id='13' author='off99555' date='2020-06-22T21:38:59Z'>
		Can you check the version of PyQt5 instead of qtpy? qtpy is just a wrapper.
		</comment>
		<comment id='14' author='off99555' date='2020-06-22T21:42:33Z'>
		
I'm suspecting that you are probably not using qtpy in labelme 4.2.9 then later you use it. That's a clue from me.
If the list from Qtpy should match with the list from labelme, then we have found the bug.

Actually, both 4.2.9 and 4.5.3 use qtpy. And the logic in app.openFile was not changed.



labelme/labelme/app.py


        Lines 1656 to 1677
      in
      0ad853b






 def openFile(self, _value=False): 



 if not self.mayContinue(): 



 return 



 path = osp.dirname(str(self.filename)) if self.filename else "." 



 formats = [ 



 "*.{}".format(fmt.data().decode()) 



 for fmt in QtGui.QImageReader.supportedImageFormats() 



     ] 



 filters = self.tr("Image &amp; Label files (%s)") % " ".join( 



 formats + ["*%s" % LabelFile.suffix] 



     ) 



 filename = QtWidgets.QFileDialog.getOpenFileName( 



 self, 



 self.tr("%s - Choose Image or Label file") % __appname__, 



 path, 



 filters, 



     ) 



 if QT5: 



 filename, _ = filename 



 filename = str(filename) 



 if filename: 



 self.loadFile(filename) 





Can you try 4.2.10 as well to see when it happens? Or something below to find where the error happens
&lt;denchmark-code&gt;git clone https://github.com/wkentaro/labelme
cd labelme
git checkout v4.2.10
pip install -e .
labelme examples/semantic_segmentation  # check if jpeg is read
git checkout HEAD~1  # previous version
labelme examples/semantic_segmentation  # check if jpeg is read
git checkout HEAD~1  # previous version
labelme examples/semantic_segmentation  # check if jpeg is read
...
&lt;/denchmark-code&gt;

		</comment>
		<comment id='15' author='off99555' date='2020-06-22T21:43:25Z'>
		
Can you check the version of PyQt5 instead of qtpy? qtpy is just a wrapper.

Here it is:
&lt;denchmark-code&gt;&gt;&gt;&gt; from PyQt5.Qt import PYQT_VERSION_STR
&gt;&gt;&gt; PYQT_VERSION_STR
'5.9.2'
&lt;/denchmark-code&gt;

I am not sure if that's the right way to check the version. I just found it from a thread in Quora.
Anyway, the PyQt5 version is the same when I uninstall labelme 4.2.9 and install 4.5.3
		</comment>
		<comment id='16' author='off99555' date='2020-06-22T21:45:15Z'>
		&lt;denchmark-link:https://user-images.githubusercontent.com/15215732/85338345-4d56f180-b50c-11ea-996a-d80b4b1f2bbd.png&gt;&lt;/denchmark-link&gt;

Here's the extension list from 4.2.10. it looks fine
		</comment>
		<comment id='17' author='off99555' date='2020-06-22T21:45:40Z'>
		
Anyway, the PyQt5 version is the same when I uninstall labelme 4.2.9 and install 4.5.3

I see. What is the output of QImageReader.supportedImageFormats() in 4.2.10?
		</comment>
		<comment id='18' author='off99555' date='2020-06-22T21:47:14Z'>
		

Anyway, the PyQt5 version is the same when I uninstall labelme 4.2.9 and install 4.5.3

I see. What is the output of QImageReader.supportedImageFormats() in 4.2.10?

Exact same as 4.2.9
&lt;denchmark-link:https://user-images.githubusercontent.com/15215732/85338528-a1fa6c80-b50c-11ea-91bf-0f6c5cde0492.png&gt;&lt;/denchmark-link&gt;

		</comment>
		<comment id='19' author='off99555' date='2020-06-22T21:49:34Z'>
		So there's no jpeg .. strange. I'm not sure why jpeg could be listed in openFile with it.
		</comment>
		<comment id='20' author='off99555' date='2020-06-22T21:52:25Z'>
		Can you check the difference between 4.3.0 and 4.2.10? Because that's where the problem happens. 4.3.0 does not have jpg.
		</comment>
		<comment id='21' author='off99555' date='2020-06-22T21:54:27Z'>
		Here is some more info:

I use anaconda 3.7.6
I install using pip install
I install in non-admin mode.

		</comment>
		<comment id='22' author='off99555' date='2020-06-22T21:56:19Z'>
		
Can you check the difference between 4.3.0 and 4.2.10? Because that's where the problem happens. 4.3.0 does not have jpg.

I almost know which code change made this happen, but I'm not sure why this could happen.
Anyway, can you check this PR? &lt;denchmark-link:https://github.com/wkentaro/labelme/pull/697&gt;#697&lt;/denchmark-link&gt;

		</comment>
		<comment id='23' author='off99555' date='2020-06-23T04:43:26Z'>
		

Can you check the difference between 4.3.0 and 4.2.10? Because that's where the problem happens. 4.3.0 does not have jpg.

I almost know which code change made this happen, but I'm not sure why this could happen.
Anyway, can you check this PR? #697

Yep. That PR shows all the long extension list. It seems to work. I have also checked the previous commit of that PR. It doesn't show the jpg. So it's confirmed 100% that commit is the relevant code.
		</comment>
	</comments>
</bug>