<bug id='25' author='patrickcgray' open_date='2017-09-22T15:30:02Z' closed_time='2018-03-17T08:17:28Z'>
	<summary>Unable to save: 'bytes' object has no attribute 'encode'</summary>
	<description>
I can't actually save a file on mac OS running python 3.6.2. Every time I try to save I get:
AttributeError: 'bytes' object has no attribute 'encode'
	</description>
	<comments>
		<comment id='1' author='patrickcgray' date='2017-09-23T06:51:25Z'>
		I also meet this problem, the error message exactly the same with patrick's
my environment :
Ubuntu 16.04, Anaconda 4, Python 2.7
		</comment>
		<comment id='2' author='patrickcgray' date='2017-09-30T01:50:39Z'>
		Hi，Thanks for sharing the code，I find a BUG that when I use the tool，if i sliding mouse，the tool will exit。what i have to do if i want to run the code and fix the bug？
		</comment>
		<comment id='3' author='patrickcgray' date='2017-10-03T17:25:42Z'>
		&lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/jjdblast&gt;@jjdblast&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/patrickcgray&gt;@patrickcgray&lt;/denchmark-link&gt;

So I found two problems with the encoding bug.
in labelFile.py in 
1.  should be  because not all the data we would like to save in json is in binary.
2.  should be   this will convert the binary image to string.
As a final step one must correct the load function as well.
this will save the json file with ascii image data in base64.
This is suggested for python3, I am sure the change in python2 is similar.
		</comment>
		<comment id='4' author='patrickcgray' date='2017-10-04T07:15:15Z'>
		I tested in below environment, and they all works. Could you please specify the version again?
with labelme==2.6.2

python2.7 + pyqt5 + linux (work)
python2.7 + pyqt4 + linux (work)
python3.6 + pyqt5 + linux (work)
python3.6 + pyqt4 + linux (work)
python2.7 + pyqt5 + mac (not tested)
python2.7 + pyqt4 + mac (not tested)
python3.5 + pyqt5 + mac (work)
python3.5 + pyqt4 + mac (work)

		</comment>
		<comment id='5' author='patrickcgray' date='2017-10-04T07:20:28Z'>
		Could it be that this problem is platform specific? I am also running on mac OS and I faced the same problem.
Did you test it on mac?
		</comment>
		<comment id='6' author='patrickcgray' date='2017-10-04T07:30:13Z'>
		&lt;denchmark-link:https://github.com/kentaro&gt;@kentaro&lt;/denchmark-link&gt;
 Wad    i can install labelme  on windows and ubuntu sucessfully. the problem is that when i use labeme to label the image, i will exit the GUI when i slide the mouse pulley.
		</comment>
		<comment id='7' author='patrickcgray' date='2017-10-04T07:31:15Z'>
		&lt;denchmark-link:https://github.com/landiaokafeiyan&gt;@landiaokafeiyan&lt;/denchmark-link&gt;
 Your problem is different from the topic in this issue, right? If so, could you please open a new issue?
		</comment>
		<comment id='8' author='patrickcgray' date='2017-10-04T07:32:27Z'>
		&lt;denchmark-link:https://github.com/ibadami&gt;@ibadami&lt;/denchmark-link&gt;
  i can install labelme on windows and ubuntu sucessfully. i have not test it on Mac
		</comment>
		<comment id='9' author='patrickcgray' date='2017-10-04T07:34:37Z'>
		&lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;
  ok sure could you please fix the bug?
		</comment>
		<comment id='10' author='patrickcgray' date='2017-10-04T07:35:00Z'>
		&lt;denchmark-link:https://github.com/landiaokafeiyan&gt;@landiaokafeiyan&lt;/denchmark-link&gt;
 I think so.
		</comment>
		<comment id='11' author='patrickcgray' date='2017-10-04T07:35:46Z'>
		&lt;denchmark-link:https://github.com/wkentaro&gt;@wkentaro&lt;/denchmark-link&gt;
 many thanks
		</comment>
		<comment id='12' author='patrickcgray' date='2017-10-04T08:06:20Z'>
		&lt;denchmark-link:https://github.com/ibadami&gt;@ibadami&lt;/denchmark-link&gt;
 I also tested on mac also, and it works. (fyi I use conda)
		</comment>
		<comment id='13' author='patrickcgray' date='2017-10-04T08:51:12Z'>
		I too used conda.
I am using pyqt5 and python 3.5 and you tested on them as well.
This is very surprising.
		</comment>
		<comment id='14' author='patrickcgray' date='2017-10-04T08:57:05Z'>
		What I do not understand is. When you read the image data using read function in app.py it is read as a binary data. Then how can you encode that binary data in utf-8 during saving. When I googled the error message, I found that this error occurs because the binary data cannot be further encoded.
		</comment>
		<comment id='15' author='patrickcgray' date='2017-10-10T20:38:46Z'>
		+1, same problem
		</comment>
		<comment id='16' author='patrickcgray' date='2017-10-11T22:46:31Z'>
		I used the following and solved the problem:
$  pip3 install SIP
$ pip3 install pyqt5
$ pip install labelme ( it did not worked with pip3)
		</comment>
		<comment id='17' author='patrickcgray' date='2017-11-07T13:54:15Z'>
		Thanks for sharing this code.
I also meet this problem on windows with python3.6 and pyqt5
		</comment>
		<comment id='18' author='patrickcgray' date='2017-11-09T01:48:23Z'>
		I tested in this way on windows, and it worked.
In labelFile.py
def save(...):    with open(filename, 'wb') as f:    if six.Py3:    imagedata=b64encode(imageData.decode('utf-8') should be with open(filename, 'w') as f:    if six.Py3:    imagedata=str(b64encode(imageData), 'utf-8')
		</comment>
		<comment id='19' author='patrickcgray' date='2017-12-25T05:42:20Z'>
		&lt;denchmark-link:https://github.com/l02i08u&gt;@l02i08u&lt;/denchmark-link&gt;
 's way works on my windows with Python 3.6. Thanks for his way.
		</comment>
		<comment id='20' author='patrickcgray' date='2017-12-26T07:59:30Z'>
		Thanks, &lt;denchmark-link:https://github.com/l02i08u&gt;@l02i08u&lt;/denchmark-link&gt;
 's way works for me as well while saving a file (Python 3.6 on Windows). However, when opening a json file saved in this way, the following code in labelFile.py should also be modified, otherwise similar encoding issues would occur:
(under )

with open(filename, 'rb') as f: should be with open(filename, 'r') as f:
imageData = b64decode(data['imageData']).decode('utf-8') should be imageData = b64decode(bytes(data['imageData'], 'utf-8'))

		</comment>
		<comment id='21' author='patrickcgray' date='2018-01-01T13:12:33Z'>
		Thank you &lt;denchmark-link:https://github.com/l02i08u&gt;@l02i08u&lt;/denchmark-link&gt;
 + &lt;denchmark-link:https://github.com/y-wan&gt;@y-wan&lt;/denchmark-link&gt;
 !  These changes solved the problem for me, too! (also Python 3.6 on Windows)
		</comment>
		<comment id='22' author='patrickcgray' date='2018-01-11T03:32:11Z'>
		&lt;denchmark-link:https://github.com/y-wan&gt;@y-wan&lt;/denchmark-link&gt;



def save(self, filename, shapes, imagePath, imageData, lineColor=None, fillColor=None):     try: with open(filename, 'w') as f: if six.PY3: imageData = str(b64encode(imageData), 'utf-8') #b64encode(imageData.encode('utf-8')) elif six.PY2: imageData = b64encode(imageData) 
When I load json file:
Traceback (most recent call last):
File "C:\Anaconda3\lib\site-packages\labelme-2.6.4-py3.5.egg\labelme\app.py", line 780, in openFile
File "C:\Anaconda3\lib\site-packages\labelme-2.6.4-py3.5.egg\labelme\app.py", line 665, in loadFile
AttributeError: 'bytes' object has no attribute 'encode'
		</comment>
		<comment id='23' author='patrickcgray' date='2018-01-18T06:46:11Z'>
		os: windows 10
python:  3.6.4
pyqt5
change labelFile.py file save method
with open(filename, 'w') as f: 
    if six.Py3:
       imagedata=str(b64encode(imageData), 'utf-8')
change labelFile.py file load method
with open(filename, 'r') as f:
    if six.PY3:
        imageData = b64decode(bytes(data['imageData'], 'utf-8'))
works
thanks &lt;denchmark-link:https://github.com/l02i08u&gt;@l02i08u&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/y-wan&gt;@y-wan&lt;/denchmark-link&gt;
 , you are life saver
		</comment>
		<comment id='24' author='patrickcgray' date='2018-02-06T10:18:50Z'>
		Sorry for late, but I confirmed this issue on Python3.
&lt;denchmark-link:https://github.com/wkentaro/labelme/pull/61&gt;#61&lt;/denchmark-link&gt;
 should fix this.
		</comment>
		<comment id='25' author='patrickcgray' date='2018-03-16T10:47:37Z'>
		you may try insted of encode, decode.
		</comment>
	</comments>
</bug>