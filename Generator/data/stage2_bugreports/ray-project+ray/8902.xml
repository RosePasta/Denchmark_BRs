<bug id='8902' author='gabrieleoliaro' open_date='2020-06-11T17:14:53Z' closed_time='2020-06-12T12:14:16Z'>
	<summary>[ray] Build/install from source fails</summary>
	<description>
&lt;denchmark-h:h3&gt;What is the problem?&lt;/denchmark-h&gt;

I'm trying to build Ray from source and to install it onto my Linux VM with
pip install -e . --verbose 
from within the ray/python folder. I've followed the instructions on the doc page &lt;denchmark-link:https://docs.ray.io/en/master/installation.html#building-ray-from-source&gt;here&lt;/denchmark-link&gt;
. However, I am getting the following error:
Error details

gabriele@ubuntu:~/Desktop/ray/python$ pip install -e . --verbose
User install by explicit request
Created temporary directory: /tmp/pip-ephem-wheel-cache-oq6bahjn
Created temporary directory: /tmp/pip-req-tracker-hvmtq7he
Initialized build tracking at /tmp/pip-req-tracker-hvmtq7he
Created build tracker: /tmp/pip-req-tracker-hvmtq7he
Entered build tracker: /tmp/pip-req-tracker-hvmtq7he
Created temporary directory: /tmp/pip-install-iypo6ucy
Obtaining file:///home/gabriele/Desktop/ray/python
  Added file:///home/gabriele/Desktop/ray/python to build tracker '/tmp/pip-req-tracker-hvmtq7he'
    Running setup.py (path:/home/gabriele/Desktop/ray/python/setup.py) egg_info for package from file:///home/gabriele/Desktop/ray/python
    Running command python setup.py egg_info
    running egg_info
    writing ray.egg-info/PKG-INFO
    writing dependency_links to ray.egg-info/dependency_links.txt
    writing entry points to ray.egg-info/entry_points.txt
    writing requirements to ray.egg-info/requires.txt
    writing top-level names to ray.egg-info/top_level.txt
    reading manifest file 'ray.egg-info/SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    /usr/lib/python3/dist-packages/setuptools/dist.py:724: UserWarning: Module Cython was already imported from /home/gabriele/.local/lib/python3.8/site-packages/Cython/__init__.py, but /home/gabriele/Desktop/ray/python/.eggs/Cython-0.29.20-py3.8-linux-x86_64.egg is being added to sys.path
      pkg_resources.working_set.add(dist, replace=True)
    /usr/lib/python3/dist-packages/setuptools/dist.py:724: UserWarning: Module cython was already imported from /home/gabriele/.local/lib/python3.8/site-packages/cython.py, but /home/gabriele/Desktop/ray/python/.eggs/Cython-0.29.20-py3.8-linux-x86_64.egg is being added to sys.path
      pkg_resources.working_set.add(dist, replace=True)
    warning: no files found matching 'ray/python/ray/autoscaler/ray-schema.json'
    writing manifest file 'ray.egg-info/SOURCES.txt'
  Source in /home/gabriele/Desktop/ray/python has version 0.9.0.dev0, which satisfies requirement ray==0.9.0.dev0 from file:///home/gabriele/Desktop/ray/python
  Removed ray==0.9.0.dev0 from file:///home/gabriele/Desktop/ray/python from build tracker '/tmp/pip-req-tracker-hvmtq7he'
Requirement already satisfied: aiohttp in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (3.6.2)
Requirement already satisfied: click&gt;=7.0 in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (7.1.2)
Requirement already satisfied: colorama in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (0.4.3)
Requirement already satisfied: filelock in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (3.0.12)
Requirement already satisfied: google in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (2.0.3)
Requirement already satisfied: grpcio in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (1.29.0)
Requirement already satisfied: jsonschema in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (3.2.0)
Requirement already satisfied: msgpack&lt;2.0.0,&gt;=0.6.0 in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (1.0.0)
Requirement already satisfied: numpy&gt;=1.16 in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (1.18.5)
Requirement already satisfied: protobuf&gt;=3.8.0 in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (3.12.2)
Requirement already satisfied: py-spy&gt;=0.2.0 in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (0.3.3)
Requirement already satisfied: pyyaml in /usr/lib/python3/dist-packages (from ray==0.9.0.dev0) (5.3.1)
Requirement already satisfied: redis&lt;3.5.0,&gt;=3.3.2 in /home/gabriele/.local/lib/python3.8/site-packages (from ray==0.9.0.dev0) (3.4.1)
Requirement already satisfied: attrs&gt;=17.3.0 in /home/gabriele/.local/lib/python3.8/site-packages (from aiohttp-&gt;ray==0.9.0.dev0) (19.3.0)
Requirement already satisfied: async-timeout&lt;4.0,&gt;=3.0 in /home/gabriele/.local/lib/python3.8/site-packages (from aiohttp-&gt;ray==0.9.0.dev0) (3.0.1)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.0 in /home/gabriele/.local/lib/python3.8/site-packages (from aiohttp-&gt;ray==0.9.0.dev0) (1.4.2)
Requirement already satisfied: multidict&lt;5.0,&gt;=4.5 in /home/gabriele/.local/lib/python3.8/site-packages (from aiohttp-&gt;ray==0.9.0.dev0) (4.7.6)
Requirement already satisfied: chardet&lt;4.0,&gt;=2.0 in /usr/lib/python3/dist-packages (from aiohttp-&gt;ray==0.9.0.dev0) (3.0.4)
Requirement already satisfied: beautifulsoup4 in /home/gabriele/.local/lib/python3.8/site-packages (from google-&gt;ray==0.9.0.dev0) (4.9.1)
Requirement already satisfied: six&gt;=1.5.2 in /usr/lib/python3/dist-packages (from grpcio-&gt;ray==0.9.0.dev0) (1.14.0)
Requirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema-&gt;ray==0.9.0.dev0) (45.2.0)
Requirement already satisfied: pyrsistent&gt;=0.14.0 in /home/gabriele/.local/lib/python3.8/site-packages (from jsonschema-&gt;ray==0.9.0.dev0) (0.16.0)
Requirement already satisfied: idna&gt;=2.0 in /usr/lib/python3/dist-packages (from yarl&lt;2.0,&gt;=1.0-&gt;aiohttp-&gt;ray==0.9.0.dev0) (2.8)
Requirement already satisfied: soupsieve&gt;1.2 in /home/gabriele/.local/lib/python3.8/site-packages (from beautifulsoup4-&gt;google-&gt;ray==0.9.0.dev0) (2.0.1)
Installing collected packages: ray
  Running setup.py develop for ray
    Running command /usr/bin/python3 -c 'import sys, setuptools, tokenize; sys.argv[0] = '"'"'/home/gabriele/Desktop/ray/python/setup.py'"'"'; __file__='"'"'/home/gabriele/Desktop/ray/python/setup.py'"'"';f=getattr(tokenize, '"'"'open'"'"', open)(__file__);code=f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' develop --no-deps --user --prefix=
    running develop
    running egg_info
    writing ray.egg-info/PKG-INFO
    writing dependency_links to ray.egg-info/dependency_links.txt
    writing entry points to ray.egg-info/entry_points.txt
    writing requirements to ray.egg-info/requires.txt
    writing top-level names to ray.egg-info/top_level.txt
    reading manifest file 'ray.egg-info/SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    /usr/lib/python3/dist-packages/setuptools/dist.py:724: UserWarning: Module Cython was already imported from /home/gabriele/.local/lib/python3.8/site-packages/Cython/__init__.py, but /home/gabriele/Desktop/ray/python/.eggs/Cython-0.29.20-py3.8-linux-x86_64.egg is being added to sys.path
      pkg_resources.working_set.add(dist, replace=True)
    /usr/lib/python3/dist-packages/setuptools/dist.py:724: UserWarning: Module cython was already imported from /home/gabriele/.local/lib/python3.8/site-packages/cython.py, but /home/gabriele/Desktop/ray/python/.eggs/Cython-0.29.20-py3.8-linux-x86_64.egg is being added to sys.path
      pkg_resources.working_set.add(dist, replace=True)
    warning: no files found matching 'ray/python/ray/autoscaler/ray-schema.json'
    writing manifest file 'ray.egg-info/SOURCES.txt'
    running build_ext
    + set -e
    + SUPPORTED_PYTHONS=("3.5" "3.6" "3.7" "3.8")
    +++ dirname ../build.sh
    ++ cd ..
    ++ pwd
    + ROOT_DIR=/home/gabriele/Desktop/ray
    ++ uname
    + unamestr=Linux
    + [[ Linux == \L\i\n\u\x ]]
    + PARALLEL=1
    + RAY_BUILD_PYTHON=YES
    + RAY_BUILD_JAVA=NO
    + PYTHON_EXECUTABLE=
    + BUILD_DIR=
    + [[ 2 -gt 0 ]]
    + key=-p
    + case $key in
    + PYTHON_EXECUTABLE=/usr/bin/python3
    + shift
    + shift
    + [[ 0 -gt 0 ]]
    + [[ -z /usr/bin/python3 ]]
    ++ /usr/bin/python3 -c 'import sys; version=sys.version_info[:3]; print("{0}.{1}".format(*version))'
    + PYTHON_VERSION=3.8
    + found=
    + for allowed in ${SUPPORTED_PYTHONS[@]}
    + [[ 3.8 == 3.5 ]]
    + for allowed in ${SUPPORTED_PYTHONS[@]}
    + [[ 3.8 == 3.6 ]]
    + for allowed in ${SUPPORTED_PYTHONS[@]}
    + [[ 3.8 == 3.7 ]]
    + for allowed in ${SUPPORTED_PYTHONS[@]}
    + [[ 3.8 == 3.8 ]]
    + found=3.8
    + break
    + [[ -z 3.8 ]]
    + echo 'Using Python executable /usr/bin/python3.'
    Using Python executable /usr/bin/python3.
    + '[' -z '' ']'
    ++ PATH=/home/gabriele/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/home/gabriele/.local/bin:/snap/bin:/home/gabriele/.bazel/bin
    ++ which bazel
    + BAZEL_EXECUTABLE=/home/gabriele/.bazel/bin/bazel
    + '[' -f /home/gabriele/.bazel/bin/bazel ']'
    + echo 'Using Bazel executable /home/gabriele/.bazel/bin/bazel.'
    Using Bazel executable /home/gabriele/.bazel/bin/bazel.
    + BUILD_DIR=/home/gabriele/Desktop/ray/build/
    + '[' '!' -d /home/gabriele/Desktop/ray/build/ ']'
    + pushd /home/gabriele/Desktop/ray/build/
    ~/Desktop/ray/build ~/Desktop/ray/python
    + '[' NO == YES ']'
    + '[' YES == YES ']'
    + pickle5_available=0
    + pickle5_path=/home/gabriele/Desktop/ray/python/ray/pickle5_files
    + check_pickle5_command='import sys\nif sys.version_info &lt; (3, 8, 2): import pickle5;'
    + PYTHONPATH=/home/gabriele/Desktop/ray/python/ray/pickle5_files:
    + /usr/bin/python3 -s -c 'exec("import sys\nif sys.version_info &lt; (3, 8, 2): import pickle5;")'
    + pickle5_available=1
    + '[' 1 -ne 1 ']'
    + '[' -z '' ']'
    + CC=gcc
    + /usr/bin/python3 -m pip install -q psutil setproctitle --target=/home/gabriele/Desktop/ray/python/ray/thirdparty_files
    WARNING: Target directory /home/gabriele/Desktop/ray/python/ray/thirdparty_files/setproctitle.cpython-38-x86_64-linux-gnu.so already exists. Specify --upgrade to force replacement.
    WARNING: Target directory /home/gabriele/Desktop/ray/python/ray/thirdparty_files/setproctitle-1.1.10.dist-info already exists. Specify --upgrade to force replacement.
    WARNING: Target directory /home/gabriele/Desktop/ray/python/ray/thirdparty_files/psutil-5.7.0.dist-info already exists. Specify --upgrade to force replacement.
    WARNING: Target directory /home/gabriele/Desktop/ray/python/ray/thirdparty_files/psutil already exists. Specify --upgrade to force replacement.
    + export PYTHON3_BIN_PATH=/usr/bin/python3
    + PYTHON3_BIN_PATH=/usr/bin/python3
    + /home/gabriele/.bazel/bin/bazel build //:ray_pkg --verbose_failures
    INFO: Writing tracer profile to '/home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/command.profile.gz'
    Loading:
    Loading: 0 packages loaded
    Analyzing: target //:ray_pkg (0 packages loaded, 0 targets configured)
    Analyzing: target //:ray_pkg (2 packages loaded, 6 targets configured)
    Analyzing: target //:ray_pkg (2 packages loaded, 105 targets configured)
    Analyzing: target //:ray_pkg (2 packages loaded, 105 targets configured)
    Analyzing: target //:ray_pkg (2 packages loaded, 105 targets configured)
    Analyzing: target //:ray_pkg (2 packages loaded, 105 targets configured)
    Analyzing: target //:ray_pkg (4 packages loaded, 477 targets configured)
    Analyzing: target //:ray_pkg (5 packages loaded, 523 targets configured)
    Analyzing: target //:ray_pkg (6 packages loaded, 810 targets configured)
    Analyzing: target //:ray_pkg (11 packages loaded, 939 targets configured)
    Analyzing: target //:ray_pkg (14 packages loaded, 1020 targets configured)
    Analyzing: target //:ray_pkg (25 packages loaded, 1897 targets configured)
    Analyzing: target //:ray_pkg (25 packages loaded, 1897 targets configured)
    Analyzing: target //:ray_pkg (25 packages loaded, 1897 targets configured)
    Analyzing: target //:ray_pkg (25 packages loaded, 1897 targets configured)
    Analyzing: target //:ray_pkg (25 packages loaded, 1897 targets configured)
    Analyzing: target //:ray_pkg (42 packages loaded, 8775 targets configured)
    INFO: Analyzed target //:ray_pkg (49 packages loaded, 10142 targets configured).

    INFO: Found 1 target...
    [0 / 1,280] [Prepa] Writing file python/ray/_raylet.so-2.params
    [120 / 1,630] Compiling external/com_google_protobuf/src/google/protobuf/wire_format.cc [for host]; 3s linux-sandbox ... (4 actions running)
    [144 / 1,630] Compiling external/com_google_protobuf/src/google/protobuf/compiler/csharp/csharp_field_base.cc [for host]; 3s linux-sandbox ... (4 actions running)
    [192 / 1,630] Compiling external/com_google_protobuf/src/google/protobuf/repeated_field.cc; 2s linux-sandbox ... (4 actions running)
    [219 / 1,630] Compiling external/com_github_grpc_grpc/src/compiler/python_generator.cc [for host]; 6s linux-sandbox ... (4 actions running)
    [268 / 1,630] Compiling external/com_google_protobuf/src/google/protobuf/util/field_comparator.cc; 1s linux-sandbox ... (4 actions running)
    [344 / 1,630] Compiling external/com_github_jupp0r_prometheus_cpp/core/src/family.cc; 2s linux-sandbox ... (4 actions running)
    [400 / 1,630] Compiling external/boost/libs/regex/src/winstances.cpp; 8s linux-sandbox ... (4 actions running)
    [468 / 1,630] Compiling external/com_google_protobuf/src/google/protobuf/struct.pb.cc; 4s linux-sandbox ... (4 actions running)
    [577 / 1,630] Compiling external/com_github_google_flatbuffers/src/idl_gen_cpp.cpp [for host]; 8s linux-sandbox ... (4 actions running)
    [613 / 1,630] Compiling external/com_google_protobuf/src/google/protobuf/compiler/cpp/cpp_message.cc [for host]; 10s linux-sandbox ... (4 actions running)
    [671 / 1,630] Compiling external/com_google_protobuf/src/google/protobuf/text_format.cc [for host]; 7s linux-sandbox ... (4 actions running)
    [782 / 1,630] Compiling external/boringssl/src/crypto/fipsmodule/bcm.c; 4s linux-sandbox ... (4 actions running)
    [993 / 1,630] Compiling external/com_google_protobuf/src/google/protobuf/descriptor.pb.cc; 8s linux-sandbox ... (4 actions running)
    [1,312 / 1,630] Compiling src/ray/protobuf/common.pb.cc; 1s linux-sandbox ... (4 actions running)
    [1,419 / 1,814] Compiling src/ray/protobuf/gcs_service.grpc.pb.cc; 40s linux-sandbox ... (4 actions running)
    [1,511 / 1,814] Compiling external/com_google_protobuf/src/google/protobuf/compiler/cpp/cpp_extension.cc; 3s linux-sandbox ... (4 actions running)
    [1,751 / 1,828] Compiling src/ray/common/client_connection.cc; 4s linux-sandbox ... (4 actions running)
    [1,778 / 1,828] Compiling src/ray/gcs/gcs_client/global_state_accessor.cc; 43s linux-sandbox ... (4 actions running)
    [1,778 / 1,828] Compiling src/ray/gcs/gcs_client/global_state_accessor.cc; 185s linux-sandbox ... (4 actions running)
    ERROR: /home/gabriele/Desktop/ray/BUILD.bazel:1111:1: C++ compilation of rule '//:global_state_accessor_lib' failed (Exit 1) gcc failed: error executing command
      (cd /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/1657/execroot/com_github_ray_project_ray &amp;&amp; \
      exec env - \
        PATH=/home/gabriele/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/home/gabriele/.local/bin:/snap/bin \
        PWD=/proc/self/cwd \
      /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/_objs/global_state_accessor_lib/global_state_accessor.pic.d '-frandom-seed=bazel-out/k8-opt/bin/_objs/global_state_accessor_lib/global_state_accessor.pic.o' -fPIC -DBOOST_ASIO_SEPARATE_COMPILATION -D__CLANG_SUPPORT_DYN_ANNOTATION__ -DCARES_STATICLIB -iquote . -iquote bazel-out/k8-opt/bin -iquote external/com_google_protobuf -iquote bazel-out/k8-opt/bin/external/com_google_protobuf -iquote external/zlib -iquote bazel-out/k8-opt/bin/external/zlib -iquote external/com_github_antirez_redis -iquote bazel-out/k8-opt/bin/external/com_github_antirez_redis -iquote external/com_github_google_flatbuffers -iquote bazel-out/k8-opt/bin/external/com_github_google_flatbuffers -iquote external/boost -iquote bazel-out/k8-opt/bin/external/boost -iquote external/com_github_google_glog -iquote bazel-out/k8-opt/bin/external/com_github_google_glog -iquote external/com_github_gflags_gflags -iquote bazel-out/k8-opt/bin/external/com_github_gflags_gflags -iquote external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -iquote external/com_google_googletest -iquote bazel-out/k8-opt/bin/external/com_google_googletest -iquote external/arrow -iquote bazel-out/k8-opt/bin/external/arrow -iquote external/com_github_grpc_grpc -iquote bazel-out/k8-opt/bin/external/com_github_grpc_grpc -iquote external/upb -iquote bazel-out/k8-opt/bin/external/upb -iquote external/com_github_cares_cares -iquote bazel-out/k8-opt/bin/external/com_github_cares_cares -iquote external/boringssl -iquote bazel-out/k8-opt/bin/external/boringssl -iquote external/msgpack -iquote bazel-out/k8-opt/bin/external/msgpack -iquote external/com_github_jupp0r_prometheus_cpp -iquote bazel-out/k8-opt/bin/external/com_github_jupp0r_prometheus_cpp -iquote external/civetweb -iquote bazel-out/k8-opt/bin/external/civetweb -iquote external/com_github_madler_zlib -iquote bazel-out/k8-opt/bin/external/com_github_madler_zlib -iquote external/io_opencensus_cpp -iquote bazel-out/k8-opt/bin/external/io_opencensus_cpp -Ibazel-out/k8-opt/bin/external/com_github_antirez_redis/_virtual_includes/hiredis -Ibazel-out/k8-opt/bin/external/com_github_antirez_redis/_virtual_includes/_hiredis -Ibazel-out/k8-opt/bin/external/com_github_google_glog/_virtual_includes/default_glog_headers -Ibazel-out/k8-opt/bin/external/com_github_gflags_gflags/_virtual_includes/gflags -Ibazel-out/k8-opt/bin/external/arrow/_virtual_includes/arrow -Ibazel-out/k8-opt/bin/external/msgpack/_virtual_includes/msgpack -Ibazel-out/k8-opt/bin/external/com_github_jupp0r_prometheus_cpp/pull/_virtual_includes/pull -Ibazel-out/k8-opt/bin/external/com_github_jupp0r_prometheus_cpp/core/_virtual_includes/core -isystem external/com_google_protobuf/src -isystem bazel-out/k8-opt/bin/external/com_google_protobuf/src -isystem external/zlib -isystem bazel-out/k8-opt/bin/external/zlib -isystem external/com_github_antirez_redis/deps/hiredis -isystem bazel-out/k8-opt/bin/external/com_github_antirez_redis/deps/hiredis -isystem external/com_github_google_flatbuffers/include -isystem bazel-out/k8-opt/bin/external/com_github_google_flatbuffers/include -isystem @boost/:asio -isystem bazel-out/k8-opt/bin/@boost/:asio -isystem src -isystem bazel-out/k8-opt/bin/src -isystem src/ray/thirdparty -isystem bazel-out/k8-opt/bin/src/ray/thirdparty -isystem external/boost -isystem bazel-out/k8-opt/bin/external/boost -isystem external/boost/boost/asio -isystem bazel-out/k8-opt/bin/external/boost/boost/asio -isystem external/boost/boost/bind -isystem bazel-out/k8-opt/bin/external/boost/boost/bind -isystem external/boost/boost/get_pointer -isystem bazel-out/k8-opt/bin/external/boost/boost/get_pointer -isystem external/boost/boost/is_placeholder -isystem bazel-out/k8-opt/bin/external/boost/boost/is_placeholder -isystem external/boost/boost/mem_fn -isystem bazel-out/k8-opt/bin/external/boost/boost/mem_fn -isystem external/boost/boost/ref -isystem bazel-out/k8-opt/bin/external/boost/boost/ref -isystem external/boost/boost/config -isystem bazel-out/k8-opt/bin/external/boost/boost/config -isystem external/boost/boost/version -isystem bazel-out/k8-opt/bin/external/boost/boost/version -isystem external/boost/boost/core -isystem bazel-out/k8-opt/bin/external/boost/boost/core -isystem external/boost/boost/detail -isystem bazel-out/k8-opt/bin/external/boost/boost/detail -isystem external/boost/boost/limits -isystem bazel-out/k8-opt/bin/external/boost/boost/limits -isystem external/boost/boost/utility -isystem bazel-out/k8-opt/bin/external/boost/boost/utility -isystem external/boost/boost/container_hash -isystem bazel-out/k8-opt/bin/external/boost/boost/container_hash -isystem external/boost/boost/assert -isystem bazel-out/k8-opt/bin/external/boost/boost/assert -isystem external/boost/boost/integer -isystem bazel-out/k8-opt/bin/external/boost/boost/integer -isystem external/boost/boost/cstdint -isystem bazel-out/k8-opt/bin/external/boost/boost/cstdint -isystem external/boost/boost/static_assert -isystem bazel-out/k8-opt/bin/external/boost/boost/static_assert -isystem external/boost/boost/type_traits -isystem bazel-out/k8-opt/bin/external/boost/boost/type_traits -isystem external/boost/boost/mpl -isystem bazel-out/k8-opt/bin/external/boost/boost/mpl -isystem external/boost/boost/move -isystem bazel-out/k8-opt/bin/external/boost/boost/move -isystem external/boost/boost/preprocessor -isystem bazel-out/k8-opt/bin/external/boost/boost/preprocessor -isystem external/boost/boost/swap -isystem bazel-out/k8-opt/bin/external/boost/boost/swap -isystem external/boost/boost/throw_exception -isystem bazel-out/k8-opt/bin/external/boost/boost/throw_exception -isystem external/boost/boost/current_function -isystem bazel-out/k8-opt/bin/external/boost/boost/current_function -isystem external/boost/boost/exception -isystem bazel-out/k8-opt/bin/external/boost/boost/exception -isystem external/boost/boost/type -isystem bazel-out/k8-opt/bin/external/boost/boost/type -isystem external/boost/boost/visit_each -isystem bazel-out/k8-opt/bin/external/boost/boost/visit_each -isystem external/boost/boost/date_time -isystem bazel-out/k8-opt/bin/external/boost/boost/date_time -isystem external/boost/boost/algorithm -isystem bazel-out/k8-opt/bin/external/boost/boost/algorithm -isystem external/boost/boost/function -isystem bazel-out/k8-opt/bin/external/boost/boost/function -isystem external/boost/boost/type_index -isystem bazel-out/k8-opt/bin/external/boost/boost/type_index -isystem external/boost/boost/functional -isystem bazel-out/k8-opt/bin/external/boost/boost/functional -isystem external/boost/boost/iterator -isystem bazel-out/k8-opt/bin/external/boost/boost/iterator -isystem external/boost/boost/range -isystem bazel-out/k8-opt/bin/external/boost/boost/range -isystem external/boost/boost/array -isystem bazel-out/k8-opt/bin/external/boost/boost/array -isystem external/boost/boost/concept_check -isystem bazel-out/k8-opt/bin/external/boost/boost/concept_check -isystem external/boost/boost/concept -isystem bazel-out/k8-opt/bin/external/boost/boost/concept -isystem external/boost/boost/concept_archetype -isystem bazel-out/k8-opt/bin/external/boost/boost/concept_archetype -isystem external/boost/boost/noncopyable -isystem bazel-out/k8-opt/bin/external/boost/boost/noncopyable -isystem external/boost/boost/optional -isystem bazel-out/k8-opt/bin/external/boost/boost/optional -isystem external/boost/boost/none -isystem bazel-out/k8-opt/bin/external/boost/boost/none -isystem external/boost/boost/regex -isystem bazel-out/k8-opt/bin/external/boost/boost/regex -isystem external/boost/boost/predef -isystem bazel-out/k8-opt/bin/external/boost/boost/predef -isystem external/boost/boost/smart_ptr -isystem bazel-out/k8-opt/bin/external/boost/boost/smart_ptr -isystem external/boost/boost/align -isystem bazel-out/k8-opt/bin/external/boost/boost/align -isystem external/boost/boost/scoped_array -isystem bazel-out/k8-opt/bin/external/boost/boost/scoped_array -isystem external/boost/boost/checked_delete -isystem bazel-out/k8-opt/bin/external/boost/boost/checked_delete -isystem external/boost/boost/scoped_ptr -isystem bazel-out/k8-opt/bin/external/boost/boost/scoped_ptr -isystem external/boost/boost/shared_array -isystem bazel-out/k8-opt/bin/external/boost/boost/shared_array -isystem external/boost/boost/shared_ptr -isystem bazel-out/k8-opt/bin/external/boost/boost/shared_ptr -isystem external/boost/boost/tuple -isystem bazel-out/k8-opt/bin/external/boost/boost/tuple -isystem external/boost/boost/io -isystem bazel-out/k8-opt/bin/external/boost/boost/io -isystem external/boost/boost/lexical_cast -isystem bazel-out/k8-opt/bin/external/boost/boost/lexical_cast -isystem external/boost/boost/chrono -isystem bazel-out/k8-opt/bin/external/boost/boost/chrono -isystem external/boost/boost/operators -isystem bazel-out/k8-opt/bin/external/boost/boost/operators -isystem external/boost/boost/ratio -isystem bazel-out/k8-opt/bin/external/boost/boost/ratio -isystem external/boost/boost/system -isystem bazel-out/k8-opt/bin/external/boost/boost/system -isystem external/boost/boost/cerrno -isystem bazel-out/k8-opt/bin/external/boost/boost/cerrno -isystem external/boost/boost/container -isystem bazel-out/k8-opt/bin/external/boost/boost/container -isystem external/boost/boost/intrusive -isystem bazel-out/k8-opt/bin/external/boost/boost/intrusive -isystem external/boost/boost/math -isystem bazel-out/k8-opt/bin/external/boost/boost/math -isystem external/boost/boost/atomic -isystem bazel-out/k8-opt/bin/external/boost/boost/atomic -isystem external/boost/boost/fusion -isystem bazel-out/k8-opt/bin/external/boost/boost/fusion -isystem external/boost/boost/call_traits -isystem bazel-out/k8-opt/bin/external/boost/boost/call_traits -isystem external/boost/boost/function_types -isystem bazel-out/k8-opt/bin/external/boost/boost/function_types -isystem external/boost/boost/typeof -isystem bazel-out/k8-opt/bin/external/boost/boost/typeof -isystem external/boost/boost/lambda -isystem bazel-out/k8-opt/bin/external/boost/boost/lambda -isystem external/boost/boost/mp11 -isystem bazel-out/k8-opt/bin/external/boost/boost/mp11 -isystem external/boost/boost/numeric_conversion -isystem bazel-out/k8-opt/bin/external/boost/boost/numeric_conversion -isystem external/boost/boost/tokenizer -isystem bazel-out/k8-opt/bin/external/boost/boost/tokenizer -isystem external/com_google_googletest/googlemock -isystem bazel-out/k8-opt/bin/external/com_google_googletest/googlemock -isystem external/com_google_googletest/googlemock/include -isystem bazel-out/k8-opt/bin/external/com_google_googletest/googlemock/include -isystem external/com_google_googletest/googletest -isystem bazel-out/k8-opt/bin/external/com_google_googletest/googletest -isystem external/com_google_googletest/googletest/include -isystem bazel-out/k8-opt/bin/external/com_google_googletest/googletest/include -isystem external/boost/boost/filesystem -isystem bazel-out/k8-opt/bin/external/boost/boost/filesystem -isystem external/com_github_grpc_grpc/include -isystem bazel-out/k8-opt/bin/external/com_github_grpc_grpc/include -isystem external/com_github_grpc_grpc/src/core/ext/upb-generated -isystem bazel-out/k8-opt/bin/external/com_github_grpc_grpc/src/core/ext/upb-generated -isystem external/com_github_cares_cares -isystem bazel-out/k8-opt/bin/external/com_github_cares_cares -isystem external/com_github_grpc_grpc/third_party/address_sorting/include -isystem bazel-out/k8-opt/bin/external/com_github_grpc_grpc/third_party/address_sorting/include -isystem external/boringssl/src/include -isystem bazel-out/k8-opt/bin/external/boringssl/src/include -isystem external/msgpack/include -isystem bazel-out/k8-opt/bin/external/msgpack/include -isystem external/civetweb/include -isystem bazel-out/k8-opt/bin/external/civetweb/include -isystem external/com_github_madler_zlib -isystem bazel-out/k8-opt/bin/external/com_github_madler_zlib -DRAY_USE_GLOG -Werror -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__="redacted"' '-D__TIMESTAMP__="redacted"' '-D__TIME__="redacted"' -c src/ray/gcs/gcs_client/global_state_accessor.cc -o bazel-out/k8-opt/bin/_objs/global_state_accessor_lib/global_state_accessor.pic.o)
    Execution platform: @local_config_platform//:host

    Use --sandbox_debug to see verbose messages from the sandbox
    gcc: fatal error: Killed signal terminated program cc1plus
    compilation terminated.
    Target //:ray_pkg failed to build
    INFO: Elapsed time: 1142.430s, Critical Path: 334.81s
    INFO: 1657 processes: 1656 linux-sandbox, 1 local.
    FAILED: Build did NOT complete successfully
    FAILED: Build did NOT complete successfully
    Traceback (most recent call last):
      File "&lt;string&gt;", line 1, in &lt;module&gt;
      File "/home/gabriele/Desktop/ray/python/setup.py", line 205, in &lt;module&gt;
        setup(
      File "/usr/lib/python3/dist-packages/setuptools/__init__.py", line 144, in setup
        return distutils.core.setup(**attrs)
      File "/usr/lib/python3.8/distutils/core.py", line 148, in setup
        dist.run_commands()
      File "/usr/lib/python3.8/distutils/dist.py", line 966, in run_commands
        self.run_command(cmd)
      File "/usr/lib/python3.8/distutils/dist.py", line 985, in run_command
        cmd_obj.run()
      File "/usr/lib/python3/dist-packages/setuptools/command/develop.py", line 38, in run
        self.install_for_development()
      File "/usr/lib/python3/dist-packages/setuptools/command/develop.py", line 140, in install_for_development
        self.run_command('build_ext')
      File "/usr/lib/python3.8/distutils/cmd.py", line 313, in run_command
        self.distribution.run_command(command)
      File "/usr/lib/python3.8/distutils/dist.py", line 985, in run_command
        cmd_obj.run()
      File "/home/gabriele/Desktop/ray/python/setup.py", line 121, in run
        subprocess.check_call(command)
      File "/usr/lib/python3.8/subprocess.py", line 364, in check_call
        raise CalledProcessError(retcode, cmd)
    subprocess.CalledProcessError: Command '['../build.sh', '-p', '/usr/bin/python3']' returned non-zero exit status 1.
Cleaning up...
Removed build tracker: '/tmp/pip-req-tracker-hvmtq7he'
ERROR: Command errored out with exit status 1: /usr/bin/python3 -c 'import sys, setuptools, tokenize; sys.argv[0] = '"'"'/home/gabriele/Desktop/ray/python/setup.py'"'"'; __file__='"'"'/home/gabriele/Desktop/ray/python/setup.py'"'"';f=getattr(tokenize, '"'"'open'"'"', open)(__file__);code=f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' develop --no-deps --user --prefix= Check the logs for full command output.
Exception information:
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/pip/_internal/cli/base_command.py", line 186, in _main
    status = self.run(options, args)
  File "/usr/lib/python3/dist-packages/pip/_internal/commands/install.py", line 421, in run
    installed = install_given_reqs(
  File "/usr/lib/python3/dist-packages/pip/_internal/req/__init__.py", line 67, in install_given_reqs
    requirement.install(
  File "/usr/lib/python3/dist-packages/pip/_internal/req/req_install.py", line 792, in install
    install_editable_legacy(
  File "/usr/lib/python3/dist-packages/pip/_internal/operations/install/editable_legacy.py", line 49, in install_editable
    call_subprocess(
  File "/usr/lib/python3/dist-packages/pip/_internal/utils/subprocess.py", line 242, in call_subprocess
    raise InstallationError(exc_msg)
pip._internal.exceptions.InstallationError: Command errored out with exit status 1: /usr/bin/python3 -c 'import sys, setuptools, tokenize; sys.argv[0] = '"'"'/home/gabriele/Desktop/ray/python/setup.py'"'"'; __file__='"'"'/home/gabriele/Desktop/ray/python/setup.py'"'"';f=getattr(tokenize, '"'"'open'"'"', open)(__file__);code=f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' develop --no-deps --user --prefix= Check the logs for full command output.


I also tried running bazel build //:ray_pkg --sandbox_debug in the ray directory, and this is the tail of the terminal output I got:
Error details (Sandbox version)

INFO: From Compiling src/ray/object_manager/object_manager.cc:
src/main/tools/linux-sandbox.cc:154: linux-sandbox-pid1 has PID 9475
src/main/tools/linux-sandbox-pid1.cc:175: working dir: /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/51/execroot/com_github_ray_project_ray
src/main/tools/linux-sandbox-pid1.cc:194: writable: /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/51/execroot/com_github_ray_project_ray
src/main/tools/linux-sandbox-pid1.cc:194: writable: /tmp
src/main/tools/linux-sandbox-pid1.cc:194: writable: /dev/shm
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /dev
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /dev/pts
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /dev/shm
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /dev/hugepages
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /dev/mqueue
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/lock
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/vmblock-fuse
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/user/1000
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/user/1000/gvfs
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/user/1000/doc
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/kernel/security
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/unified
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/systemd
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/rdma
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/cpu,cpuacct
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/perf_event
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/hugetlb
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/freezer
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/pids
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/devices
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/blkio
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/net_cls,net_prio
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/memory
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/cpuset
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/pstore
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/bpf
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/kernel/debug
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/kernel/tracing
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/fuse/connections
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/kernel/config
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /proc
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /proc/sys/fs/binfmt_misc
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/core18/1705
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/core18/1754
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/gnome-3-34-1804/36
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/gnome-3-34-1804/24
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/htop/1207
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/core/9289
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/snap-store/433
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/sublime-text/85
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/gtk-common-themes/1506
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/snapd/7264
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/snapd/7777
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/snap-store/454
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /boot/efi
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/51/execroot/com_github_ray_project_ray
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/51/execroot/com_github_ray_project_ray
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /tmp
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /dev/shm
src/main/tools/process-tools.cc:118: sigaction(32, &amp;sa, nullptr) failed
src/main/tools/process-tools.cc:118: sigaction(33, &amp;sa, nullptr) failed
src/main/tools/linux-sandbox-pid1.cc:437: waitpid returned 2
src/main/tools/linux-sandbox-pid1.cc:457: child exited with code 0
src/main/tools/linux-sandbox.cc:204: child exited normally with exitcode 0
ERROR: /home/gabriele/Desktop/ray/BUILD.bazel:1090:1: C++ compilation of rule '//:service_based_gcs_client_lib' failed (Exit 1) linux-sandbox failed: error executing command 
  (cd /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/53/execroot/com_github_ray_project_ray &amp;&amp; \
  exec env - \
    PATH=/home/gabriele/.local/bin:/home/gabriele/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/home/gabriele/.local/bin:/snap/bin \
    PWD=/proc/self/cwd \
    TMPDIR=/tmp \
  /home/gabriele/.cache/bazel/_bazel_gabriele/install/4fdab1f12e1523537c08f2c5b4ce00aa/_embedded_binaries/linux-sandbox -t 15 -w /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/53/execroot/com_github_ray_project_ray -w /tmp -w /dev/shm -D -- /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/_objs/service_based_gcs_client_lib/service_based_accessor.pic.d '-frandom-seed=bazel-out/k8-opt/bin/_objs/service_based_gcs_client_lib/service_based_accessor.pic.o' -fPIC -DBOOST_ASIO_SEPARATE_COMPILATION -D__CLANG_SUPPORT_DYN_ANNOTATION__ -DCARES_STATICLIB -iquote . -iquote bazel-out/k8-opt/bin -iquote external/com_google_protobuf -iquote bazel-out/k8-opt/bin/external/com_google_protobuf -iquote external/zlib -iquote bazel-out/k8-opt/bin/external/zlib -iquote external/com_github_antirez_redis -iquote bazel-out/k8-opt/bin/external/com_github_antirez_redis -iquote external/com_github_google_flatbuffers -iquote bazel-out/k8-opt/bin/external/com_github_google_flatbuffers -iquote external/boost -iquote bazel-out/k8-opt/bin/external/boost -iquote external/com_github_google_glog -iquote bazel-out/k8-opt/bin/external/com_github_google_glog -iquote external/com_github_gflags_gflags -iquote bazel-out/k8-opt/bin/external/com_github_gflags_gflags -iquote external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -iquote external/com_google_googletest -iquote bazel-out/k8-opt/bin/external/com_google_googletest -iquote external/arrow -iquote bazel-out/k8-opt/bin/external/arrow -iquote external/com_github_grpc_grpc -iquote bazel-out/k8-opt/bin/external/com_github_grpc_grpc -iquote external/upb -iquote bazel-out/k8-opt/bin/external/upb -iquote external/com_github_cares_cares -iquote bazel-out/k8-opt/bin/external/com_github_cares_cares -iquote external/boringssl -iquote bazel-out/k8-opt/bin/external/boringssl -iquote external/msgpack -iquote bazel-out/k8-opt/bin/external/msgpack -iquote external/com_github_jupp0r_prometheus_cpp -iquote bazel-out/k8-opt/bin/external/com_github_jupp0r_prometheus_cpp -iquote external/civetweb -iquote bazel-out/k8-opt/bin/external/civetweb -iquote external/com_github_madler_zlib -iquote bazel-out/k8-opt/bin/external/com_github_madler_zlib -iquote external/io_opencensus_cpp -iquote bazel-out/k8-opt/bin/external/io_opencensus_cpp -Ibazel-out/k8-opt/bin/external/com_github_antirez_redis/_virtual_includes/hiredis -Ibazel-out/k8-opt/bin/external/com_github_antirez_redis/_virtual_includes/_hiredis -Ibazel-out/k8-opt/bin/external/com_github_google_glog/_virtual_includes/default_glog_headers -Ibazel-out/k8-opt/bin/external/com_github_gflags_gflags/_virtual_includes/gflags -Ibazel-out/k8-opt/bin/external/arrow/_virtual_includes/arrow -Ibazel-out/k8-opt/bin/external/msgpack/_virtual_includes/msgpack -Ibazel-out/k8-opt/bin/external/com_github_jupp0r_prometheus_cpp/pull/_virtual_includes/pull -Ibazel-out/k8-opt/bin/external/com_github_jupp0r_prometheus_cpp/core/_virtual_includes/core -isystem external/com_google_protobuf/src -isystem bazel-out/k8-opt/bin/external/com_google_protobuf/src -isystem external/zlib -isystem bazel-out/k8-opt/bin/external/zlib -isystem external/com_github_antirez_redis/deps/hiredis -isystem bazel-out/k8-opt/bin/external/com_github_antirez_redis/deps/hiredis -isystem external/com_github_google_flatbuffers/include -isystem bazel-out/k8-opt/bin/external/com_github_google_flatbuffers/include -isystem @boost/:asio -isystem bazel-out/k8-opt/bin/@boost/:asio -isystem src -isystem bazel-out/k8-opt/bin/src -isystem src/ray/thirdparty -isystem bazel-out/k8-opt/bin/src/ray/thirdparty -isystem external/boost -isystem bazel-out/k8-opt/bin/external/boost -isystem external/boost/boost/asio -isystem bazel-out/k8-opt/bin/external/boost/boost/asio -isystem external/boost/boost/bind -isystem bazel-out/k8-opt/bin/external/boost/boost/bind -isystem external/boost/boost/get_pointer -isystem bazel-out/k8-opt/bin/external/boost/boost/get_pointer -isystem external/boost/boost/is_placeholder -isystem bazel-out/k8-opt/bin/external/boost/boost/is_placeholder -isystem external/boost/boost/mem_fn -isystem bazel-out/k8-opt/bin/external/boost/boost/mem_fn -isystem external/boost/boost/ref -isystem bazel-out/k8-opt/bin/external/boost/boost/ref -isystem external/boost/boost/config -isystem bazel-out/k8-opt/bin/external/boost/boost/config -isystem external/boost/boost/version -isystem bazel-out/k8-opt/bin/external/boost/boost/version -isystem external/boost/boost/core -isystem bazel-out/k8-opt/bin/external/boost/boost/core -isystem external/boost/boost/detail -isystem bazel-out/k8-opt/bin/external/boost/boost/detail -isystem external/boost/boost/limits -isystem bazel-out/k8-opt/bin/external/boost/boost/limits -isystem external/boost/boost/utility -isystem bazel-out/k8-opt/bin/external/boost/boost/utility -isystem external/boost/boost/container_hash -isystem bazel-out/k8-opt/bin/external/boost/boost/container_hash -isystem external/boost/boost/assert -isystem bazel-out/k8-opt/bin/external/boost/boost/assert -isystem external/boost/boost/integer -isystem bazel-out/k8-opt/bin/external/boost/boost/integer -isystem external/boost/boost/cstdint -isystem bazel-out/k8-opt/bin/external/boost/boost/cstdint -isystem external/boost/boost/static_assert -isystem bazel-out/k8-opt/bin/external/boost/boost/static_assert -isystem external/boost/boost/type_traits -isystem bazel-out/k8-opt/bin/external/boost/boost/type_traits -isystem external/boost/boost/mpl -isystem bazel-out/k8-opt/bin/external/boost/boost/mpl -isystem external/boost/boost/move -isystem bazel-out/k8-opt/bin/external/boost/boost/move -isystem external/boost/boost/preprocessor -isystem bazel-out/k8-opt/bin/external/boost/boost/preprocessor -isystem external/boost/boost/swap -isystem bazel-out/k8-opt/bin/external/boost/boost/swap -isystem external/boost/boost/throw_exception -isystem bazel-out/k8-opt/bin/external/boost/boost/throw_exception -isystem external/boost/boost/current_function -isystem bazel-out/k8-opt/bin/external/boost/boost/current_function -isystem external/boost/boost/exception -isystem bazel-out/k8-opt/bin/external/boost/boost/exception -isystem external/boost/boost/type -isystem bazel-out/k8-opt/bin/external/boost/boost/type -isystem external/boost/boost/visit_each -isystem bazel-out/k8-opt/bin/external/boost/boost/visit_each -isystem external/boost/boost/date_time -isystem bazel-out/k8-opt/bin/external/boost/boost/date_time -isystem external/boost/boost/algorithm -isystem bazel-out/k8-opt/bin/external/boost/boost/algorithm -isystem external/boost/boost/function -isystem bazel-out/k8-opt/bin/external/boost/boost/function -isystem external/boost/boost/type_index -isystem bazel-out/k8-opt/bin/external/boost/boost/type_index -isystem external/boost/boost/functional -isystem bazel-out/k8-opt/bin/external/boost/boost/functional -isystem external/boost/boost/iterator -isystem bazel-out/k8-opt/bin/external/boost/boost/iterator -isystem external/boost/boost/range -isystem bazel-out/k8-opt/bin/external/boost/boost/range -isystem external/boost/boost/array -isystem bazel-out/k8-opt/bin/external/boost/boost/array -isystem external/boost/boost/concept_check -isystem bazel-out/k8-opt/bin/external/boost/boost/concept_check -isystem external/boost/boost/concept -isystem bazel-out/k8-opt/bin/external/boost/boost/concept -isystem external/boost/boost/concept_archetype -isystem bazel-out/k8-opt/bin/external/boost/boost/concept_archetype -isystem external/boost/boost/noncopyable -isystem bazel-out/k8-opt/bin/external/boost/boost/noncopyable -isystem external/boost/boost/optional -isystem bazel-out/k8-opt/bin/external/boost/boost/optional -isystem external/boost/boost/none -isystem bazel-out/k8-opt/bin/external/boost/boost/none -isystem external/boost/boost/regex -isystem bazel-out/k8-opt/bin/external/boost/boost/regex -isystem external/boost/boost/predef -isystem bazel-out/k8-opt/bin/external/boost/boost/predef -isystem external/boost/boost/smart_ptr -isystem bazel-out/k8-opt/bin/external/boost/boost/smart_ptr -isystem external/boost/boost/align -isystem bazel-out/k8-opt/bin/external/boost/boost/align -isystem external/boost/boost/scoped_array -isystem bazel-out/k8-opt/bin/external/boost/boost/scoped_array -isystem external/boost/boost/checked_delete -isystem bazel-out/k8-opt/bin/external/boost/boost/checked_delete -isystem external/boost/boost/scoped_ptr -isystem bazel-out/k8-opt/bin/external/boost/boost/scoped_ptr -isystem external/boost/boost/shared_array -isystem bazel-out/k8-opt/bin/external/boost/boost/shared_array -isystem external/boost/boost/shared_ptr -isystem bazel-out/k8-opt/bin/external/boost/boost/shared_ptr -isystem external/boost/boost/tuple -isystem bazel-out/k8-opt/bin/external/boost/boost/tuple -isystem external/boost/boost/io -isystem bazel-out/k8-opt/bin/external/boost/boost/io -isystem external/boost/boost/lexical_cast -isystem bazel-out/k8-opt/bin/external/boost/boost/lexical_cast -isystem external/boost/boost/chrono -isystem bazel-out/k8-opt/bin/external/boost/boost/chrono -isystem external/boost/boost/operators -isystem bazel-out/k8-opt/bin/external/boost/boost/operators -isystem external/boost/boost/ratio -isystem bazel-out/k8-opt/bin/external/boost/boost/ratio -isystem external/boost/boost/system -isystem bazel-out/k8-opt/bin/external/boost/boost/system -isystem external/boost/boost/cerrno -isystem bazel-out/k8-opt/bin/external/boost/boost/cerrno -isystem external/boost/boost/container -isystem bazel-out/k8-opt/bin/external/boost/boost/container -isystem external/boost/boost/intrusive -isystem bazel-out/k8-opt/bin/external/boost/boost/intrusive -isystem external/boost/boost/math -isystem bazel-out/k8-opt/bin/external/boost/boost/math -isystem external/boost/boost/atomic -isystem bazel-out/k8-opt/bin/external/boost/boost/atomic -isystem external/boost/boost/fusion -isystem bazel-out/k8-opt/bin/external/boost/boost/fusion -isystem external/boost/boost/call_traits -isystem bazel-out/k8-opt/bin/external/boost/boost/call_traits -isystem external/boost/boost/function_types -isystem bazel-out/k8-opt/bin/external/boost/boost/function_types -isystem external/boost/boost/typeof -isystem bazel-out/k8-opt/bin/external/boost/boost/typeof -isystem external/boost/boost/lambda -isystem bazel-out/k8-opt/bin/external/boost/boost/lambda -isystem external/boost/boost/mp11 -isystem bazel-out/k8-opt/bin/external/boost/boost/mp11 -isystem external/boost/boost/numeric_conversion -isystem bazel-out/k8-opt/bin/external/boost/boost/numeric_conversion -isystem external/boost/boost/tokenizer -isystem bazel-out/k8-opt/bin/external/boost/boost/tokenizer -isystem external/com_google_googletest/googlemock -isystem bazel-out/k8-opt/bin/external/com_google_googletest/googlemock -isystem external/com_google_googletest/googlemock/include -isystem bazel-out/k8-opt/bin/external/com_google_googletest/googlemock/include -isystem external/com_google_googletest/googletest -isystem bazel-out/k8-opt/bin/external/com_google_googletest/googletest -isystem external/com_google_googletest/googletest/include -isystem bazel-out/k8-opt/bin/external/com_google_googletest/googletest/include -isystem external/boost/boost/filesystem -isystem bazel-out/k8-opt/bin/external/boost/boost/filesystem -isystem external/com_github_grpc_grpc/include -isystem bazel-out/k8-opt/bin/external/com_github_grpc_grpc/include -isystem external/com_github_grpc_grpc/src/core/ext/upb-generated -isystem bazel-out/k8-opt/bin/external/com_github_grpc_grpc/src/core/ext/upb-generated -isystem external/com_github_cares_cares -isystem bazel-out/k8-opt/bin/external/com_github_cares_cares -isystem external/com_github_grpc_grpc/third_party/address_sorting/include -isystem bazel-out/k8-opt/bin/external/com_github_grpc_grpc/third_party/address_sorting/include -isystem external/boringssl/src/include -isystem bazel-out/k8-opt/bin/external/boringssl/src/include -isystem external/msgpack/include -isystem bazel-out/k8-opt/bin/external/msgpack/include -isystem external/civetweb/include -isystem bazel-out/k8-opt/bin/external/civetweb/include -isystem external/com_github_madler_zlib -isystem bazel-out/k8-opt/bin/external/com_github_madler_zlib -DRAY_USE_GLOG -Werror -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__="redacted"' '-D__TIMESTAMP__="redacted"' '-D__TIME__="redacted"' -c src/ray/gcs/gcs_client/service_based_accessor.cc -o bazel-out/k8-opt/bin/_objs/service_based_gcs_client_lib/service_based_accessor.pic.o)
src/main/tools/linux-sandbox.cc:154: linux-sandbox-pid1 has PID 9514
src/main/tools/linux-sandbox-pid1.cc:175: working dir: /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/53/execroot/com_github_ray_project_ray
src/main/tools/linux-sandbox-pid1.cc:194: writable: /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/53/execroot/com_github_ray_project_ray
src/main/tools/linux-sandbox-pid1.cc:194: writable: /tmp
src/main/tools/linux-sandbox-pid1.cc:194: writable: /dev/shm
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /dev
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /dev/pts
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /dev/shm
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /dev/hugepages
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /dev/mqueue
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/lock
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/vmblock-fuse
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/user/1000
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/user/1000/gvfs
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /run/user/1000/doc
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/kernel/security
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/unified
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/systemd
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/rdma
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/cpu,cpuacct
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/perf_event
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/hugetlb
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/freezer
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/pids
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/devices
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/blkio
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/net_cls,net_prio
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/memory
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/cgroup/cpuset
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/pstore
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/bpf
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/kernel/debug
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/kernel/tracing
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/fs/fuse/connections
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /sys/kernel/config
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /proc
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /proc/sys/fs/binfmt_misc
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/core18/1705
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/core18/1754
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/gnome-3-34-1804/36
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/gnome-3-34-1804/24
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/htop/1207
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/core/9289
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/snap-store/433
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/sublime-text/85
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/gtk-common-themes/1506
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/snapd/7264
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/snapd/7777
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /snap/snap-store/454
src/main/tools/linux-sandbox-pid1.cc:265: remount ro: /boot/efi
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/53/execroot/com_github_ray_project_ray
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/sandbox/linux-sandbox/53/execroot/com_github_ray_project_ray
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /tmp
src/main/tools/linux-sandbox-pid1.cc:265: remount rw: /dev/shm
src/main/tools/process-tools.cc:118: sigaction(32, &amp;sa, nullptr) failed
src/main/tools/process-tools.cc:118: sigaction(33, &amp;sa, nullptr) failed
gcc: fatal error: Killed signal terminated program cc1plus
compilation terminated.
src/main/tools/linux-sandbox-pid1.cc:437: waitpid returned 2
src/main/tools/linux-sandbox-pid1.cc:457: child exited with code 1
src/main/tools/linux-sandbox.cc:204: child exited normally with exitcode 1
Target //:ray_pkg failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 484.871s, Critical Path: 253.13s
INFO: 53 processes: 1 remote cache hit, 52 linux-sandbox.
FAILED: Build did NOT complete successfully



This &lt;denchmark-link:https://github.com/ray-project/ray/issues/8535&gt;issue&lt;/denchmark-link&gt;
 looks similar.

ray: Latest one on the &lt;denchmark-link:https://github.com/ray-project/&gt;master branch&lt;/denchmark-link&gt;

python: 3.8.2
gcc: 9.3.0
bazel: 1.1.0
os: Ubuntu 20.04 LTS. Also tried on Ubuntu 18.04.
&lt;denchmark-h:h3&gt;Reproduction (REQUIRED)&lt;/denchmark-h&gt;

Please provide a script that can be run to reproduce the issue. The script should have no external library dependencies (i.e., use fake or mock data / environments):
For reproduction, you can just follow the instructions &lt;denchmark-link:https://docs.ray.io/en/master/installation.html#building-ray-from-source&gt;here&lt;/denchmark-link&gt;
 and run:
sudo apt-get update
sudo apt-get install -y build-essential curl unzip psmisc
pip install cython==0.29.0 pytest
git clone https://github.com/ray-project/ray.git

# Install Bazel.
ray/ci/travis/install-bazel.sh

# Optionally build the dashboard (requires Node.js, see below for more information).
pushd ray/python/ray/dashboard/client
npm ci
npm run build
popd

# Install Ray.
cd ray/python
pip install -e . --verbose  # Add --user if you see a permission denied error. 

If we cannot run your script, we cannot fix your issue.

 I have verified my script runs in a clean environment and reproduces the issue.
 I have verified the issue also occurs with the latest wheels.

	</description>
	<comments>
		<comment id='1' author='gabrieleoliaro' date='2020-06-11T21:37:10Z'>
		Would you mind trying the following and posting the result?
&lt;denchmark-code&gt;bazel build  --run_under="strace -qq -k -e exit -s 32768 -f" //:global_state_accessor_lib
&lt;/denchmark-code&gt;

		</comment>
		<comment id='2' author='gabrieleoliaro' date='2020-06-11T23:00:25Z'>
		&lt;denchmark-link:https://github.com/mehrdadn&gt;@mehrdadn&lt;/denchmark-link&gt;
 Sure! I've just run it. This is the terminal output I get:
gabriele@ubuntu:~/Desktop/ray$ bazel build  --run_under="strace -qq -k -e exit -s 32768 -f" //:global_state_accessor_lib
INFO: Writing tracer profile to '/home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/command.profile.gz'
INFO: Build option --run_under has changed, discarding analysis cache.
INFO: Analyzed target //:global_state_accessor_lib (1 packages loaded, 9349 targets configured).
INFO: Found 1 target...
ERROR: /home/gabriele/Desktop/ray/BUILD.bazel:1111:1: C++ compilation of rule '//:global_state_accessor_lib' failed (Exit 1) gcc failed: error executing command /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections ... (remaining 473 argument(s) skipped)

Use --sandbox_debug to see verbose messages from the sandbox
gcc: fatal error: Killed signal terminated program cc1plus
compilation terminated.
Target //:global_state_accessor_lib failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 419.856s, Critical Path: 415.18s
INFO: 0 processes.
FAILED: Build did NOT complete successfully
		</comment>
		<comment id='3' author='gabrieleoliaro' date='2020-06-11T23:02:05Z'>
		Ah shoot, I thought it would show a stack trace :\ never mind, sorry about that!
		</comment>
		<comment id='4' author='gabrieleoliaro' date='2020-06-11T23:03:40Z'>
		no worries! Let me see if I can build/install using Anaconda and Python 3.6 on Ubuntu 18.04
		</comment>
		<comment id='5' author='gabrieleoliaro' date='2020-06-12T01:39:53Z'>
		
@mehrdadn Sure! I've just run it. This is the terminal output I get:
gabriele@ubuntu:~/Desktop/ray$ bazel build  --run_under="strace -qq -k -e exit -s 32768 -f" //:global_state_accessor_lib
INFO: Writing tracer profile to '/home/gabriele/.cache/bazel/_bazel_gabriele/fe8ca04b32d4e28331c2f1fad7926138/command.profile.gz'
INFO: Build option --run_under has changed, discarding analysis cache.
INFO: Analyzed target //:global_state_accessor_lib (1 packages loaded, 9349 targets configured).
INFO: Found 1 target...
ERROR: /home/gabriele/Desktop/ray/BUILD.bazel:1111:1: C++ compilation of rule '//:global_state_accessor_lib' failed (Exit 1) gcc failed: error executing command /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections ... (remaining 473 argument(s) skipped)

Use --sandbox_debug to see verbose messages from the sandbox
gcc: fatal error: Killed signal terminated program cc1plus
compilation terminated.
Target //:global_state_accessor_lib failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 419.856s, Critical Path: 415.18s
INFO: 0 processes.
FAILED: Build did NOT complete successfully

Can you show us how many cpu and memory in this machine?
There is no enough memory when all cpu cores are enabled, so bazel build crash/interrupted (actually it's root cause in our builder pipeline).
Perphas it's helpful to add build --jobs=4 in ray/.bazelrc.
		</comment>
		<comment id='6' author='gabrieleoliaro' date='2020-06-12T01:50:40Z'>
		&lt;denchmark-link:https://github.com/ashione&gt;@ashione&lt;/denchmark-link&gt;
 Thanks a bunch for the tip! I'll try to re-run with the  option. My laptop has 8gb of ram with an Intel i7 @ 2.6 GHz. For the VMWare VM where I'm building Ray I reserved 4gb of RAM and 4 processor cores. When I ran htop during the build process, all four processors where at close to 100% utilization.
		</comment>
		<comment id='7' author='gabrieleoliaro' date='2020-06-12T01:54:51Z'>
		
@ashione Thanks a bunch for the tip! I'll try to re-run with the --jobs=4 option. My laptop has 8gb of ram with an Intel i7 @ 2.6 GHz. For the VMWare VM where I'm building Ray I reserved 4gb of RAM and 4 processor cores. When I ran htop during the build process, all four processors where at close to 100% utilization.

If there is less memory, you can properly reduce the number of CPU cores when executing bazel build.
		</comment>
		<comment id='8' author='gabrieleoliaro' date='2020-06-12T02:56:39Z'>
		I've seen a similar issue before, bazel was killed due to out of memory.
We used the workaround that &lt;denchmark-link:https://github.com/ashione&gt;@ashione&lt;/denchmark-link&gt;
 suggested above. Reducing the number of concurrent jobs will also reduce memory consumption.
		</comment>
		<comment id='9' author='gabrieleoliaro' date='2020-06-12T12:14:15Z'>
		&lt;denchmark-link:https://github.com/ashione&gt;@ashione&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/raulchen&gt;@raulchen&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/mehrdadn&gt;@mehrdadn&lt;/denchmark-link&gt;

I finally got it to work! Thanks everyone for the help! I ended up adding  to the ~/.bazelrc file before running  and the issue disappeared.
		</comment>
	</comments>
</bug>