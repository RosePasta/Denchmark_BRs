<bug id='39970' author='prathak' open_date='2020-05-28T21:25:00Z' closed_time='2020-06-12T15:09:25Z'>
	<summary>Unable to use tfp.optimizer.lbfgs_minimize, error after 2 iterations</summary>
	<description>
Hi I am unable to use tfp.optimizer.lbfgs_minimize, following the tutorial on &lt;denchmark-link:https://www.tensorflow.org/probability/examples/Optimizers_in_TensorFlow_Probability&gt;https://www.tensorflow.org/probability/examples/Optimizers_in_TensorFlow_Probability&lt;/denchmark-link&gt;
.
Similar to &lt;denchmark-link:https://github.com/tensorflow/probability/issues/398&gt;tensorflow/probability#398&lt;/denchmark-link&gt;
,
I am facing error "Inputs to operation Select of type Select must have the same size and shape.  Input 0: [110] != input 1: [1] [Op:Select]"
I noticed that when my cost function if of shape (1,) and my gradient of shape (x,1) it says x!=1
But what I don't understand is why does my cost function need to be of shape(x,1)? When I add a placeholder return which returns shape (x,1) for cost value as well, it runs.
&lt;denchmark-link:https://user-images.githubusercontent.com/7682371/83195374-09054b00-a132-11ea-8b56-f353f89b54a7.png&gt;&lt;/denchmark-link&gt;

	</description>
	<comments>
		<comment id='1' author='prathak' date='2020-05-29T13:57:45Z'>
		&lt;denchmark-link:https://github.com/prathak&gt;@prathak&lt;/denchmark-link&gt;

Please share a simple stand alone code along with tensor flow version for us to replicate the issue faced.
		</comment>
		<comment id='2' author='prathak' date='2020-06-05T14:34:28Z'>
		This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you.
		</comment>
		<comment id='3' author='prathak' date='2020-06-12T15:09:20Z'>
		Closing as stale. Please reopen if you'd like to work on this further.
		</comment>
		<comment id='4' author='prathak' date='2020-06-12T15:09:26Z'>
		Are you satisfied with the resolution of your issue?
&lt;denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&amp;entry.2137816233=https://github.com/tensorflow/tensorflow/issues/39970&gt;Yes&lt;/denchmark-link&gt;

&lt;denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&amp;entry.2137816233=https://github.com/tensorflow/tensorflow/issues/39970&gt;No&lt;/denchmark-link&gt;

		</comment>
	</comments>
</bug>