<bug id='38460' author='nagisa' open_date='2020-04-11T17:06:18Z' closed_time='2020-05-14T22:43:19Z'>
	<summary>[1.14/1.15] TensorRT ConvertGraphDefToEngine SIGSEGV</summary>
	<description>
Please make sure that this is a bug. As per our
GitHub Policy,
we only address code/doc bugs, performance issues, feature requests and
build/installation issues on GitHub. tag:bug_template
System information

Have I written custom code (as opposed to using a stock
example script provided in TensorFlow): yes
OS Platform and Distribution (e.g.,
Linux Ubuntu 16.04): NixOS
Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if
the issue happens on mobile device:  N/A
TensorFlow installed from (source or
binary): Source
TensorFlow version (use command below): 1.14
Python version: 3.6.10
Bazel: v0.26.0
version (if compiling from source):
GCC/Compiler version (if compiling from
source): 0.9.2
CUDA/cuDNN version: 10.0.130/7.6.5.32
GPU model and memory: No GPU in the system/sandboxed environment

You can collect some of this information using our environment capture
&lt;denchmark-link:https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh&gt;script&lt;/denchmark-link&gt;

You can also obtain the TensorFlow version with: 1. TF 1.0:  2. TF 2.0: 
Describe the current behavior
When making tensorflow to invoke TensorRT graph optimiser on the system without a GPU/inside a sandbox, tensorflow will segfault with a null dereference.

Log
2020-04-11 19:39:35.067438: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-04-11 19:39:35.069624: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2020-04-11 19:39:35.069654: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (shirobox): /proc/driver/nvidia/version does not exist
2020-04-11 19:39:35.088189: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2999610000 Hz
2020-04-11 19:39:35.089136: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x40682b0 executing computations on platform Host. Devices:
2020-04-11 19:39:35.089190: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): &lt;undefined&gt;, &lt;undefined&gt;
2020-04-11 19:39:35.829560: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
[2020-04-11 19:39:35,858][WARNING][tensorflow][deprecation new_func] From test_tensorrt_enabled.py:26: convert_variables_to_constants (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.convert_variables_to_constants`
[2020-04-11 19:39:35,858][WARNING][tensorflow][deprecation new_func] From /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/framework/graph_util_impl.py:270: extract_sub_graph (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.extract_sub_graph`
[2020-04-11 19:39:35,876][INFO][tensorflow][graph_util_impl convert_variables_to_constants] Froze 11 variables.
[2020-04-11 19:39:35,890][INFO][tensorflow][graph_util_impl convert_variables_to_constants] Converted 11 variables to const ops.
[2020-04-11 19:39:35,891][INFO][tensorflow][trt_convert _check_trt_version_compatibility] Linked TensorRT version: (7, 0, 0)
[2020-04-11 19:39:35,891][INFO][tensorflow][trt_convert _check_trt_version_compatibility] Loaded TensorRT version: (7, 0, 0)
[2020-04-11 19:39:35,891][INFO][tensorflow][trt_convert _check_trt_version_compatibility] Running against TensorRT version 7.0.0
2020-04-11 19:39:35.948446: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count &gt;= 8, compute capability &gt;= 0.0): 0
2020-04-11 19:39:35.948611: I tensorflow/core/grappler/clusters/single_machine.cc:359] Starting new session
2020-04-11 19:39:35.997673: I tensorflow/compiler/tf2tensorrt/segment/segment.cc:460] There are 5 ops of 4 different types in the graph that are not converted to TensorRT: Identity, FusedBatchNorm, NoOp, Placeholder, (For more information see https://docs.nvidia.com/deeplearning/dgx/tf-trt-user-guide/index.html#supported-ops).
2020-04-11 19:39:35.997810: I tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:733] Number of TensorRT candidate segments: 1
2020-04-11 19:39:36.003553: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2020-04-11 19:39:36.006215: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:797] Couldn't get current device: no CUDA-capable device is detected
2020-04-11 19:39:36.006242: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 0 does not exist Not found: TensorFlow device GPU:0 was not registered
2020-04-11 19:39:36.006267: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 1 does not exist Not found: TensorFlow device GPU:1 was not registered
2020-04-11 19:39:36.006279: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 2 does not exist Not found: TensorFlow device GPU:2 was not registered
2020-04-11 19:39:36.006289: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 3 does not exist Not found: TensorFlow device GPU:3 was not registered
2020-04-11 19:39:36.006300: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 4 does not exist Not found: TensorFlow device GPU:4 was not registered
2020-04-11 19:39:36.006311: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 5 does not exist Not found: TensorFlow device GPU:5 was not registered
2020-04-11 19:39:36.006321: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 6 does not exist Not found: TensorFlow device GPU:6 was not registered
2020-04-11 19:39:36.006332: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 7 does not exist Not found: TensorFlow device GPU:7 was not registered
2020-04-11 19:39:36.006342: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 8 does not exist Not found: TensorFlow device GPU:8 was not registered
2020-04-11 19:39:36.006352: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 9 does not exist Not found: TensorFlow device GPU:9 was not registered
2020-04-11 19:39:36.006363: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 10 does not exist Not found: TensorFlow device GPU:10 was not registered
2020-04-11 19:39:36.006373: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 11 does not exist Not found: TensorFlow device GPU:11 was not registered
2020-04-11 19:39:36.006384: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 12 does not exist Not found: TensorFlow device GPU:12 was not registered
2020-04-11 19:39:36.006395: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 13 does not exist Not found: TensorFlow device GPU:13 was not registered
2020-04-11 19:39:36.006406: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 14 does not exist Not found: TensorFlow device GPU:14 was not registered
2020-04-11 19:39:36.006416: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 15 does not exist Not found: TensorFlow device GPU:15 was not registered
2020-04-11 19:39:36.006426: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 16 does not exist Not found: TensorFlow device GPU:16 was not registered
2020-04-11 19:39:36.006436: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 17 does not exist Not found: TensorFlow device GPU:17 was not registered
2020-04-11 19:39:36.006447: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 18 does not exist Not found: TensorFlow device GPU:18 was not registered
2020-04-11 19:39:36.006457: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 19 does not exist Not found: TensorFlow device GPU:19 was not registered
2020-04-11 19:39:36.006467: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 20 does not exist Not found: TensorFlow device GPU:20 was not registered
2020-04-11 19:39:36.006478: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 21 does not exist Not found: TensorFlow device GPU:21 was not registered
2020-04-11 19:39:36.006488: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 22 does not exist Not found: TensorFlow device GPU:22 was not registered
2020-04-11 19:39:36.006498: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 23 does not exist Not found: TensorFlow device GPU:23 was not registered
2020-04-11 19:39:36.006509: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 24 does not exist Not found: TensorFlow device GPU:24 was not registered
2020-04-11 19:39:36.006519: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 25 does not exist Not found: TensorFlow device GPU:25 was not registered
2020-04-11 19:39:36.006529: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 26 does not exist Not found: TensorFlow device GPU:26 was not registered
2020-04-11 19:39:36.006540: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 27 does not exist Not found: TensorFlow device GPU:27 was not registered
2020-04-11 19:39:36.006550: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 28 does not exist Not found: TensorFlow device GPU:28 was not registered
2020-04-11 19:39:36.006561: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 29 does not exist Not found: TensorFlow device GPU:29 was not registered
2020-04-11 19:39:36.006571: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 30 does not exist Not found: TensorFlow device GPU:30 was not registered
2020-04-11 19:39:36.006582: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 31 does not exist Not found: TensorFlow device GPU:31 was not registered
2020-04-11 19:39:36.006592: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 32 does not exist Not found: TensorFlow device GPU:32 was not registered
2020-04-11 19:39:36.006602: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 33 does not exist Not found: TensorFlow device GPU:33 was not registered
2020-04-11 19:39:36.006613: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 34 does not exist Not found: TensorFlow device GPU:34 was not registered
2020-04-11 19:39:36.006625: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 35 does not exist Not found: TensorFlow device GPU:35 was not registered
2020-04-11 19:39:36.006636: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 36 does not exist Not found: TensorFlow device GPU:36 was not registered
2020-04-11 19:39:36.006647: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 37 does not exist Not found: TensorFlow device GPU:37 was not registered
2020-04-11 19:39:36.006659: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 38 does not exist Not found: TensorFlow device GPU:38 was not registered
2020-04-11 19:39:36.006670: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 39 does not exist Not found: TensorFlow device GPU:39 was not registered
2020-04-11 19:39:36.006682: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 40 does not exist Not found: TensorFlow device GPU:40 was not registered
2020-04-11 19:39:36.006693: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 41 does not exist Not found: TensorFlow device GPU:41 was not registered
2020-04-11 19:39:36.006705: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 42 does not exist Not found: TensorFlow device GPU:42 was not registered
2020-04-11 19:39:36.006717: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 43 does not exist Not found: TensorFlow device GPU:43 was not registered
2020-04-11 19:39:36.006728: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 44 does not exist Not found: TensorFlow device GPU:44 was not registered
2020-04-11 19:39:36.006738: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 45 does not exist Not found: TensorFlow device GPU:45 was not registered
2020-04-11 19:39:36.006749: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 46 does not exist Not found: TensorFlow device GPU:46 was not registered
2020-04-11 19:39:36.006761: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 47 does not exist Not found: TensorFlow device GPU:47 was not registered
2020-04-11 19:39:36.006772: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 48 does not exist Not found: TensorFlow device GPU:48 was not registered
2020-04-11 19:39:36.006784: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 49 does not exist Not found: TensorFlow device GPU:49 was not registered
2020-04-11 19:39:36.006794: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 50 does not exist Not found: TensorFlow device GPU:50 was not registered
2020-04-11 19:39:36.006805: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 51 does not exist Not found: TensorFlow device GPU:51 was not registered
2020-04-11 19:39:36.006817: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 52 does not exist Not found: TensorFlow device GPU:52 was not registered
2020-04-11 19:39:36.006828: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 53 does not exist Not found: TensorFlow device GPU:53 was not registered
2020-04-11 19:39:36.006838: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 54 does not exist Not found: TensorFlow device GPU:54 was not registered
2020-04-11 19:39:36.006849: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 55 does not exist Not found: TensorFlow device GPU:55 was not registered
2020-04-11 19:39:36.006860: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 56 does not exist Not found: TensorFlow device GPU:56 was not registered
2020-04-11 19:39:36.006872: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 57 does not exist Not found: TensorFlow device GPU:57 was not registered
2020-04-11 19:39:36.006883: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 58 does not exist Not found: TensorFlow device GPU:58 was not registered
2020-04-11 19:39:36.006894: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 59 does not exist Not found: TensorFlow device GPU:59 was not registered
2020-04-11 19:39:36.006905: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 60 does not exist Not found: TensorFlow device GPU:60 was not registered
2020-04-11 19:39:36.006917: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 61 does not exist Not found: TensorFlow device GPU:61 was not registered
2020-04-11 19:39:36.006928: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 62 does not exist Not found: TensorFlow device GPU:62 was not registered
2020-04-11 19:39:36.006939: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 63 does not exist Not found: TensorFlow device GPU:63 was not registered
2020-04-11 19:39:36.006950: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 64 does not exist Not found: TensorFlow device GPU:64 was not registered
2020-04-11 19:39:36.006962: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 65 does not exist Not found: TensorFlow device GPU:65 was not registered
2020-04-11 19:39:36.006972: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 66 does not exist Not found: TensorFlow device GPU:66 was not registered
2020-04-11 19:39:36.006983: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 67 does not exist Not found: TensorFlow device GPU:67 was not registered
2020-04-11 19:39:36.006994: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 68 does not exist Not found: TensorFlow device GPU:68 was not registered
2020-04-11 19:39:36.007011: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 69 does not exist Not found: TensorFlow device GPU:69 was not registered
2020-04-11 19:39:36.007024: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 70 does not exist Not found: TensorFlow device GPU:70 was not registered
2020-04-11 19:39:36.007035: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 71 does not exist Not found: TensorFlow device GPU:71 was not registered
2020-04-11 19:39:36.007045: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 72 does not exist Not found: TensorFlow device GPU:72 was not registered
2020-04-11 19:39:36.007056: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 73 does not exist Not found: TensorFlow device GPU:73 was not registered
2020-04-11 19:39:36.007067: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 74 does not exist Not found: TensorFlow device GPU:74 was not registered
2020-04-11 19:39:36.007078: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 75 does not exist Not found: TensorFlow device GPU:75 was not registered
2020-04-11 19:39:36.007089: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 76 does not exist Not found: TensorFlow device GPU:76 was not registered
2020-04-11 19:39:36.007100: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 77 does not exist Not found: TensorFlow device GPU:77 was not registered
2020-04-11 19:39:36.007110: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 78 does not exist Not found: TensorFlow device GPU:78 was not registered
2020-04-11 19:39:36.007121: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 79 does not exist Not found: TensorFlow device GPU:79 was not registered
2020-04-11 19:39:36.007132: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 80 does not exist Not found: TensorFlow device GPU:80 was not registered
2020-04-11 19:39:36.007142: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 81 does not exist Not found: TensorFlow device GPU:81 was not registered
2020-04-11 19:39:36.007153: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 82 does not exist Not found: TensorFlow device GPU:82 was not registered
2020-04-11 19:39:36.007164: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 83 does not exist Not found: TensorFlow device GPU:83 was not registered
2020-04-11 19:39:36.007175: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 84 does not exist Not found: TensorFlow device GPU:84 was not registered
2020-04-11 19:39:36.007185: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 85 does not exist Not found: TensorFlow device GPU:85 was not registered
2020-04-11 19:39:36.007195: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 86 does not exist Not found: TensorFlow device GPU:86 was not registered
2020-04-11 19:39:36.007206: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 87 does not exist Not found: TensorFlow device GPU:87 was not registered
2020-04-11 19:39:36.007217: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 88 does not exist Not found: TensorFlow device GPU:88 was not registered
2020-04-11 19:39:36.007228: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 89 does not exist Not found: TensorFlow device GPU:89 was not registered
2020-04-11 19:39:36.007240: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 90 does not exist Not found: TensorFlow device GPU:90 was not registered
2020-04-11 19:39:36.007251: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 91 does not exist Not found: TensorFlow device GPU:91 was not registered
2020-04-11 19:39:36.007260: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 92 does not exist Not found: TensorFlow device GPU:92 was not registered
2020-04-11 19:39:36.007272: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 93 does not exist Not found: TensorFlow device GPU:93 was not registered
2020-04-11 19:39:36.007282: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 94 does not exist Not found: TensorFlow device GPU:94 was not registered
2020-04-11 19:39:36.007293: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 95 does not exist Not found: TensorFlow device GPU:95 was not registered
2020-04-11 19:39:36.007304: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 96 does not exist Not found: TensorFlow device GPU:96 was not registered
2020-04-11 19:39:36.007315: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 97 does not exist Not found: TensorFlow device GPU:97 was not registered
2020-04-11 19:39:36.007326: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 98 does not exist Not found: TensorFlow device GPU:98 was not registered
2020-04-11 19:39:36.007338: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] TF GPU with id 99 does not exist Not found: TensorFlow device GPU:99 was not registered
2020-04-11 19:39:36.007348: W tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:824] Can't identify the cuda device. Running on device 0
2020-04-11 19:39:36.007394: E tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:41] DefaultLogger CUDA initialization failure with error 38. Please check your CUDA installation:  http://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html
Fatal Python error: Segmentation fault

Current thread 0x00007f02020e7f40 (most recent call first):
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/grappler/tf_optimizer.py", line 41 in OptimizeGraph
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/compiler/tensorrt/trt_convert.py", line 204 in _run_conversion
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/compiler/tensorrt/trt_convert.py", line 226 in _convert_graph_def
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/compiler/tensorrt/trt_convert.py", line 298 in convert
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/compiler/tensorrt/trt_convert.py", line 1146 in create_inference_graph
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/contrib/tensorrt/python/trt_convert.py", line 51 in create_inference_graph
  File "test_tensorrt_enabled.py", line 38 in test_tensorrt_enabled
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/python.py", line 167 in pytest_pyfunc_call
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/callers.py", line 187 in _multicall
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 87 in &lt;lambda&gt;
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 93 in _hookexec
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/hooks.py", line 286 in __call__
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/python.py", line 1445 in runtest
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/runner.py", line 134 in pytest_runtest_call
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/callers.py", line 187 in _multicall
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 87 in &lt;lambda&gt;
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 93 in _hookexec
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/hooks.py", line 286 in __call__
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/runner.py", line 210 in &lt;lambda&gt;
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/runner.py", line 237 in from_call
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/runner.py", line 210 in call_runtest_hook
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/runner.py", line 185 in call_and_report
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/runner.py", line 99 in runtestprotocol
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/runner.py", line 84 in pytest_runtest_protocol
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/callers.py", line 187 in _multicall
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 87 in &lt;lambda&gt;
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 93 in _hookexec
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/hooks.py", line 286 in __call__
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/main.py", line 271 in pytest_runtestloop
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/callers.py", line 187 in _multicall
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 87 in &lt;lambda&gt;
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 93 in _hookexec
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/hooks.py", line 286 in __call__
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/main.py", line 247 in _main
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/main.py", line 197 in wrap_session
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/main.py", line 240 in pytest_cmdline_main
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/callers.py", line 187 in _multicall
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 87 in &lt;lambda&gt;
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/manager.py", line 93 in _hookexec
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pluggy/hooks.py", line 286 in __call__
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/_pytest/config/__init__.py", line 93 in main
  File "/nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/pytest/__main__.py", line 7 in &lt;module&gt;
  File "/nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/python3.6/runpy.py", line 85 in _run_code
  File "/nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/python3.6/runpy.py", line 193 in _run_module_as_main



gdb backtrace
#0  0x00007fff359762f7 in tensorflow::tensorrt::convert::ConvertGraphDefToEngine(tensorflow::GraphDef const&amp;, tensorflow::tensorrt::TrtPrecisionMode, int, unsigned long, std::vector&lt;tensorflow::PartialTensorShape, std::allocator&lt;tensorflow::PartialTensorShape&gt; &gt; const&amp;, tensorflow::tensorrt::Logger*, nvinfer1::IGpuAllocator*, tensorflow::tensorrt::TRTInt8Calibrator*, std::unique_ptr&lt;nvinfer1::ICudaEngine, tensorflow::tensorrt::TrtDestroyer&lt;nvinfer1::ICudaEngine&gt; &gt;*, bool, bool*) () from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/compiler/tf2tensorrt/python/ops/libtftrt.so
#1  0x00007fff3593f8e0 in tensorflow::tensorrt::convert::CreateTRTNode(tensorflow::tensorrt::convert::ConversionParams const&amp;, std::vector&lt;tensorflow::tensorrt::convert::EngineInfo, std::allocator&lt;tensorflow::tensorrt::convert::EngineInfo&gt; &gt; const&amp;, int, int, tensorflow::Graph*, nvinfer1::IGpuAllocator*, std::vector&lt;tensorflow::Node*, std::allocator&lt;tensorflow::Node*&gt; &gt;*) ()
   from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/compiler/tf2tensorrt/python/ops/libtftrt.so
#2  0x00007fff35947551 in tensorflow::tensorrt::convert::ConvertAfterShapes(tensorflow::tensorrt::convert::ConversionParams const&amp;) ()
   from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/compiler/tf2tensorrt/python/ops/libtftrt.so
#3  0x00007fff3597ff50 in tensorflow::tensorrt::convert::TRTOptimizationPass::Optimize(tensorflow::grappler::Cluster*, tensorflow::grappler::GrapplerItem const&amp;, tensorflow::GraphDef*) ()
   from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/compiler/tf2tensorrt/python/ops/libtftrt.so
#4  0x00007fff9c7d2105 in tensorflow::grappler::MetaOptimizer::RunOptimizer(tensorflow::grappler::GraphOptimizer*, tensorflow::grappler::Cluster*, tensorflow::grappler::GrapplerItem*, tensorflow::GraphDef*, tensorflow::grappler::MetaOptimizer::GraphOptimizationResult*) () from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#5  0x00007fff9c7d3631 in tensorflow::grappler::MetaOptimizer::OptimizeGraph(tensorflow::grappler::Cluster*, tensorflow::grappler::GrapplerItem const&amp;, tensorflow::GraphDef*) ()
   from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#6  0x00007fff9c7d51fe in tensorflow::grappler::MetaOptimizer::Optimize(tensorflow::grappler::Cluster*, tensorflow::grappler::GrapplerItem const&amp;, tensorflow::GraphDef*) ()
   from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#7  0x00007fff94cfaa43 in TF_OptimizeGraph(GCluster, tensorflow::ConfigProto const&amp;, tensorflow::MetaGraphDef const&amp;, bool, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, TF_Status*) ()
   from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#8  0x00007fff94d024fa in _wrap_TF_OptimizeGraph () from /nix/store/w7dqhlrb6qv0im8hnwl309f13q86pnb4-python3-3.6.10-env/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#9  0x00007ffff7d76cf3 in _PyCFunction_FastCallDict () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#10 0x00007ffff7dfb4c4 in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#11 0x00007ffff7e0032a in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#12 0x00007ffff7dfafda in _PyEval_EvalCodeWithName () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#13 0x00007ffff7dfb3d4 in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#14 0x00007ffff7e00a8f in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#15 0x00007ffff7dfa5d3 in _PyFunction_FastCall () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#16 0x00007ffff7dfb59c in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#17 0x00007ffff7e0032a in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#18 0x00007ffff7dfa5d3 in _PyFunction_FastCall () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#19 0x00007ffff7dfb59c in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#20 0x00007ffff7e0032a in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#21 0x00007ffff7dfa5d3 in _PyFunction_FastCall () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#22 0x00007ffff7dfb59c in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#23 0x00007ffff7e0032a in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#24 0x00007ffff7dfafda in _PyEval_EvalCodeWithName () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#25 0x00007ffff7dfb3d4 in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#26 0x00007ffff7e00a8f in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#27 0x00007ffff7dfafda in _PyEval_EvalCodeWithName () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#28 0x00007ffff7dfb3d4 in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#29 0x00007ffff7e00a8f in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#30 0x00007ffff7dfafda in _PyEval_EvalCodeWithName () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#31 0x00007ffff7dfb5ee in PyEval_EvalCodeEx () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#32 0x00007ffff7d4f60e in function_call () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#33 0x00007ffff7d21087 in PyObject_Call () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#34 0x00007ffff7e0084c in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#35 0x00007ffff7dfafda in _PyEval_EvalCodeWithName () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#36 0x00007ffff7dfb5ee in PyEval_EvalCodeEx () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#37 0x00007ffff7d4f52e in function_call () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#38 0x00007ffff7d21087 in PyObject_Call () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#39 0x00007ffff7e0084c in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#40 0x00007ffff7dfafda in _PyEval_EvalCodeWithName () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#41 0x00007ffff7dfb3d4 in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#42 0x00007ffff7e00a8f in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#43 0x00007ffff7dfafda in _PyEval_EvalCodeWithName () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#44 0x00007ffff7dfb3d4 in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#45 0x00007ffff7e0032a in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#46 0x00007ffff7dfa5d3 in _PyFunction_FastCall () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#47 0x00007ffff7dfb59c in call_function () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#48 0x00007ffff7e0032a in _PyEval_EvalFrameDefault () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#49 0x00007ffff7dfafda in _PyEval_EvalCodeWithName () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#50 0x00007ffff7e03c37 in _PyFunction_FastCallDict () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0
#51 0x00007ffff7d212a1 in _PyObject_FastCallDict () from /nix/store/2ard4hsnrajrxdwvp20kgql2r5j2fl82-python3-3.6.10/lib/libpython3.6m.so.1.0



disassembly/registers
...
   0x00007fff359762db &lt;+155&gt;:	je     0x7fff359762e0 &lt;_ZN10tensorflow8tensorrt7convert23ConvertGraphDefToEngineERKNS_8GraphDefENS0_16TrtPrecisionModeEimRKSt6vectorINS_18PartialTensorShapeESaIS7_EEPNS0_6LoggerEPN8nvinfer113IGpuAllocatorEPNS0_17TRTInt8CalibratorEPSt10unique_ptrINSE_11ICudaEngineENS0_12TrtDestroyerISK_EEEbPb+160&gt;
   0x00007fff359762dd &lt;+157&gt;:	movb   $0x0,(%rcx)
   0x00007fff359762e0 &lt;+160&gt;:	mov    $0x1b58,%esi
   0x00007fff359762e5 &lt;+165&gt;:	mov    %rax,%rdi
   0x00007fff359762e8 &lt;+168&gt;:	callq  0x7fff35923510 &lt;createInferBuilder_INTERNAL@plt&gt;
   0x00007fff359762ed &lt;+173&gt;:	mov    %rax,%rdi
   0x00007fff359762f0 &lt;+176&gt;:	mov    %rax,-0x440(%rbp)
=&gt; 0x00007fff359762f7 &lt;+183&gt;:	mov    (%rax),%rax
   0x00007fff359762fa &lt;+186&gt;:	mov    %r15d,%esi
   0x00007fff359762fd &lt;+189&gt;:	mov    %rdi,%r15
   0x00007fff35976300 &lt;+192&gt;:	callq  *0x8(%rax)
   0x00007fff35976303 &lt;+195&gt;:	mov    (%r15),%rax
...

(gdb) info registers
rax            0x0                 0
....


I suspect that what’s happening is that  &lt;denchmark-link:https://github.com/tensorflow/tensorflow/blob/00fad90125b18b80fe054de1055770cfb8fe4ba3/tensorflow/compiler/tf2tensorrt/convert/convert_nodes.cc#L4917&gt;here&lt;/denchmark-link&gt;
 returns a nullptr (becaue of missing GPU) and then tensorflow dereferences it without checking the return value.
From what I can see this issue is still present &lt;denchmark-link:https://github.com/tensorflow/tensorflow/blob/20a26f65d08ed37232a5adb19d9762bf65b6d761/tensorflow/compiler/tf2tensorrt/convert/convert_nodes.cc#L1204&gt;in master&lt;/denchmark-link&gt;
 – the  is never checked for nullptr before it is dereferenced with  a couple lines below.
Describe the expected behavior
Tensorflow should return an error/raise an exception instead of trying to dereference a nullptr.
Standalone code to reproduce the issue
import tensorflow as tf
import tensorflow.contrib.slim as slim
import tensorflow.contrib.tensorrt as trt

with tf.Session() as sess:
    input0 = tf.placeholder(tf.float32, [10, 3, 224, 224])
    out = input0

    out = slim.batch_norm(out, data_format="NHWC", scope="bn2")
    with slim.arg_scope([slim.conv2d, slim.batch_norm], data_format="NCHW"), slim.arg_scope(
        [slim.batch_norm]
    ):
        out = slim.conv2d(
            out, 64, [3, 3], normalizer_fn=slim.batch_norm, activation_fn=tf.nn.relu
        )
        out = slim.conv2d(out, 64, [3, 3], normalizer_fn=slim.batch_norm)
        out = tf.identity(out)
    out = tf.identity(out)
    out_name = out.name[:-2]

    init = tf.global_variables_initializer()
    sess.run(init)

    frozen_graph = tf.graph_util.convert_variables_to_constants(
        sess, tf.get_default_graph().as_graph_def(), output_node_names=[out_name]
    )

    trt_graph = trt.create_inference_graph(
        frozen_graph,
        [out_name],
        max_batch_size=10,
        is_dynamic_op=False,
    )
	</description>
	<comments>
		<comment id='1' author='nagisa' date='2020-04-13T07:17:15Z'>
		&lt;denchmark-link:https://github.com/nagisa&gt;@nagisa&lt;/denchmark-link&gt;

I have tried on colab with TF version 1.14 . Please, find the gist &lt;denchmark-link:https://colab.sandbox.google.com/gist/ravikyram/3c6d36532a13b25f923b8aae0c429e22/untitled767.ipynb&gt;here&lt;/denchmark-link&gt;
. Is this the expected behavior? Thanks!
		</comment>
		<comment id='2' author='nagisa' date='2020-04-13T11:25:07Z'>
		&lt;denchmark-link:https://github.com/ravikyram&gt;@ravikyram&lt;/denchmark-link&gt;
 colab does not appear to have TensorRT enabled as evidenced by
&lt;denchmark-code&gt;INFO:tensorflow:Linked TensorRT version: (0, 0, 0)
INFO:tensorflow:Loaded TensorRT version: (0, 0, 0)
INFO:tensorflow:Running against TensorRT version 0.0.0
&lt;/denchmark-code&gt;

so it is not invoking any TensorRT code-paths at all and thus won’t be able to reproduce this issue. I believe a custom build of TF is necessary to take advantage of TensorRT at all (with TF_NEED_TENSORRT=1 set when building).
		</comment>
		<comment id='3' author='nagisa' date='2020-04-16T16:56:54Z'>
		Can you try 1.15 or later? 1.14 has been released in a bad state and should be skipped if possible.
		</comment>
		<comment id='4' author='nagisa' date='2020-04-16T21:52:55Z'>
		The SIGSEGV is still present when running 1.15. This is fairly apparent by just reviewing code but I ran the test case "just in case" and it still reproduces:
&lt;denchmark-code&gt;2020-04-17 00:50:22.602495: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
WARNING: Logging before flag parsing goes to stderr.
W0417 00:50:24.764523 139696792719168 __init__.py:329] Limited tf.compat.v2.summary API due to missing TensorBoard installation.
W0417 00:50:25.624777 139696792719168 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

2020-04-17 00:50:25.630230: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.7
2020-04-17 00:50:25.630325: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer_plugin.so.7
W0417 00:50:25.634957 139696792719168 module_wrapper.py:139] From test.py:5: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-04-17 00:50:25.636118: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-04-17 00:50:25.638156: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2020-04-17 00:50:25.638181: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (shirobox): /proc/driver/nvidia/version does not exist
2020-04-17 00:50:25.659198: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2999610000 Hz
2020-04-17 00:50:25.659750: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x507ff40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-04-17 00:50:25.659778: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
W0417 00:50:25.661654 139696792719168 module_wrapper.py:139] From test.py:6: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0417 00:50:25.664518 139696792719168 deprecation.py:323] From /nix/store/3qxd7awvhwpw31mjqrnx0ipcs8is2zy4-python3.6-tensorflow-gpu-1.15.2/lib/python3.6/site-packages/tensorflow_core/contrib/layers/python/layers/layers.py:650: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
W0417 00:50:25.810726 139696792719168 module_wrapper.py:139] From test.py:21: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

W0417 00:50:25.832406 139696792719168 module_wrapper.py:139] From test.py:25: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0417 00:50:25.857594 139696792719168 deprecation.py:323] From test.py:25: convert_variables_to_constants (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.convert_variables_to_constants`
W0417 00:50:25.857715 139696792719168 deprecation.py:323] From /nix/store/3qxd7awvhwpw31mjqrnx0ipcs8is2zy4-python3.6-tensorflow-gpu-1.15.2/lib/python3.6/site-packages/tensorflow_core/python/framework/graph_util_impl.py:277: extract_sub_graph (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.extract_sub_graph`
2020-04-17 00:50:25.878155: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.7
2020-04-17 00:50:25.914339: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count &gt;= 8, compute capability &gt;= 0.0): 0
2020-04-17 00:50:25.914627: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session
2020-04-17 00:50:25.949588: W tensorflow/compiler/tf2tensorrt/convert/convert_nodes.cc:4399] FusedBatchNormV3 only supports is_training=false. If you are using Keras, please call keras.backend.set_learning_phase(0) before constructing your model. At Conv/BatchNorm/FusedBatchNormV3
2020-04-17 00:50:25.949786: W tensorflow/compiler/tf2tensorrt/convert/convert_nodes.cc:4399] FusedBatchNormV3 only supports is_training=false. If you are using Keras, please call keras.backend.set_learning_phase(0) before constructing your model. At Conv_1/BatchNorm/FusedBatchNormV3
2020-04-17 00:50:25.949926: I tensorflow/compiler/tf2tensorrt/segment/segment.cc:460] There are 7 ops of 4 different types in the graph that are not converted to TensorRT: Identity, FusedBatchNormV3, NoOp, Placeholder, (For more information see https://docs.nvidia.com/deeplearning/frameworks/tf-trt-user-guide/index.html#supported-ops).
2020-04-17 00:50:25.950231: I tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:633] Number of TensorRT candidate segments: 1
2020-04-17 00:50:25.959752: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:696] Couldn't get current device: no CUDA-capable device is detected
2020-04-17 00:50:25.959808: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:101] Could not find any TF GPUs
2020-04-17 00:50:25.959822: W tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:723] Can't identify the cuda device. Running on device 0
2020-04-17 00:50:25.960108: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.7
2020-04-17 00:50:25.963251: E tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:41] DefaultLogger CUDA initialization failure with error 38. Please check your CUDA installation:  http://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html
fish: “python test.py” terminated by signal SIGSEGV (Address boundary error)
&lt;/denchmark-code&gt;

		</comment>
		<comment id='5' author='nagisa' date='2020-04-17T16:18:09Z'>
		Thanks for confirming. I will investigate more.
		</comment>
		<comment id='6' author='nagisa' date='2020-04-17T16:20:41Z'>
		Note, that I linked the relevant code in the original description. Re-producing the links here:



tensorflow/tensorflow/compiler/tf2tensorrt/convert/convert_nodes.cc


         Line 4917
      in
      00fad90






 TrtUniquePtrType&lt;nvinfer1::IBuilder&gt; builder( 








tensorflow/tensorflow/compiler/tf2tensorrt/convert/convert_nodes.cc


         Line 1204
      in
      20a26f6






 trt_builder_.reset(nvinfer1::createInferBuilder(*trt_logger)); 





		</comment>
		<comment id='7' author='nagisa' date='2020-04-17T16:45:15Z'>
		I missed those. Thank you. I'm on it as of now and will have a fix by end of day and then backport it over the next weeks. Apologies for the delay this process entails
		</comment>
		<comment id='8' author='nagisa' date='2020-04-21T00:55:25Z'>
		The code on master is not causing the failure since the code paths are different (graph models are no longer converted by tensorrt). Deprecated code has just not been removed yet.
Trying to build now with 1.15 and test there.
		</comment>
		<comment id='9' author='nagisa' date='2020-04-21T16:24:30Z'>
		I am unable to reproduce in the supported environment. I built tensorflow-gpu on a supported environment with CUDA headers and then installed the pip on a supported environment without CUDA. When running the test all I get is
&lt;denchmark-code&gt;2020-04-21 09:13:40.771653: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfe
r.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory                                         
2020-04-21 09:13:40.771683: F tensorflow/compiler/tf2tensorrt/stub/nvinfer_stub.cc:49] getInferLibVersion symbol not found.          
Aborted 
&lt;/denchmark-code&gt;

Tried with master, 2.2rc3, 2.1.0, 2.0.1, 2.0.0, 1.15.2 and 1.15.0. Never got a segfault.
For the versions not using contrib (as it has been deprecated), I have used
from tensorflow.python.compiler.tensorrt import trt_convert as trt

converter = trt.TrtGraphConverterV2(input_saved_model_dir='/tmp/mobilenet/1/')
converter.convert()
where the model to convert has been generated via
import tensorflow as tf

pretrained_model = tf.keras.applications.MobileNet()
tf.saved_model.save(pretrained_model, "/tmp/mobilenet/1/")
At this point, since you are building from source, can you check if the fix you propose (i.e., checking for nullptr before accessing) works? If it does, can you submit a PR please?
		</comment>
		<comment id='10' author='nagisa' date='2020-04-21T16:26:49Z'>
		This also makes sense since the binding between TF and TRT seems to raise the symbol not found error if the header does not exist. The only time nullptr can be returned is if the symbol bound against returns nullptr: &lt;denchmark-link:https://cs.opensource.google/tensorflow/tensorflow/+/master:tensorflow/compiler/tf2tensorrt/stub/NvInfer_5_1.inc;l=5-10&gt;https://cs.opensource.google/tensorflow/tensorflow/+/master:tensorflow/compiler/tf2tensorrt/stub/NvInfer_5_1.inc;l=5-10&lt;/denchmark-link&gt;

		</comment>
		<comment id='11' author='nagisa' date='2020-04-21T16:34:35Z'>
		The environment I’m using has cuda and all the related libraries installed and available. It just doesn’t have an actual GPU attached.
Think of it this way:

Install everything to run tensorrt properly;
Shutdown the machine;
Pull out the GPU(s);
Power on the machine;
Try running the test case (the cuda libraries will still be present, but a GPU will be absent).

I think that might be why you are not able to reproduce this issue.
		</comment>
		<comment id='12' author='nagisa' date='2020-04-21T19:32:18Z'>
		I did that and still no segfault. Here is the log I get
&lt;denchmark-code&gt;2020-04-21 12:25:26.189672: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1                                                                                                                         
2020-04-21 12:25:27.424632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.6                                                                                                                           
2020-04-21 12:25:27.566116: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1                                                                                                                              
2020-04-21 12:25:27.578055: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected                          
2020-04-21 12:25:27.578125: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: packer-5e4c64c2-6ffe-09bb-47a3-1096cbf0e2cb                                                                                       
2020-04-21 12:25:27.578134: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: packer-5e4c64c2-6ffe-09bb-47a3-1096cbf0e2cb                                                                                                                              
2020-04-21 12:25:27.578251: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.64.0         
2020-04-21 12:25:27.578288: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.64.0          
2020-04-21 12:25:27.578301: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.64.0   
2020-04-21 12:25:27.578715: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX AVX2 FMA                     
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.                                          
2020-04-21 12:25:27.589214: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2300000000 Hz                  
2020-04-21 12:25:27.591760: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x71413b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:                                                                               
2020-04-21 12:25:27.591796: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version     
2020-04-21 12:25:30.510865: I tensorflow/core/grappler/devices.cc:69] Number of eligible GPUs (core count &gt;= 8, compute capability &gt;= 0.0): 0                                                                                                                             
2020-04-21 12:25:30.511106: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session 
2020-04-21 12:25:30.545872: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:810] Optimization results for grappler item: graph_to_optimize                                                                                                                        
2020-04-21 12:25:30.545929: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   function_optimizer: Graph size after: 559 nodes (419), 852 edges (712), time = 17.04ms.                                                                                        
2020-04-21 12:25:30.545936: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   function_optimizer: function_optimizer did nothing. time = 0.366ms.                                                                                                            
2020-04-21 12:25:31.426631: I tensorflow/core/grappler/devices.cc:69] Number of eligible GPUs (core count &gt;= 8, compute capability &gt;= 0.0): 0
2020-04-21 12:25:31.426973: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session
2020-04-21 12:25:31.735623: I tensorflow/compiler/tf2tensorrt/segment/segment.cc:460] There are 41 ops of 8 different types in the graph that are not converted to TensorRT: Reshape, StridedSlice, NoOp, Placeholder, Pack, Shape, Identity, FusedBatchNormV3, (For more 
information see https://docs.nvidia.com/deeplearning/frameworks/tf-trt-user-guide/index.html#supported-ops).
2020-04-21 12:25:31.739816: I tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:659] Number of TensorRT candidate segments: 29
2020-04-21 12:25:31.740282: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:102] Could not find any TF GPUs
2020-04-21 12:25:31.740677: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:102] Could not find any TF GPUs
2020-04-21 12:25:31.740895: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:102] Could not find any TF GPUs
2020-04-21 12:25:31.741106: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:102] Could not find any TF GPUs
2020-04-21 12:25:31.741358: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:102] Could not find any TF GPUs
...
2020-04-21 12:25:31.785400: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:725] Couldn't get current device: no CUDA-capable device is detected
2020-04-21 12:25:31.785467: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:102] Could not find any TF GPUs
2020-04-21 12:25:31.785473: W tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:752] Can't identify the cuda device. Running on device 0 
2020-04-21 12:25:31.785625: I tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:763] Replaced segment 0 consisting of 5 nodes by TRTEngineOp_0_0.
2020-04-21 12:25:31.785681: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:102] Could not find any TF GPUs
2020-04-21 12:25:31.785691: W tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:752] Can't identify the cuda device. Running on device 0 
2020-04-21 12:25:31.785744: I tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:763] Replaced segment 1 consisting of 3 nodes by StatefulPartitionedCall/mobilenet_1.00_224/TRTEngineOp_0_1.
...
2020-04-21 12:25:31.788720: I tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:763] Replaced segment 27 consisting of 3 nodes by StatefulPartitionedCall/mobilenet_1.00_224/TRTEngineOp_0_27.
2020-04-21 12:25:31.788765: E tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:102] Could not find any TF GPUs
2020-04-21 12:25:31.788774: W tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:752] Can't identify the cuda device. Running on device 0 
2020-04-21 12:25:31.788831: I tensorflow/compiler/tf2tensorrt/convert/convert_graph.cc:763] Replaced segment 28 consisting of 3 nodes by StatefulPartitionedCall/mobilenet_1.00_224/TRTEngineOp_0_28.
2020-04-21 12:25:31.926398: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:810] Optimization results for grappler item: tf_graph
2020-04-21 12:25:31.926463: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   constant_folding: Graph size after: 396 nodes (-137), 552 edges (-274), time = 144.978ms.
2020-04-21 12:25:31.926471: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   layout: layout did nothing. time = 0.777ms.
2020-04-21 12:25:31.926482: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   constant_folding: Graph size after: 396 nodes (0), 552 edges (0), time = 26.016ms.
2020-04-21 12:25:31.926536: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   TensorRTOptimizer: Graph size after: 326 nodes (-70), 475 edges (-77), time = 147.931ms.
2020-04-21 12:25:31.926549: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   constant_folding: Graph size after: 326 nodes (0), 475 edges (0), time = 16.335ms.
...
2020-04-21 12:25:31.927976: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:810] Optimization results for grappler item: StatefulPartitionedCall/mobilenet_1.00_224/TRTEngineOp_0_25_native_segment
2020-04-21 12:25:31.927985: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   constant_folding: Graph size after: 5 nodes (0), 4 edges (0), time = 0.703ms.
2020-04-21 12:25:31.927993: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   layout: layout did nothing. time = 0.023ms.
2020-04-21 12:25:31.928001: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   constant_folding: Graph size after: 5 nodes (0), 4 edges (0), time = 0.598ms.
2020-04-21 12:25:31.928009: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   TensorRTOptimizer: Graph size after: 5 nodes (0), 4 edges (0), time = 0.104ms.
2020-04-21 12:25:31.928018: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812]   constant_folding: Graph size after: 5 nodes (0), 4 edges (0), time = 0.618ms.
&lt;/denchmark-code&gt;

		</comment>
		<comment id='13' author='nagisa' date='2020-04-21T19:37:34Z'>
		&lt;denchmark-link:https://github.com/mihaimaruseac&gt;@mihaimaruseac&lt;/denchmark-link&gt;
 I can submit a PR, yes. What would be the best error to return here? Should I create a new one for this situation specifically?
edit: interesting re it still working in your case. Could also be cuda/cudnn/tensorrt, etc version dependent. After all the null pointer ultimately comes from a call to nvinfer1.
		</comment>
		<comment id='14' author='nagisa' date='2020-04-21T19:50:31Z'>
		Something like return errors::Internal("Failed to create TensorRT network object due to not being able to find CUDA device"); should work?
		</comment>
		<comment id='15' author='nagisa' date='2020-04-21T19:50:55Z'>
		Yes, it's very likely this is an issue caused by cuda/cudnn/tensorrt, not TF
		</comment>
		<comment id='16' author='nagisa' date='2020-05-13T01:50:10Z'>
		We are in the process of releasing a patch for 1.15. If you have a PR ready please let us know, otherwise this will have to wait until we will do another patch, if ever.
		</comment>
		<comment id='17' author='nagisa' date='2020-05-13T01:58:58Z'>
		I probably won’t get to it as its not actually blocking me in any way – I just need to remember to not run tensorflow on machines without GPUs.
		</comment>
		<comment id='18' author='nagisa' date='2020-05-14T22:43:19Z'>
		In that case I'll close as not reproducible (since I was not able to reproduce).
		</comment>
		<comment id='19' author='nagisa' date='2020-05-14T22:43:21Z'>
		Are you satisfied with the resolution of your issue?
&lt;denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&amp;entry.2137816233=https://github.com/tensorflow/tensorflow/issues/38460&gt;Yes&lt;/denchmark-link&gt;

&lt;denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&amp;entry.2137816233=https://github.com/tensorflow/tensorflow/issues/38460&gt;No&lt;/denchmark-link&gt;

		</comment>
	</comments>
</bug>