<bug id='18211' author='kjancke' open_date='2018-04-03T18:12:14Z' closed_time='2019-01-09T22:22:55Z'>
	<summary>freeze_graph.py generates error messages when run on sample model (census / wide_deep)</summary>
	<description>

It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).
The form below must be filled out.
It shouldn't be a TensorBoard issue. Those go here.

Here's why we have that policy: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.
&lt;denchmark-h:hr&gt;&lt;/denchmark-h&gt;

&lt;denchmark-h:h3&gt;System information&lt;/denchmark-h&gt;


Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No
OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04
TensorFlow installed from (source or binary): binary
TensorFlow version (use command below): ('v1.6.0-0-gd2e24b6039', '1.6.0')
Python version: Python 2.7.12 (default, Dec  4 2017, 14:50:18) [GCC 5.4.0 20160609] on linux2
CUDA/cuDNN version: Not using GPU
GPU model and memory: Not using GPU
Exact command to reproduce:
Follow the "wide_deep" tutorial
Try to freeze the generated model by running:
python freeze_graph.py
--input_graph=/tmp/census_model/graph.pbtxt
--input_checkpoint=/tmp/census_model/model.ckpt-190
--output_graph=/tmp/census_model/frozen_graph.pb
--output_node_names=softmax

An error is generated:
TypeError: names_to_saveables must be a dict mapping string names to Tensors/Variables. Not a variable: Tensor("dnn/hiddenlayer_0/bias:0", shape=(100,), dtype=float32)
&lt;denchmark-h:h3&gt;Describe the problem&lt;/denchmark-h&gt;

I would think that the freeze_graph script should finish successfully, hence I believe the problem is that an error message is generated.
&lt;denchmark-h:h3&gt;Source code / logs&lt;/denchmark-h&gt;

Traceback (most recent call last):
File "freeze_graph.py", line 380, in 
app.run(main=main, argv=[sys.argv[0]] + unparsed)
File "/media/LinuxApps/home/karsten/.local/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 126, in run
_sys.exit(main(argv))
File "freeze_graph.py", line 274, in main
FLAGS.saved_model_tags, checkpoint_version)
File "freeze_graph.py", line 256, in freeze_graph
checkpoint_version=checkpoint_version)
File "freeze_graph.py", line 130, in freeze_graph_with_def_protos
var_list=var_list, write_version=checkpoint_version)
File "/media/LinuxApps/home/karsten/.local/lib/python2.7/site-packages/tensorflow/python/training/saver.py", line 1293, in init
self.build()
File "/media/LinuxApps/home/karsten/.local/lib/python2.7/site-packages/tensorflow/python/training/saver.py", line 1302, in build
self._build(self._filename, build_save=True, build_restore=True)
File "/media/LinuxApps/home/karsten/.local/lib/python2.7/site-packages/tensorflow/python/training/saver.py", line 1339, in _build
build_save=build_save, build_restore=build_restore)
File "/media/LinuxApps/home/karsten/.local/lib/python2.7/site-packages/tensorflow/python/training/saver.py", line 774, in _build_internal
saveables = self._ValidateAndSliceInputs(names_to_saveables)
File "/media/LinuxApps/home/karsten/.local/lib/python2.7/site-packages/tensorflow/python/training/saver.py", line 677, in _ValidateAndSliceInputs
variable)
TypeError: names_to_saveables must be a dict mapping string names to Tensors/Variables. Not a variable: Tensor("dnn/hiddenlayer_0/bias:0", shape=(100,), dtype=float32)
	</description>
	<comments>
		<comment id='1' author='kjancke' date='2018-04-04T00:36:42Z'>
		Thank you for your post. We noticed you have not filled out the following field in the issue template. Could you update them if they are relevant in your case, or leave them as N/A? Thanks.
Bazel version
		</comment>
		<comment id='2' author='kjancke' date='2018-05-03T23:23:38Z'>
		TensorFlow graph definition files are code and it's not clear to me if this is a bug in TensorFlow or an issue with the custom code. Consider trying &lt;denchmark-link:http://stackoverflow.com/questions/tagged/tensorflow&gt;StackOverflow&lt;/denchmark-link&gt;
. There is a larger community that reads questions there.
If you think we've misinterpreted a bug, please comment again with a clear explanation, as well as all of the information requested in the &lt;denchmark-link:https://github.com/tensorflow/tensorflow/issues/new&gt;issue template&lt;/denchmark-link&gt;
. Thanks!
		</comment>
		<comment id='3' author='kjancke' date='2018-05-21T13:52:32Z'>
		The issue occurs on the model which is generated by the census example. No custom code involved at all. Just running the tensorflow census example and then try to freeze it.
Bazel version is: 0.11.1
		</comment>
		<comment id='4' author='kjancke' date='2018-05-21T16:51:25Z'>
		I believe you. Let's reopen.
I noticed you're using TF 1.6. The &lt;denchmark-link:https://www.tensorflow.org/tutorials/wide_and_deep&gt;tutorial&lt;/denchmark-link&gt;
 points to &lt;denchmark-link:https://github.com/tensorflow/models/commits/master/official/wide_deep/wide_deep.py&gt;wide_deep.py&lt;/denchmark-link&gt;
 which had E2E tests added in &lt;denchmark-link:https://github.com/tensorflow/models/pull/3798&gt;tensorflow/models#3798&lt;/denchmark-link&gt;
 a few months after that release.
&lt;denchmark-link:https://github.com/kjancke&gt;@kjancke&lt;/denchmark-link&gt;
 could you please try the tutorial at head and let us know if it works? If it doesn't, then could you include a short minimal little shell script that reproduces the error? Something along the lines of:
virtualenv tf
source tf/bin/activate
pip install tensorflow
wget https://raw.githubusercontent.com/tensorflow/models/master/official/wide_deep/wide_deep.py
python wide_deep.py ...
		</comment>
		<comment id='5' author='kjancke' date='2018-05-23T16:07:37Z'>
		Sure, will do. I have TF v1.8.0-2153-ge844159e63 on another machine, will this be current enough?
		</comment>
		<comment id='6' author='kjancke' date='2019-01-09T22:22:55Z'>
		Closing this issue since its &lt;denchmark-link:https://github.com/tensorflow/models/pull/3798&gt;resolved&lt;/denchmark-link&gt;
. Feel free to reopen if the problem still persists. Thanks!
		</comment>
	</comments>
</bug>