<bug id='9193' author='nkrishnappaGIT' open_date='2019-06-03T06:23:24Z' closed_time='2019-07-25T01:08:54Z'>
	<summary>FileSystemContext.acquireMasterClient() cause NPE while we create FileSystem.create()</summary>
	<description>
Alluxio Version:
What version of Alluxio are you using?
1.8.0
Describe the bug
whenever we're trying to upload multiple files simultaneously to alluxioFileSystem. Ex: if I upload 10 files, 2-3 file upload fails due to a below-given exception.
And Iâ€™m using below api:
&lt;denchmark-code&gt;FileSystem.get(hdfsConfiguration)

fileSystem.create(alluxioFilePath, (short) 1)
&lt;/denchmark-code&gt;

hdfsConfiguration contains
&lt;denchmark-code&gt;"[fs.alluxio.impl]": alluxio.hadoop.FileSystem"
[fs.AbstractFileSystem.alluxio.impl]": alluxio.hadoop.AlluxioFileSystem
&lt;/denchmark-code&gt;

&lt;denchmark-code&gt;Exception - java.lang.NullPointerException: nullat
alluxio.client.file.FileSystemContext.acquireMasterClient(FileSystemContext.java:285)at 
alluxio.client.file.BaseFileSystem.exists(BaseFileSystem.java:187)at 
alluxio.client.file.BaseFileSystem.exists(BaseFileSystem.java:181)at 
alluxio.hadoop.AbstractFileSystem.create(AbstractFileSystem.java:183)at 
alluxio.hadoop.FileSystem.create(FileSystem.java:27)at 
org.apache.hadoop.fs.FileSystem.create(FileSystem.java:909)at 
org.apache.hadoop.fs.FileSystem.create(FileSystem.java:890)at 
org.apache.hadoop.fs.FileSystem.create(FileSystem.java:816)

&lt;/denchmark-code&gt;

Expected behavior
All files should be uploaded successfully.
Alluxio JIRA Link - &lt;denchmark-link:https://alluxio.atlassian.net/browse/ALLUXIO-3399&gt;https://alluxio.atlassian.net/browse/ALLUXIO-3399&lt;/denchmark-link&gt;

	</description>
	<comments>
		<comment id='1' author='nkrishnappaGIT' date='2019-07-25T01:08:54Z'>
		I think this is a race condition fixed in v1.8.1 with  to guard the singleton creation inside &lt;denchmark-link:https://github.com/Alluxio/alluxio/blob/082ccd3594f20e617a2e894df0846bcfdb1c2555/core/client/fs/src/main/java/alluxio/client/file/FileSystemContext.java#L134&gt;FileSystemContext.get&lt;/denchmark-link&gt;

		</comment>
	</comments>
</bug>