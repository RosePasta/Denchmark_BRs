<bug id='10858' author='ns1123' open_date='2020-02-06T19:10:10Z' closed_time='2020-02-13T18:48:06Z'>
	<summary>Upgrade cycle with RocksDB results in BlockStore errors</summary>
	<description>
Alluxio Version:
2.1.2
Describe the bug
When upgrading from an older version of Alluxio to a newer one, failing to copy the ./metastore directory that is generated for RocksDB results in errors with certain blocks missing from the blockstore. This causes cached blocks to be considered orphaned when the master starts up.
To Reproduce
Repro is intermittent. General steps involve using Embedded and RocksDB and then creating/discovering directories from the UFS. After blockID's have been assigned, load the data and then stop the cluster. Then delete the ./metadata folder and restart the masters. (So far I have been unable to repro on a single master embedded cluster). In certain cases, some files will report missing BlockId Exceptions when trying to run ./bin/alluxio fs stat.
Expected behavior
Either replay of the journal rebuilds the BlockStore in its entirety in RocksDB, or instructions need to be updated to explicitly mention the need to preserve the directory in the event of an upgrade.
Urgency
High. Users are losing cached block metadata which can be a painful process.
	</description>
	<comments>
	</comments>
</bug>