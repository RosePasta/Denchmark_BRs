<bug id='10073' author='dxiangaka' open_date='2019-10-09T17:38:39Z' closed_time='2019-10-10T21:38:45Z'>
	<summary>Alluxio master starts with failure at first time in Kubernetes</summary>
	<description>
Alluxio Version:
Alluxio-2.0.0
Describe the bug
When deploying Alluxio cluster in K8s, the master server failed with following error message:
2019-10-09 15:51:01,836 ERROR AlluxioMaster - Fatal error: Failed to create master process
java.lang.RuntimeException: java.lang.RuntimeException: Journal alluxio.master.journal.raft.RaftJournalSystem@35cabb2a has not been formatted!
	at alluxio.master.AlluxioMasterProcess.&lt;init&gt;(AlluxioMasterProcess.java:117)
	at alluxio.master.FaultTolerantAlluxioMasterProcess.&lt;init&gt;(FaultTolerantAlluxioMasterProcess.java:58)
	at alluxio.master.AlluxioMasterProcess$Factory.create(AlluxioMasterProcess.java:378)
	at alluxio.master.AlluxioMaster.main(AlluxioMaster.java:45)
Caused by: java.lang.RuntimeException: Journal alluxio.master.journal.raft.RaftJournalSystem@35cabb2a has not been formatted!

Following steps described in &lt;denchmark-link:https://docs.alluxio.io/os/user/stable/en/deploy/Running-Alluxio-On-Kubernetes.html&gt;https://docs.alluxio.io/os/user/stable/en/deploy/Running-Alluxio-On-Kubernetes.html&lt;/denchmark-link&gt;
 to start Alluxio cluster in HA mode with embedded journal setups.
Run command to check log messages
kubectl logs -f alluxio-master-0 -c alluxio-master
Expected behavior
The Alluxio master should be formatted at the very first time if it has not been formatted. The option "--no-format" should apply if pod is restarted.
Urgency
High priority.
Additional context
Add any other context about the problem here.
	</description>
	<comments>
		<comment id='1' author='dxiangaka' date='2019-10-09T18:05:08Z'>
		&lt;denchmark-link:https://github.com/madanadit&gt;@madanadit&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/jiacheliu3&gt;@jiacheliu3&lt;/denchmark-link&gt;
 can you double check if this issue has been fixed recently in master (2.1.0-SNAPSHOT) branch?
		</comment>
		<comment id='2' author='dxiangaka' date='2019-10-09T21:56:19Z'>
		&lt;denchmark-link:https://github.com/apc999&gt;@apc999&lt;/denchmark-link&gt;
 The issue has been fixed in 2.1.0-SNAPSHOT. There are template YAML files that users can start from for multi-master environment using embedded journal. And the instructions for setting this up is documentated in the updated in the docs.
&lt;denchmark-link:https://github.com/dxiangaka&gt;@dxiangaka&lt;/denchmark-link&gt;
 If you look at &lt;denchmark-link:https://github.com/Alluxio/alluxio/tree/master/integration/kubernetes/multiMaster-embeddedJournal&gt;Alluxio template embedded journal&lt;/denchmark-link&gt;
 this provides a working set of YAML templates to start from.  is applied to Alluxio master so this is resolved.
Specific to 2.0.0, i think the documentation for 2.0 says Embedded Journal was not supported?
		</comment>
		<comment id='3' author='dxiangaka' date='2019-10-09T23:46:01Z'>
		I think this issue can be closed because it's fixed in the latest version. What do you think &lt;denchmark-link:https://github.com/madanadit&gt;@madanadit&lt;/denchmark-link&gt;
 ?
		</comment>
		<comment id='4' author='dxiangaka' date='2019-10-10T17:26:48Z'>
		&lt;denchmark-link:https://github.com/madanadit&gt;@madanadit&lt;/denchmark-link&gt;
 can you point out the fix here and I could close this ticket. In case &lt;denchmark-link:https://github.com/dxiangaka&gt;@dxiangaka&lt;/denchmark-link&gt;
 still see the issue with nightly build, we could re-open the issue.
		</comment>
		<comment id='5' author='dxiangaka' date='2019-10-10T21:38:45Z'>
		Close this Issue as this has been addressed in 2.1.0-SNAPSHOT and &lt;denchmark-link:https://github.com/dxiangaka&gt;@dxiangaka&lt;/denchmark-link&gt;
 has a workaround too.
		</comment>
	</comments>
</bug>