<bug id='8426' author='LuQQiu' open_date='2019-02-19T19:28:12Z' closed_time='2019-04-09T23:09:06Z'>
	<summary>Use Alluxio Metadata to Avoid Eventual Consistency Issues with Under Storage</summary>
	<description>
Is your feature request related to a problem? Please describe.
Alluxio metadata is strongly consistent. If we make the assumption that there are no out of band operations, Alluxio should retry any inconsistencies between its metadata and the underlying storage, if that storage can be eventually consistent (ie. S3). This will avoid propagating errors to the user.
One of the error is:
&lt;denchmark-code&gt;2018-10-13 05:10:52,410 ERROR ObjectUnderFileSystem - Unable to rename s3a://xxxxx/_temporary/1/task_1539407183469_0001_m_000005/part-m-00005 to s3a://xxxxx/Input/part-m-00005 because source does not exist or is a directory.
2018-10-13 05:10:52,411 WARN  FileSystemMasterClientServiceHandler - Exit (Error): Rename: srcPath=/_temporary/1/task_1539407183469_0001_m_000005/part-m-000055, dstPath=/Input/part-m-00005 options=RenameTOptions(commonOptions:FileSystemMasterCommonTOptions(syncIntervalMs:-1)), Error=java.io.IOException: Failed to rename s3a://xxxxx/_temporary/1/task_1539407183469_0001_m_000005/part-m-00005 to s3a://xxxxx/Input/part-m-00005 in the under file system
&lt;/denchmark-code&gt;

Describe the solution you'd like

write-then-read (storages:S3): already fixed.
write-then-list (storages: S3, Swift): will retry listing operations in s3 and swift under system.
write-then-change metadata (storage:S3, Swift): retry listing operation in s3 and swift will also help solve the write-then-rename operation.
delete-then-read/list/change metadata (Alluxio metadata will not allow, do not consisder)
Other eventual consistency issues that may consider in the future:
(1) write-then-delete
(2) revoking access from resources (storage GCS)
(3) cache related eventual consistency issue (GCS cache-control, NFS weak cache consistency)
Describe alternatives you've considered
A clear and concise description of any alternative solutions or features you've considered.

Additional context
	</description>
	<comments>
		<comment id='1' author='LuQQiu' date='2019-04-09T23:09:06Z'>
		Done
		</comment>
	</comments>
</bug>