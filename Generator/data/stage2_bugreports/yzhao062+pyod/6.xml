<bug id='6' author='mdlockyer' open_date='2018-06-12T22:12:52Z' closed_time='2018-07-25T21:26:20Z'>
	<summary>pyod fails to install using pip</summary>
	<description>
When attempting to install without nose, I receive the following error:
&lt;denchmark-code&gt;(PyVi) Michael:PyVi michael$ pip install pyod
Collecting pyod==0.5.0 (from -r requirements.txt (line 18))
  Using cached https://files.pythonhosted.org/packages/c9/8c/6774fa2e7ae6fe9c2c648114d15ba584f950002377480e14183a0999af30/pyod-0.5.0.tar.gz
    Complete output from command python setup.py egg_info:
    Traceback (most recent call last):
      File "&lt;string&gt;", line 1, in &lt;module&gt;
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-gjdzzane/pyod/setup.py", line 2, in &lt;module&gt;
        from pyod import __version__
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-gjdzzane/pyod/pyod/__init__.py", line 4, in &lt;module&gt;
        from . import models
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-gjdzzane/pyod/pyod/models/__init__.py", line 2, in &lt;module&gt;
        from .abod import ABOD
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-gjdzzane/pyod/pyod/models/abod.py", line 17, in &lt;module&gt;
        from .base import BaseDetector
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-gjdzzane/pyod/pyod/models/base.py", line 27, in &lt;module&gt;
        from ..utils.utility import precision_n_scores
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-gjdzzane/pyod/pyod/utils/__init__.py", line 2, in &lt;module&gt;
        from .utility import check_parameter
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-gjdzzane/pyod/pyod/utils/utility.py", line 18, in &lt;module&gt;
        from sklearn.utils.testing import assert_equal
      File "/Users/michael/anaconda3/envs/PyVi/lib/python3.6/site-packages/sklearn/utils/testing.py", line 49, in &lt;module&gt;
        from nose.tools import raises
    ModuleNotFoundError: No module named 'nose'
    
    ----------------------------------------
Command "python setup.py egg_info" failed with error code 1 in /private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-gjdzzane/pyod/
&lt;/denchmark-code&gt;

	</description>
	<comments>
		<comment id='1' author='mdlockyer' date='2018-06-12T22:32:40Z'>
		Also have the same issue when installing from source
		</comment>
		<comment id='2' author='mdlockyer' date='2018-06-12T22:34:41Z'>
		Should also note that I'm attempting to install into an Anaconda environment running Python 3.6.5
		</comment>
		<comment id='3' author='mdlockyer' date='2018-06-12T23:10:46Z'>
		Thanks for the feedback. I included the test files in the package which triggers "nose", even it is only listed as optional. I will submit a fix (possibly tonight) to remove test files in the package. Will comment again once that is ready. Yue
		</comment>
		<comment id='4' author='mdlockyer' date='2018-06-12T23:12:01Z'>
		Sounds good!
		</comment>
		<comment id='5' author='mdlockyer' date='2018-06-12T23:15:09Z'>
		Sorry I just noticed that another problem is pyod depends on sklearn...which uses nose for validation, see error message below.
If possible, I would suggest installing nose (by either pip install nose or use Requirments.txt). I will need to double check sklearn dependency, which may not be possible to fix from my end. If that is the case, I will have change 'nose' from optional to required...
&lt;denchmark-code&gt;    from sklearn.utils.testing import assert_equal
  File "/Users/michael/anaconda3/envs/PyVi/lib/python3.6/site-packages/sklearn/utils/testing.py", line 49, in &lt;module&gt;
    from nose.tools import raises
&lt;/denchmark-code&gt;

		</comment>
		<comment id='6' author='mdlockyer' date='2018-06-12T23:23:46Z'>
		Tried installing nose then installing Pyod. I get an issue here that comes from matplotlib. It's an Anaconda (or venv I assume) specific error because matplotlib wants python installed as a framework. It seems like at the moment Pyod won't work in an Anaconda env. Possibly something for a future version as I would assume a lot of people working with data science/ statistics would use Anaconda.
here is the backtrace for reference:
&lt;denchmark-code&gt;(PyVi) Michael:PyVi michael$ pip install pyod
Collecting pyod
  Using cached https://files.pythonhosted.org/packages/c9/8c/6774fa2e7ae6fe9c2c648114d15ba584f950002377480e14183a0999af30/pyod-0.5.0.tar.gz
    Complete output from command python setup.py egg_info:
    Traceback (most recent call last):
      File "&lt;string&gt;", line 1, in &lt;module&gt;
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-7z8033c1/pyod/setup.py", line 2, in &lt;module&gt;
        from pyod import __version__
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-7z8033c1/pyod/pyod/__init__.py", line 4, in &lt;module&gt;
        from . import models
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-7z8033c1/pyod/pyod/models/__init__.py", line 2, in &lt;module&gt;
        from .abod import ABOD
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-7z8033c1/pyod/pyod/models/abod.py", line 17, in &lt;module&gt;
        from .base import BaseDetector
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-7z8033c1/pyod/pyod/models/base.py", line 27, in &lt;module&gt;
        from ..utils.utility import precision_n_scores
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-7z8033c1/pyod/pyod/utils/__init__.py", line 9, in &lt;module&gt;
        from .data import generate_data
      File "/private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-7z8033c1/pyod/pyod/utils/data.py", line 16, in &lt;module&gt;
        import matplotlib.pyplot as plt
      File "/Users/michael/anaconda3/envs/PyVi/lib/python3.6/site-packages/matplotlib/pyplot.py", line 115, in &lt;module&gt;
        _backend_mod, new_figure_manager, draw_if_interactive, _show = pylab_setup()
      File "/Users/michael/anaconda3/envs/PyVi/lib/python3.6/site-packages/matplotlib/backends/__init__.py", line 62, in pylab_setup
        [backend_name], 0)
      File "/Users/michael/anaconda3/envs/PyVi/lib/python3.6/site-packages/matplotlib/backends/backend_macosx.py", line 17, in &lt;module&gt;
        from matplotlib.backends import _macosx
    RuntimeError: Python is not installed as a framework. The Mac OS X backend will not be able to function correctly if Python is not installed as a framework. See the Python documentation for more information on installing Python as a framework on Mac OS X. Please either reinstall Python as a framework, or try one of the other backends. If you are using (Ana)Conda please install python.app and replace the use of 'python' with 'pythonw'. See 'Working with Matplotlib on OSX' in the Matplotlib FAQ for more information.
    
    ----------------------------------------
Command "python setup.py egg_info" failed with error code 1 in /private/var/folders/j4/_68f6f3j4d51_2smq2mh5hyh0000gn/T/pip-install-7z8033c1/pyod/
&lt;/denchmark-code&gt;

		</comment>
		<comment id='7' author='mdlockyer' date='2018-06-13T02:10:41Z'>
		The issue you saw is specific to the virtual env Qt problem on mac, which is caused by matplotlib, and it is a lingering issue. The problem can be reproduced by:
 import matplotlib.pyplot as plt
It throws error if you install the matplotlib with pip command in a mac conda virtual env... There are several fixes though.

Workaround 1: "conda install matplotlib" first
Workaround 2: https://stackoverflow.com/questions/29433824/unable-to-import-matplotlib-pyplot-as-plt-in-virtualenv

Using workaround 1, I managed to install pyod in mac virtual env and also succeeded in running examples. See the screenshot below:
&lt;denchmark-link:https://user-images.githubusercontent.com/15079146/41325888-a60f5396-6e8a-11e8-94e0-abd7cbeef6bc.png&gt;&lt;/denchmark-link&gt;

To facilitate the installation, I also removed the use of matplotlib in the code (I do not remove it from dependency since example codes still need it) and publish a new version 0.5.2. You may want to give it a shot...
Let me know if the problem persists.
		</comment>
		<comment id='8' author='mdlockyer' date='2018-06-21T15:42:29Z'>
		I think that similar solution to this can solve the first issue - &lt;denchmark-link:https://github.com/sciunto-org/python-bibtexparser/pull/111&gt;sciunto-org/python-bibtexparser#111&lt;/denchmark-link&gt;
 (I can create a PR with this solution if you would like)
		</comment>
		<comment id='9' author='mdlockyer' date='2018-06-21T17:53:19Z'>
		&lt;denchmark-link:https://github.com/tomron&gt;@tomron&lt;/denchmark-link&gt;
 Thanks Tom. I did check the post and it is an interesting bug :)
The pip install issue in pyod is because I used a function "sklearn.utils.testing.assert_equal", which depends on nose.tools. Even I listed  in requirements.txt, it still requires  to be installed, which should have been installed because sklearn depends on . This bug would happen if a person installs  first and then uninstalls . The requirement of  is fulfilled but  is not there.
So I fixed this bug by listing nose as one of the requirements in requirements.txt. Not sure if this is exactly the same bug you mentioned.
		</comment>
		<comment id='10' author='mdlockyer' date='2018-06-21T18:02:50Z'>
		This issue is actually a mixture of several issues which should probably be separated to several issues.
As a user of your package I don't want to pre install myself any dependency I want the setup file to do that.
When you import pyod in the setup file it calls the init file which imports other files and if the required packages are not present it will fail. The fix I suggested will fix this issue (I also suggest to fix the dependencies' versions, some dependencies miss the version)
		</comment>
		<comment id='11' author='mdlockyer' date='2018-07-25T21:26:20Z'>
		&lt;denchmark-link:https://github.com/yzhao062/pyod/pull/12&gt;#12&lt;/denchmark-link&gt;
 should fix the setup.py dependency issue. #
		</comment>
		<comment id='12' author='mdlockyer' date='2019-07-26T03:43:37Z'>
		I received an error when i exported the pyod.models.hbos however i have successfully installed pyod in ananconda environment ,the error shows like 'No module named 'pyod.models'; 'pyod' is not a package'
		</comment>
		<comment id='13' author='mdlockyer' date='2019-07-26T04:33:25Z'>
		@dksajgfaigfkja It should be working. I just tested it under Python 2.7 and Python 3.7 by initializing new env with conda. The command I used is:
conda create -n newenv python=2.7
conda activate newenv
pip install pyod
pip list &lt;- make sure pyod is installed
&lt;denchmark-link:https://user-images.githubusercontent.com/15079146/61925965-311b9f00-afa1-11e9-8fa2-d1e53e01297a.png&gt;&lt;/denchmark-link&gt;

python hbos_example.py
Thoughts:

make sure env is correct
use pip list to see whether pyod is installed
reactivate the env if needed

		</comment>
	</comments>
</bug>