<bug id='13412' author='ezyang' open_date='2018-10-31T19:43:24Z' closed_time='2019-12-05T22:28:21Z'>
	<summary>Default chosen cuDNN convolution algorithm for V100 uses twice as much memory</summary>
	<description>
We received an internal report that in some situations, the default cuDNN convolution algorithm PyTorch selects on V100 uses twice as much as the default convolution on a P100.
A successful workaround was to set torch.backends.cudnn.benchmark = True; this seemed to let us pick a more memory efficient convolution for the setting.
It was somewhat inconvenient to get the actual algorithm selected. However, we have some nvprof traces:
P100 without benchmark:
&lt;denchmark-code&gt;==35866== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   12.55%  385.52ms      5572  69.188us     896ns  9.7897ms  [CUDA memcpy DtoH]
                   12.03%  369.59ms       740  499.44us  112.42us  2.6312ms  maxwell_scudnn_128x128_relu_interior_nn
                    9.11%  279.93ms       520  538.33us  164.83us  2.9586ms  maxwell_scudnn_winograd_128x128_ldg1_ldg4_tile148n_nt
                    8.37%  257.08ms       328  783.79us  340.80us  3.0241ms  maxwell_scudnn_128x128_stridedB_splitK_interior_nn
                    2.65%  81.250ms       174  466.95us  312.58us  1.1997ms  maxwell_scudnn_128x128_stridedB_interior_nn
                    2.61%  80.287ms       189  424.80us  44.192us  1.6065ms  maxwell_scudnn_128x64_relu_interior_nn
                    2.54%  78.010ms        60  1.3002ms  788.92us  3.7351ms  void cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1&gt;*, kernel_grad_params, int, int, float, int, int, int)
                    2.46%  75.574ms        72  1.0496ms  591.58us  4.3448ms  maxwell_scudnn_128x128_stridedB_splitK_large_nn
                    2.32%  71.165ms       638  111.54us     768ns  3.7148ms  [CUDA memcpy HtoD]
                    2.30%  70.740ms       156  453.46us  308.99us  1.5184ms  maxwell_scudnn_winograd_128x128_ldg1_ldg4_tile228n_nt
                    2.22%  68.077ms       672  101.30us  15.904us  597.18us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=-1, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    2.13%  65.491ms       444  147.50us  15.488us  1.4862ms  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=-1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    1.95%  59.898ms        74  809.43us  530.75us  1.6064ms  maxwell_scudnn_128x128_stridedB_small_nn
                    1.95%  59.884ms      1218  49.166us  2.0800us  461.76us  void kernelPointwiseApply1&lt;ThresholdUpdateOutputIP&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;ThresholdUpdateOutputIP&lt;float&gt;, float, unsigned int&gt;, float, float)
                    1.88%  57.692ms        66  874.12us  229.50us  2.1433ms  maxwell_scudnn_128x64_stridedB_splitK_interior_nn
                    1.81%  55.484ms        90  616.49us  245.44us  1.2237ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    1.78%  54.717ms       990  55.269us  4.2240us  301.05us  void cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;(float, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;, cudnnTensorStruct, float const *, float, cudnnTensorStruct*, float, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const *, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;)
                    1.77%  54.248ms       226  240.04us  63.680us  1.0196ms  void cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=14&gt;(float, float, float, float, cudnnTensorStruct, float const *, cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=14&gt;, float const , cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=14&gt;, cudnnTensorStruct*, float const *, float*, float const *, float const , float const , float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnBwPersistentState*, int, float, float, float, int, float, cudnnStatus_t*, bool)
                    1.69%  51.838ms        18  2.8799ms  1.3016ms  8.0033ms  void cudnn::detail::wgrad_alg0_engine&lt;float, int=512, int=6, int=5, int=3, int=3, int=3, bool=1, int=512&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg0_engine&lt;float, int=512, int=6, int=5, int=3, int=3, int=3, bool=1, int=512&gt;*, float const , kernel_grad_params, int, float, int, int, int, int)
                    1.69%  51.805ms       100  518.05us  152.77us  1.1848ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    1.64%  50.363ms       130  387.41us  165.15us  1.0714ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    1.58%  48.483ms      1636  29.635us  1.3120us  658.08us  void kernelPointwiseApply2&lt;TensorAddOp&lt;float&gt;, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;TensorAddOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    1.48%  45.399ms        46  986.94us  671.49us  2.1858ms  void cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1&gt;*, kernel_grad_params, int, int, float, int, int, int)
                    1.41%  43.175ms       348  124.07us  21.152us  676.99us  void kernelPointwiseApply3&lt;TensorAddOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorAddOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    1.41%  43.171ms       600  71.952us  5.0880us  560.29us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    1.40%  43.094ms        26  1.6575ms  971.23us  5.2034ms  void cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1, int=512&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1, int=512&gt;*, float const , kernel_grad_params, int, float, int, int, int, int)
                    1.27%  38.933ms       348  111.88us  5.8240us  726.36us  void kernelPointwiseApply3&lt;ThresholdUpdateGradInput&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;ThresholdUpdateGradInput&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    1.15%  35.238ms       204  172.73us  48.255us  633.18us  void cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=20&gt;(cudnnTensorStruct, float const *, cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=20&gt;, cudnnTensorStruct*, float const *, float const , float, float, float*, float const *, float const *, float const *, float, float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnFwPersistentState*, int, float, float, float, int, float, float, cudnnStatus_t*, bool)
                    0.88%  27.120ms       222  122.16us  7.9040us  1.4950ms  void calc_bias_diff&lt;int=2, float, float, int=128, int=0&gt;(cudnnTensorStruct, float const *, cudnnTensorStruct, float*, float, float, int)
                    0.85%  26.078ms       174  149.88us  87.680us  262.33us  void im2col4d_kernel&lt;float, int&gt;(im2col4d_params, cudnnConvolutionStruct, cudnnTensor4dStruct, float const *, float*, int)
                    0.81%  24.775ms      4940  5.0150us  1.1200us  72.864us  void kernelPointwiseApply1&lt;TensorMulConstantOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorMulConstantOp&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.70%  21.528ms       590  36.488us  5.3120us  527.49us  void add_tensor_kernel_v3&lt;int=2, float, float, int=128, int=1, int=1, int=4, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.70%  21.505ms        33  651.67us  241.06us  2.0924ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.69%  21.303ms        20  1.0652ms  658.24us  1.7894ms  maxwell_scudnn_winograd_128x128_ldg1_ldg4_tile418n_nt
                    0.67%  20.698ms       702  29.484us  9.4080us  127.97us  void cudnn::winograd::generateWinogradTilesKernel&lt;int=0, float, float&gt;(cudnn::winograd::GenerateWinogradTilesParams&lt;float, float&gt;)
                    0.66%  20.271ms        18  1.1262ms  943.96us  1.5449ms  maxwell_scudnn_128x128_stridedB_splitK_medium_nn
                    0.65%  19.822ms      1978  10.021us     928ns  156.00us  void kernelPointwiseApply1&lt;TensorFillOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorFillOp&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.49%  15.182ms       504  30.123us  4.1280us  235.36us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=2, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.48%  14.864ms        18  825.76us  666.14us  1.4981ms  maxwell_scudnn_128x64_stridedB_splitK_large_nn
                    0.39%  11.997ms      1300  9.2280us  1.7270us  149.73us  void kernelPointwiseApply3&lt;TensorAddCDivOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorAddCDivOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.32%  9.9349ms        21  473.09us  270.43us  1.2882ms  maxwell_scudnn_128x64_relu_medium_nn
                    0.30%  9.1689ms       170  53.934us  24.448us  165.86us  void cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;(cudnnTensorStruct, float const *, cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, cudnnTensorStruct*, float const *, float const , float, float, float*, float const *, float const *, float const *, float, float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnFwPersistentState*, int, float, float, float, int, float, float, cudnnStatus_t*, bool)
                    0.29%  8.9304ms      1300  6.8690us  1.3120us  112.38us  void kernelPointwiseApply3&lt;TensorAddCMulOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorAddCMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.29%  8.8891ms      1300  6.8370us  1.4720us  107.84us  void kernelPointwiseApply2&lt;TensorCAddOp&lt;float&gt;, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;TensorCAddOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.27%  8.3468ms        30  278.23us  96.703us  510.59us  maxwell_scudnn_128x64_stridedB_interior_nn
                    0.26%  8.1352ms       450  18.078us  3.4880us  57.695us  void kernelReduceAllPass1&lt;float, unsigned int, float, TensorNormOp&lt;float, int=2&gt;, ReduceAdd&lt;float&gt;, int=1&gt;(TensorInfo&lt;float, unsigned int&gt;, unsigned int, float, float, int=2, float*)
                    0.25%  7.8002ms       608  12.829us  1.6000us  258.01us  void scalePackedTensor_kernel&lt;float, float&gt;(cudnnTensor4dStruct, float*, float)
                    0.25%  7.7592ms        41  189.25us  143.33us  1.5122ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.23%  7.2142ms       110  65.583us  35.519us  116.67us  void cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=7&gt;(float, float, float, float, cudnnTensorStruct, float const *, cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=7&gt;, float const , cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=7&gt;, cudnnTensorStruct*, float const *, float*, float const *, float const , float const , float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnBwPersistentState*, int, float, float, float, int, float, cudnnStatus_t*, bool)
                    0.22%  6.8664ms      1300  5.2810us  1.3120us  75.200us  void kernelPointwiseApply2&lt;Tensor_sqrt_Float_Op, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;float, unsigned int, int=1&gt;, OffsetInfo&lt;float, unsigned int, int=1&gt;, unsigned int, Tensor_sqrt_Float_Op)
                    0.22%  6.8267ms         6  1.1378ms  948.25us  1.9424ms  void MaxPoolBackward&lt;float, float&gt;(int, float const *, long const *, int, int, int, int, int, int, int, int, int, int, int, int, int, int, float*)
                    0.22%  6.6230ms        20  331.15us  305.60us  359.58us  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.21%  6.3058ms      1300  4.8500us  1.2800us  72.544us  void kernelPointwiseApply1&lt;TensorAddConstantOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorAddConstantOp&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.18%  5.5026ms        21  262.03us  146.50us  721.69us  void MaxPoolForward&lt;float, float&gt;(int, float const *, int, int, int, int, int, int, int, int, int, int, int, int, int, int, float*, long*)
                    0.15%  4.6061ms        96  47.980us  12.864us  167.78us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=2&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.11%  3.3530ms      1229  2.7280us  2.1760us  13.440us  cudnn::maxwell::gemm::computeOffsetsKernel(cudnn::maxwell::gemm::ComputeOffsetsParams)
                    0.11%  3.3429ms        60  55.714us  25.184us  122.43us  void cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;(float, float, float, float, cudnnTensorStruct, float const *, cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, float const , cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, cudnnTensorStruct*, float const *, float*, float const *, float const , float const , float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnBwPersistentState*, int, float, float, float, int, float, cudnnStatus_t*, bool)
                    0.10%  3.1068ms       266  11.679us  1.2800us  471.52us  [CUDA memcpy DtoD]
                    0.10%  2.9244ms         6  487.40us  401.85us  912.86us  maxwell_scudnn_winograd_128x128_ldg1_ldg4_tile148t_nt
                    0.09%  2.8738ms       850  3.3800us  2.9110us  12.960us  void kernelReduceAll&lt;float, unsigned int, float, TensorNormOp&lt;float, int=2&gt;, ReduceAdd&lt;float&gt;, int=1&gt;(TensorInfo&lt;float, unsigned int&gt;, unsigned int, float, float, int=2, float*)
                    0.09%  2.8177ms       179  15.741us  6.5920us  76.128us  void add_tensor_kernel_v3&lt;int=2, float, float, int=64, int=1, int=2, int=4, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.09%  2.7672ms      2953     937ns     703ns  8.7360us  [CUDA memset]
                    0.07%  2.0808ms        22  94.582us  50.272us  164.93us  void cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=10&gt;(cudnnTensorStruct, float const *, cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=10&gt;, cudnnTensorStruct*, float const *, float const , float, float, float*, float const *, float const *, float const *, float, float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnFwPersistentState*, int, float, float, float, int, float, float, cudnnStatus_t*, bool)
                    0.07%  2.0368ms       780  2.6110us  2.1760us  10.112us  cudnn::maxwell::gemm::computeBOffsetsKernel(cudnn::maxwell::gemm::ComputeBOffsetsParams)
                    0.05%  1.6635ms         6  277.25us  233.28us  491.33us  void kernelPointwiseApply3&lt;TensorMulOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=2&gt;(OffsetInfo&lt;TensorMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.05%  1.6547ms         6  275.79us  233.85us  481.60us  void kernelPointwiseApply2&lt;TensorMulOp&lt;float&gt;, float, float, unsigned int, int=1, int=2&gt;(OffsetInfo&lt;TensorMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.04%  1.3427ms       450  2.9830us  2.0480us  12.864us  void kernelReduceAllPass2&lt;float, ReduceAdd&lt;float&gt;&gt;(int, float, float, float*, float*)
                    0.04%  1.2778ms         1  1.2778ms  1.2778ms  1.2778ms  maxwell_scudnn_128x128_relu_small_nn
                    0.04%  1.2759ms       502  2.5410us  2.3350us  4.3200us  cudnn::maxwell::gemm::computeWgradOffsetsKernel(cudnn::maxwell::gemm::ComputeOffsetsParams)
                    0.03%  914.72us        22  41.577us  20.032us  128.32us  void CatArrayBatchedCopy&lt;float, unsigned int, int=4&gt;(float*, CatArrInputTensor&lt;float, unsigned int&gt;*, OutputTensorSizeStride&lt;unsigned int, unsigned int=4&gt;, int, unsigned int)
                    0.03%  816.47us       396  2.0610us  1.7280us  3.9040us  void kernelPointwiseApply1&lt;TensorAddConstantOp&lt;long&gt;, long, unsigned int, int=1&gt;(OffsetInfo&lt;TensorAddConstantOp&lt;long&gt;, long, unsigned int&gt;, long, long)
                    0.02%  734.49us         6  122.42us  94.847us  240.51us  void caffe_gpu_interp2_kernel_backward&lt;float, float&gt;(int, float, float, bool, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;)
                    0.02%  724.35us        21  34.492us  25.280us  64.992us  void caffe_gpu_interp2_kernel&lt;float, float&gt;(int, float, float, bool, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;)
                    0.01%  428.48us        17  25.204us  21.664us  44.640us  void kernelPointwiseApply3&lt;TensorMulOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.01%  241.50us        11  21.954us  20.000us  34.944us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::ReduceAgent&lt;thrust::cuda_cub::transform_pair_of_input_iterators_t&lt;float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, mse_functor&lt;float, float&gt;&gt;, float*, float, long, thrust::plus&lt;float&gt;&gt;, thrust::cuda_cub::transform_pair_of_input_iterators_t&lt;float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, mse_functor&lt;float, float&gt;&gt;, float*, long, thrust::cuda_cub::cub::GridEvenShare&lt;int&gt;, thrust::cuda_cub::cub::GridQueue&lt;int&gt;, thrust::plus&lt;float&gt;&gt;(float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, float, float, mse_functor&lt;float, float&gt;)
                    0.01%  163.68us        11  14.879us  13.120us  27.680us  void kernelPointwiseApply2&lt;TensorGTValueOp&lt;float, unsigned char&gt;, unsigned char, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;unsigned char, unsigned char, float&gt;, OffsetInfo&lt;TensorGTValueOp&lt;float, unsigned char&gt;, unsigned char, unsigned int&gt;, unsigned char, float)
                    0.00%  149.31us         8  18.664us  18.240us  19.232us  void add_tensor_kernel_v3&lt;int=2, float, float, int=32, int=1, int=4, int=2, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.00%  138.56us        11  12.596us  10.880us  25.279us  void kernelPointwiseApply2&lt;CopyOp&lt;float, unsigned char&gt;, float, unsigned char, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;unsigned char, float, unsigned char&gt;, OffsetInfo&lt;CopyOp&lt;float, unsigned char&gt;, float, unsigned int&gt;, float, float)
                    0.00%  133.44us         6  22.239us  18.496us  40.192us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__parallel_for::ParallelForAgent&lt;thrust::cuda_cub::__transform::binary_transform_f&lt;thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor&lt;float, float&gt;, thrust::cuda_cub::__transform::always_true_predicate&gt;, long&gt;, thrust::cuda_cub::__transform::binary_transform_f&lt;thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor&lt;float, float&gt;, thrust::cuda_cub::__transform::always_true_predicate&gt;, long&gt;(thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;)
                    0.00%  38.880us        11  3.5340us  3.3920us  4.2560us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::ReduceAgent&lt;float*, float*, float, long, thrust::plus&lt;float&gt;&gt;, float*, float*, int, thrust::plus&lt;float&gt;, float&gt;(float*, float, long, float, thrust::plus&lt;float&gt;)
                    0.00%  28.096us         6  4.6820us  4.5120us  4.8640us  generate_bernoulli(curandStateMtgp32*, int, float*, double)
                    0.00%  23.103us        11  2.1000us  1.9520us  2.2390us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::DrainAgent&lt;long&gt;, thrust::cuda_cub::cub::GridQueue&lt;int&gt;, long&gt;(thrust::cuda_cub::__reduce::DrainAgent&lt;long&gt;, int)
                    0.00%  9.9520us         6  1.6580us  1.5040us  2.1440us  void kernelPointwiseApply1&lt;TensorDivConstantOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorDivConstantOp&lt;float&gt;, float, unsigned int&gt;, float, float)
      API calls:   60.33%  4.58376s       336  13.642ms  7.4750us  4.51753s  cudaMalloc
                   15.81%  1.20086s      5013  239.55us  5.8540us  103.64ms  cudaMemcpyAsync
                    7.34%  557.43ms      4736  117.70us  1.5330us  57.306ms  cudaStreamSynchronize
                    6.87%  522.31ms     31381  16.644us  5.4560us  3.7393ms  cudaLaunch
                    6.42%  487.58ms      1463  333.28us  6.8200us  169.88ms  cudaMemcpy
                    1.21%  91.906ms    238250     385ns     231ns  2.9827ms  cudaGetDevice
                    0.65%  49.740ms      2953  16.843us  2.4950us  4.2529ms  cudaMemsetAsync
                    0.53%  40.507ms     84834     477ns     265ns  602.46us  cudaSetDevice
                    0.35%  26.216ms    140636     186ns      94ns  541.84us  cudaSetupArgument
                    0.14%  10.487ms      5679  1.8460us     734ns  523.10us  cudaEventRecord
                    0.11%  8.1587ms     39029     209ns      94ns  511.10us  cudaGetLastError
                    0.10%  7.3341ms     31381     233ns     111ns  574.78us  cudaConfigureCall
                    0.04%  3.0267ms       844  3.5860us  1.1920us  44.804us  cudaBindTexture
                    0.04%  2.8432ms         2  1.4216ms  1.3995ms  1.4438ms  cudaHostAlloc
                    0.01%  989.55us       844  1.1720us     430ns  18.096us  cudaUnbindTexture
                    0.01%  952.78us       185  5.1500us     142ns  192.74us  cuDeviceGetAttribute
                    0.01%  932.09us         2  466.05us  456.34us  475.75us  cudaGetDeviceProperties
                    0.01%  800.61us       656  1.2200us     658ns  17.158us  cudaStreamWaitEvent
                    0.01%  556.40us         2  278.20us  274.95us  281.45us  cuDeviceTotalMem
                    0.00%  292.25us         8  36.530us  28.339us  82.199us  cudaStreamCreateWithFlags
                    0.00%  134.20us         2  67.099us  43.805us  90.393us  cuDeviceGetName
                    0.00%  128.73us        28  4.5970us  2.1000us  20.300us  cudaFuncGetAttributes
                    0.00%  112.55us        21  5.3590us  2.8310us  20.871us  cudaEventQuery
                    0.00%  111.42us         4  27.856us  25.833us  31.886us  cudaStreamCreateWithPriority
                    0.00%  82.022us        50  1.6400us  1.0270us  4.7350us  cudaEventCreateWithFlags
                    0.00%  68.976us        22  3.1350us     488ns  46.202us  cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
                    0.00%  55.310us       110     502ns     233ns  1.6900us  cudaDeviceGetAttribute
                    0.00%  34.139us        21  1.6250us     968ns  3.2160us  cudaEventDestroy
                    0.00%  13.737us        78     176ns     101ns     484ns  cudaPeekAtLastError
                    0.00%  9.5470us        25     381ns     116ns  1.5740us  cudaGetDeviceCount
                    0.00%  6.2740us         1  6.2740us  6.2740us  6.2740us  cudaDeviceGetStreamPriorityRange
                    0.00%  3.7750us         2  1.8870us  1.6720us  2.1030us  cudaFree
                    0.00%  3.3250us         1  3.3250us  3.3250us  3.3250us  cudaHostGetDevicePointer
                    0.00%  2.3740us         4     593ns     144ns  1.2250us  cuDeviceGetCount
                    0.00%  1.8230us         1  1.8230us  1.8230us  1.8230us  cuInit
                    0.00%  1.6770us         3     559ns     252ns     993ns  cuDeviceGet
                    0.00%  1.2320us         1  1.2320us  1.2320us  1.2320us  cuDriverGetVersion
&lt;/denchmark-code&gt;

V100 without benchmark:
&lt;denchmark-code&gt;==2861== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   11.66%  517.91ms        24  21.579ms  21.539ms  21.672ms  void DSE::vector_fft&lt;int=1, int=2, int=256, int=16, int=16, int=1, float, float, float2&gt;(float2*, float2, int, int3, float2*)
                   11.26%  499.84ms        24  20.827ms  20.719ms  22.230ms  void DSE::regular_fft_clip&lt;int=1, int=2, int=256, int=16, int=16, int=1, float, float, float2&gt;(float*, float2*, int, int3, float2*, int, float2*, float2*, int, int, int, int, int, float, float, bool, int, float, float)
                   11.16%  495.78ms      5572  88.977us  1.5350us  10.134ms  [CUDA memcpy DtoH]
                   10.75%  477.22ms      2830  168.63us  78.655us  1.2301ms  volta_gcgemm_32x32_nt
                    9.63%  427.77ms        24  17.824ms  17.107ms  21.212ms  void pointwise_mult_and_sum_complex&lt;float2, int=8, int=4&gt;(float2*, float2*, float2*, int, int, int, int, int, float2)
                    5.51%  244.85ms       471  519.84us  146.40us  3.1637ms  void cudnn::winograd::winograd3x3Kernel&lt;float, float, int=1, int=4, int=8, bool=0&gt;(cudnn::maxwell::winograd::KernelParams)
                    4.05%  179.68ms       779  230.66us  32.863us  1.2444ms  volta_scudnn_128x64_relu_interior_nn_v1
                    3.20%  142.26ms       638  222.99us  1.4080us  8.8673ms  [CUDA memcpy HtoD]
                    2.55%  113.06ms       217  521.04us  251.13us  1.4873ms  volta_scudnn_128x64_stridedB_splitK_interior_nn_v1
                    1.79%  79.684ms        97  821.48us  371.77us  3.3131ms  void cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1&gt;*, kernel_grad_params, int, int, float, int, int, int)
                    1.58%  70.068ms        83  844.19us  470.75us  2.8063ms  void cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1&gt;*, kernel_grad_params, int, int, float, int, int, int)
                    1.31%  58.243ms      3116  18.691us  1.1520us  458.68us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_17gpu_binary_kernelIZNS0_15add_kernel_implIfEEvRNS_14TensorIteratorENS_6ScalarEEUlffE_EEvS5_RKT_EUliE_EEviT1_
                    1.27%  56.265ms        69  815.44us  408.92us  2.9769ms  volta_scudnn_128x128_stridedB_splitK_xregs_large_nn_v1
                    1.24%  55.046ms       134  410.79us  273.82us  1.4657ms  void cudnn::winograd::winograd3x3Kernel&lt;float, float, int=2, int=2, int=8, bool=0&gt;(cudnn::maxwell::winograd::KernelParams)
                    1.23%  54.624ms       194  281.56us  114.43us  953.46us  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    1.22%  53.969ms      2830  19.070us  9.0560us  63.519us  void fft2d_r2c_32x32&lt;float, unsigned int=0, bool=0&gt;(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool)
                    1.12%  49.886ms      2830  17.627us  9.2480us  84.864us  void fft2d_c2r_32x32&lt;float, bool=0, unsigned int=0, bool=0, bool=0&gt;(float*, float2 const *, int, int, int, int, int, int, int, int, int, float, float, cudnn::reduced_divisor, bool, float*, float*)
                    1.10%  48.975ms        60  816.25us  106.98us  4.2423ms  void cudnn::detail::wgrad_alg0_engine&lt;float, int=512, int=6, int=5, int=3, int=3, int=3, bool=1, int=512&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg0_engine&lt;float, int=512, int=6, int=5, int=3, int=3, int=3, bool=1, int=512&gt;*, float const , kernel_grad_params, int, float, int, int, int, int)
                    1.05%  46.655ms       126  370.28us  65.855us  852.18us  void fft2d_r2c_32x32&lt;float, unsigned int=1, bool=1&gt;(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool)
                    1.03%  45.568ms       396  115.07us  16.800us  865.14us  void cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;(float, float, float, float, cudnnTensorStruct, float const *, cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, float const , cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, cudnnTensorStruct*, float const *, float*, float const *, float const , float const , float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnBwPersistentState*, int, float, float, float, int, float, cudnnStatus_t*, bool)
                    0.93%  41.501ms       187  221.93us  66.656us  643.64us  volta_scudnn_128x64_stridedB_interior_nn_v1
                    0.93%  41.187ms       990  41.603us  3.6160us  234.65us  void cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;(float, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;, cudnnTensorStruct, float const *, float, cudnnTensorStruct*, float, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const *, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;)
                    0.90%  39.962ms      1218  32.809us  1.7280us  314.49us  void kernelPointwiseApply1&lt;ThresholdUpdateOutputIP&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;ThresholdUpdateOutputIP&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.86%  38.099ms        72  529.16us  193.31us  3.1919ms  void cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1, int=512&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1, int=512&gt;*, float const , kernel_grad_params, int, float, int, int, int, int)
                    0.80%  35.414ms        78  454.03us  256.32us  899.83us  void cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1, int=512&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1, int=512&gt;*, float const , kernel_grad_params, int, float, int, int, int, int)
                    0.76%  33.547ms       396  84.713us  15.967us  496.32us  void cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;(cudnnTensorStruct, float const *, cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, cudnnTensorStruct*, float const *, float const , float, float, float*, float const *, float const *, float const *, float, float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnFwPersistentState*, int, float, float, float, int, float, float, cudnnStatus_t*, bool)
                    0.74%  32.887ms       266  123.64us  57.760us  646.71us  void im2col4d_kernel&lt;float, int&gt;(im2col4d_params, cudnnConvolutionStruct, cudnnTensor4dStruct, float const *, float*, int)
                    0.67%  29.760ms        71  419.16us  288.03us  1.6501ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.65%  29.061ms       600  48.434us  3.7120us  373.95us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.61%  26.928ms       348  77.377us  4.0960us  484.12us  void kernelPointwiseApply3&lt;ThresholdUpdateGradInput&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;ThresholdUpdateGradInput&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.58%  25.867ms       672  38.492us  6.4320us  197.05us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=-1, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.54%  23.865ms       222  107.50us  6.1440us  1.4110ms  void calc_bias_diff&lt;int=2, float, float, int=128, int=0&gt;(cudnnTensorStruct, float const *, cudnnTensorStruct, float*, float, float, int)
                    0.47%  20.763ms        20  1.0381ms  1.0278ms  1.0598ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.42%  18.775ms        59  318.22us  230.94us  1.5533ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.42%  18.456ms      4940  3.7360us  1.0240us  50.400us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_16gpu_unary_kernelIZNS0_17gpu_binary_kernelIZNS0_15mul_kernel_implIfEEvRNS_14TensorIteratorEEUlffE_EEvS6_RKT_EUlfE0_EEvS6_SA_EUliE_EEviT1_
                    0.35%  15.511ms        48  323.15us  185.60us  707.29us  void DSE::vector_fft&lt;int=0, int=1, int=256, int=16, int=16, int=1, float, float, float2&gt;(float2*, float2, int, int3, float2*)
                    0.35%  15.448ms        16  965.50us  580.12us  1.8013ms  void cudnn::winograd::winograd3x3Kernel&lt;float, float, int=4, int=1, int=8, bool=0&gt;(cudnn::maxwell::winograd::KernelParams)
                    0.34%  14.986ms        63  237.87us  196.03us  1.2386ms  volta_scudnn_128x128_relu_interior_nn_v1
                    0.32%  14.247ms        26  547.95us  375.20us  1.1500ms  volta_scudnn_128x128_stridedB_small_nn_v1
                    0.32%  14.021ms       590  23.764us  4.4480us  333.25us  void add_tensor_kernel_v3&lt;int=2, float, float, int=128, int=1, int=1, int=4, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.31%  13.550ms        34  398.54us  291.61us  735.61us  volta_scudnn_128x64_stridedB_small_nn_v1
                    0.29%  12.734ms       252  50.533us  5.6640us  462.20us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=-1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.26%  11.646ms       168  69.323us  19.872us  240.06us  _ZN2at6native18elementwise_kernelILi128ELi4EZNS0_17gpu_binary_kernelIZNS0_15add_kernel_implIfEEvRNS_14TensorIteratorENS_6ScalarEEUlffE_EEvS5_RKT_EUliE0_EEviT1_
                    0.26%  11.510ms        48  239.79us  144.22us  523.84us  void DSE::regular_fft_pad&lt;int=0, int=1, int=256, int=16, int=16, int=1, float, float, float2&gt;(float2*, float*, int, int3, float*, int, float*, float*, int, int, int, int, int, bool)
                    0.25%  10.940ms        20  546.99us  545.08us  550.72us  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.24%  10.822ms      1978  5.4710us     991ns  73.599us  void kernelPointwiseApply1&lt;TensorFillOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorFillOp&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.24%  10.612ms       504  21.055us  2.7520us  159.30us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=2, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.22%  9.9008ms       627  15.790us  4.6080us  76.191us  void cudnn::winograd::generateWinogradTilesKernel&lt;int=0, float, float&gt;(cudnn::winograd::GenerateWinogradTilesParams&lt;float, float&gt;)
                    0.22%  9.6015ms        18  533.42us  465.21us  911.86us  volta_scudnn_128x128_stridedB_splitK_interior_nn_v1
                    0.20%  8.9943ms        22  408.83us  216.61us  2.8138ms  volta_scudnn_128x64_relu_small_nn_v1
                    0.19%  8.3830ms      1300  6.4480us  1.3760us  107.65us  void kernelPointwiseApply3&lt;TensorAddCDivOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorAddCDivOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.13%  5.7320ms       493  11.626us  1.4400us  166.53us  void scalePackedTensor_kernel&lt;float, float&gt;(cudnnTensor4dStruct, float*, float)
                    0.13%  5.7139ms      1300  4.3950us  1.1200us  74.464us  void kernelPointwiseApply3&lt;TensorAddCMulOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorAddCMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.12%  5.4707ms         1  5.4707ms  5.4707ms  5.4707ms  volta_scudnn_128x128_relu_small_nn_v1
                    0.10%  4.5757ms      3063  1.4930us  1.3110us  3.0400us  [CUDA memset]
                    0.10%  4.3706ms        10  437.06us  434.56us  441.56us  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=512, int=6, int=8, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=512, int=6, int=8, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.10%  4.2890ms      1300  3.2990us  1.0560us  50.399us  void kernelPointwiseApply2&lt;Tensor_sqrt_Float_Op, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;float, unsigned int, int=1&gt;, OffsetInfo&lt;float, unsigned int, int=1&gt;, unsigned int, Tensor_sqrt_Float_Op)
                    0.10%  4.2369ms       450  9.4150us  2.6880us  35.936us  void kernelReduceAllPass1&lt;float, unsigned int, float, TensorNormOp&lt;float, int=2&gt;, ReduceAdd&lt;float&gt;, int=1&gt;(TensorInfo&lt;float, unsigned int&gt;, unsigned int, float, float, int=2, float*)
                    0.09%  3.9573ms      1300  3.0440us     992ns  49.824us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_16gpu_unary_kernelIZNS0_17gpu_binary_kernelIZNS0_15add_kernel_implIfEEvRNS_14TensorIteratorENS_6ScalarEEUlffE_EEvS6_RKT_EUlfE0_EEvS6_SB_EUliE_EEviT1_
                    0.08%  3.4324ms        96  35.753us  10.400us  121.12us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=2&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.07%  3.2333ms         6  538.89us  483.13us  792.03us  volta_scudnn_128x64_stridedB_splitK_medium_nn_v1
                    0.07%  3.2069ms        17  188.64us  160.22us  378.97us  volta_scudnn_128x128_stridedB_interior_nn_v1
                    0.06%  2.4977ms        21  118.94us  67.871us  301.28us  void MaxPoolForward&lt;float, float&gt;(int, float const *, int, int, int, int, int, int, int, int, int, int, int, int, int, int, float*, long*)
                    0.06%  2.4592ms      1129  2.1780us  1.6320us  13.856us  cudnn::gemm::computeOffsetsKernel(cudnn::gemm::ComputeOffsetsParams)
                    0.05%  2.4352ms         6  405.87us  347.61us  684.95us  void MaxPoolBackward&lt;float, float&gt;(int, float const *, long const *, int, int, int, int, int, int, int, int, int, int, int, int, int, int, float*)
                    0.05%  2.2032ms        12  183.60us  155.58us  316.99us  _ZN2at6native18elementwise_kernelILi128ELi4EZNS0_17gpu_binary_kernelIZNS0_15mul_kernel_implIfEEvRNS_14TensorIteratorEEUlffE_EEvS5_RKT_EUliE0_EEviT1_
                    0.05%  2.1979ms       850  2.5850us  2.2400us  3.8080us  void kernelReduceAll&lt;float, unsigned int, float, TensorNormOp&lt;float, int=2&gt;, ReduceAdd&lt;float&gt;, int=1&gt;(TensorInfo&lt;float, unsigned int&gt;, unsigned int, float, float, int=2, float*)
                    0.04%  1.8328ms         6  305.46us  247.39us  581.24us  void cudnn::winograd::winograd3x3Kernel&lt;float, float, int=1, int=4, int=8, bool=1&gt;(cudnn::maxwell::winograd::KernelParams)
                    0.04%  1.6563ms       179  9.2530us  5.1520us  46.335us  void add_tensor_kernel_v3&lt;int=2, float, float, int=64, int=1, int=2, int=4, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.03%  1.4848ms         2  742.38us  739.61us  745.14us  volta_scudnn_128x128_stridedB_splitK_medium_nn_v1
                    0.03%  1.1258ms         1  1.1258ms  1.1258ms  1.1258ms  void cudnn::detail::dgrad2d_alg1_1&lt;float, int=0, int=6, int=7, int=5, int=4, int=5, bool=1, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad2d_alg1_1&lt;float, int=0, int=6, int=7, int=5, int=4, int=5, bool=1, bool=1&gt;*, kernel_grad_params, int, int, float, int, int)
                    0.02%  999.38us       396  2.5230us  2.2080us  3.7440us  _ZN2at6native18elementwise_kernelILi128ELi4EZNS0_16gpu_unary_kernelIZNS0_17gpu_binary_kernelIZNS0_15add_kernel_implIlEEvRNS_14TensorIteratorENS_6ScalarEEUlllE_EEvS6_RKT_EUllE0_EEvS6_SB_EUliE0_EEviT1_
                    0.02%  969.75us       450  2.1550us  1.6000us  3.6480us  void kernelReduceAllPass2&lt;float, ReduceAdd&lt;float&gt;&gt;(int, float, float, float*, float*)
                    0.02%  872.69us        12  72.724us  62.815us  83.071us  void fft2d_r2c_32x32&lt;float, unsigned int=1, bool=0&gt;(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool)
                    0.02%  857.91us         1  857.91us  857.91us  857.91us  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=6, int=7, int=3, int=3, int=5, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=6, int=7, int=3, int=3, int=5, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.02%  808.50us         1  808.50us  808.50us  808.50us  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.02%  680.89us       312  2.1820us  1.5040us  3.5840us  cudnn::gemm::computeWgradBOffsetsKernel(cudnn::gemm::ComputeBOffsetsParams)
                    0.01%  623.26us        22  28.330us  12.864us  73.984us  void CatArrayBatchedCopy&lt;float, unsigned int, int=4&gt;(float*, CatArrInputTensor&lt;float, unsigned int&gt;*, OutputTensorSizeStride&lt;unsigned int, unsigned int=4&gt;, int, unsigned int)
                    0.01%  565.40us       264  2.1410us  1.4080us  3.4240us  cudnn::gemm::computeBOffsetsKernel(cudnn::gemm::ComputeBOffsetsParams)
                    0.01%  560.83us       312  1.7970us  1.6000us  2.3040us  cudnn::gemm::computeWgradSplitKOffsetsKernel(cudnn::gemm::ComputeOffsetsParams)
                    0.01%  291.42us        21  13.877us  10.944us  33.248us  void caffe_gpu_interp2_kernel&lt;float, float&gt;(int, float, float, bool, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;)
                    0.01%  277.34us        17  16.314us  13.152us  30.976us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_17gpu_binary_kernelIZNS0_15mul_kernel_implIfEEvRNS_14TensorIteratorEEUlffE_EEvS5_RKT_EUliE_EEviT1_
                    0.00%  206.88us         6  34.479us  28.832us  60.223us  void caffe_gpu_interp2_kernel_backward&lt;float, float&gt;(int, float, float, bool, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;)
                    0.00%  163.68us        11  14.879us  12.864us  26.144us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::ReduceAgent&lt;thrust::cuda_cub::transform_pair_of_input_iterators_t&lt;float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, mse_functor&lt;float, float&gt;&gt;, float*, float, long, thrust::plus&lt;float&gt;&gt;, thrust::cuda_cub::transform_pair_of_input_iterators_t&lt;float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, mse_functor&lt;float, float&gt;&gt;, float*, long, thrust::cuda_cub::cub::GridEvenShare&lt;int&gt;, thrust::cuda_cub::cub::GridQueue&lt;int&gt;, thrust::plus&lt;float&gt;&gt;(float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, float, float, mse_functor&lt;float, float&gt;)
                    0.00%  109.44us        11  9.9480us  8.4160us  18.656us  void kernelPointwiseApply2&lt;TensorGTValueOp&lt;float, unsigned char&gt;, unsigned char, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;unsigned char, unsigned char, float&gt;, OffsetInfo&lt;TensorGTValueOp&lt;float, unsigned char&gt;, unsigned char, unsigned int&gt;, unsigned char, float)
                    0.00%  96.895us         6  16.149us  13.184us  27.200us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__parallel_for::ParallelForAgent&lt;thrust::cuda_cub::__transform::binary_transform_f&lt;thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor&lt;float, float&gt;, thrust::cuda_cub::__transform::always_true_predicate&gt;, long&gt;, thrust::cuda_cub::__transform::binary_transform_f&lt;thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor&lt;float, float&gt;, thrust::cuda_cub::__transform::always_true_predicate&gt;, long&gt;(thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;)
                    0.00%  86.559us         8  10.819us  8.5120us  14.304us  void add_tensor_kernel_v3&lt;int=2, float, float, int=32, int=1, int=4, int=2, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.00%  65.311us        11  5.9370us  4.9920us  14.463us  void kernelPointwiseApply2&lt;CopyOp&lt;float, unsigned char&gt;, float, unsigned char, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;unsigned char, float, unsigned char&gt;, OffsetInfo&lt;CopyOp&lt;float, unsigned char&gt;, float, unsigned int&gt;, float, float)
                    0.00%  34.079us        11  3.0980us  2.8480us  3.4240us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::ReduceAgent&lt;float*, float*, float, long, thrust::plus&lt;float&gt;&gt;, float*, float*, int, thrust::plus&lt;float&gt;, float&gt;(float*, float, long, float, thrust::plus&lt;float&gt;)
                    0.00%  23.648us         6  3.9410us  3.6480us  4.4160us  _ZN2at4cuda83_GLOBAL__N__59_tmpxft_000043d1_00000000_9_Distributions_compute_70_cpp1_ii_c3aa7ee621kernelPointwiseApply1IZN83_GLOBAL__N__59_tmpxft_000043d1_00000000_9_Distributions_compute_70_cpp1_ii_c3aa7ee628bernoulli_scalar_cuda_kernelIfEEvRNS_6TensorEdSt4pairImmEEUliRfS9_S9_S9_E_fjLi1ELi4EEEvNS0_6detail10TensorInfoIT0_T1_EESE_T_
                    0.00%  16.224us        11  1.4740us  1.3120us  1.8560us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::DrainAgent&lt;long&gt;, thrust::cuda_cub::cub::GridQueue&lt;int&gt;, long&gt;(thrust::cuda_cub::__reduce::DrainAgent&lt;long&gt;, int)
                    0.00%  8.3840us         6  1.3970us  1.3440us  1.6000us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_16gpu_unary_kernelIZNS0_17div_constant_implIfEEvRNS_14TensorIteratorET_EUlfE_EEvS5_RKS6_EUliE_EEviT1_
      API calls:   58.46%  6.00115s       306  19.612ms  5.9240us  5.88557s  cudaMalloc
                   15.90%  1.63214s     39231  41.603us  4.7250us  21.585ms  cudaLaunch
                   13.23%  1.35769s      4747  286.01us  5.3050us  71.572ms  cudaMemcpyAsync
                    5.43%  557.70ms      1463  381.20us  8.8710us  368.75ms  cudaMemcpy
                    4.37%  448.71ms      4736  94.744us  2.5090us  44.302ms  cudaStreamSynchronize
                    0.98%  100.12ms    271671     368ns     241ns  581.61us  cudaGetDevice
                    0.43%  44.413ms    110474     402ns     257ns  526.88us  cudaSetDevice
                    0.42%  43.575ms    284654     153ns     102ns  570.27us  cudaSetupArgument
                    0.26%  26.800ms      3063  8.7490us  2.5030us  441.54us  cudaMemsetAsync
                    0.11%  11.449ms      7311  1.5660us     458ns  521.39us  cudaEventRecord
                    0.10%  10.351ms     39231     263ns     114ns  606.07us  cudaConfigureCall
                    0.08%  7.7388ms     36176     213ns     100ns  431.42us  cudaGetLastError
                    0.06%  6.0911ms      5946  1.0240us     483ns  444.05us  cudaStreamWaitEvent
                    0.04%  4.0995ms       276  14.853us     126ns  680.45us  cuDeviceGetAttribute
                    0.04%  3.8201ms      1214  3.1460us  1.4240us  26.962us  cudaBindTexture
                    0.03%  3.2742ms         2  1.6371ms  1.6316ms  1.6426ms  cudaGetDeviceProperties
                    0.02%  2.2877ms         2  1.1438ms  1.1191ms  1.1686ms  cudaHostAlloc
                    0.01%  1.3007ms         3  433.56us  294.24us  608.92us  cuDeviceTotalMem
                    0.01%  1.0819ms      1214     891ns     418ns  1.9250us  cudaUnbindTexture
                    0.00%  417.41us         8  52.176us  18.277us  269.56us  cudaStreamCreateWithFlags
                    0.00%  398.95us         3  132.98us  102.46us  178.81us  cuDeviceGetName
                    0.00%  344.77us       138  2.4980us  1.9200us  18.586us  cudaEventCreate
                    0.00%  262.50us       159  1.6500us  1.1780us  22.360us  cudaEventDestroy
                    0.00%  185.41us         4  46.351us  19.258us  125.43us  cudaStreamCreateWithPriority
                    0.00%  100.18us        28  3.5780us  2.1650us  6.2390us  cudaFuncGetAttributes
                    0.00%  89.878us        21  4.2790us  3.6080us  5.5000us  cudaEventQuery
                    0.00%  56.296us        50  1.1250us     434ns  2.4360us  cudaEventCreateWithFlags
                    0.00%  48.184us        32  1.5050us     689ns  15.166us  cudaFuncSetAttribute
                    0.00%  41.098us       110     373ns     243ns  1.2820us  cudaDeviceGetAttribute
                    0.00%  23.578us        22  1.0710us     504ns  3.4490us  cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
                    0.00%  12.529us        78     160ns     101ns     324ns  cudaPeekAtLastError
                    0.00%  11.668us        25     466ns     107ns  2.3150us  cudaGetDeviceCount
                    0.00%  3.2560us         2  1.6280us     780ns  2.4760us  cuInit
                    0.00%  2.7970us         5     559ns     131ns  1.4550us  cuDeviceGetCount
                    0.00%  2.1830us         2  1.0910us     417ns  1.7660us  cuDriverGetVersion
                    0.00%  2.0440us         1  2.0440us  2.0440us  2.0440us  cudaHostGetDevicePointer
                    0.00%  1.7420us         4     435ns     167ns     760ns  cuDeviceGet
                    0.00%  1.6210us         2     810ns     664ns     957ns  cudaFree
                    0.00%  1.1290us         1  1.1290us  1.1290us  1.1290us  cudaDeviceGetStreamPriorityRange
&lt;/denchmark-code&gt;

V100 with benchmark:
&lt;denchmark-code&gt;==6479== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   19.41%  2.80465s        86  32.612ms  18.137ms  36.746ms  volta_cgemm_32x64_tn
                   15.02%  2.17016s       300  7.2339ms  21.152us  28.626ms  void transpose_readWrite_alignment_kernel&lt;float2, float2, int=1, bool=0, int=6, int=4, int=4&gt;(cublasTransposeParams&lt;float2&gt;, float2 const *, float2*, float2 const *)
                    6.30%  910.67ms      8458  107.67us  57.695us  10.673ms  volta_cgemm_32x32_tn
                    4.97%  718.30ms      3449  208.26us  13.248us  4.0273ms  volta_gcgemm_32x32_nt
                    4.14%  598.32ms        80  7.4790ms  101.50us  21.515ms  void DSE::vector_fft&lt;int=0, int=1, int=256, int=16, int=16, int=1, float, float, float2&gt;(float2*, float2, int, int3, float2*)
                    4.10%  592.08ms        80  7.4011ms  69.663us  21.397ms  void DSE::vector_fft&lt;int=0, int=1, int=128, int=8, int=8, int=1, float, float, float2&gt;(float2*, float2, int, int3, float2*)
                    3.63%  524.54ms        80  6.5567ms  51.647us  19.343ms  void fft2d_r2c_64x64&lt;float&gt;(float2*, float const *, int, int, int, int, int, int, int, int)
                    2.59%  374.14ms        80  4.6767ms  99.871us  13.369ms  void DSE::regular_fft_pad&lt;int=0, int=1, int=256, int=16, int=16, int=1, float, float, float2&gt;(float2*, float*, int, int3, float*, int, float*, float*, int, int, int, int, int, bool)
                    2.49%  359.67ms      5572  64.550us  1.5350us  11.721ms  [CUDA memcpy DtoH]
                    2.46%  355.64ms        80  4.4455ms  76.447us  12.911ms  void DSE::regular_fft_pad&lt;int=0, int=1, int=128, int=16, int=32, int=1, float, float, float2&gt;(float2*, float*, int, int3, float*, int, float*, float*, int, int, int, int, int, bool)
                    2.38%  343.99ms        20  17.200ms  9.3676ms  21.317ms  void pointwise_mult_and_sum_complex&lt;float2, int=8, int=4&gt;(float2*, float2*, float2*, int, int, int, int, int, float2)
                    2.18%  314.90ms      1143  275.51us  33.311us  1.3690ms  volta_scudnn_128x64_relu_interior_nn_v1
                    1.77%  255.96ms       513  498.95us  146.43us  3.2678ms  void cudnn::winograd::winograd3x3Kernel&lt;float, float, int=1, int=4, int=8, bool=0&gt;(cudnn::maxwell::winograd::KernelParams)
                    1.41%  203.78ms        40  5.0946ms  91.007us  21.623ms  void DSE::vector_fft&lt;int=1, int=2, int=256, int=16, int=16, int=1, float, float, float2&gt;(float2*, float2, int, int3, float2*)
                    1.36%  196.61ms        40  4.9154ms  47.583us  21.260ms  void DSE::vector_fft&lt;int=1, int=2, int=128, int=8, int=8, int=1, float, float, float2&gt;(float2*, float2, int, int3, float2*)
                    1.35%  195.06ms        40  4.8764ms  102.78us  20.722ms  void DSE::regular_fft_clip&lt;int=1, int=2, int=256, int=16, int=16, int=1, float, float, float2&gt;(float*, float2*, int, int3, float2*, int, float2*, float2*, int, int, int, int, int, float, float, bool, int, float, float)
                    1.29%  186.06ms        40  4.6515ms  57.631us  20.186ms  void DSE::regular_fft_clip&lt;int=1, int=2, int=128, int=16, int=32, int=1, float, float, float2&gt;(float*, float2*, int, int3, float2*, int, float2*, float2*, int, int, int, int, int, float, float, bool, int, float, float)
                    1.26%  181.65ms       638  284.71us  1.4080us  13.324ms  [CUDA memcpy HtoD]
                    1.17%  169.48ms        40  4.2371ms  50.495us  18.522ms  void fft2d_c2r_64x64&lt;float, bool=0&gt;(float*, float2*, int, int, int, int, int, int, int, int, int, int, float, float, int, float*, float*)
                    1.11%  160.70ms       314  511.77us  228.96us  3.0887ms  void cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1, int=512&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1, int=512&gt;*, float const , kernel_grad_params, int, float, int, int, int, int)
                    1.01%  145.56ms       124  1.1739ms  252.51us  5.9291ms  void cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=8, int=3, int=3, int=5, bool=1&gt;*, kernel_grad_params, int, int, float, int, int, int)
                    0.99%  142.88ms       192  744.15us  281.66us  1.5934ms  volta_scudnn_128x64_stridedB_splitK_interior_nn_v1
                    0.92%  133.67ms       194  689.04us  109.82us  2.4333ms  volta_scudnn_128x64_stridedB_small_nn_v1
                    0.83%  120.50ms       100  1.2050ms  20.192us  4.8866ms  void fft2d_r2c_32x32&lt;float, unsigned int=1, bool=1&gt;(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool)
                    0.77%  110.56ms       113  978.41us  108.83us  3.9149ms  void cudnn::detail::wgrad_alg0_engine&lt;float, int=512, int=6, int=5, int=3, int=3, int=3, bool=1, int=512&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg0_engine&lt;float, int=512, int=6, int=5, int=3, int=3, int=3, bool=1, int=512&gt;*, float const , kernel_grad_params, int, float, int, int, int, int)
                    0.71%  103.32ms       198  521.82us  72.703us  2.8749ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.68%  97.728ms       151  647.21us  169.05us  2.7924ms  volta_scudnn_128x64_relu_small_nn_v1
                    0.64%  92.249ms       108  854.16us  143.10us  3.3025ms  void cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1&gt;*, kernel_grad_params, int, int, float, int, int, int)
                    0.59%  84.549ms      3830  22.075us  7.5840us  97.407us  void fft2d_r2c_32x32&lt;float, unsigned int=0, bool=0&gt;(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool)
                    0.55%  78.863ms      3830  20.590us  7.2320us  125.73us  void fft2d_c2r_32x32&lt;float, bool=0, unsigned int=0, bool=0, bool=0&gt;(float*, float2 const *, int, int, int, int, int, int, int, int, int, float, float, cudnn::reduced_divisor, bool, float*, float*)
                    0.53%  76.877ms        29  2.6509ms  636.06us  5.1447ms  volta_sgemm_128x128_nn
                    0.48%  70.017ms       102  686.44us  84.319us  4.3210ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=128, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.44%  63.785ms       144  442.95us  115.81us  1.8978ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.41%  58.614ms        50  1.1723ms  20.192us  4.7261ms  void fft2d_r2c_32x32&lt;float, unsigned int=1, bool=0&gt;(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool)
                    0.40%  58.438ms       175  333.93us  92.639us  2.4593ms  volta_sgemm_128x64_nt
                    0.35%  50.063ms       250  200.25us  50.559us  2.7229ms  void im2col4d_kernel&lt;float, int&gt;(im2col4d_params, cudnnConvolutionStruct, cudnnTensor4dStruct, float const *, float*, int)
                    0.34%  49.685ms       211  235.47us  67.391us  684.44us  volta_scudnn_128x64_stridedB_interior_nn_v1
                    0.34%  48.763ms        83  587.50us  191.71us  3.0115ms  void cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1, int=512&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg0_engine&lt;float, int=128, int=6, int=7, int=3, int=3, int=5, bool=1, int=512&gt;*, float const , kernel_grad_params, int, float, int, int, int, int)
                    0.34%  48.622ms       112  434.12us  272.35us  1.5631ms  void cudnn::winograd::winograd3x3Kernel&lt;float, float, int=2, int=2, int=8, bool=0&gt;(cudnn::maxwell::winograd::KernelParams)
                    0.32%  46.287ms        88  525.99us  106.50us  1.7655ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.32%  46.247ms       396  116.78us  16.863us  889.85us  void cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;(float, float, float, float, cudnnTensorStruct, float const *, cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, float const , cudnn::detail::bn_bw_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, cudnnTensorStruct*, float const *, float*, float const *, float const , float const , float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnBwPersistentState*, int, float, float, float, int, float, cudnnStatus_t*, bool)
                    0.30%  43.019ms        38  1.1321ms  398.81us  3.1560ms  volta_scudnn_128x128_stridedB_splitK_xregs_large_nn_v1
                    0.30%  42.921ms        18  2.3845ms  646.36us  5.0880ms  volta_sgemm_128x128_nt
                    0.29%  42.445ms        93  456.40us  59.744us  1.9236ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=5, int=5, int=3, int=3, int=3, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.29%  42.063ms       990  42.488us  3.0720us  235.33us  void cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;(float, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;, cudnnTensorStruct, float const *, float, cudnnTensorStruct*, float, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const *, cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt; const , cudnn::detail::bn_fw_inf_1C11_kernel_new&lt;float, float, bool=1, int=1&gt;)
                    0.29%  41.885ms        78  536.98us  34.240us  2.0867ms  void cudnn::winograd_nonfused::winogradForwardData4x4&lt;float, float&gt;(cudnn::winograd_nonfused::WinogradDataParams&lt;float, float&gt;)
                    0.29%  41.720ms       567  73.581us  67.327us  81.855us  volta_gcgemm_64x64_nt
                    0.29%  41.554ms      1218  34.116us  1.6640us  350.04us  void kernelPointwiseApply1&lt;ThresholdUpdateOutputIP&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;ThresholdUpdateOutputIP&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.28%  40.021ms        98  408.38us  127.49us  1.0479ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=1024, int=6, int=7, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.25%  35.700ms        78  457.70us  30.496us  1.9198ms  void cudnn::winograd_nonfused::winogradForwardOutput4x4&lt;float, float&gt;(cudnn::winograd_nonfused::WinogradOutputParams&lt;float, float&gt;)
                    0.24%  35.044ms       396  88.495us  16.223us  526.14us  void cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;(cudnnTensorStruct, float const *, cudnn::detail::bn_fw_tr_1C11_singleread&lt;float, int=512, bool=1, int=1, int=2, int=0&gt;, cudnnTensorStruct*, float const *, float const , float, float, float*, float const *, float const *, float const *, float, float, cudnn::reduced_divisor, int, float*, cudnn::detail::bnFwPersistentState*, int, float, float, float, int, float, float, cudnnStatus_t*, bool)
                    0.24%  34.745ms      1636  21.238us  1.1840us  483.48us  void kernelPointwiseApply2&lt;TensorAddOp&lt;float&gt;, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;TensorAddOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.24%  34.712ms        55  631.13us  373.98us  1.3740ms  volta_scudnn_128x128_stridedB_small_nn_v1
                    0.21%  30.565ms       348  87.831us  12.288us  494.81us  void kernelPointwiseApply3&lt;TensorAddOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorAddOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.21%  29.748ms       600  49.580us  3.5200us  395.32us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.21%  29.644ms        23  1.2889ms  595.48us  2.4732ms  volta_sgemm_128x64_nn
                    0.19%  27.538ms       348  79.133us  4.2560us  517.79us  void kernelPointwiseApply3&lt;ThresholdUpdateGradInput&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;ThresholdUpdateGradInput&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.19%  27.408ms        29  945.10us  195.04us  3.3095ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=6, int=7, int=3, int=3, int=5, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=1024, int=6, int=7, int=3, int=3, int=5, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.18%  26.308ms       672  39.148us  6.3680us  202.11us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=-1, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.18%  25.387ms        42  604.46us  140.67us  1.4667ms  volta_gcgemm_64x32_nt
                    0.17%  25.085ms       222  112.99us  6.2720us  1.4513ms  void calc_bias_diff&lt;int=2, float, float, int=128, int=0&gt;(cudnnTensorStruct, float const *, cudnnTensorStruct, float*, float, float, int)
                    0.16%  22.928ms       444  51.639us  5.6000us  421.79us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=-1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.14%  20.022ms        17  1.1778ms  645.53us  1.9055ms  void cudnn::winograd::winograd3x3Kernel&lt;float, float, int=4, int=1, int=8, bool=0&gt;(cudnn::maxwell::winograd::KernelParams)
                    0.13%  19.119ms      4940  3.8700us     960ns  56.639us  void kernelPointwiseApply1&lt;TensorMulConstantOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorMulConstantOp&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.13%  18.198ms         6  3.0330ms  1.3064ms  6.1778ms  void cudnn::detail::wgrad_alg1_engine&lt;float, int=512, int=6, int=5, int=3, int=3, int=3, bool=1, bool=1&gt;(int, int, int, float const *, int, cudnn::detail::wgrad_alg1_engine&lt;float, int=512, int=6, int=5, int=3, int=3, int=3, bool=1, bool=1&gt;*, float const , kernel_grad_params, int, float, float, int, int, int*, kernel_grad_params, int, int)
                    0.11%  15.789ms         4  3.9474ms  589.95us  7.1092ms  void cudnn::detail::dgrad2d_alg1_1&lt;float, int=0, int=6, int=7, int=5, int=4, int=5, bool=1, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad2d_alg1_1&lt;float, int=0, int=6, int=7, int=5, int=4, int=5, bool=1, bool=1&gt;*, kernel_grad_params, int, int, float, int, int)
                    0.10%  15.026ms        20  751.32us  198.24us  1.5589ms  volta_scudnn_128x128_relu_interior_nn_v1
                    0.10%  14.686ms       590  24.892us  4.5120us  383.74us  void add_tensor_kernel_v3&lt;int=2, float, float, int=128, int=1, int=1, int=4, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.10%  14.540ms       167  87.066us  13.600us  732.02us  void cudnn::winograd_nonfused::winogradWgradData4x4&lt;float, float&gt;(cudnn::winograd_nonfused::WinogradDataParams&lt;float, float&gt;)
                    0.10%  13.842ms       198  69.907us  22.688us  535.32us  void fft1d_r2c_32&lt;float, float, float2, bool=0, bool=0&gt;(float2*, float const *, int, int3, int3, int2, int2)
                    0.09%  13.528ms        30  450.92us  12.512us  742.04us  void flip_filter&lt;float, float&gt;(float*, float const *, int, int, int, int)
                    0.09%  13.468ms        34  396.11us  70.272us  1.3399ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=1&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.09%  12.556ms       644  19.496us  4.6400us  89.791us  void cudnn::winograd::generateWinogradTilesKernel&lt;int=0, float, float&gt;(cudnn::winograd::GenerateWinogradTilesParams&lt;float, float&gt;)
                    0.08%  12.017ms       487  24.676us  1.1840us  173.66us  void scalePackedTensor_kernel&lt;float, float&gt;(cudnnTensor4dStruct, float*, float)
                    0.08%  11.546ms      1978  5.8370us     832ns  83.039us  void kernelPointwiseApply1&lt;TensorFillOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorFillOp&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.08%  11.244ms         5  2.2487ms  935.64us  4.3585ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=5, int=5, int=3, int=3, int=3, int=0, bool=0&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=5, int=5, int=3, int=3, int=3, int=0, bool=0&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.08%  11.043ms       504  21.911us  2.7520us  178.53us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=2, int=1&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.08%  10.900ms         7  1.5571ms  787.38us  4.6218ms  volta_scudnn_128x128_relu_small_nn_v1
                    0.07%  10.410ms        16  650.61us  445.02us  1.1222ms  void cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=512, int=6, int=8, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;(int, int, int, float const *, int, float*, cudnn::detail::implicit_convolve_sgemm&lt;float, float, int=512, int=6, int=8, int=3, int=3, int=5, int=1, bool=1, bool=0, bool=1&gt;*, kernel_conv_params, int, float, float, int, float, float, int, int)
                    0.07%  10.089ms       167  60.411us  9.2150us  678.49us  void cudnn::winograd_nonfused::winogradWgradDelta4x4&lt;float, float&gt;(cudnn::winograd_nonfused::WinogradDeltaParams&lt;float, float&gt;)
                    0.07%  9.5398ms        36  265.00us  41.375us  855.70us  void fft1d_r2c_32&lt;float, float, float2, bool=1, bool=0&gt;(float2*, float const *, int, int3, int3, int2, int2)
                    0.06%  8.9673ms      1300  6.8970us  1.5360us  112.06us  void kernelPointwiseApply3&lt;TensorAddCDivOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorAddCDivOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.06%  8.5061ms        56  151.89us  31.904us  564.44us  void fft1d_r2c_256&lt;float, float, float2, bool=0, bool=0&gt;(float2*, float const *, int3, int3, int2, int2)
                    0.05%  7.4965ms        25  299.86us  168.45us  783.26us  volta_scudnn_128x64_relu_medium_nn_v1
                    0.05%  6.9500ms       180  38.610us  8.1600us  109.60us  void fft1d_c2r_32&lt;float2, float, float, bool=0, bool=1, bool=0, bool=0&gt;(float*, float2 const *, int, int3, int3, int2, int, float, float, float*, float*)
                    0.05%  6.8129ms        10  681.29us  479.07us  975.73us  volta_scudnn_128x128_stridedB_splitK_interior_nn_v1
                    0.04%  6.1961ms      1300  4.7660us  1.1520us  79.615us  void kernelPointwiseApply2&lt;TensorCAddOp&lt;float&gt;, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;TensorCAddOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.04%  5.7998ms        48  120.83us  24.128us  403.93us  void fft1d_c2r_256&lt;float2, float, float, bool=0, bool=1, bool=0, bool=0&gt;(float*, float2 const *, int3, int3, int2, int, float, float, float*, float*)
                    0.04%  5.6757ms      1300  4.3650us  1.0240us  80.447us  void kernelPointwiseApply3&lt;TensorAddCMulOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorAddCMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.04%  5.3858ms      3498  1.5390us  1.3110us  4.4800us  [CUDA memset]
                    0.04%  5.0842ms       167  30.444us  4.8960us  136.83us  void cudnn::winograd_nonfused::winogradWgradOutput4x4&lt;float, float&gt;(cudnn::winograd_nonfused::WinogradWgradOutputParams&lt;float, float&gt;)
                    0.03%  4.9537ms         2  2.4769ms  2.2623ms  2.6914ms  void cudnn::detail::dgrad2d_alg1_1&lt;float, int=0, int=6, int=6, int=5, int=4, int=4, bool=1, bool=1&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::dgrad2d_alg1_1&lt;float, int=0, int=6, int=6, int=5, int=4, int=4, bool=1, bool=1&gt;*, kernel_grad_params, int, int, float, int, int)
                    0.03%  4.4569ms      1300  3.4280us  1.0560us  58.527us  void kernelPointwiseApply2&lt;Tensor_sqrt_Float_Op, float, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;float, unsigned int, int=1&gt;, OffsetInfo&lt;float, unsigned int, int=1&gt;, unsigned int, Tensor_sqrt_Float_Op)
                    0.03%  4.4514ms         7  635.91us  489.15us  817.08us  volta_scudnn_128x64_stridedB_splitK_medium_nn_v1
                    0.03%  4.3677ms       450  9.7060us  2.7200us  45.632us  void kernelReduceAllPass1&lt;float, unsigned int, float, TensorNormOp&lt;float, int=2&gt;, ReduceAdd&lt;float&gt;, int=1&gt;(TensorInfo&lt;float, unsigned int&gt;, unsigned int, float, float, int=2, float*)
                    0.03%  4.1370ms      1823  2.2690us  1.6320us  11.648us  cudnn::gemm::computeOffsetsKernel(cudnn::gemm::ComputeOffsetsParams)
                    0.03%  4.0255ms      1300  3.0960us     960ns  55.231us  void kernelPointwiseApply1&lt;TensorAddConstantOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorAddConstantOp&lt;float&gt;, float, unsigned int&gt;, float, float)
                    0.02%  3.5143ms        96  36.607us  10.176us  127.42us  void kernelPointwiseApply2&lt;CopyOp&lt;float, float&gt;, float, float, unsigned int, int=1, int=2&gt;(OffsetInfo&lt;float, float, float&gt;, OffsetInfo&lt;CopyOp&lt;float, float&gt;, float, unsigned int&gt;, float, float)
                    0.02%  3.0556ms        17  179.74us  159.90us  376.70us  volta_scudnn_128x128_stridedB_interior_nn_v1
                    0.02%  2.7742ms         1  2.7742ms  2.7742ms  2.7742ms  void cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0&gt;(int, int, int, float const *, int, float const , int, cudnn::detail::explicit_convolve_sgemm&lt;float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0&gt;*, kernel_conv_params, int, int, float, float, int, float const *, float const *)
                    0.02%  2.5515ms        21  121.50us  68.351us  318.21us  void MaxPoolForward&lt;float, float&gt;(int, float const *, int, int, int, int, int, int, int, int, int, int, int, int, int, int, float*, long*)
                    0.02%  2.4422ms         6  407.03us  347.93us  693.85us  void MaxPoolBackward&lt;float, float&gt;(int, float const *, long const *, int, int, int, int, int, int, int, int, int, int, int, int, int, int, float*)
                    0.02%  2.3724ms        78  30.415us  4.2240us  155.84us  void cudnn::winograd_nonfused::winogradForwardFilter4x4&lt;float, float&gt;(cudnn::winograd_nonfused::WinogradFilterParams&lt;float, float&gt;)
                    0.02%  2.3546ms       266  8.8510us  1.0880us  348.06us  [CUDA memcpy DtoD]
                    0.02%  2.2064ms       850  2.5950us  2.2400us  4.0000us  void kernelReduceAll&lt;float, unsigned int, float, TensorNormOp&lt;float, int=2&gt;, ReduceAdd&lt;float&gt;, int=1&gt;(TensorInfo&lt;float, unsigned int&gt;, unsigned int, float, float, int=2, float*)
                    0.01%  2.0093ms        96  20.930us  4.3520us  56.383us  compute_gemm_pointers(float2**, float2 const *, int, float2 const *, int, float2 const *, int, int)
                    0.01%  1.7223ms       179  9.6210us  5.1200us  52.736us  void add_tensor_kernel_v3&lt;int=2, float, float, int=64, int=1, int=2, int=4, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.01%  1.4640ms         2  732.02us  726.04us  738.01us  volta_scudnn_128x128_stridedB_splitK_medium_nn_v1
                    0.01%  1.2843ms        16  80.271us  26.880us  137.34us  void fft1d_r2c_256&lt;float, float, float2, bool=1, bool=0&gt;(float2*, float const *, int3, int3, int2, int2)
                    0.01%  1.1635ms         6  193.91us  157.47us  355.00us  void kernelPointwiseApply2&lt;TensorMulOp&lt;float&gt;, float, float, unsigned int, int=1, int=2&gt;(OffsetInfo&lt;TensorMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.01%  1.1399ms         6  189.98us  154.72us  346.27us  void kernelPointwiseApply3&lt;TensorMulOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=2&gt;(OffsetInfo&lt;TensorMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.01%  955.12us       477  2.0020us  1.2470us  15.584us  cudnn::gemm::computeBOffsetsKernel(cudnn::gemm::ComputeBOffsetsParams)
                    0.01%  893.91us         2  446.96us  280.03us  613.88us  void cudnn::winograd::winograd3x3Kernel&lt;float, float, int=1, int=4, int=8, bool=1&gt;(cudnn::maxwell::winograd::KernelParams)
                    0.01%  841.37us       450  1.8690us  1.4400us  3.2000us  void kernelReduceAllPass2&lt;float, ReduceAdd&lt;float&gt;&gt;(int, float, float, float*, float*)
                    0.00%  708.83us       396  1.7890us  1.5040us  3.3280us  void kernelPointwiseApply1&lt;TensorAddConstantOp&lt;long&gt;, long, unsigned int, int=1&gt;(OffsetInfo&lt;TensorAddConstantOp&lt;long&gt;, long, unsigned int&gt;, long, long)
                    0.00%  634.23us        22  28.828us  12.672us  73.024us  void CatArrayBatchedCopy&lt;float, unsigned int, int=4&gt;(float*, CatArrInputTensor&lt;float, unsigned int&gt;*, OutputTensorSizeStride&lt;unsigned int, unsigned int=4&gt;, int, unsigned int)
                    0.00%  566.91us       249  2.2760us  1.5040us  15.488us  cudnn::gemm::computeWgradBOffsetsKernel(cudnn::gemm::ComputeBOffsetsParams)
                    0.00%  489.50us       249  1.9650us  1.7270us  2.4320us  cudnn::gemm::computeWgradSplitKOffsetsKernel(cudnn::gemm::ComputeOffsetsParams)
                    0.00%  292.00us        17  17.176us  12.671us  36.287us  void kernelPointwiseApply3&lt;TensorMulOp&lt;float&gt;, float, float, float, unsigned int, int=1, int=1, int=1&gt;(OffsetInfo&lt;TensorMulOp&lt;float&gt;, float, unsigned int&gt;, OffsetInfo&lt;float, float, int=1&gt;, OffsetInfo&lt;float, float, int=1&gt;, float, float)
                    0.00%  287.52us        21  13.691us  10.911us  30.784us  void caffe_gpu_interp2_kernel&lt;float, float&gt;(int, float, float, bool, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;)
                    0.00%  208.38us         6  34.730us  28.288us  59.967us  void caffe_gpu_interp2_kernel_backward&lt;float, float&gt;(int, float, float, bool, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;, THCDeviceTensor&lt;float, int=4, int, DefaultPtrTraits&gt;)
                    0.00%  178.81us        11  16.255us  13.920us  31.712us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::ReduceAgent&lt;thrust::cuda_cub::transform_pair_of_input_iterators_t&lt;float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, mse_functor&lt;float, float&gt;&gt;, float*, float, long, thrust::plus&lt;float&gt;&gt;, thrust::cuda_cub::transform_pair_of_input_iterators_t&lt;float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, mse_functor&lt;float, float&gt;&gt;, float*, long, thrust::cuda_cub::cub::GridEvenShare&lt;int&gt;, thrust::cuda_cub::cub::GridQueue&lt;int&gt;, thrust::plus&lt;float&gt;&gt;(float, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, float, float, mse_functor&lt;float, float&gt;)
                    0.00%  115.14us        11  10.466us  8.6080us  19.808us  void kernelPointwiseApply2&lt;TensorGTValueOp&lt;float, unsigned char&gt;, unsigned char, float, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;unsigned char, unsigned char, float&gt;, OffsetInfo&lt;TensorGTValueOp&lt;float, unsigned char&gt;, unsigned char, unsigned int&gt;, unsigned char, float)
                    0.00%  112.09us         6  18.682us  12.960us  36.095us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__parallel_for::ParallelForAgent&lt;thrust::cuda_cub::__transform::binary_transform_f&lt;thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor&lt;float, float&gt;, thrust::cuda_cub::__transform::always_true_predicate&gt;, long&gt;, thrust::cuda_cub::__transform::binary_transform_f&lt;thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;, thrust::cuda_cub::__transform::no_stencil_tag, mse_updateGradInput_functor&lt;float, float&gt;, thrust::cuda_cub::__transform::always_true_predicate&gt;, long&gt;(thrust::device_ptr&lt;float&gt;, thrust::device_ptr&lt;float&gt;)
                    0.00%  94.816us         8  11.852us  8.5440us  19.680us  void add_tensor_kernel_v3&lt;int=2, float, float, int=32, int=1, int=4, int=2, int=2&gt;(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, float, float)
                    0.00%  71.485us        11  6.4980us  4.9280us  20.256us  void kernelPointwiseApply2&lt;CopyOp&lt;float, unsigned char&gt;, float, unsigned char, unsigned int, int=1, int=1&gt;(OffsetInfo&lt;unsigned char, float, unsigned char&gt;, OffsetInfo&lt;CopyOp&lt;float, unsigned char&gt;, float, unsigned int&gt;, float, float)
                    0.00%  34.207us        11  3.1090us  2.8800us  3.2960us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::ReduceAgent&lt;float*, float*, float, long, thrust::plus&lt;float&gt;&gt;, float*, float*, int, thrust::plus&lt;float&gt;, float&gt;(float*, float, long, float, thrust::plus&lt;float&gt;)
                    0.00%  22.815us         6  3.8020us  3.3600us  4.4480us  generate_bernoulli(curandStateMtgp32*, int, float*, double)
                    0.00%  15.520us        11  1.4100us  1.3120us  1.6000us  void thrust::cuda_cub::core::_kernel_agent&lt;thrust::cuda_cub::__reduce::DrainAgent&lt;long&gt;, thrust::cuda_cub::cub::GridQueue&lt;int&gt;, long&gt;(thrust::cuda_cub::__reduce::DrainAgent&lt;long&gt;, int)
                    0.00%  8.6080us         6  1.4340us  1.3120us  1.6640us  void kernelPointwiseApply1&lt;TensorDivConstantOp&lt;float&gt;, float, unsigned int, int=1&gt;(OffsetInfo&lt;TensorDivConstantOp&lt;float&gt;, float, unsigned int&gt;, float, float)
      API calls:   63.22%  45.0299s      1712  26.303ms  6.5190us  5.45148s  cudaMalloc
                   16.84%  11.9928s      1262  9.5030ms  1.3110us  293.28ms  cudaFree
                   16.14%  11.4938s      1874  6.1333ms  38.585us  95.931ms  cudaEventSynchronize
                    1.37%  972.99ms      5013  194.09us  4.5600us  62.729ms  cudaMemcpyAsync
                    1.09%  779.26ms     55818  13.960us  4.8630us  26.852ms  cudaLaunch
                    0.33%  234.73ms      1463  160.44us  9.3780us  112.37ms  cudaMemcpy
                    0.25%  178.93ms      4736  37.780us  1.5650us  28.420ms  cudaStreamSynchronize
                    0.18%  125.49ms       358  350.54us  262.47us  2.1834ms  cudaMemGetInfo
                    0.14%  99.667ms    239130     416ns     230ns  609.20us  cudaGetDevice
                    0.13%  94.328ms    595356     158ns      94ns  1.1035ms  cudaSetupArgument
                    0.06%  46.065ms      3498  13.169us  2.9060us  594.98us  cudaMemsetAsync
                    0.06%  42.469ms     84834     500ns     266ns  486.87us  cudaSetDevice
                    0.06%  39.812ms     12387  3.2140us     412ns  69.673us  cudaEventRecord
                    0.04%  26.383ms      1874  14.078us  4.3100us  52.922us  cudaEventElapsedTime
                    0.02%  14.271ms     55818     255ns     104ns  618.39us  cudaConfigureCall
                    0.02%  13.144ms     65302     201ns      92ns  449.07us  cudaGetLastError
                    0.02%  10.923ms      2038  5.3590us  1.2520us  56.134us  cudaBindTexture
                    0.01%  10.194ms      9070  1.1230us     442ns  722.58us  cudaStreamWaitEvent
                    0.00%  3.2243ms         2  1.6121ms  1.5797ms  1.6446ms  cudaHostAlloc
                    0.00%  3.0296ms      2038  1.4860us     406ns  48.181us  cudaUnbindTexture
                    0.00%  2.8802ms       185  15.568us     122ns  672.67us  cuDeviceGetAttribute
                    0.00%  2.6442ms         2  1.3221ms  1.2133ms  1.4310ms  cudaGetDeviceProperties
                    0.00%  2.0135ms       766  2.6280us     524ns  21.274us  cudaEventCreateWithFlags
                    0.00%  1.6702ms       965  1.7300us     441ns  20.012us  cudaEventDestroy
                    0.00%  1.3971ms       228  6.1270us  1.4590us  52.132us  cudaEventCreate
                    0.00%  1.0185ms         2  509.26us  405.37us  613.15us  cuDeviceTotalMem
                    0.00%  600.79us         8  75.099us  34.834us  342.72us  cudaStreamCreateWithFlags
                    0.00%  372.71us         4  93.177us  35.671us  257.98us  cudaStreamCreateWithPriority
                    0.00%  297.13us         2  148.57us  104.88us  192.25us  cuDeviceGetName
                    0.00%  176.02us        28  6.2860us  2.1280us  29.668us  cudaFuncGetAttributes
                    0.00%  117.91us        21  5.6140us  4.6630us  7.5900us  cudaEventQuery
                    0.00%  86.113us       110     782ns     224ns  14.161us  cudaDeviceGetAttribute
                    0.00%  56.546us        32  1.7670us  1.2700us  4.1070us  cudaFuncSetAttribute
                    0.00%  39.138us        22  1.7790us     424ns  5.5350us  cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
                    0.00%  17.173us        78     220ns      95ns     503ns  cudaPeekAtLastError
                    0.00%  8.6080us        25     344ns      90ns  2.1930us  cudaGetDeviceCount
                    0.00%  3.2030us         1  3.2030us  3.2030us  3.2030us  cudaHostGetDevicePointer
                    0.00%  2.5900us         4     647ns     110ns  1.4870us  cuDeviceGetCount
                    0.00%  2.4550us         1  2.4550us  2.4550us  2.4550us  cuDriverGetVersion
                    0.00%  1.6560us         1  1.6560us  1.6560us  1.6560us  cuInit
                    0.00%  1.6440us         1  1.6440us  1.6440us  1.6440us  cudaDeviceGetStreamPriorityRange
                    0.00%  1.4930us         3     497ns     171ns     691ns  cuDeviceGet
&lt;/denchmark-code&gt;

CC &lt;denchmark-link:https://github.com/ngoyal2707&gt;@ngoyal2707&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/ngimel&gt;@ngimel&lt;/denchmark-link&gt;

&lt;denchmark-h:hr&gt;&lt;/denchmark-h&gt;

For Facebook people:
&lt;denchmark-link:https://fb.workplace.com/groups/1405155842844877/permalink/1111557699000808/&gt;https://fb.workplace.com/groups/1405155842844877/permalink/1111557699000808/&lt;/denchmark-link&gt;

	</description>
	<comments>
		<comment id='1' author='ezyang' date='2018-10-31T19:54:51Z'>
		Which cudnn version? Can you please collect API log for cudnn? &lt;denchmark-link:https://docs.nvidia.com/deeplearning/sdk/cudnn-developer-guide/index.html#api-logging&gt;https://docs.nvidia.com/deeplearning/sdk/cudnn-developer-guide/index.html#api-logging&lt;/denchmark-link&gt;

		</comment>
		<comment id='2' author='ezyang' date='2018-11-06T23:15:07Z'>
		Hey &lt;denchmark-link:https://github.com/ngimel&gt;@ngimel&lt;/denchmark-link&gt;
 , I have generated  cudnn API logs for both cases when  and  . What's the best way to share them with you, they are  and I can't upload here.
		</comment>
		<comment id='3' author='ezyang' date='2018-11-06T23:19:05Z'>
		If you have a short pytorch script reproducing the problem, that would be enough. Otherwise, upload logs to google drive?
		</comment>
		<comment id='4' author='ezyang' date='2018-11-06T23:51:34Z'>
		Perfect, have shared dropbox folder with you with the logs, let me know if you need something else.
		</comment>
		<comment id='5' author='ezyang' date='2019-04-05T18:15:06Z'>
		Update on our side is that we are investigating. I'll post more as soon as possible.
		</comment>
		<comment id='6' author='ezyang' date='2019-08-22T20:35:43Z'>
		&lt;denchmark-link:https://github.com/mruberry&gt;@mruberry&lt;/denchmark-link&gt;
 did anything come out of the investigation?
		</comment>
		<comment id='7' author='ezyang' date='2019-08-22T20:38:36Z'>
		&lt;denchmark-link:https://github.com/gchanan&gt;@gchanan&lt;/denchmark-link&gt;
 Not as of when I was last at NVIDIA. &lt;denchmark-link:https://github.com/csarofeen&gt;@csarofeen&lt;/denchmark-link&gt;
 should have the latest status.
		</comment>
		<comment id='8' author='ezyang' date='2019-08-26T17:24:30Z'>
		Sorry for the delayed response.
Since Natalia is not on our end any more, can I get the repro info again. &lt;denchmark-link:https://github.com/ngoyal2707&gt;@ngoyal2707&lt;/denchmark-link&gt;

		</comment>
		<comment id='9' author='ezyang' date='2019-08-26T19:56:57Z'>
		Many thanks to &lt;denchmark-link:https://github.com/ngimel&gt;@ngimel&lt;/denchmark-link&gt;
 on passing the information.
The issue has been fixed in cudnn 7.6.1 heuristics update. We should verify and close this one.
		</comment>
		<comment id='10' author='ezyang' date='2019-12-05T17:23:26Z'>
		&lt;denchmark-link:https://github.com/mruberry&gt;@mruberry&lt;/denchmark-link&gt;
 Do you want to verify this is fixed post 7.6.1?
		</comment>
		<comment id='11' author='ezyang' date='2019-12-05T18:12:12Z'>
		I'm not familiar with the issues &lt;denchmark-link:https://github.com/ezyang&gt;@ezyang&lt;/denchmark-link&gt;
 originally cited. &lt;denchmark-link:https://github.com/ezyang&gt;@ezyang&lt;/denchmark-link&gt;
, do you want to ping me?
		</comment>
		<comment id='12' author='ezyang' date='2019-12-05T21:32:31Z'>
		This is pretty old. I'm OK with just calling it fixed and someone file a new bug if there's still problems.
		</comment>
		<comment id='13' author='ezyang' date='2019-12-05T22:28:21Z'>
		Will reopen if this reappears.
		</comment>
	</comments>
</bug>