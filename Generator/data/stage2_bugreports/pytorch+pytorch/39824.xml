<bug id='39824' author='tgoldina' open_date='2020-06-10T23:04:39Z' closed_time='2020-06-16T16:11:06Z'>
	<summary>SegFault on torch.nn.functional.conv2d on MacOS Catalina</summary>
	<description>
&lt;denchmark-h:h2&gt;üêõ Bug&lt;/denchmark-h&gt;

torch.nn.functional.conv2d produces a segmentation fault when using float32 data type and large enough padding
&lt;denchmark-h:h2&gt;To Reproduce&lt;/denchmark-h&gt;

Steps to reproduce the behavior:
&lt;denchmark-code&gt;import numpy as np
import torch
img = np.zeros((2048,2048),dtype=np.float32)
img[500,300] = 1.0
psf_half = 25
conv_size = 2*psf_half+1
psf = np.ones((conv_size,conv_size), dtype = np.float32)

weights_t = torch.tensor(psf[np.newaxis,np.newaxis,:,:]) #Numpy to tensor
img_t = torch.tensor(img[np.newaxis,np.newaxis,:,:]) # batch size 1, 1 channel -- 1 color
img_conv_pytorch = torch.nn.functional.conv2d(img_t, weights_t, padding=psf_half)
&lt;/denchmark-code&gt;

Process:               python3.7 [29737]
Path:                  /Users/USER/*/python3.7
Identifier:            python3.7
Version:               ???
Code Type:             X86-64 (Native)
Parent Process:        bash [18756]
Responsible:           Terminal [1449]
Date/Time:             2020-06-10 15:57:17.206 -0700
OS Version:            Mac OS X 10.15.5 (19F101)
Report Version:        12
Bridge OS Version:     4.5 (17P5300)
Time Awake Since Boot: 100000 seconds
Time Since Wake:       18000 seconds
System Integrity Protection: enabled
Crashed Thread:        0  Dispatch queue: com.apple.main-thread
Exception Type:        EXC_BAD_ACCESS (SIGSEGV)
Exception Codes:       KERN_INVALID_ADDRESS at 0x00007fc1cdc00000
Exception Note:        EXC_CORPSE_NOTIFY
Termination Signal:    Segmentation fault: 11
Termination Reason:    Namespace SIGNAL, Code 0xb
Terminating Process:   exc handler [29737]
VM Regions Near 0x7fc1cdc00000:
__LINKEDIT             0000000118b6f000-000000011a040000 [ 20.8M] r--/rwx SM=COW  /Users/USER//.dylib
--&gt;
MALLOC_LARGE           00007fc3cdc00000-00007fc3d5c00000 [128.0M] rw-/rwx SM=PRV
Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
0   libsystem_platform.dylib      	0x00007fff68ceedd5 _platform_bzero$VARIANT$Haswell + 53
1   libtorch_cpu.dylib            	0x000000011781f204 void mkldnn::impl::cpu::jit_gemm_convolution_utils::im2col(mkldnn::impl::cpu::jit_gemm_conv_conf_t const&amp;, float const*, float*, int, int, int, int) + 1588
2   libtorch_cpu.dylib            	0x000000011781da45 mkldnn::impl::cpu::gemm_convolution_fwd_t::execute_forward() const::$_0::operator()(int, int) const::'lambda'(int, mkldnn::impl::cpu::(anonymous namespace)::im_pos_t const&amp;, mkldnn::impl::cpu::(anonymous namespace)::im_pos_t&amp;, mkldnn::impl::cpu::(anonymous namespace)::im_pos_t&amp;, mkldnn::impl::cpu::(anonymous namespace)::im_pos_t const&amp;)::operator()(int, mkldnn::impl::cpu::(anonymous namespace)::im_pos_t const&amp;, mkldnn::impl::cpu::(anonymous namespace)::im_pos_t&amp;, mkldnn::impl::cpu::(anonymous namespace)::im_pos_t&amp;, mkldnn::impl::cpu::(anonymous namespace)::im_pos_t const&amp;) const + 341
3   libtorch_cpu.dylib            	0x000000011781c3eb mkldnn::impl::cpu::gemm_convolution_fwd_t::execute_forward() const + 1627
4   libtorch_cpu.dylib            	0x0000000116fb847c mkldnn::impl::cpu::gemm_convolution_fwd_t::execute(mkldnn::impl::event_t*) const + 28
5   libtorch_cpu.dylib            	0x0000000116f55855 mkldnn::impl::cpu::cpu_engine_t::submit(mkldnn_primitive*, mkldnn::impl::event_t*, mkldnn::impl::nstl::vectormkldnn::impl::event_t*&amp;) + 117
6   libtorch_cpu.dylib            	0x0000000116efbbc5 mkldnn::impl::stream_eager_t::submit_impl(unsigned long, unsigned long, mkldnn_primitive**) + 757
7   libtorch_cpu.dylib            	0x0000000116efb2a2 mkldnn_stream::submit(mkldnn::impl::nstl::vector&lt;mkldnn_primitive*&gt; const&amp;, mkldnn_primitive**) + 274
8   libtorch_cpu.dylib            	0x0000000116efb647 mkldnn_stream_submit + 167
9   libtorch_cpu.dylib            	0x0000000113e0292a ideep::primitive_group::execute(ideep::stream&amp;) + 74
10  libtorch_cpu.dylib            	0x0000000113e2830f void ideep::computation::execute&lt;ideep::tensor, ideep::tensor&gt;(ideep::tensor const&amp;, ideep::tensor const&amp;, ideep::tensor const&amp;) + 95
11  libtorch_cpu.dylib            	0x0000000113e267da void ideep::convolution_forward::compute_impl&lt;at::native::AllocForMKLDNN, false, mkldnn::algorithm&amp;, mkldnn::prop_kind&amp;, mkldnn::padding_kind&amp;&gt;(std::__1::basic_string&lt;char, std::__1::char_traits, std::__1::allocator &gt;&amp;, ideep::tensor const&amp;, ideep::tensor const&amp;, ideep::tensor const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, ideep::tensor&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;float, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;float, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;float, std::__1::allocator &gt; const&amp;, ideep::descriptor_group::attr_t const&amp;, ideep::lowp_kind, mkldnn::algorithm&amp;, mkldnn::prop_kind&amp;, mkldnn::padding_kind&amp;) + 4954
12  libtorch_cpu.dylib            	0x0000000113e24a59 void ideep::convolution_forward::compute&lt;at::native::AllocForMKLDNN, false&gt;(std::__1::basic_string&lt;char, std::__1::char_traits, std::__1::allocator &gt;&amp;, ideep::tensor const&amp;, ideep::tensor const&amp;, ideep::tensor const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, ideep::tensor&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, int, std::__1::vector&lt;float, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;float, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;float, std::__1::allocator &gt; const&amp;, ideep::descriptor_group::attr_t const&amp;, mkldnn::algorithm, mkldnn::prop_kind, mkldnn::padding_kind, ideep::lowp_kind) + 1113
13  libtorch_cpu.dylib            	0x0000000113e245bd void ideep::convolution_forward::compute&lt;at::native::AllocForMKLDNN, false&gt;(ideep::tensor const&amp;, ideep::tensor const&amp;, ideep::tensor const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, ideep::tensor&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, int, ideep::descriptor_group::attr_t const&amp;, mkldnn::algorithm, mkldnn::prop_kind, mkldnn::padding_kind) + 349
14  libtorch_cpu.dylib            	0x0000000113e0d833 void ideep::convolution_forward::computeat::native::AllocForMKLDNN(ideep::tensor const&amp;, ideep::tensor const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, ideep::tensor&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::__1::allocator &gt; const&amp;, std::__1::vector&lt;int, std::1::allocator &gt; const&amp;, std::1::vector&lt;int, std::1::allocator &gt; const&amp;, int, ideep::descriptor_group::attr_t const&amp;, mkldnn::algorithm, mkldnn::prop_kind, mkldnn::padding_kind) + 243
15  libtorch_cpu.dylib            	0x0000000113e0cd67 at::native::mkldnn_conv2d(ideep::tensor const&amp;, ideep::tensor const&amp;, c10::optionalideep::tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 5911
16  libtorch_cpu.dylib            	0x0000000113e0e09f at::native::mkldnn_convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 1903
17  libtorch_cpu.dylib            	0x0000000113fac248 at::TypeDefault::mkldnn_convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 296
18  libtorch_cpu.dylib            	0x0000000114007c15 c10::detail::wrap_kernel_functor_unboxed&lt;c10::detail::WrapRuntimeKernelFunctor&lt;at::Tensor ()(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long), at::Tensor, c10::guts::typelist::typelist&lt;at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long&gt; &gt;, at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long)&gt;::call(c10::OperatorKernel, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 85
19  libtorch_cpu.dylib            	0x000000011393dea3 at::Tensor c10::OperatorHandle::callUnboxed&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long&gt;(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) const + 515
20  libtorch_cpu.dylib            	0x0000000115cc143a torch::autograd::VariableType::mkldnn_convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 4506
21  libtorch_cpu.dylib            	0x0000000114007c15 c10::detail::wrap_kernel_functor_unboxed&lt;c10::detail::WrapRuntimeKernelFunctor&lt;at::Tensor ()(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long), at::Tensor, c10::guts::typelist::typelist&lt;at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long&gt; &gt;, at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long)&gt;::call(c10::OperatorKernel, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 85
22  libtorch_cpu.dylib            	0x000000011393dea3 at::Tensor c10::OperatorHandle::callUnboxed&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long&gt;(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) const + 515
23  libtorch_cpu.dylib            	0x000000011392ac38 at::native::convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool) + 19400
24  libtorch_cpu.dylib            	0x0000000113f98e31 at::TypeDefault::convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool) + 401
25  libtorch_cpu.dylib            	0x0000000115d67274 torch::autograd::VariableType::convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool) + 1668
26  libtorch_cpu.dylib            	0x00000001140072ef c10::detail::wrap_kernel_functor_unboxed&lt;c10::detail::WrapRuntimeKernelFunctor&lt;at::Tensor ()(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool), at::Tensor, c10::guts::typelist::typelist&lt;at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool&gt; &gt;, at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool)&gt;::call(c10::OperatorKernel, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool) + 159
27  libtorch_cpu.dylib            	0x0000000113939140 at::Tensor c10::OperatorHandle::callUnboxed&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool&gt;(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long, bool, bool, bool) const + 640
28  libtorch_cpu.dylib            	0x0000000113925dd5 at::native::convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long) + 341
29  libtorch_cpu.dylib            	0x0000000113f982bb at::TypeDefault::convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long) + 347
30  libtorch_cpu.dylib            	0x0000000115d9c975 torch::autograd::VariableType::convolution(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long) + 1141
31  libtorch_cpu.dylib            	0x0000000114006cc5 c10::detail::wrap_kernel_functor_unboxed&lt;c10::detail::WrapRuntimeKernelFunctor&lt;at::Tensor ()(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long), at::Tensor, c10::guts::typelist::typelist&lt;at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long&gt; &gt;, at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long)&gt;::call(c10::OperatorKernel, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long) + 117
32  libtorch_cpu.dylib            	0x00000001139388c2 at::Tensor c10::OperatorHandle::callUnboxed&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long&gt;(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, bool, c10::ArrayRef, long long) const + 610
33  libtorch_cpu.dylib            	0x0000000113925709 at::native::conv2d(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 281
34  libtorch_cpu.dylib            	0x0000000113f99d58 at::TypeDefault::conv2d(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 296
35  libtorch_cpu.dylib            	0x0000000115fe02f6 torch::autograd::VariableType::conv2d(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 1110
36  libtorch_cpu.dylib            	0x0000000114007c15 c10::detail::wrap_kernel_functor_unboxed&lt;c10::detail::WrapRuntimeKernelFunctor&lt;at::Tensor ()(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long), at::Tensor, c10::guts::typelist::typelist&lt;at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long&gt; &gt;, at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long)&gt;::call(c10::OperatorKernel, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) + 85
37  libtorch_python.dylib         	0x0000000112b5b113 at::Tensor c10::OperatorHandle::callUnboxed&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long&gt;(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor const&amp;, c10::ArrayRef, c10::ArrayRef, c10::ArrayRef, long long) const + 515
38  libtorch_python.dylib         	0x00000001129aad9d torch::autograd::THPVariable_conv2d(_object*, _object*, _object*) + 1149
39  python                        	0x00000001045dc5e2 _PyMethodDef_RawFastCallKeywords + 642
40  python                        	0x0000000104718ce2 call_function + 306
41  python                        	0x0000000104716a7e _PyEval_EvalFrameDefault + 46334
42  python                        	0x000000010470a34a _PyEval_EvalCodeWithName + 410
43  python                        	0x000000010476db80 PyRun_FileExFlags + 256
44  python                        	0x000000010476cff7 PyRun_SimpleFileExFlags + 391
45  python                        	0x000000010479accf pymain_main + 9711
46  python                        	0x00000001045ae8dd main + 125
47  libdyld.dylib                 	0x00007fff68af8cc9 start + 1
Thread 0 crashed with X86 Thread State (64-bit):
rax: 0x00007fc1cdc00000  rbx: 0x0000000000000000  rcx: 0x0000000000000000  rdx: 0x0000000000002000
rdi: 0x00007fc1cdc00000  rsi: 0x0000000000000000  rbp: 0x00007ffeeb64ead0  rsp: 0x00007ffeeb64ead0
r8: 0x0000000000000000   r9: 0x0000000000000000  r10: 0x0000000000002000  r11: 0x0000000000000019
r12: 0x0000000000000817  r13: 0x0000000000000000  r14: 0x0000000000000017  r15: 0x00007fce07fe1fa8
rip: 0x00007fff68ceedd5  rfl: 0x0000000000010287  cr2: 0x00007fc1cdc00000
Logical CPU:     4
Error Code:      0x00000006 (no mapping for user data write)
Trap Number:     14
Binary Images:
0x1045ad000 -        0x10487dfff +python (0) &lt;6630A34D-C116-3833-B8E2-4D959EF186AA&gt; /Users/USER//python
0x1049f1000 -        0x1049f2fff +_heapq.cpython-37m-darwin.so (0)  /Users/USER//_heapq.cpython-37m-darwin.so
0x1049f6000 -        0x104d76fff +_multiarray_umath.cpython-37m-darwin.so (0)  /Users/USER//_multiarray_umath.cpython-37m-darwin.so
0x104df8000 -        0x105561fff +libmkl_rt.dylib (0) &lt;78FA54FD-7231-3ADF-A277-CB558D1C4F2B&gt; /Users/USER//libmkl_rt.dylib
0x1057e7000 -        0x1057edffb +math.cpython-37m-darwin.so (0) &lt;75CB4ABF-9838-389C-8455-02C9D9D7E531&gt; /Users/USER//math.cpython-37m-darwin.so
0x1057f4000 -        0x105803ffb +_datetime.cpython-37m-darwin.so (0) &lt;7FEAB1BD-9583-3338-B423-8574AFB0E9EA&gt; /Users/USER//_datetime.cpython-37m-darwin.so
0x10580f000 -        0x105814fff +_struct.cpython-37m-darwin.so (0) &lt;38F3144D-00EE-33FA-B0B6-147F09DB901D&gt; /Users/USER//_struct.cpython-37m-darwin.so
0x10581d000 -        0x105833ffb +_pickle.cpython-37m-darwin.so (0) &lt;5365127A-52F5-356B-B637-D6F2E350A813&gt; /Users/USER//_pickle.cpython-37m-darwin.so
0x10583f000 -        0x10584cffb +_multiarray_tests.cpython-37m-darwin.so (0)  /Users/USER//_multiarray_tests.cpython-37m-darwin.so
0x105856000 -        0x105868fff +_ctypes.cpython-37m-darwin.so (0) &lt;66269FD6-56F9-32A5-8A25-F986023901A1&gt; /Users/USER//_ctypes.cpython-37m-darwin.so
0x105878000 -        0x10587dff7 +libffi.6.dylib (0) &lt;22D0AE69-2280-39F6-A06F-481E4164E735&gt; /Users/USER//libffi.6.dylib
0x105882000 -        0x105883fff +_posixsubprocess.cpython-37m-darwin.so (0)  /Users/USER//_posixsubprocess.cpython-37m-darwin.so
0x105887000 -        0x10588aff3 +select.cpython-37m-darwin.so (0)  /Users/USER//select.cpython-37m-darwin.so
0x105890000 -        0x105892ffb +lapack_lite.cpython-37m-darwin.so (0) &lt;2B351101-9D99-3D75-89A0-89D447FBB115&gt; /Users/USER//lapack_lite.cpython-37m-darwin.so
0x105895000 -        0x1058affff +_umath_linalg.cpython-37m-darwin.so (0) &lt;93FC4270-5AE1-33E9-ADA4-E450E6E36B26&gt; /Users/USER//_umath_linalg.cpython-37m-darwin.so
0x1058b7000 -        0x1058bbfff +zlib.cpython-37m-darwin.so (0) &lt;19EDEF28-0886-3049-8319-638A2C219C2F&gt; /Users/USER//zlib.cpython-37m-darwin.so
0x1058c1000 -        0x1058d6fff +libz.1.2.11.dylib (0)  /Users/USER//libz.1.2.11.dylib
0x1058da000 -        0x1058ecfff +_bz2.cpython-37m-darwin.so (0)  /Users/USER//_bz2.cpython-37m-darwin.so
0x1058f2000 -        0x1058f6ffb +_lzma.cpython-37m-darwin.so (0)  /Users/USER//_lzma.cpython-37m-darwin.so
0x1058fc000 -        0x10591cff7 +liblzma.5.dylib (0) &lt;80299D86-7CB4-3EE8-9193-AD9027F0CD27&gt; /Users/USER//liblzma.5.dylib
0x105922000 -        0x105923fff +grp.cpython-37m-darwin.so (0)  /Users/USER//grp.cpython-37m-darwin.so
0x105926000 -        0x10596dff7 +_decimal.cpython-37m-darwin.so (0)  /Users/USER//_decimal.cpython-37m-darwin.so
0x105985000 -        0x105995ff7 +_pocketfft_internal.cpython-37m-darwin.so (0)  /Users/USER//_pocketfft_internal.cpython-37m-darwin.so
0x105998000 -        0x1059fcfff +mtrand.cpython-37m-darwin.so (0)  /Users/USER//mtrand.cpython-37m-darwin.so
0x105a3b000 -        0x105a57ff7 +_bit_generator.cpython-37m-darwin.so (0) &lt;1B0312B8-BE47-3596-B241-2C5D69D4F98C&gt; /Users/USER//_bit_generator.cpython-37m-darwin.so
0x105a69000 -        0x105a94fff +_common.cpython-37m-darwin.so (0)  /Users/USER//_common.cpython-37m-darwin.so
0x105aa2000 -        0x105aa6ff7 +binascii.cpython-37m-darwin.so (0) &lt;7642ACCF-2EE8-3470-9567-13051891E3C2&gt; /Users/USER//binascii.cpython-37m-darwin.so
0x105aaa000 -        0x105aadfff +_hashlib.cpython-37m-darwin.so (0)  /Users/USER//_hashlib.cpython-37m-darwin.so
0x105ab2000 -        0x105c9487b +libcrypto.1.1.dylib (0) &lt;6F5DB370-615A-3737-AA60-8D6B3B27C397&gt; /Users/USER//libcrypto.1.1.dylib
0x105d24000 -        0x105d2aff3 +_blake2.cpython-37m-darwin.so (0) &lt;77B9D30A-C343-32CC-AB8A-8A80C57D2E83&gt; /Users/USER//_blake2.cpython-37m-darwin.so
0x105d2f000 -        0x105d40ffb +_sha3.cpython-37m-darwin.so (0)  /Users/USER//_sha3.cpython-37m-darwin.so
0x105d46000 -        0x105d47fff +_bisect.cpython-37m-darwin.so (0) &lt;25F1D157-8D0A-3D95-B44E-78BED32972E8&gt; /Users/USER//_bisect.cpython-37m-darwin.so
0x105d4a000 -        0x105d4bffb +_random.cpython-37m-darwin.so (0)  /Users/USER//_random.cpython-37m-darwin.so
0x105d4e000 -        0x105d96ff7 +_bounded_integers.cpython-37m-darwin.so (0)  /Users/USER//_bounded_integers.cpython-37m-darwin.so
0x105da9000 -        0x105dbbfff +_mt19937.cpython-37m-darwin.so (0) &lt;95E043AD-1220-39DA-A824-11634D3AD42A&gt; /Users/USER//_mt19937.cpython-37m-darwin.so
0x105dc3000 -        0x105dcfff7 +_philox.cpython-37m-darwin.so (0)  /Users/USER//_philox.cpython-37m-darwin.so
0x105dd7000 -        0x105de1ffb +_pcg64.cpython-37m-darwin.so (0) &lt;19AF15EC-5ABE-35CF-8C31-218503229139&gt; /Users/USER//_pcg64.cpython-37m-darwin.so
0x105de9000 -        0x105df0fff +_sfc64.cpython-37m-darwin.so (0) &lt;030EC799-C361-3150-8F88-E50808172991&gt; /Users/USER//_sfc64.cpython-37m-darwin.so
0x105df7000 -        0x105e6ffff +_generator.cpython-37m-darwin.so (0)  /Users/USER//_generator.cpython-37m-darwin.so
0x105eaf000 -        0x109c3ff37 +libmkl_core.dylib (0) &lt;4E843307-4D4A-3350-873E-2F7A7E48C9AB&gt; /Users/USER//libmkl_core.dylib
0x10a0ee000 -        0x10a165ff7 +libomp.dylib (0) &lt;48576612-0C13-38C2-A665-5DB381336002&gt; /Users/USER//libomp.dylib
0x10a197000 -        0x10c65dff7 +libmkl_intel_thread.dylib (0) &lt;7EBCB280-00B2-38D3-B676-1D1F675881B3&gt; /Users/USER//libmkl_intel_thread.dylib
0x10cf0a000 -        0x10e1dafe7 +libmkl_intel_lp64.dylib (0)  /Users/USER//libmkl_intel_lp64.dylib
0x10e432000 -        0x111039f3f +libmkl_avx2.dylib (0) &lt;4BC97CFD-F080-39FC-B7BA-26AC6974AC12&gt; /Users/USER//libmkl_avx2.dylib
0x11120c000 -        0x111d64fd7 +libmkl_vml_avx2.dylib (0)  /Users/USER//libmkl_vml_avx2.dylib
0x111df5000 -        0x111df5ffb +_opcode.cpython-37m-darwin.so (0) &lt;26EEED10-A7E5-3B30-B8F3-BEC98DEE9107&gt; /Users/USER//_opcode.cpython-37m-darwin.so
0x111df8000 -        0x111df9fff +_queue.cpython-37m-darwin.so (0)  /Users/USER//_queue.cpython-37m-darwin.so
0x111dfd000 -        0x111dfefff +libtorch_global_deps.dylib (0) &lt;3C1D0FD7-170E-372E-AEC8-457C24835F83&gt; /Users/USER//libtorch_global_deps.dylib
0x111e00000 -        0x111e00ff3 +_C.cpython-37m-darwin.so (0) &lt;814AA3A4-00D1-395C-A858-B25E69B8EBAA&gt; /Users/USER//_C.cpython-37m-darwin.so
0x111e03000 -        0x111e0bff7 +libshm.dylib (0) &lt;9634A57B-36C3-3DCB-BE8A-835A7181C9B3&gt; /Users/USER//libshm.dylib
0x111e12000 -        0x111e8fffb +libc++.1.0.dylib (0) &lt;6518E2D6-4A37-31D8-9F94-4D27E233BC17&gt; /Users/USER//libc++.1.0.dylib
0x111ee0000 -        0x111ee2fff +libtorch.dylib (0) &lt;0E7290FB-4FCD-3112-98A7-71ECD75E5BBE&gt; /Users/USER//libtorch.dylib
0x111ee4000 -        0x111f0dff3 +libc10.dylib (0) &lt;4249E685-5A4B-30AA-B799-ED20624890CC&gt; /Users/USER//libc10.dylib
0x11202a000 -        0x112034ff7 +_socket.cpython-37m-darwin.so (0) &lt;6E3DEB39-8A1E-37A7-879B-AA5AB211295C&gt; /Users/USER//_socket.cpython-37m-darwin.so
0x112041000 -        0x112047ff7 +array.cpython-37m-darwin.so (0)  /Users/USER//array.cpython-37m-darwin.so
0x112051000 -        0x112052ff3 +_multiprocessing.cpython-37m-darwin.so (0) &lt;201AE99F-9963-3E26-86B7-38F6ACBF52F2&gt; /Users/USER//_multiprocessing.cpython-37m-darwin.so
0x112056000 -        0x112065ff7 +_ssl.cpython-37m-darwin.so (0) &lt;1204F417-1154-3878-AE0F-D1791F8BEF63&gt; /Users/USER//_ssl.cpython-37m-darwin.so
0x112076000 -        0x1120d1ffb +libssl.1.1.dylib (0) &lt;6853C101-B387-3DDF-9187-15267B90B292&gt; /Users/USER//libssl.1.1.dylib
0x1120fa000 -        0x1120fbffb +_scproxy.cpython-37m-darwin.so (0)  /Users/USER//_scproxy.cpython-37m-darwin.so
0x11263b000 -        0x1126cceff  dyld (750.5)  /usr/lib/dyld
0x112740000 -        0x1133eeff3 +libtorch_python.dylib (0) &lt;0E64262E-9CE3-3710-9EB7-20715BB8C9BB&gt; /Users/USER//libtorch_python.dylib
0x1137cb000 -        0x1189faff7 +libtorch_cpu.dylib (0) &lt;906425F3-C65E-3EF0-9852-461F65E97752&gt; /Users/USER/*/libtorch_cpu.dylib
0x7fff2a89e000 -     0x7fff2a89efff  com.apple.Accelerate (1.11 - Accelerate 1.11) &lt;56DFF715-6A4E-3231-BDCC-A348BCB05047&gt; /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate
0x7fff2a8b6000 -     0x7fff2af0cfff  com.apple.vImage (8.1 - 524.2.1) &lt;17C93AB9-1625-3FDB-9851-C5E77BBE3428&gt; /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage
0x7fff2af0d000 -     0x7fff2b174ff7  libBLAS.dylib (1303.60.1)  /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
0x7fff2b175000 -     0x7fff2b648fef  libBNNS.dylib (144.100.2) &lt;8D653678-1F9B-3670-AAE2-46DFB8D37643&gt; /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBNNS.dylib
0x7fff2b649000 -     0x7fff2b9e4fff  libLAPACK.dylib (1303.60.1)  /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib
0x7fff2b9e5000 -     0x7fff2b9fafec  libLinearAlgebra.dylib (1303.60.1)  /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLinearAlgebra.dylib
0x7fff2b9fb000 -     0x7fff2ba00ff3  libQuadrature.dylib (7) &lt;3112C977-8306-3190-8313-01A952B7F3CF&gt; /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libQuadrature.dylib
0x7fff2ba01000 -     0x7fff2ba71fff  libSparse.dylib (103) &lt;40510BF9-99A7-3155-A81D-6DE5A0C73EDC&gt; /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libSparse.dylib
0x7fff2ba72000 -     0x7fff2ba84fef  libSparseBLAS.dylib (1303.60.1) &lt;3C1066AB-20D5-38D2-B1F2-70A03DE76D0B&gt; /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libSparseBLAS.dylib
0x7fff2ba85000 -     0x7fff2bc5cfd7  libvDSP.dylib (735.121.1) &lt;74702E2E-ED05-3765-B18C-64BEFF62B517&gt; /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib
0x7fff2bc5d000 -     0x7fff2bd1ffef  libvMisc.dylib (735.121.1) &lt;137558BF-503D-3A6E-96DC-A181E3FB31FF&gt; /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib
0x7fff2bd20000 -     0x7fff2bd20fff  com.apple.Accelerate.vecLib (3.11 - vecLib 3.11)  /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib
0x7fff2d485000 -     0x7fff2d813ffd  com.apple.CFNetwork (1126 - 1126)  /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork
0x7fff2ec13000 -     0x7fff2f092ffb  com.apple.CoreFoundation (6.9 - 1676.105) &lt;6AF8B3CC-BC3F-3869-B9FB-1D881422364E&gt; /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation
0x7fff2fffa000 -     0x7fff2fffafff  com.apple.CoreServices (1069.24 - 1069.24)  /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices
0x7fff2fffb000 -     0x7fff30080fff  com.apple.AE (838.1 - 838.1) &lt;5F26DA9B-FB2E-3AF8-964B-63BD6671CF12&gt; /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE
0x7fff30081000 -     0x7fff30362ff7  com.apple.CoreServices.CarbonCore (1217 - 1217) &lt;8022AF47-AA99-3786-B086-141D84F00387&gt; /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore
0x7fff30363000 -     0x7fff303b0ffd  com.apple.DictionaryServices (1.2 - 323.6)  /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices
0x7fff303b1000 -     0x7fff303b9ff7  com.apple.CoreServices.FSEvents (1268.100.1 - 1268.100.1)  /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/FSEvents.framework/Versions/A/FSEvents
0x7fff303ba000 -     0x7fff305f4ff6  com.apple.LaunchServices (1069.24 - 1069.24) &lt;2E0AD228-B1CC-3645-91EE-EB7F46F2147B&gt; /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices
0x7fff305f5000 -     0x7fff3068dff1  com.apple.Metadata (10.7.0 - 2076.6)  /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata
0x7fff3068e000 -     0x7fff306bbfff  com.apple.CoreServices.OSServices (1069.24 - 1069.24) &lt;72FDEA52-7607-3745-AC43-630D80962099&gt; /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices
0x7fff306bc000 -     0x7fff30723fff  com.apple.SearchKit (1.4.1 - 1.4.1) &lt;086EB5DF-A2EC-3342-8028-CA7996BE5CB2&gt; /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit
0x7fff30724000 -     0x7fff30748ff5  com.apple.coreservices.SharedFileList (131.4 - 131.4)  /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SharedFileList.framework/Versions/A/SharedFileList
0x7fff30f8e000 -     0x7fff30f94fff  com.apple.DiskArbitration (2.7 - 2.7) &lt;52E7D181-2A18-37CD-B24F-AA32E93F7A69&gt; /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration
0x7fff312cd000 -     0x7fff31692fff  com.apple.Foundation (6.9 - 1676.105) &lt;1FA28BAB-7296-3A09-8E1E-E62A7D233DB8&gt; /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
0x7fff31a06000 -     0x7fff31aaaff3  com.apple.framework.IOKit (2.0.2 - 1726.121.1)  /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit
0x7fff355ab000 -     0x7fff355b7ffe  com.apple.NetFS (6.0 - 4.0)  /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS
0x7fff38199000 -     0x7fff381b5fff  com.apple.CFOpenDirectory (10.15 - 220.40.1)  /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory
0x7fff381b6000 -     0x7fff381c1ffd  com.apple.OpenDirectory (10.15 - 220.40.1) &lt;76A20BBA-775F-3E17-AB0F-FEDFCDCE0716&gt; /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory
0x7fff3b55b000 -     0x7fff3b8a4ff1  com.apple.security (7.0 - 59306.120.7)  /System/Library/Frameworks/Security.framework/Versions/A/Security
0x7fff3b8a5000 -     0x7fff3b92dffb  com.apple.securityfoundation (6.0 - 55236.60.1) &lt;79289FE1-CB5F-3BEF-A33F-11A29A93A681&gt; /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation
0x7fff3b95c000 -     0x7fff3b960ff8  com.apple.xpc.ServiceManagement (1.0 - 1) &lt;4194D29D-F0D4-33F8-839A-D03C6C62D8DB&gt; /System/Library/Frameworks/ServiceManagement.framework/Versions/A/ServiceManagement
0x7fff3c60c000 -     0x7fff3c67aff7  com.apple.SystemConfiguration (1.19 - 1.19) &lt;0CF8726A-BE41-3E07-B895-FBC44B75450E&gt; /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration
0x7fff405db000 -     0x7fff406a0ff7  com.apple.APFS (1412.120.2 - 1412.120.2) &lt;1E8FD511-FDC4-31A2-ACDE-EB5192032BC6&gt; /System/Library/PrivateFrameworks/APFS.framework/Versions/A/APFS
0x7fff423a5000 -     0x7fff423b4fd7  com.apple.AppleFSCompression (119.100.1 - 1.0) &lt;2E75CF51-B693-3275-9A4F-40571D48745E&gt; /System/Library/PrivateFrameworks/AppleFSCompression.framework/Versions/A/AppleFSCompression
0x7fff43b74000 -     0x7fff43b7dff7  com.apple.coreservices.BackgroundTaskManagement (1.0 - 104)  /System/Library/PrivateFrameworks/BackgroundTaskManagement.framework/Versions/A/BackgroundTaskManagement
0x7fff4697a000 -     0x7fff4698aff3  com.apple.CoreEmoji (1.0 - 107.1)  /System/Library/PrivateFrameworks/CoreEmoji.framework/Versions/A/CoreEmoji
0x7fff46fca000 -     0x7fff47034ff0  com.apple.CoreNLP (1.0 - 213) &lt;40FC46D2-844C-3282-A8E4-69DD827F05C5&gt; /System/Library/PrivateFrameworks/CoreNLP.framework/Versions/A/CoreNLP
0x7fff47eaf000 -     0x7fff47eddffd  com.apple.CSStore (1069.24 - 1069.24)  /System/Library/PrivateFrameworks/CoreServicesStore.framework/Versions/A/CoreServicesStore
0x7fff54127000 -     0x7fff541f5ffd  com.apple.LanguageModeling (1.0 - 215.1)  /System/Library/PrivateFrameworks/LanguageModeling.framework/Versions/A/LanguageModeling
0x7fff541f6000 -     0x7fff5423efff  com.apple.Lexicon-framework (1.0 - 72) &lt;6AE1872C-0352-36FE-90CC-7303F13A5BEF&gt; /System/Library/PrivateFrameworks/Lexicon.framework/Versions/A/Lexicon
0x7fff54245000 -     0x7fff5424aff3  com.apple.LinguisticData (1.0 - 353.18) &lt;686E7B7C-640F-3D7B-A9C1-31E2DFACD457&gt; /System/Library/PrivateFrameworks/LinguisticData.framework/Versions/A/LinguisticData
0x7fff555b1000 -     0x7fff555fdfff  com.apple.spotlight.metadata.utilities (1.0 - 2076.6)  /System/Library/PrivateFrameworks/MetadataUtilities.framework/Versions/A/MetadataUtilities
0x7fff560b4000 -     0x7fff560befff  com.apple.NetAuth (6.2 - 6.2)  /System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth
0x7fff5f339000 -     0x7fff5f349ff3  com.apple.TCC (1.0 - 1)  /System/Library/PrivateFrameworks/TCC.framework/Versions/A/TCC
0x7fff62a1b000 -     0x7fff62a1dff3  com.apple.loginsupport (1.0 - 1) &lt;31F02734-1ECF-37D9-9DF6-7C3BC3A324FE&gt; /System/Library/PrivateFrameworks/login.framework/Versions/A/Frameworks/loginsupport.framework/Versions/A/loginsupport
0x7fff6553b000 -     0x7fff6556ffff  libCRFSuite.dylib (48) &lt;02C52318-C537-3FD8-BBC4-E5BD25430652&gt; /usr/lib/libCRFSuite.dylib
0x7fff65572000 -     0x7fff6557cfff  libChineseTokenizer.dylib (34) &lt;04A7CB5A-FD68-398A-A206-33A510C115E7&gt; /usr/lib/libChineseTokenizer.dylib
0x7fff65608000 -     0x7fff6560aff7  libDiagnosticMessagesClient.dylib (112) &lt;27220E98-6CE2-33E3-BD48-3CC3CE4AA036&gt; /usr/lib/libDiagnosticMessagesClient.dylib
0x7fff65ade000 -     0x7fff65adffff  libSystem.B.dylib (1281.100.1)  /usr/lib/libSystem.B.dylib
0x7fff65b6c000 -     0x7fff65b6dfff  libThaiTokenizer.dylib (3) &lt;97DC10ED-3C11-3C89-B366-299A644035E7&gt; /usr/lib/libThaiTokenizer.dylib
0x7fff65b85000 -     0x7fff65b9bfff  libapple_nghttp2.dylib (1.39.2)  /usr/lib/libapple_nghttp2.dylib
0x7fff65bd0000 -     0x7fff65c42ff7  libarchive.2.dylib (72.100.1) &lt;20B70252-0C4B-3AFD-8C8D-F51921E9D324&gt; /usr/lib/libarchive.2.dylib
0x7fff65ce0000 -     0x7fff65ce0ff3  libauto.dylib (187) &lt;85383E24-1592-36BC-BB39-308B7F1C826E&gt; /usr/lib/libauto.dylib
0x7fff65da6000 -     0x7fff65db6ffb  libbsm.0.dylib (60.100.1)  /usr/lib/libbsm.0.dylib
0x7fff65db7000 -     0x7fff65dc3fff  libbz2.1.0.dylib (44)  /usr/lib/libbz2.1.0.dylib
0x7fff65dc4000 -     0x7fff65e16fff  libc++.1.dylib (902.1)  /usr/lib/libc++.1.dylib
0x7fff65e17000 -     0x7fff65e2cffb  libc++abi.dylib (902) &lt;771E9263-E832-3985-9477-8F1B2D73B771&gt; /usr/lib/libc++abi.dylib
0x7fff65e2d000 -     0x7fff65e2dfff  libcharset.1.dylib (59)  /usr/lib/libcharset.1.dylib
0x7fff65e2e000 -     0x7fff65e3ffff  libcmph.dylib (8) &lt;296A51E6-9661-3AC2-A1C9-F1E3510F91AA&gt; /usr/lib/libcmph.dylib
0x7fff65e40000 -     0x7fff65e57fd7  libcompression.dylib (87) &lt;21F37C2E-B9AA-38CE-9023-B763C8828AC6&gt; /usr/lib/libcompression.dylib
0x7fff66131000 -     0x7fff66147ff7  libcoretls.dylib (167) &lt;9E5D1E0C-03F8-37B6-82A1-0D0597021CB8&gt; /usr/lib/libcoretls.dylib
0x7fff66148000 -     0x7fff66149fff  libcoretls_cfhelpers.dylib (167)  /usr/lib/libcoretls_cfhelpers.dylib
0x7fff6686f000 -     0x7fff6686ffff  libenergytrace.dylib (21)  /usr/lib/libenergytrace.dylib
0x7fff66896000 -     0x7fff66898fff  libfakelink.dylib (149.1) &lt;122F530F-F10E-3DD5-BBEA-91796BE583F3&gt; /usr/lib/libfakelink.dylib
0x7fff668a7000 -     0x7fff668acfff  libgermantok.dylib (24)  /usr/lib/libgermantok.dylib
0x7fff668b7000 -     0x7fff669a7fff  libiconv.2.dylib (59)  /usr/lib/libiconv.2.dylib
0x7fff669a8000 -     0x7fff66bfffff  libicucore.A.dylib (64260.0.1) &lt;7B9204AC-EA14-3FF3-B6B9-4C85B37EED79&gt; /usr/lib/libicucore.A.dylib
0x7fff66c19000 -     0x7fff66c1afff  liblangid.dylib (133) &lt;36581D30-1C7B-3A58-AA07-36237BD75E0E&gt; /usr/lib/liblangid.dylib
0x7fff66c1b000 -     0x7fff66c33ff3  liblzma.5.dylib (16) &lt;4DB30730-DBD1-3503-957A-D604049B98F9&gt; /usr/lib/liblzma.5.dylib
0x7fff66c4b000 -     0x7fff66cf2ff7  libmecab.dylib (883.11) &lt;66AD729B-2BCC-3347-B9B3-FD88570E884D&gt; /usr/lib/libmecab.dylib
0x7fff66cf3000 -     0x7fff66f55ff1  libmecabra.dylib (883.11) &lt;2AE744D2-AC95-3720-8E66-4F9C7A79384C&gt; /usr/lib/libmecabra.dylib
0x7fff67421000 -     0x7fff6789dff5  libnetwork.dylib (1880.120.4) &lt;715FB943-BA01-351C-BEA6-121970472985&gt; /usr/lib/libnetwork.dylib
0x7fff6793e000 -     0x7fff67971fde  libobjc.A.dylib (787.1)  /usr/lib/libobjc.A.dylib
0x7fff67984000 -     0x7fff67988fff  libpam.2.dylib (25.100.1) &lt;732E8D8E-C630-3EC2-B6C3-A1564E3B68B8&gt; /usr/lib/libpam.2.dylib
0x7fff6798b000 -     0x7fff679c1ff7  libpcap.A.dylib (89.120.1)  /usr/lib/libpcap.A.dylib
0x7fff67ab9000 -     0x7fff67ca3ff7  libsqlite3.dylib (308.5)  /usr/lib/libsqlite3.dylib
0x7fff67ef4000 -     0x7fff67ef7ffb  libutil.dylib (57)  /usr/lib/libutil.dylib
0x7fff67ef8000 -     0x7fff67f05ff7  libxar.1.dylib (425.2) &lt;943A4CBB-331B-3A04-A11F-A2301189D40B&gt; /usr/lib/libxar.1.dylib
0x7fff67f0b000 -     0x7fff67fedff7  libxml2.2.dylib (33.3) &lt;262EF7C6-7D83-3C01-863F-36E97F5ACD34&gt; /usr/lib/libxml2.2.dylib
0x7fff67ff1000 -     0x7fff68019fff  libxslt.1.dylib (16.9) &lt;86FE4382-BD77-3C19-A678-11EBCD70685A&gt; /usr/lib/libxslt.1.dylib
0x7fff6801a000 -     0x7fff6802cff3  libz.1.dylib (76)  /usr/lib/libz.1.dylib
0x7fff688da000 -     0x7fff688dfff3  libcache.dylib (83)  /usr/lib/system/libcache.dylib
0x7fff688e0000 -     0x7fff688ebfff  libcommonCrypto.dylib (60165.120.1)  /usr/lib/system/libcommonCrypto.dylib
0x7fff688ec000 -     0x7fff688f3fff  libcompiler_rt.dylib (101.2) &lt;652A6012-7E5C-3F4F-9438-86BC094526F3&gt; /usr/lib/system/libcompiler_rt.dylib
0x7fff688f4000 -     0x7fff688fdff7  libcopyfile.dylib (166.40.1) &lt;40113A69-A81C-3397-ADC6-1D16B9A22C3E&gt; /usr/lib/system/libcopyfile.dylib
0x7fff688fe000 -     0x7fff68990fe3  libcorecrypto.dylib (866.120.3) &lt;5E4B0E50-24DD-3E04-9374-EDA9FFD6257B&gt; /usr/lib/system/libcorecrypto.dylib
0x7fff68a9d000 -     0x7fff68addff0  libdispatch.dylib (1173.100.2) &lt;201EDBF3-0B36-31BA-A7CB-443CE35C05D4&gt; /usr/lib/system/libdispatch.dylib
0x7fff68ade000 -     0x7fff68b14fff  libdyld.dylib (750.5) &lt;7E711A46-5E4D-393C-AEA6-440E2A5CCD0C&gt; /usr/lib/system/libdyld.dylib
0x7fff68b15000 -     0x7fff68b15ffb  libkeymgr.dylib (30) &lt;52662CAA-DB1F-30A3-BE13-D6274B1A6D7B&gt; /usr/lib/system/libkeymgr.dylib
0x7fff68b16000 -     0x7fff68b22ff3  libkxld.dylib (6153.121.2) &lt;5EBB4886-C7B6-31D6-AA63-D861B2D58FCE&gt; /usr/lib/system/libkxld.dylib
0x7fff68b23000 -     0x7fff68b23ff7  liblaunch.dylib (1738.120.8) &lt;07CF647B-F9DC-3907-AD98-2F85FCB34A72&gt; /usr/lib/system/liblaunch.dylib
0x7fff68b24000 -     0x7fff68b29ff7  libmacho.dylib (959.0.1)  /usr/lib/system/libmacho.dylib
0x7fff68b2a000 -     0x7fff68b2cff3  libquarantine.dylib (110.40.3)  /usr/lib/system/libquarantine.dylib
0x7fff68b2d000 -     0x7fff68b2eff7  libremovefile.dylib (48)  /usr/lib/system/libremovefile.dylib
0x7fff68b2f000 -     0x7fff68b46ff3  libsystem_asl.dylib (377.60.2) &lt;1170348D-2491-33F1-AA79-E2A05B4A287C&gt; /usr/lib/system/libsystem_asl.dylib
0x7fff68b47000 -     0x7fff68b47ff7  libsystem_blocks.dylib (74) &lt;7AFBCAA6-81BE-36C3-8DB0-AAE0A4ACE4C5&gt; /usr/lib/system/libsystem_blocks.dylib
0x7fff68b48000 -     0x7fff68bcffff  libsystem_c.dylib (1353.100.2) &lt;935DDCE9-4ED0-3F79-A05A-A123DDE399CC&gt; /usr/lib/system/libsystem_c.dylib
0x7fff68bd0000 -     0x7fff68bd3ffb  libsystem_configuration.dylib (1061.120.2)  /usr/lib/system/libsystem_configuration.dylib
0x7fff68bd4000 -     0x7fff68bd7fff  libsystem_coreservices.dylib (114) &lt;3D0A3AA8-8415-37B2-AAE3-66C03BCE8B55&gt; /usr/lib/system/libsystem_coreservices.dylib
0x7fff68bd8000 -     0x7fff68be0fff  libsystem_darwin.dylib (1353.100.2) &lt;6EEC9975-EE3B-3C95-AA5B-030FD10587BC&gt; /usr/lib/system/libsystem_darwin.dylib
0x7fff68be1000 -     0x7fff68be8fff  libsystem_dnssd.dylib (1096.100.3) &lt;0115092A-E61B-317D-8670-41C7C34B1A82&gt; /usr/lib/system/libsystem_dnssd.dylib
0x7fff68be9000 -     0x7fff68beaffb  libsystem_featureflags.dylib (17)  /usr/lib/system/libsystem_featureflags.dylib
0x7fff68beb000 -     0x7fff68c38ff7  libsystem_info.dylib (538) &lt;851693E9-C079-3547-AD41-353F8C248BE8&gt; /usr/lib/system/libsystem_info.dylib
0x7fff68c39000 -     0x7fff68c65ff7  libsystem_kernel.dylib (6153.121.2) &lt;9F9902C9-A46F-3CA9-B7F9-5CCFE98FBF75&gt; /usr/lib/system/libsystem_kernel.dylib
0x7fff68c66000 -     0x7fff68cadfff  libsystem_m.dylib (3178) &lt;436CFF76-6A99-36F2-A3B6-8D017396A050&gt; /usr/lib/system/libsystem_m.dylib
0x7fff68cae000 -     0x7fff68cd5fff  libsystem_malloc.dylib (283.100.6)  /usr/lib/system/libsystem_malloc.dylib
0x7fff68cd6000 -     0x7fff68ce3ffb  libsystem_networkextension.dylib (1095.120.6) &lt;6DE86DB0-8CD2-361E-BD6A-A34282B47847&gt; /usr/lib/system/libsystem_networkextension.dylib
0x7fff68ce4000 -     0x7fff68cedff7  libsystem_notify.dylib (241.100.2) &lt;7E9E2FC8-DF26-340C-B196-B81B11850C46&gt; /usr/lib/system/libsystem_notify.dylib
0x7fff68cee000 -     0x7fff68cf6fef  libsystem_platform.dylib (220.100.1) &lt;736920EA-6AE0-3B1B-BBDA-7DCDF0C229DF&gt; /usr/lib/system/libsystem_platform.dylib
0x7fff68cf7000 -     0x7fff68d01fff  libsystem_pthread.dylib (416.100.3) &lt;77488669-19A3-3993-AD65-CA5377E2475A&gt; /usr/lib/system/libsystem_pthread.dylib
0x7fff68d02000 -     0x7fff68d06ff3  libsystem_sandbox.dylib (1217.120.7) &lt;20C93D69-6452-3C82-9521-8AE54345C66F&gt; /usr/lib/system/libsystem_sandbox.dylib
0x7fff68d07000 -     0x7fff68d09fff  libsystem_secinit.dylib (62.100.2)  /usr/lib/system/libsystem_secinit.dylib
0x7fff68d0a000 -     0x7fff68d11ffb  libsystem_symptoms.dylib (1238.120.1) &lt;25C3866B-004E-3621-9CD3-B1E9C4D887EB&gt; /usr/lib/system/libsystem_symptoms.dylib
0x7fff68d12000 -     0x7fff68d28ff2  libsystem_trace.dylib (1147.120)  /usr/lib/system/libsystem_trace.dylib
0x7fff68d2a000 -     0x7fff68d2fff7  libunwind.dylib (35.4) &lt;253A12E2-F88F-3838-A666-C5306F833CB8&gt; /usr/lib/system/libunwind.dylib
0x7fff68d30000 -     0x7fff68d65ffe  libxpc.dylib (1738.120.8) &lt;68D433B6-DCFF-385D-8620-F847FB7D4A5A&gt; /usr/lib/system/libxpc.dylib
External Modification Summary:
Calls made by other processes targeting this process:
task_for_pid: 1
thread_create: 0
thread_set_state: 0
Calls made by this process:
task_for_pid: 0
thread_create: 0
thread_set_state: 0
Calls made by all processes on this machine:
task_for_pid: 1005859
thread_create: 0
thread_set_state: 0
VM Region Summary:
ReadOnly portion of Libraries: Total=788.4M resident=0K(0%) swapped_out_or_unallocated=788.4M(100%)
Writable regions: Total=41.7G written=0K(0%) resident=0K(0%) swapped_out=0K(0%) unallocated=41.7G(100%)
&lt;denchmark-code&gt;                            VIRTUAL   REGION 
&lt;/denchmark-code&gt;

REGION TYPE                        SIZE    COUNT (non-coalesced)
===========                     =======  =======
Activity Tracing                   256K        1
Kernel Alloc Once                    8K        1
MALLOC                             8.2G      104
MALLOC guard page                   24K        5
MALLOC_LARGE (reserved)           32.7G        1         reserved VM address space (unallocated)
MALLOC_MEDIUM (reserved)         832.0M        7         reserved VM address space (unallocated)
STACK GUARD                          4K        1
Stack                             16.0M        1
VM_ALLOCATE                       1028K        5
__DATA                            12.9M      197
__DATA_CONST                        20K        1
__LINKEDIT                       432.7M       63
__OBJC_RO                         32.2M        1
__OBJC_RW                         1892K        2
__TEXT                           355.7M      180
__UNICODE                          564K        1
shared memory                       12K        3
===========                     =======  =======
TOTAL                             42.5G      574
TOTAL, minus reserved VM space     9.0G      574
&lt;denchmark-h:h2&gt;Expected behavior&lt;/denchmark-h&gt;

&lt;denchmark-h:h2&gt;Environment&lt;/denchmark-h&gt;

Collecting environment information...
PyTorch version: 1.5.0
Is debug build: No
CUDA used to build PyTorch: None
OS: Mac OSX 10.15.5
GCC version: Could not collect
CMake version: Could not collect
Python version: 3.7
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA
Versions of relevant libraries:
[pip3] numpy==1.18.5
[pip3] torch==1.5.0
[pip3] torchvision==0.6.0a0+82fd1c8
[conda] blas                      2.15                        mkl    conda-forge
[conda] libblas                   3.8.0                    15_mkl    conda-forge
[conda] libcblas                  3.8.0                    15_mkl    conda-forge
[conda] liblapack                 3.8.0                    15_mkl    conda-forge
[conda] liblapacke                3.8.0                    15_mkl    conda-forge
[conda] mkl                       2020.1                      218    conda-forge
[conda] numpy                     1.18.5           py37h7687784_0    conda-forge
[conda] pytorch                   1.5.0                   py3.7_0    pytorch
[conda] torchvision               0.6.0                  py37_cpu    pytorch
&lt;denchmark-h:h2&gt;Additional context&lt;/denchmark-h&gt;

No crash if float64 is used or no padding parameter to torch.nn.functional.conv2d
Same issue with pytorch 1.4
cc &lt;denchmark-link:https://github.com/ezyang&gt;@ezyang&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/gchanan&gt;@gchanan&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/zou3519&gt;@zou3519&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/gujinghui&gt;@gujinghui&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/PenghuiCheng&gt;@PenghuiCheng&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/XiaobingSuper&gt;@XiaobingSuper&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/jianyuh&gt;@jianyuh&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/VitalyFedyunin&gt;@VitalyFedyunin&lt;/denchmark-link&gt;

	</description>
	<comments>
		<comment id='1' author='tgoldina' date='2020-06-11T00:27:02Z'>
		High priority because it's a crash.
		</comment>
		<comment id='2' author='tgoldina' date='2020-06-11T04:16:44Z'>
		It cannot be reproduced on the latest master branch with mkl-dnn 1.2. For old version of pytorch, you may temporarily disable this specific mkldnn convolution as below, then it will fallback to the THNN implementation
&lt;denchmark-code&gt;import torch.backends.mkldnn
with torch.backends.mkldnn.flags(enabled=False):
    img_conv_pytorch = torch.nn.functional.conv2d(img_t, weights_t, padding=psf_half)
&lt;/denchmark-code&gt;

Note that due to the large kernel size (it has to expand the input size by k^2 times), it requires at least ~40GB ram with THNN kernel, hope macOS could handle it well.
		</comment>
		<comment id='3' author='tgoldina' date='2020-06-15T17:08:01Z'>
		&lt;denchmark-link:https://github.com/pinzhenx&gt;@pinzhenx&lt;/denchmark-link&gt;
 Do you know which commit in fixed it? If we can verify that things are fine on PyTorch master, it is probably sufficient to close this issue by adding a test.
		</comment>
		<comment id='4' author='tgoldina' date='2020-06-16T12:34:06Z'>
		&lt;denchmark-link:https://github.com/ezyang&gt;@ezyang&lt;/denchmark-link&gt;
 It was fixed on mkldnn v1.2 with this patch &lt;denchmark-link:https://github.com/oneapi-src/oneDNN/commit/3e775972383932ffe818b02c95adbfe5758756fe&gt;oneapi-src/oneDNN@3e77597&lt;/denchmark-link&gt;
, and it's already been in the pytorch master branch
We could also close this similar issue &lt;denchmark-link:https://github.com/pytorch/pytorch/issues/31195&gt;#31195&lt;/denchmark-link&gt;

		</comment>
		<comment id='5' author='tgoldina' date='2020-06-16T15:14:46Z'>
		Thank you. Indeed, my test case works if I use nightly.
		</comment>
	</comments>
</bug>