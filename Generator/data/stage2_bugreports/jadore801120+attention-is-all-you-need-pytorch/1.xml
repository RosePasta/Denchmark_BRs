<bug id='1' author='vince62s' open_date='2017-06-20T17:07:22Z' closed_time='2017-06-26T00:04:31Z'>
	<summary>Index error during translating</summary>
	<description>
Hi,
I tried to force the GPU selection with CUDA_VISIBLE_DEVICES=1
but it pops an error:
RuntimeError: cublas runtime error : library not initialized at /py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCGeneral.c:387
I think it's related to this: &lt;denchmark-link:https://discuss.pytorch.org/t/cublas-runtime-error-library-not-initialized-at-data-users-soumith-builder-wheel-pytorch-src-torch-lib-thc-thcgeneral-c-383/1375/8&gt;https://discuss.pytorch.org/t/cublas-runtime-error-library-not-initialized-at-data-users-soumith-builder-wheel-pytorch-src-torch-lib-thc-thcgeneral-c-383/1375/8&lt;/denchmark-link&gt;

	</description>
	<comments>
		<comment id='1' author='vince62s' date='2017-06-20T20:29:52Z'>
		I got this error now (I am using torch.cuda.device(1))
CUDA_LAUNCH_BLOCKING=1  CUDA_VISIBLE_DEVICES=1 python3 train.py -data baseline.pt -save trained.chkpt -save_mode best
[ Epoch 0 ]

(Training)   :   0%|                                                      | 0/15767 [00:00&lt;?, ?it/s]/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [0,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [1,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [2,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [3,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [4,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [5,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [6,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [7,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [8,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [9,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [10,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [11,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [12,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [13,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [14,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [15,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [16,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [17,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [18,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [19,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [20,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [21,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [22,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [23,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [24,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [25,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [26,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [27,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [28,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [29,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [30,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [31,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [32,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [33,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [34,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [35,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [36,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [37,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [38,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [39,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [40,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [41,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [42,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [43,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [44,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [45,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [46,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [47,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [48,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [49,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [50,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [51,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [52,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [53,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [54,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [55,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [56,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [57,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [58,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [59,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [60,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [61,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [62,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [136,0,0], thread: [63,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [64,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [65,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [66,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [67,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [68,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [69,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [70,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [71,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [72,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [73,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [74,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [75,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [76,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [77,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [78,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [79,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [80,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [81,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [82,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [83,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [84,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [85,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [86,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [87,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [88,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [89,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [90,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [91,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [92,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [93,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [94,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [95,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [96,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [97,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [98,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [99,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [100,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [101,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [102,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [103,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [104,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [105,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [106,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [107,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [108,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [109,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [110,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [111,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [112,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [113,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [114,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [115,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [116,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [117,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [118,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [119,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [120,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [121,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [122,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [123,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [124,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [125,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [126,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [8,0,0], thread: [127,0,0] Assertion srcIndex &lt; srcSelectDimSize failed.
THCudaCheck FAIL file=/py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/generated/../generic/THCTensorMathPointwise.cu line=246 error=59 : device-side assert triggered
Traceback (most recent call last):
File "train.py", line 241, in 
main()
File "train.py", line 238, in main
train(transformer, training_data, validation_data, crit, optimizer, opt)
File "train.py", line 118, in train
train_loss, train_accu = train_epoch(model, training_data, crit, optimizer)
File "train.py", line 54, in train_epoch
pred = model(src, tgt)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Models.py", line 180, in forward
enc_outputs, enc_slf_attns = self.encoder(src_seq, src_pos)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Models.py", line 69, in forward
enc_input += self.position_enc(src_pos)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/autograd/variable.py", line 741, in iadd
return self.add_(other)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/autograd/variable.py", line 283, in add_
return self._add(other, True)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/autograd/variable.py", line 274, in _add
return Add(inplace)(self, other)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/autograd/functions/basic_ops.py", line 18, in forward
return a.add(b)
RuntimeError: cuda runtime error (59) : device-side assert triggered at /py/conda-bld/pytorch_1490903321756/work/torch/lib/THC/generated/../generic/THCTensorMathPointwise.cu:246

		</comment>
		<comment id='2' author='vince62s' date='2017-06-20T20:40:01Z'>
		and with -no_cuda
python3 train.py -data baseline.pt -save trained.chkpt -save_mode best -embs_share_weight -proj_share_weight -no_cuda
[ Epoch 0 ]
Traceback (most recent call last):
File "train.py", line 241, in 
main()
File "train.py", line 238, in main
train(transformer, training_data, validation_data, crit, optimizer, opt)
File "train.py", line 118, in train
train_loss, train_accu = train_epoch(model, training_data, crit, optimizer)
File "train.py", line 54, in train_epoch
pred = model(src, tgt)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Models.py", line 180, in forward
enc_outputs, enc_slf_attns = self.encoder(src_seq, src_pos)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Models.py", line 66, in forward
enc_input = self.src_word_emb(src_seq)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/sparse.py", line 94, in forward
)(input, self.weight)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/thnn/sparse.py", line 63, in forward
output = torch.index_select(weight, 0, indices.view(-1))
TypeError: torch.index_select received an invalid combination of arguments - got (torch.FloatTensor, int, torch.cuda.LongTensor), but expected (torch.FloatTensor source, int dim, torch.LongTensor index)
		</comment>
		<comment id='3' author='vince62s' date='2017-06-20T22:06:46Z'>
		That happens because -no_cuda parameter failed to pass the no-cudaness to DataLoader. I have opened a pull request to fix this.
After that, we see that the original issues are caused by out-of-bounds indexing:
&lt;denchmark-code&gt;$ python3 train.py -data data/multi30k/data.pt -save trained.chkpt -save_mode best -no_cuda
[ Epoch 0 ]
Traceback (most recent call last):                                                                                                                                                                                   
  File "train.py", line 242, in &lt;module&gt;
    main()
  File "train.py", line 239, in main
    train(transformer, training_data, validation_data, crit, optimizer, opt)
  File "train.py", line 117, in train
    train_loss, train_accu = train_epoch(model, training_data, crit, optimizer)
  File "train.py", line 53, in train_epoch
    pred = model(src, tgt)
  File "/home/sliedes/.local/lib/python3.5/site-packages/torch/nn/modules/module.py", line 206, in __call__
    result = self.forward(*input, **kwargs)
  File "transformer/Models.py", line 180, in forward
    enc_outputs, enc_slf_attns = self.encoder(src_seq, src_pos)
  File "/home/sliedes/.local/lib/python3.5/site-packages/torch/nn/modules/module.py", line 206, in __call__
    result = self.forward(*input, **kwargs)
  File "transformer/Models.py", line 69, in forward
    enc_input += self.position_enc(src_pos)
  File "/home/sliedes/.local/lib/python3.5/site-packages/torch/nn/modules/module.py", line 206, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/sliedes/.local/lib/python3.5/site-packages/torch/nn/modules/sparse.py", line 94, in forward
    )(input, self.weight)
  File "/home/sliedes/.local/lib/python3.5/site-packages/torch/nn/_functions/thnn/sparse.py", line 53, in forward
    output = torch.index_select(weight, 0, indices.view(-1))
RuntimeError: index out of range at /b/wheel/pytorch-src/torch/lib/TH/generic/THTensorMath.c:273
&lt;/denchmark-code&gt;

I'm not sure if I am doing the preprocessing correctly. I did this:
&lt;denchmark-code&gt;mkdir -p data/multi30k
wget http://www.quest.dcs.shef.ac.uk/wmt16_files_mmt/training.tar.gz &amp;&amp;  tar -xf training.tar.gz -C data/multi30k &amp;&amp; rm training.tar.gz
wget http://www.quest.dcs.shef.ac.uk/wmt16_files_mmt/validation.tar.gz &amp;&amp; tar -xf validation.tar.gz -C data/multi30k &amp;&amp; rm validation.tar.gz
wget https://staff.fnwi.uva.nl/d.elliott/wmt16/mmt16_task1_test.tgz &amp;&amp; tar -xf mmt16_task1_test.tgz -C data/multi30k &amp;&amp; rm mmt16_task1_test.tgz
python3 preprocess.py -train_src data/multi30k/train.en -train_tgt data/multi30k/train.de -valid_src data/multi30k/val.en -valid_tgt data/multi30k/val.de -output data/multi30k/data.pt
&lt;/denchmark-code&gt;

I'm also running the training without the suggested -embs_share_weight -proj_share_weight parameters (they effectively require that the source and target languages are the same, don't they?)
		</comment>
		<comment id='4' author='vince62s' date='2017-06-21T02:01:29Z'>
		Hi &lt;denchmark-link:https://github.com/vince62s&gt;@vince62s&lt;/denchmark-link&gt;
,
Thanks for the bug report!
About the "library not initialized" error, I am facing the same issue and still trying to figure out.
Any further suggestion or hint will be appreciated!
		</comment>
		<comment id='5' author='vince62s' date='2017-06-21T02:05:04Z'>
		Hi &lt;denchmark-link:https://github.com/sliedes&gt;@sliedes&lt;/denchmark-link&gt;
,
Thanks for the bug report and the pull request!
The "index out of range" error is a preprocessing phase bug, and just I fixed it in &lt;denchmark-link:https://github.com/jadore801120/attention-is-all-you-need-pytorch/commit/dad35e5a0ea3dd2dc2257571682465acc81d25a2&gt;#dad35e5&lt;/denchmark-link&gt;
 and &lt;denchmark-link:https://github.com/jadore801120/attention-is-all-you-need-pytorch/commit/f49c7ef637c86e204c443e00b6272dfbdbc95ffe&gt;#f49c7ef&lt;/denchmark-link&gt;
. Please take a look.
		</comment>
		<comment id='6' author='vince62s' date='2017-06-21T04:55:49Z'>
		for some reason, we need to set:
CUDA_VISIBLE_DEVICES=1 (to make only GPU &lt;denchmark-link:https://github.com/jadore801120/attention-is-all-you-need-pytorch/pull/2&gt;#2&lt;/denchmark-link&gt;
 visible)
and in train.py
torch.cuda.device(0)
cheers.
		</comment>
		<comment id='7' author='vince62s' date='2017-06-21T06:57:48Z'>
		ok, it trained (I think, because console is not 100% clear) one epoch and then again (might be during first eval) :
THCudaCheck FAIL file=/py/conda-bld/pytorch_1493681908901/work/torch/lib/THC/generic/THCTensorMath.cu line=226 error=59 : device-side assert triggered
Traceback (most recent call last):
File "train.py", line 244, in 
main()
File "train.py", line 241, in main
train(transformer, training_data, validation_data, crit, optimizer, opt)
File "train.py", line 120, in train
valid_loss, valid_accu = eval_epoch(model, validation_data, crit)
File "train.py", line 85, in eval_epoch
pred = model(src, tgt)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Models.py", line 180, in forward
enc_outputs, enc_slf_attns = self.encoder(src_seq, src_pos)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Models.py", line 76, in forward
enc_output, slf_attn_mask=enc_slf_attn_mask)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Layers.py", line 18, in forward
enc_input, enc_input, enc_input, attn_mask=slf_attn_mask)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py", line 206, in call
result = self.forward(*input, **kwargs)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/SubLayers.py", line 43, in forward
outputs = torch.cat(outputs, 2)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/autograd/variable.py", line 841, in cat
return Concat(dim)(*iterable)
File "/home/user/anaconda3/lib/python3.6/site-packages/torch/autograd/_functions/tensor.py", line 310, in forward
return torch.cat(inputs, self.dim)
RuntimeError: cuda runtime error (59) : device-side assert triggered at /py/conda-bld/pytorch_1493681908901/work/torch/lib/THC/generic/THCTensorMath.cu:226
		</comment>
		<comment id='8' author='vince62s' date='2017-06-21T07:40:45Z'>
		Hi &lt;denchmark-link:https://github.com/vince62s&gt;@vince62s&lt;/denchmark-link&gt;
 ,
Thanks for report!
I am not quite sure about this error, but I just found a fatal assignment error in preprocessing phase and is fixed in &lt;denchmark-link:https://github.com/jadore801120/attention-is-all-you-need-pytorch/commit/01371c44ecfcb0cd4e5e57367709fcf4ca917a76&gt;#01371c4&lt;/denchmark-link&gt;
.
Please pull the latest code and retry.
Thank you!
		</comment>
		<comment id='9' author='vince62s' date='2017-06-21T08:22:26Z'>
		ok, it fixed it.
Now after one epoch I am getting nans:
[ Epoch 0 ]

(Training)   loss:      nan, accuracy: 0.54 %
(Validation) loss:      nan, accuracy: 0.622 %

[Info] The checkpoint file has been updated.



		</comment>
		<comment id='10' author='vince62s' date='2017-06-21T08:33:43Z'>
		also at translate.py another index error:
[Info] Get 1000 instances from baseline-1M_test.en.tok
[Warning] 5 instances are trimmed to the max sentence length 50.
[Info] Trained model state loaded.
Traceback (most recent call last):
File "translate.py", line 64, in 
main()
File "translate.py", line 56, in main
all_hyp, all_scores = translator.translate_batch(batch)
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Translator.py", line 82, in translate_batch
b.get_current_state() for b in beam if not b.done]) # size: mb x bm x sq
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Translator.py", line 82, in 
b.get_current_state() for b in beam if not b.done]) # size: mb x bm x sq
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Beam.py", line 36, in get_current_state
return self.get_tentative_hypothesis()
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Beam.py", line 87, in get_tentative_hypothesis
hyps = [self.get_hypothesis(k) for k in keys]
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Beam.py", line 87, in 
hyps = [self.get_hypothesis(k) for k in keys]
File "/home/user/pytorchwork/attention-is-all-you-need-pytorch/transformer/Beam.py", line 108, in get_hypothesis
hyp.append(self.next_ys[j+1][k])
IndexError: index 1688941604742 is out of range for dimension 0 (of size 5)
		</comment>
		<comment id='11' author='vince62s' date='2017-06-24T00:34:45Z'>
		I have the same prblem of IndexError.
		</comment>
		<comment id='12' author='vince62s' date='2017-06-26T00:00:45Z'>
		Hi @wuhaixutab, &lt;denchmark-link:https://github.com/vince62s&gt;@vince62s&lt;/denchmark-link&gt;
 ,
It turns out that the topk function in PyTorch sometimes returns unexpected result.
It can be solved by calling the function again.
--
The following is my test code:
print('=========================')
best_scores, best_scores_id = flat_beam_lk.topk(self.size, 0, True, True) # 1st sort
print('1st best_scores_id')
print(best_scores_id)
print('-------------------------')
best_scores2, best_scores_id2 = flat_beam_lk.topk(self.size, 0, True, True) # 2nd sort
print('2nd best_scores_id')
print(best_scores_id2)
And the following image is my std output.
&lt;denchmark-link:https://user-images.githubusercontent.com/3960874/27520714-d74168c0-5a43-11e7-9ff8-99deb91e1b3f.png&gt;&lt;/denchmark-link&gt;

That's very weird. I still not sure under what situation will this result emerge.
--
Anyway, this error has been fix with commit &lt;denchmark-link:https://github.com/jadore801120/attention-is-all-you-need-pytorch/commit/6fc942471f0d8fee28c53519ea7acba2ac63d9a6&gt;6fc9424&lt;/denchmark-link&gt;
 with double sort.
Please pull the newest commit and retry.
Thank you.
Yu-Hsiang
		</comment>
		<comment id='13' author='vince62s' date='2017-06-26T00:04:04Z'>
		Hi,
I think this comment thread is too long to read now, so I will close this issue.
If someone get another Index error or other problem, feel free to open a new issue.
Yu-Hsiang
		</comment>
	</comments>
</bug>