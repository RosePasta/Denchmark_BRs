<bug id='16197' author='lincccc' open_date='2019-12-19T02:42:06Z' closed_time='2020-12-11T21:31:43Z'>
	<summary>Wrong image pyramid generated by ORB feature, if FirstLevel &amp;gt; 0, and crash if FirstLevel &amp;gt;= 3</summary>
	<description>
&lt;denchmark-h:h5&gt;System information (version)&lt;/denchmark-h&gt;


OpenCV =&gt; 3.4.1
Operating System / Platform =&gt; Windows 64 Bit
Compiler =&gt; Visual Studio 2017

&lt;denchmark-h:h5&gt;Detailed description&lt;/denchmark-h&gt;

ORB feature generate wrong image pyramid if set firstLevel &gt; 0. For example firstLevel = 2, create imagePyramid as following image 72 *72. The upscaled image overlaps others.
&lt;denchmark-link:https://user-images.githubusercontent.com/1185380/71140225-91122b00-224b-11ea-9d08-6dd4c331eb11.png&gt;&lt;/denchmark-link&gt;

If firstLevel &gt;= 3, it crashes around line 1051 Mat extImg = imagePyramid(wholeLinfo), extMask;
It seems there is still some issue in code that calculates image pyramid's height.
&lt;denchmark-h:h5&gt;Steps to reproduce&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;Mat img = imread("119_10_1_15_31_7086.png");
Ptr&lt;ORB&gt; orbPtr = ORB::create();
orbPtr-&gt;setNLevels(5);
orbPtr-&gt;setFirstLevel(2);
// orbPtr-&gt;setFirstLevel(3); exception
orbPtr-&gt;setScaleFactor(1.8);
orbPtr-&gt;setPatchSize(8);
orbPtr-&gt;setEdgeThreshold(8);
std::vector&lt;KeyPoint&gt; kps;
Mat fv;
orbPtr-&gt;detectAndCompute(img, noArray(), kps, fv);
&lt;/denchmark-code&gt;

&lt;denchmark-link:https://user-images.githubusercontent.com/1185380/74296295-570e6280-4d7e-11ea-8e48-8d1ffa3566c1.png&gt;&lt;/denchmark-link&gt;

	</description>
	<comments>
		<comment id='1' author='lincccc' date='2020-01-31T05:50:03Z'>
		&lt;denchmark-link:https://github.com/lincccc&gt;@lincccc&lt;/denchmark-link&gt;
 could you share reproducer code and image that you use?
		</comment>
		<comment id='2' author='lincccc' date='2020-02-12T02:00:25Z'>
		&lt;denchmark-link:https://github.com/asmorkalov&gt;@asmorkalov&lt;/denchmark-link&gt;
 I've updated with code and image.
		</comment>
	</comments>
</bug>