<bug id='1095' author='adriacabeza' open_date='2019-05-23T15:35:07Z' closed_time='2019-08-02T17:31:28Z'>
	<summary>Error "trt_engine != nullptr was false" when running inference of ONNX model</summary>
	<description>
Hey I am trying to run TensorRT inference to my model using onnxruntime but I do get an error whenever I try to run an inference session.
The pipeline of what I am doing is the following:
I convert my tensorflow model to ONNX using tf2onnx:
os.system('python3 -m tf2onnx.convert --input {} --inputs {}:0 --outputs {}:0 --output {}  --verbose --fold_const --opset 9'.format(args.tf, input_names, output_names, args.onnx))
And I do get a model.onnx with all the ops mapped.
tensorflow ops: Counter({'Const': 432, 'Switch': 318, 'FusedBatchNorm': 106, 'BiasAdd': 55, 'Merge': 53, 'Conv2D': 53, 'Relu': 50, 'Add': 16, 'Pad': 2, 'MatMul': 2, 'Placeholder': 1, 'MaxPool': 1, 'Softmax': 1, 'Mean': 1})
	tensorflow attr: Counter({'T': 658, 'dtype': 433, 'value': 432, 'data_format': 215, 'epsilon': 106, 'is_training': 106, 'padding': 54, 'strides': 54, 'N': 53, 'use_cudnn_on_gpu': 53, 'dilations': 53, 'Tpaddings': 2, 'transpose_a': 2, 'transpose_b': 2, 'Tidx': 1, 'keep_dims': 1, 'ksize': 1, 'shape': 1})
	onnx mapped: Counter({'Const': 431, 'FusedBatchNorm': 106, 'BiasAdd': 55, 'If': 53, 'Conv2D': 52, 'Relu': 50, 'Add': 16, 'MatMul': 2, 'Pad': 1, 'Placeholder': 1, 'MaxPool': 1, 'Mean': 1, 'Softmax': 1})
	onnx unmapped: Counter()
Then I take the onnx file and I try to create an inference session and it shows up this error message:
2019-05-23 15:29:51.527597392 [W:onnxruntime:Default, tensorrt_execution_provider.h:31 log] 
[2019-05-23 15:29:51   ERROR] Parameter check failed at: ../builder/Network.cpp::addInput::432, condition: isValidDims(dims)

2019-05-23 15:29:51.527633639 [W:onnxruntime:Default, tensorrt_execution_provider.h:31 log] 
[2019-05-23 15:29:51   ERROR] Network must have at least one output

2019-05-23 15:29:51.527773110 [E:onnxruntime:InferenceSession, inference_session.cc:497 Initialize] 
Exception during initialization: /workspace/onnxruntime/onnxruntime/core/providers/tensorrt/tensorrt_execution_provider.cc:255 
virtual onnxruntime::common::Status onnxruntime::TensorrtExecutionProvider::Compile(const std::vector&lt;onnxruntime::Node*&gt;&amp;, std::vector&lt;onnxruntime::NodeComputeInfo&gt;&amp;) trt_engine != nullptr was false.
Stacktrace:

Traceback (most recent call last):
  File "fromKeras2ONNXRuntimewithTRT.py", line 159, in &lt;module&gt;
    main()
  File "fromKeras2ONNXRuntimewithTRT.py", line 155, in main
    fromONNX2Runtime(args.onnx, args.warmup)
  File "fromKeras2ONNXRuntimewithTRT.py", line 80, in fromONNX2Runtime
    sess = rt.InferenceSession(onnx_model)
  File "/usr/local/lib/python3.5/dist-packages/onnxruntime/capi/session.py", line 29, in __init__
    self._sess.load_model(path_or_bytes)
RuntimeError: [ONNXRuntimeError] : 6 : RUNTIME_EXCEPTION : Exception during initialization:
 /workspace/onnxruntime/onnxruntime/core/providers/tensorrt/tensorrt_execution_provider.cc:255 virtual onnxruntime::common::Status onnxruntime::TensorrtExecutionProvider::Compile(const std::vector&lt;onnxruntime::Node*&gt;&amp;, std::vector&lt;onnxruntime::NodeComputeInfo&gt;&amp;) trt_engine != nullptr was false.
Stacktrace:


	</description>
	<comments>
		<comment id='1' author='adriacabeza' date='2019-05-23T18:46:49Z'>
		&lt;denchmark-link:https://github.com/adriacabeza&gt;@adriacabeza&lt;/denchmark-link&gt;
 Hi, where did you obtain the binary? If you built it yourself, have you enabled TENSORRT support?
		</comment>
		<comment id='2' author='adriacabeza' date='2019-05-24T21:07:35Z'>
		the failure is "Network must have at least one output" when building TRT network (graph). &lt;denchmark-link:https://github.com/adriacabeza&gt;@adriacabeza&lt;/denchmark-link&gt;
 is it possible to share the converted model to repro the issue?
		</comment>
		<comment id='3' author='adriacabeza' date='2019-05-24T22:38:53Z'>
		This is where failure happened,
[2019-05-23 15:29:51   ERROR] Parameter check failed at: ../builder/Network.cpp::addInput::432, condition: isValidDims(dims)
Are there dynamic shapes on the inputs?
		</comment>
		<comment id='4' author='adriacabeza' date='2019-05-24T23:23:55Z'>
		if there's dynamic shape inputs, then TRT should not return the sub-graph in GetCapability, right? &lt;denchmark-link:https://github.com/stevenlix&gt;@stevenlix&lt;/denchmark-link&gt;

		</comment>
		<comment id='5' author='adriacabeza' date='2019-05-24T23:35:10Z'>
		TRT parser won't check dynamic shape until this PR (&lt;denchmark-link:https://github.com/microsoft/onnxruntime/pull/1012&gt;#1012&lt;/denchmark-link&gt;
) checked in. Please try the latest master code, or if possible share the model so that I can take a look.
		</comment>
		<comment id='6' author='adriacabeza' date='2019-05-26T09:38:57Z'>
		I built it from source cloning the repository &lt;denchmark-link:https://github.com/Microsoft/onnxruntime&gt;https://github.com/Microsoft/onnxruntime&lt;/denchmark-link&gt;
 and then I also installed with pip the .whl created:
&lt;denchmark-code&gt;./build.sh --use_cuda --cudnn_home /usr --cuda_home /usr/local/cuda --config RelWithDebInfo --build_wheel --use_openmp --enable_pybind  --use_tensorrt --tensorrt_home ../tensorrt

&lt;/denchmark-code&gt;

so as you can see I enabled tensorrt. Also it does have variable dimensions as you can see in the Keras summary of the model with those None :
&lt;denchmark-code&gt;__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, None, None, 3 0
__________________________________________________________________________________________________
conv1_pad (ZeroPadding2D)       (None, None, None, 3 0           input_1[0][0]
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, None, None, 6 9472        conv1_pad[0][0]
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, None, None, 6 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, None, None, 6 0           bn_conv1[0][0]
__________________________________________________________________________________________________
pool1_pad (ZeroPadding2D)       (None, None, None, 6 0           activation_1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, None, None, 6 0           pool1_pad[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, None, None, 6 4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, None, None, 6 256         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, None, None, 6 0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, None, None, 6 36928       activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, None, None, 6 256         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, None, None, 6 0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, None, None, 2 16640       activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, None, None, 2 16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, None, None, 2 1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, None, None, 2 1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, None, None, 2 0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, None, None, 2 0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, None, None, 6 16448       activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, None, None, 6 256         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, None, None, 6 0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, None, None, 6 36928       activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, None, None, 6 256         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, None, None, 6 0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, None, None, 2 16640       activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, None, None, 2 1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, None, None, 2 0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, None, None, 2 0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, None, None, 6 16448       activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, None, None, 6 256         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, None, None, 6 0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, None, None, 6 36928       activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, None, None, 6 256         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, None, None, 6 0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, None, None, 2 16640       activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, None, None, 2 1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, None, None, 2 0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, None, None, 2 0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, None, None, 1 32896       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, None, None, 1 512         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, None, None, 1 0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, None, None, 1 147584      activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, None, None, 1 512         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, None, None, 1 0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, None, None, 5 66048       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, None, None, 5 131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, None, None, 5 2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, None, None, 5 2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, None, None, 5 0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, None, None, 5 0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, None, None, 1 65664       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, None, None, 1 512         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, None, None, 1 0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, None, None, 1 147584      activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, None, None, 1 512         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, None, None, 1 0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, None, None, 5 66048       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, None, None, 5 2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, None, None, 5 0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, None, None, 5 0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, None, None, 1 65664       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, None, None, 1 512         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, None, None, 1 0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, None, None, 1 147584      activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, None, None, 1 512         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, None, None, 1 0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, None, None, 5 66048       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, None, None, 5 2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, None, None, 5 0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, None, None, 5 0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, None, None, 1 65664       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, None, None, 1 512         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, None, None, 1 0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, None, None, 1 147584      activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, None, None, 1 512         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, None, None, 1 0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, None, None, 5 66048       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, None, None, 5 2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, None, None, 5 0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, None, None, 5 0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, None, None, 2 131328      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, None, None, 2 1024        res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, None, None, 2 0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, None, None, 2 590080      activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, None, None, 2 1024        res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, None, None, 2 0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, None, None, 1 263168      activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, None, None, 1 525312      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, None, None, 1 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, None, None, 1 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, None, None, 1 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, None, None, 1 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, None, None, 2 262400      activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, None, None, 2 1024        res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, None, None, 2 0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, None, None, 2 590080      activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, None, None, 2 1024        res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, None, None, 2 0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, None, None, 1 263168      activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, None, None, 1 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, None, None, 1 0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, None, None, 1 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, None, None, 2 262400      activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, None, None, 2 1024        res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, None, None, 2 0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, None, None, 2 590080      activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, None, None, 2 1024        res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, None, None, 2 0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, None, None, 1 263168      activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, None, None, 1 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, None, None, 1 0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, None, None, 1 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, None, None, 2 262400      activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, None, None, 2 1024        res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, None, None, 2 0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, None, None, 2 590080      activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, None, None, 2 1024        res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, None, None, 2 0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, None, None, 1 263168      activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, None, None, 1 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, None, None, 1 0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, None, None, 1 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, None, None, 2 262400      activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, None, None, 2 1024        res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, None, None, 2 0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, None, None, 2 590080      activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, None, None, 2 1024        res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, None, None, 2 0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, None, None, 1 263168      activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, None, None, 1 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, None, None, 1 0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, None, None, 1 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, None, None, 2 262400      activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, None, None, 2 1024        res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, None, None, 2 0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, None, None, 2 590080      activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, None, None, 2 1024        res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, None, None, 2 0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, None, None, 1 263168      activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, None, None, 1 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, None, None, 1 0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, None, None, 1 0           add_13[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, None, None, 5 524800      activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, None, None, 5 2048        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, None, None, 5 0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, None, None, 5 2359808     activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, None, None, 5 2048        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, None, None, 5 0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, None, None, 2 1050624     activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, None, None, 2 2099200     activation_40[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, None, None, 2 8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, None, None, 2 8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, None, None, 2 0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, None, None, 2 0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, None, None, 5 1049088     activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, None, None, 5 2048        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, None, None, 5 0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, None, None, 5 2359808     activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, None, None, 5 2048        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, None, None, 5 0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, None, None, 2 1050624     activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, None, None, 2 8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, None, None, 2 0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, None, None, 2 0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, None, None, 5 1049088     activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, None, None, 5 2048        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, None, None, 5 0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, None, None, 5 2359808     activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, None, None, 5 2048        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, None, None, 5 0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, None, None, 2 1050624     activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, None, None, 2 8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, None, None, 2 0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, None, None, 2 0           add_16[0][0]
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 2048)         0           activation_49[0][0]
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1024)         2098176     global_average_pooling2d_1[0][0]
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 5)            5125        dense_1[0][0]
==================================================================================================
Total params: 25,691,013
Trainable params: 25,637,893
Non-trainable params: 53,120

&lt;/denchmark-code&gt;

		</comment>
		<comment id='7' author='adriacabeza' date='2019-05-27T08:37:18Z'>
		I've tried the latest master version of the repo and it seems that the issue about the variable dimensions is solved, but now I get a segmentation fault (core dumped) when rt.InferenceSession(my_onnx_model):
&lt;denchmark-code&gt;Creating the ONNX Runtime engine with TensorRT inference
Using GPU
Starting to run inference to the model
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
...
Found unsupported input: /workspace/onnxruntime/cmake/external/onnx-tensorrt/onnx2trt_utils.hpp
[1]    2225 segmentation fault (core dumped)  python fromKeras2ONNXRuntimewithTRT.py

&lt;/denchmark-code&gt;

		</comment>
		<comment id='8' author='adriacabeza' date='2019-06-07T17:16:24Z'>
		&lt;denchmark-link:https://github.com/adriacabeza&gt;@adriacabeza&lt;/denchmark-link&gt;
 could you share the binary model and its inputs, please? That would save some time. Thanks!
		</comment>
		<comment id='9' author='adriacabeza' date='2019-06-08T17:01:49Z'>
		Of course. Can you provide any email?
		</comment>
		<comment id='10' author='adriacabeza' date='2019-06-10T17:32:48Z'>
		&lt;denchmark-link:https://github.com/adriacabeza&gt;@adriacabeza&lt;/denchmark-link&gt;
 would not attaching it here to the issue work?
		</comment>
		<comment id='11' author='adriacabeza' date='2019-06-20T10:50:51Z'>
		The input is an image converted to a numpy array:
image = Image.open(INPUT_FILE)
image_ndarray = np.asarray(image.resize((224, 224), resample=Image.BICUBIC), dtype=np.float32)
image_ndarray = image_ndarray / 255. 
About the binary model, I cannot attach the model since it is too big to insert it here. That is why I was asking for your email.
		</comment>
		<comment id='12' author='adriacabeza' date='2019-06-20T22:31:32Z'>
		&lt;denchmark-link:https://github.com/adriacabeza&gt;@adriacabeza&lt;/denchmark-link&gt;
 How big is the model? Would you compress it?
Email systems have their limits as well.
		</comment>
		<comment id='13' author='adriacabeza' date='2019-07-03T11:18:46Z'>
		I tried tar, tar.gz, zip and 7z and the compression rate was really low for all of them.
However, not long ago I was told I cannot share the model for external issues, so I am trying to replicate it by myself with another dataset.
		</comment>
		<comment id='14' author='adriacabeza' date='2019-07-09T22:48:53Z'>
		&lt;denchmark-link:https://github.com/adriacabeza&gt;@adriacabeza&lt;/denchmark-link&gt;
 do you still need assistance to debug this? If you cannot share the entire model, sharing part of it that causes the issue can also help. If it's no longer an issue, please close this, thanks!
		</comment>
	</comments>
</bug>