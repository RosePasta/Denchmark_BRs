<bug id='5318' author='haven-jeon' open_date='2020-12-31T13:49:05Z' closed_time='2021-01-18T17:25:05Z'>
	<summary>RPC timeout when model parallel with large model(&amp;gt; 4B)</summary>
	<description>
&lt;denchmark-h:h2&gt;üêõ Bug&lt;/denchmark-h&gt;

Although different results will be shown depending on hardware conditions such as GPU specifications, it can be seen that rpc timeout errors may occur while making piped sequeicial models. In my case, it occurred by making the 4B's GPT2 model as a sequential parallel model on 8 x P40 GPU.
&lt;denchmark-code&gt;Exception has occurred: RuntimeError
RPCErr:1:RPC ran for more than 60000 milliseconds and timed out.
&lt;/denchmark-code&gt;

It would be nice to have the following rpc_timeout_sec parameters that can control the RPC timeout.
DDPSequentialPlugin(balance=[5, 5, 5, 5, 5, 5, 5, 4], microbatches=8, rpc_timeout_sec=60 * 5)
After modifying the following code, training could proceed normally.
&lt;denchmark-link:https://github.com/haven-jeon/pytorch-lightning/commit/6e2205cda65562df0860b14f6b20b994ee494d8a&gt;haven-jeon@6e2205c&lt;/denchmark-link&gt;

&lt;denchmark-h:h2&gt;Please reproduce using the BoringModel&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;python train.py --gpus 8 --accelerator ddp  ....  --use_ddp_sequential
&lt;/denchmark-code&gt;

&lt;denchmark-h:h3&gt;To Reproduce&lt;/denchmark-h&gt;

&lt;denchmark-h:h3&gt;Environment&lt;/denchmark-h&gt;


PyTorch Version (e.g., 1.0): 1.6.0
OS (e.g., Linux): CentOS 7
How you installed PyTorch (conda, pip, source): source
Build command you used (if compiling from source): pip install -U .
Python version: 3.7
CUDA/cuDNN version: 10.1
GPU models and configuration: P40
Any other relevant information:

&lt;denchmark-h:h3&gt;Additional context&lt;/denchmark-h&gt;

	</description>
	<comments>
		<comment id='1' author='haven-jeon' date='2021-01-04T09:13:00Z'>
		Dear &lt;denchmark-link:https://github.com/haven-jeon&gt;@haven-jeon&lt;/denchmark-link&gt;
,
Would you mind making a PR for adding rpc_timeout_sec ?
Best regards,
T.C
		</comment>
		<comment id='2' author='haven-jeon' date='2021-01-04T11:24:26Z'>
		
Dear @haven-jeon,
Would you mind making a PR for adding rpc_timeout_sec ?
Best regards,
T.C

Sure! üòÑ
		</comment>
		<comment id='3' author='haven-jeon' date='2021-01-16T05:53:32Z'>
		&lt;denchmark-link:https://github.com/tchaton&gt;@tchaton&lt;/denchmark-link&gt;
  The code has already been applied, can I close the issue?
		</comment>
		<comment id='4' author='haven-jeon' date='2021-01-18T17:25:25Z'>
		Hey &lt;denchmark-link:https://github.com/haven-jeon&gt;@haven-jeon&lt;/denchmark-link&gt;
,
Yes, closing the issue.
Best regards,
T.C
		</comment>
	</comments>
</bug>