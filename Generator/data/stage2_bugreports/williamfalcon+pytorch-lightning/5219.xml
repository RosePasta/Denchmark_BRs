<bug id='5219' author='pisarik' open_date='2020-12-21T14:43:32Z' closed_time='2021-01-18T17:14:23Z'>
	<summary>Typing: LightningModule casted to double turns into nn.Module</summary>
	<description>
&lt;denchmark-h:h2&gt;üêõ Bug&lt;/denchmark-h&gt;

import pytorch_lightning as pl


class PLModule(pl.LightningModule):
    pass


module = PLModule().double()
trainer = pl.Trainer()
trainer.fit(module)
You will get a typing warning on the last line in PyCharm:
Expected type 'LightningModule', got 'Module' instead 
&lt;denchmark-h:h3&gt;Expected behavior&lt;/denchmark-h&gt;

No typing warnings
&lt;denchmark-h:h3&gt;Environment&lt;/denchmark-h&gt;

PyCharm 2020.3
pytorch-lightning 1.1.1
	</description>
	<comments>
		<comment id='1' author='pisarik' date='2020-12-21T14:44:15Z'>
		Hi! thanks for your contribution!, great first issue!
		</comment>
		<comment id='2' author='pisarik' date='2021-01-18T17:12:50Z'>
		Hey &lt;denchmark-link:https://github.com/pisarik&gt;@pisarik&lt;/denchmark-link&gt;
,
I tried with BoringModel and everything seems fine.
&lt;denchmark-code&gt;def test_lightning_module_conversion(tmpdir):

    class Model(BoringModel):
        def step(self, x):
            x = self(x.double())
            out = torch.nn.functional.mse_loss(x, torch.ones_like(x))
            return out

        def training_step(self, batch, batch_idx):
            output = self.layer(batch.double())
            loss = self.loss(batch, output)
            return {"loss": loss}

        def validation_step(self, batch, batch_idx):
            output = self.layer(batch.double())
            loss = self.loss(batch, output)
            return {"x": loss}

    model = Model()
    model = model.double()
    assert isinstance(model, LightningModule)
    model.training_epoch_end = None

    trainer = Trainer(
        max_epochs=1,
        default_root_dir=tmpdir,
        limit_train_batches=8,
        accumulate_grad_batches=1,
    )

    trainer.fit(model)
&lt;/denchmark-code&gt;

I am closing this issue as I couldn't reproduce the bug with provided sample.
		</comment>
		<comment id='3' author='pisarik' date='2021-01-20T19:39:45Z'>
		&lt;denchmark-link:https://github.com/tchaton&gt;@tchaton&lt;/denchmark-link&gt;
 The reason why it works for you is because you added the line .
Pycharm recognizes such lines and assumes that after assert the  is of type , otherwise it would raise an error.
If you will remove the line with assert, then you will get exactly the same typing warning as I described.
However, if you will further remove .double(), then the typing warning disappear. I.e. casting model to double somehow breaks typings (perhaps because it returns Module instead of LightningModule).
		</comment>
	</comments>
</bug>