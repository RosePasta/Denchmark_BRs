<bug id='3189' author='dedeswim' open_date='2020-08-26T08:25:32Z' closed_time='2020-10-07T21:55:25Z'>
	<summary>Broken [Source] links in docs</summary>
	<description>
&lt;denchmark-h:h2&gt;ðŸ“š Documentation&lt;/denchmark-h&gt;

Hello, I was browsing the docs, and out of curiosity, I wanted to check the source for , and so I clicked on the [Source] link of the  method. The link, however, sends to &lt;denchmark-link:https://github.com/PyTorchLightning/PyTorch-Lightning/blob/pytorch_lightning/core/lightning/LightningModule.py&gt;https://github.com/PyTorchLightning/PyTorch-Lightning/blob/pytorch_lightning/core/lightning/LightningModule.py&lt;/denchmark-link&gt;
, which is not right, as the repo name is "pytorch-lightning".
I am not familiar with Sphinx, but I checked the docs and the conf file, and I think that the reason can be found here:



pytorch-lightning/docs/source/conf.py


        Lines 59 to 71
      in
      ee4eae8






 project = 'PyTorch-Lightning' 



 copyright = pytorch_lightning.__copyright__ 



 author = pytorch_lightning.__author__ 



 



 # The short X.Y version 



 version = pytorch_lightning.__version__ 



 # The full version, including alpha/beta/rc tags 



 release = pytorch_lightning.__version__ 



 



 # Options for the linkcode extension 



 # ---------------------------------- 



 github_user = 'PyTorchLightning' 



 github_repo = project 





Since github-repo is set to project, which is, indeed, PyTorch-Lightning, as in the broken link.
If someone more familiar with Sphinx can confirm this, I'd be glad to submit a PR to fix this.
	</description>
	<comments>
		<comment id='1' author='dedeswim' date='2020-08-26T08:26:10Z'>
		Hi! thanks for your contribution!, great first issue!
		</comment>
		<comment id='2' author='dedeswim' date='2020-08-26T16:12:02Z'>
		&lt;denchmark-link:https://github.com/awaelchli&gt;@awaelchli&lt;/denchmark-link&gt;
 mind have look? 
		</comment>
		<comment id='3' author='dedeswim' date='2020-08-26T16:20:24Z'>
		&lt;denchmark-link:https://github.com/dedeswim&gt;@dedeswim&lt;/denchmark-link&gt;
 so the reason you pointed out is not exactly why a wrong link is being generated for LightningModule.
&lt;denchmark-link:https://github.com/PyTorchLightning/pytorch-lightning/blob/master/docs/source/conf.py#L347&gt;https://github.com/PyTorchLightning/pytorch-lightning/blob/master/docs/source/conf.py#L347&lt;/denchmark-link&gt;

The function linkcode_resolve generates the 'source' links in the doc and that is giving out the wrong link for LightningModule. If you see the link generated for say TrainResult class, it links to the master branch and the exact line number for the methods, which is not the case here.
		</comment>
		<comment id='4' author='dedeswim' date='2020-08-26T16:22:34Z'>
		btw, need to keep compatibility with tagged releases as well as with master...
		</comment>
		<comment id='5' author='dedeswim' date='2020-08-26T19:55:24Z'>
		Hi, thank you &lt;denchmark-link:https://github.com/ananyahjha93&gt;@ananyahjha93&lt;/denchmark-link&gt;
 for the explanation!
I indeed realized that the link should go to "pytorch_lightning/core/lightning.py", instead of "pytorch_lightning/core/lightning/LightningModule.py".
Interestingly, the 0.8.5 version of the docs redirects to the right link (the one above), whereas the "0.9.0", "latest" and "stable" versions (which are the same version, right?) don't work.
		</comment>
		<comment id='6' author='dedeswim' date='2020-08-27T07:01:42Z'>
		ok, then we may have the wrong path in docs, is it only this case or all docs have wrong links?
		</comment>
		<comment id='7' author='dedeswim' date='2020-08-27T07:07:09Z'>
		I tried with all the other classes under the "Python API" section of the bar on the right in the docs and it looks like this is the only one broken
		</comment>
		<comment id='8' author='dedeswim' date='2020-08-27T07:23:33Z'>
		ok, then it is nothing with linkcode_resolve but just wrong link in docs, mind send a PR fix



pytorch-lightning/pytorch_lightning/core/lightning.py


         Line 136
      in
      4d98419






 def forward(self, *args, **kwargs): 





		</comment>
		<comment id='9' author='dedeswim' date='2020-08-27T08:04:38Z'>
		I'd be happy to, but I am not sure about how to fix this. Where is the path to the source defined? Isn't it generated by linkcode_resolve?
		</comment>
		<comment id='10' author='dedeswim' date='2020-08-27T15:27:44Z'>
		&lt;denchmark-link:https://github.com/Borda&gt;@Borda&lt;/denchmark-link&gt;
 others are correct, LightningModule is the only one that seems broken.
		</comment>
		<comment id='11' author='dedeswim' date='2020-09-01T18:50:12Z'>
		it looks like this is because in the .rst docs we refer to the methods with autofunction instead of automethod. changing to automethod solves the link issue, but breaks formatting of docs, need to figure out how to  properly use it.
		</comment>
		<comment id='12' author='dedeswim' date='2020-09-14T16:39:40Z'>
		&lt;denchmark-link:https://github.com/Borda&gt;@Borda&lt;/denchmark-link&gt;
 or &lt;denchmark-link:https://github.com/awaelchli&gt;@awaelchli&lt;/denchmark-link&gt;
 is there a specific reason using  extension?
if not, shall we use this extension &lt;denchmark-link:https://www.sphinx-doc.org/en/master/usage/extensions/viewcode.html&gt;https://www.sphinx-doc.org/en/master/usage/extensions/viewcode.html&lt;/denchmark-link&gt;
?
this creates  folder for source code and link to that folder. PyTorch is using this also.
It also solves this issue using ,  won't work just like &lt;denchmark-link:https://github.com/awaelchli&gt;@awaelchli&lt;/denchmark-link&gt;
 comment.
I discovered that PyTorch docs doesn't refer to source code for , so we need to add some css to the forked theme.
Here's the tried output:
It doesn't show self which is pretty normal I think, just like methods of other classes.
&lt;denchmark-link:https://user-images.githubusercontent.com/32727188/93113155-d7af8b80-f6de-11ea-9840-7026948f0250.png&gt;&lt;/denchmark-link&gt;

		</comment>
		<comment id='13' author='dedeswim' date='2020-09-14T16:54:57Z'>
		&lt;denchmark-link:https://github.com/ydcjeff&gt;@ydcjeff&lt;/denchmark-link&gt;
 nice, could you make a draft PR so we can try it out?
		</comment>
		<comment id='14' author='dedeswim' date='2020-09-14T16:58:04Z'>
		&lt;denchmark-link:https://github.com/awaelchli&gt;@awaelchli&lt;/denchmark-link&gt;
 with  extension?
sure, I can
		</comment>
		<comment id='15' author='dedeswim' date='2020-09-14T17:05:36Z'>
		so you say it's a two step fix.

replace linkcode with viewcode, which solves the problem with linked source code, but we lose methods source code
add the custom css to the theme so we have methods properly linked

if it can consistently link all modules, classes, methods and functions, I think this is what we want.
		</comment>
		<comment id='16' author='dedeswim' date='2020-09-14T17:09:43Z'>
		Yes, pytorch sphinx theme doesn't include css for directly linking methods.
So, we need to add it. I think viewcode works with all modules, classes, methods and functions.
But i will try with all to make sure it works and i will draft a PR
		</comment>
		<comment id='17' author='dedeswim' date='2020-09-15T22:38:50Z'>
		just testing and sure if it is a better way as before it linked to GitHub source and you simply create a perm link...
		</comment>
	</comments>
</bug>