<bug id='64' author='vivekam101' open_date='2020-06-22T15:48:46Z' closed_time='2020-06-23T18:15:59Z'>
	<summary>Bert Inference Issue</summary>
	<description>
Thanks for the repo.. Can you guys please check for below error
$ python -m models.bert --dataset Reuters  --model bert-base-uncased --max-seq-length 256 --batch-size 16 --lr 2e-5 --epochs 30 --trained-model model_checkpoints/bert/Reuters/2020-06-21_10-03-33.pt
&lt;denchmark-h:hr&gt;&lt;/denchmark-h&gt;

Device: CUDA
Number of GPUs: 4
FP16: False
Traceback (most recent call last):
File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
"main", mod_spec)
File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
exec(code, run_globals)
File "/home/ubuntu/vivek/hedwig/models/bert/main.py", line 122, in 
warmup_steps=args.warmup_proportion * num_train_optimization_steps)
TypeError: unsupported operand type(s) for *: 'float' and 'NoneType'
&lt;denchmark-h:hr&gt;&lt;/denchmark-h&gt;

Please check
	</description>
	<comments>
		<comment id='1' author='vivekam101' date='2020-06-23T04:39:55Z'>
		Hello &lt;denchmark-link:https://github.com/vivekam101&gt;@vivekam101&lt;/denchmark-link&gt;
! Thanks for pointing this issue out. Looks like there is a bug in scheduler initialization when loading a trained BERT model. Please let me know if the changes in &lt;denchmark-link:https://github.com/castorini/hedwig/pull/65&gt;#65&lt;/denchmark-link&gt;
 fix this for you.
		</comment>
	</comments>
</bug>