<bug id='140' author='sanersbug' open_date='2018-10-25T05:42:19Z' closed_time='2018-12-17T22:19:21Z'>
	<summary>ninja: build stopped: subcommand failed.</summary>
	<description>
After i installed ninja , When i run
python main.py --dataset cifar10 --model encnetdrop --widen 8 --ncodes 32 --resume model/encnet_cifar.pth.tar --eval
it shows the error:
/home/anaconda3/lib/python3.6/site-packages/torch/utils/cpp_extension.py:118: UserWarning:
&lt;denchmark-code&gt;                           !! WARNING !!
&lt;/denchmark-code&gt;

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) may be ABI-incompatible with PyTorch!
Please use a compiler that is ABI-compatible with GCC 4.9 and above.
See &lt;denchmark-link:https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html&gt;https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html&lt;/denchmark-link&gt;
.
See &lt;denchmark-link:https://gist.github.com/goldsborough/d466f43e8ffc948ff92de7486c5216d6&gt;https://gist.github.com/goldsborough/d466f43e8ffc948ff92de7486c5216d6&lt;/denchmark-link&gt;

for instructions on how to install GCC 4.9 or higher.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;denchmark-code&gt;                          !! WARNING !!
&lt;/denchmark-code&gt;

warnings.warn(ABI_INCOMPATIBILITY_WARNING.format(compiler))
Traceback (most recent call last):
File "/home/anaconda3/lib/python3.6/site-packages/torch/utils/cpp_extension.py", line 759, in _build_extension_module
['ninja', '-v'], stderr=subprocess.STDOUT, cwd=build_directory)
File "/home/anaconda3/lib/python3.6/subprocess.py", line 336, in check_output
**kwargs).stdout
File "/home/anaconda3/lib/python3.6/subprocess.py", line 418, in run
output=stdout, stderr=stderr)
subprocess.CalledProcessError: Command '['ninja', '-v']' returned non-zero exit status 1.
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
File "main.py", line 24, in 
from encoding.utils import *
File "/home/anaconda3/lib/python3.6/site-packages/encoding/init.py", line 13, in 
from . import nn, functions, dilated, parallel, utils, models, datasets
File "/home/anaconda3/lib/python3.6/site-packages/encoding/nn/init.py", line 12, in 
from .encoding import *
File "/home/anaconda3/lib/python3.6/site-packages/encoding/nn/encoding.py", line 18, in 
from ..functions import scaled_l2, aggregate, pairwise_cosine
File "/home/anaconda3/lib/python3.6/site-packages/encoding/functions/init.py", line 2, in 
from .encoding import *
File "/home/anaconda3/lib/python3.6/site-packages/encoding/functions/encoding.py", line 14, in 
from .. import lib
File "/home/anaconda3/lib/python3.6/site-packages/encoding/lib/init.py", line 15, in 
], build_directory=cpu_path, verbose=False)
File "/home/anaconda3/lib/python3.6/site-packages/torch/utils/cpp_extension.py", line 514, in load
with_cuda=with_cuda)
File "/home/anaconda3/lib/python3.6/site-packages/torch/utils/cpp_extension.py", line 682, in _jit_compile
_build_extension_module(name, build_directory)
File "/home/anaconda3/lib/python3.6/site-packages/torch/utils/cpp_extension.py", line 765, in _build_extension_module
name, error.output.decode()))
RuntimeError: Error building extension 'enclib_cpu': [1/4] c++ -MMD -MF syncbn_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/TH -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/THC -I/home/anaconda3/include/python3.6m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/syncbn_cpu.cpp -o syncbn_cpu.o
FAILED: syncbn_cpu.o
c++ -MMD -MF syncbn_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/TH -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/THC -I/home/anaconda3/include/python3.6m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/syncbn_cpu.cpp -o syncbn_cpu.o
/home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/syncbn_cpu.cpp:1:26: fatal error: torch/tensor.h: No such file or directory
compilation terminated.
[2/4] c++ -MMD -MF roi_align_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/TH -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/THC -I/home/anaconda3/include/python3.6m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/roi_align_cpu.cpp -o roi_align_cpu.o
FAILED: roi_align_cpu.o
c++ -MMD -MF roi_align_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/TH -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/THC -I/home/anaconda3/include/python3.6m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/roi_align_cpu.cpp -o roi_align_cpu.o
/home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/roi_align_cpu.cpp:1:26: fatal error: torch/tensor.h: No such file or directory
compilation terminated.
[3/4] c++ -MMD -MF nms_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/TH -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/THC -I/home/anaconda3/include/python3.6m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/nms_cpu.cpp -o nms_cpu.o
FAILED: nms_cpu.o
c++ -MMD -MF nms_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/TH -I/home/anaconda3/lib/python3.6/site-packages/torch/lib/include/THC -I/home/anaconda3/include/python3.6m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/nms_cpu.cpp -o nms_cpu.o
/home/anaconda3/lib/python3.6/site-packages/encoding/lib/cpu/nms_cpu.cpp:1:26: fatal error: torch/tensor.h: No such file or directory
compilation terminated.
ninja: build stopped: subcommand failed.
	</description>
	<comments>
		<comment id='1' author='sanersbug' date='2018-10-25T14:43:54Z'>
		That looks like PyTorch problem.
		</comment>
		<comment id='2' author='sanersbug' date='2018-11-13T04:23:08Z'>
		hi, have you solved this problem ?
		</comment>
		<comment id='3' author='sanersbug' date='2018-11-13T14:14:17Z'>
		Wow, I have faced with the same problem. But I have an gcc version of 5.4.0, I don't know why.
		</comment>
		<comment id='4' author='sanersbug' date='2018-11-13T16:05:24Z'>
		Hello! im getting the same error when i try running model/download_models.py
Did anyone manage to solve this issue?
		</comment>
		<comment id='5' author='sanersbug' date='2018-11-13T17:58:43Z'>
		Please change torch/torch.h to torch/extension.h. This is because rapid updates in PyTorch.
		</comment>
		<comment id='6' author='sanersbug' date='2018-11-14T10:50:09Z'>
		Thanks for the quick reply.
Unfortunately the error message persists even after changing the name.
(I changed pipPath/torch/lib/include/torch/torch.h to extension.h, where pipPath = folder that includes all pip installs).
Heres the error message i get when running model/download_models.py. I will highlight the errors in bold with gcc version5.4.0:
`
/home/ev/.local/lib/python3.5/site-packages/torch/utils/cpp_extension.py:118: UserWarning:
&lt;denchmark-code&gt;                           !! WARNING !!
&lt;/denchmark-code&gt;

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) may be ABI-incompatible with PyTorch!
Please use a compiler that is ABI-compatible with GCC 4.9 and above.
See &lt;denchmark-link:https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html&gt;https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html&lt;/denchmark-link&gt;
.
See &lt;denchmark-link:https://gist.github.com/goldsborough/d466f43e8ffc948ff92de7486c5216d6&gt;https://gist.github.com/goldsborough/d466f43e8ffc948ff92de7486c5216d6&lt;/denchmark-link&gt;

for instructions on how to install GCC 4.9 or higher.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;denchmark-code&gt;                          !! WARNING !!
&lt;/denchmark-code&gt;

warnings.warn(ABI_INCOMPATIBILITY_WARNING.format(compiler))
Traceback (most recent call last):
File "/home/ev/.local/lib/python3.5/site-packages/torch/utils/cpp_extension.py", line 759, in _build_extension_module
['ninja', '-v'], stderr=subprocess.STDOUT, cwd=build_directory)
File "/usr/lib/python3.5/subprocess.py", line 626, in check_output
**kwargs).stdout
File "/usr/lib/python3.5/subprocess.py", line 708, in run
output=stdout, stderr=stderr)
subprocess.CalledProcessError: Command '['ninja', '-v']' returned non-zero exit status 1
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
File "model/download_models.py", line 1, in 
import encoding
File "/home/ev/.local/lib/python3.5/site-packages/encoding/init.py", line 13, in 
from . import nn, functions, dilated, parallel, utils, models, datasets
File "/home/ev/.local/lib/python3.5/site-packages/encoding/nn/init.py", line 12, in 
from .encoding import *
File "/home/ev/.local/lib/python3.5/site-packages/encoding/nn/encoding.py", line 18, in 
from ..functions import scaled_l2, aggregate, pairwise_cosine
File "/home/ev/.local/lib/python3.5/site-packages/encoding/functions/init.py", line 2, in 
from .encoding import *
File "/home/ev/.local/lib/python3.5/site-packages/encoding/functions/encoding.py", line 14, in 
from .. import lib
File "/home/ev/.local/lib/python3.5/site-packages/encoding/lib/init.py", line 15, in 
], build_directory=cpu_path, verbose=False)
File "/home/evangello/.local/lib/python3.5/site-packages/torch/utils/cpp_extension.py", line 514, in load
with_cuda=with_cuda)
File "/home/evangello/.local/lib/python3.5/site-packages/torch/utils/cpp_extension.py", line 682, in _jit_compile
_build_extension_module(name, build_directory)
File "/home/ev/.local/lib/python3.5/site-packages/torch/utils/cpp_extension.py", line 765, in _build_extension_module
name, error.output.decode()))
RuntimeError: Error building extension 'enclib_cpu': [1/4] c++ -MMD -MF syncbn_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/TH -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/THC -I/usr/include/python3.5m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/syncbn_cpu.cpp -o syncbn_cpu.o
FAILED: syncbn_cpu.o
c++ -MMD -MF syncbn_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/TH -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/THC -I/usr/include/python3.5m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/syncbn_cpu.cpp -o syncbn_cpu.o
/home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/syncbn_cpu.cpp:1:26: fatal error: torch/tensor.h: No such file or directory
compilation terminated.
[2/4] c++ -MMD -MF roi_align_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/TH -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/THC -I/usr/include/python3.5m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/roi_align_cpu.cpp -o roi_align_cpu.o
FAILED: roi_align_cpu.o
c++ -MMD -MF roi_align_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/TH -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/THC -I/usr/include/python3.5m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/roi_align_cpu.cpp -o roi_align_cpu.o
/home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/roi_align_cpu.cpp:1:26: fatal error: torch/tensor.h: No such file or directory
compilation terminated.
[3/4] c++ -MMD -MF nms_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/TH -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/THC -I/usr/include/python3.5m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/nms_cpu.cpp -o nms_cpu.o
FAILED: nms_cpu.o
c++ -MMD -MF nms_cpu.o.d -DTORCH_EXTENSION_NAME=enclib_cpu -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/TH -I/home/ev/.local/lib/python3.5/site-packages/torch/lib/include/THC -I/usr/include/python3.5m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++11 -c /home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/nms_cpu.cpp -o nms_cpu.o
/home/ev/.local/lib/python3.5/site-packages/encoding/lib/cpu/nms_cpu.cpp:1:26: fatal error: torch/tensor.h: No such file or directory
compilation terminated.
ninja: build stopped: subcommand failed.
`
		</comment>
		<comment id='7' author='sanersbug' date='2018-11-14T17:11:11Z'>
		see my previous comment &lt;denchmark-link:https://github.com/zhanghang1989/PyTorch-Encoding/issues/140#issuecomment-438373706&gt;#140 (comment)&lt;/denchmark-link&gt;

		</comment>
		<comment id='8' author='sanersbug' date='2018-11-18T01:59:44Z'>
		I found that the problem is that the position of &lt;torch/tensor.h&gt; has been changed , it's in &lt;torch/serialize/tensor.h&gt; now. I changed the code and solved my prolem.
		</comment>
		<comment id='9' author='sanersbug' date='2018-11-19T05:45:31Z'>
		
I found that the problem is that the position of &lt;torch/tensor.h&gt; has been changed , it's in &lt;torch/serialize/tensor.h&gt; now. I changed the code and solved my prolem.

Hi, which version of pytorch do you use??
		</comment>
		<comment id='10' author='sanersbug' date='2018-11-19T06:08:14Z'>
		&lt;denchmark-link:https://user-images.githubusercontent.com/18614177/48689044-bb865480-ec03-11e8-9fc7-18a17380cf7c.png&gt;&lt;/denchmark-link&gt;

This is the version of pytorch. I use the master branch of Nov, 17. But I think may be v1.0 will help after change the code.
ps:CUDA=9.0, CUDNN=7.0. I wish that these will help.
		</comment>
		<comment id='11' author='sanersbug' date='2018-11-19T18:11:58Z'>
		Please change torch/torch.h to torch/extension.h. This is because rapid updates in PyTorch.
		</comment>
		<comment id='12' author='sanersbug' date='2018-11-29T03:22:21Z'>
		
I found that the problem is that the position of &lt;torch/tensor.h&gt; has been changed , it's in &lt;torch/serialize/tensor.h&gt; now. I changed the code and solved my prolem.

Hello, i meet the same problems, i want to know how to change the code? than you
		</comment>
		<comment id='13' author='sanersbug' date='2018-11-29T03:36:39Z'>
		

I found that the problem is that the position of &lt;torch/tensor.h&gt; has been changed , it's in &lt;torch/serialize/tensor.h&gt; now. I changed the code and solved my prolem.

Hello, i meet the same problems, i want to know how to change the code? than you

At first I tried what &lt;denchmark-link:https://github.com/zhanghang1989&gt;@zhanghang1989&lt;/denchmark-link&gt;
 said " Please change torch/torch.h to torch/extension.h. " .But it didn't solve my problem. I found that the error was that &lt;torch/tensor.h&gt; couldnot be found, so I changed all the "#include &lt;torch/tensor.h&gt;" in cpp files to "#include &lt;torch/serialize/tensor.h&gt;". Maybe the position of "tensor.h" can be different, you can change the path in your own system. Hope this will help.
		</comment>
		<comment id='14' author='sanersbug' date='2018-11-30T09:20:10Z'>
		


I found that the problem is that the position of &lt;torch/tensor.h&gt; has been changed , it's in &lt;torch/serialize/tensor.h&gt; now. I changed the code and solved my prolem.

Hello, i meet the same problems, i want to know how to change the code? than you

At first I tried what @zhanghang1989 said " Please change torch/torch.h to torch/extension.h. " .But it didn't solve my problem. I found that the error was that &lt;torch/tensor.h&gt; couldnot be found, so I changed all the "#include &lt;torch/tensor.h&gt;" in cpp files to "#include &lt;torch/serialize/tensor.h&gt;". Maybe the position of "tensor.h" can be different, you can change the path in your own system. Hope this will help.

I have the same problem as yours.
		</comment>
		<comment id='15' author='sanersbug' date='2019-04-10T02:59:35Z'>
		
Please change torch/torch.h to torch/extension.h. This is because rapid updates in PyTorch.


hi, Rename torch.h to extension.h  ?
		</comment>
	</comments>
</bug>