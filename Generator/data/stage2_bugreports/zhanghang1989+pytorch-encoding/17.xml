<bug id='17' author='SoonminHwang' open_date='2017-12-14T13:58:36Z' closed_time='2018-03-21T16:43:34Z'>
	<summary>Fail to install in Ubuntu 14.04</summary>
	<description>
Hi.
Thanks for your effort.
I fail to install your library on my machine (Ubuntu 14.04, CUDA 8.0, python3 with anaconda).
&lt;denchmark-code&gt;$ python setup.py install
-- The C compiler identification is GNU 4.9.4
-- The CXX compiler identification is GNU 4.9.4
-- Check for working C compiler: /usr/bin/gcc
-- Check for working C compiler: /usr/bin/gcc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/gcc
-- Check for working CXX compiler: /usr/bin/gcc -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- TORCH_BUILD_DIR: /home/rcvlab/anaconda3/lib/python3.5/site-packages/torch/lib
-- Found CUDA: /usr/local/cuda (found suitable version "8.0", minimum required is "6.5")
-- Autodetected CUDA architecture(s): 6.1 6.1
-- Torch_INSTALL_INCLUDE:/home/rcvlab/anaconda3/lib/python3.5/site-packages/torch/lib/include/home/rcvlab/anaconda3/lib/python3.5/site-packages/torch/lib/include/TH/home/rcvlab/anaconda3/lib/python3.5/site-packages/torch/lib/include/THC
-- Configuring done
-- Generating done
-- Build files have been written to: /media/rcvlab/soonmin2017/pytorch.segmentation/semantic/external/PyTorch-Encoding/encoding/lib
[100%] Building NVCC (Device) object CMakeFiles/ENCODING.dir/kernel/./ENCODING_generated_thc_encoding.cu.o
CMake Warning at /usr/share/cmake-2.8/Modules/FindCUDA/make2cmake.cmake:66 (message):
   Removing non-existent dependency file: generic/THStorage.h

CMake Warning at /usr/share/cmake-2.8/Modules/FindCUDA/make2cmake.cmake:66 (message):
   Removing non-existent dependency file: generic/THStorageCopy.h

CMake Warning at /usr/share/cmake-2.8/Modules/FindCUDA/make2cmake.cmake:66 (message):
   Removing non-existent dependency file: generic/THCStorage.h

CMake Warning at /usr/share/cmake-2.8/Modules/FindCUDA/make2cmake.cmake:66 (message):
   Removing non-existent dependency file: generic/THCStorageCopy.h

CMake Warning at /usr/share/cmake-2.8/Modules/FindCUDA/make2cmake.cmake:66 (message):
   Removing non-existent dependency file: generic/THTensor.h

CMake Warning at /usr/share/cmake-2.8/Modules/FindCUDA/make2cmake.cmake:66 (message):
   Removing non-existent dependency file: generic/THTensorCopy.h
...

/usr/lib/gcc/x86_64-linux-gnu/4.9/include/stddef.h(432): error: identifier "nullptr" is undefined
/usr/lib/gcc/x86_64-linux-gnu/4.9/include/stddef.h(432): error: expected a ";"
/usr/include/x86_64-linux-gnu/c++/4.9/bits/c++config.h(192): error: expected a ";"
/usr/include/c++/4.9/exception(63): error: expected a ";"
&lt;/denchmark-code&gt;

And finally,
&lt;denchmark-code&gt;/usr/include/c++/4.9/cmath(240): error: inline specifier allowed on function declarations only

/usr/include/c++/4.9/cmath(240): error: variable "std::constexpr" has already been defined

/usr/include/c++/4.9/cmath(240): error: expected a ";"

Error limit reached.
100 errors detected in the compilation of "/tmp/tmpxft_0000331f_00000000-7_thc_encoding.cpp1.ii".
Compilation terminated.
CMake Error at ENCODING_generated_thc_encoding.cu.o.cmake:264 (message):
  Error generating file
  /media/rcvlab/soonmin2017/pytorch.segmentation/semantic/external/PyTorch-Encoding/encoding/lib/CMakeFiles/ENCODING.dir/kernel/./ENCODING_generated_thc_encoding.cu.o


make[2]: *** [CMakeFiles/ENCODING.dir/kernel/./ENCODING_generated_thc_encoding.cu.o] Error 1
make[1]: *** [CMakeFiles/ENCODING.dir/all] Error 2
make: *** [all] Error 2
Traceback (most recent call last):
  File "setup.py", line 69, in &lt;module&gt;
    'install': install,
  File "/home/rcvlab/anaconda3/lib/python3.5/distutils/core.py", line 108, in setup
    _setup_distribution = dist = klass(attrs)
  File "/home/rcvlab/anaconda3/lib/python3.5/site-packages/setuptools/dist.py", line 338, in __init__
    _Distribution.__init__(self, attrs)
  File "/home/rcvlab/anaconda3/lib/python3.5/distutils/dist.py", line 281, in __init__
    self.finalize_options()
  File "/home/rcvlab/anaconda3/lib/python3.5/site-packages/setuptools/dist.py", line 471, in finalize_options
    ep.load()(self, ep.name, value)
  File "/home/rcvlab/anaconda3/lib/python3.5/site-packages/cffi/setuptools_ext.py", line 188, in cffi_modules
    add_cffi_module(dist, cffi_module)
  File "/home/rcvlab/anaconda3/lib/python3.5/site-packages/cffi/setuptools_ext.py", line 49, in add_cffi_module
    execfile(build_file_name, mod_vars)
  File "/home/rcvlab/anaconda3/lib/python3.5/site-packages/cffi/setuptools_ext.py", line 25, in execfile
    exec(code, glob, glob)
  File "/media/rcvlab/soonmin2017/pytorch.segmentation/semantic/external/PyTorch-Encoding/build.py", line 36, in &lt;module&gt;
    subprocess.check_call(build_all_cmd, env=dict(os.environ))
  File "/home/rcvlab/anaconda3/lib/python3.5/subprocess.py", line 581, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['bash', 'encoding/make.sh']' returned non-zero exit status 2
&lt;/denchmark-code&gt;

I guess it's a gcc compiler issue, but I'm not sure.
Could you give me a hint for it?
	</description>
	<comments>
		<comment id='1' author='SoonminHwang' date='2017-12-25T00:34:12Z'>
		Hi, I don't have a ubuntu machine at hand now for reproducing the error. I will follow up this issue next month.
		</comment>
		<comment id='2' author='SoonminHwang' date='2018-01-15T18:16:46Z'>
		I also got this issue, but I seem to find a solution.
change line 5 in  encoding/make.sh
from
  cmake  ..
to
  cmake -DCUDA_NVCC_FLAGS='-std=c++11' ..
works for me.
reference: &lt;denchmark-link:https://github.com/ComputationalRadiationPhysics/picongpu/issues/1147&gt;ComputationalRadiationPhysics/picongpu#1147&lt;/denchmark-link&gt;

		</comment>
		<comment id='3' author='SoonminHwang' date='2018-02-27T16:06:55Z'>
		The above solution doesn't work for me.
		</comment>
		<comment id='4' author='SoonminHwang' date='2018-03-16T21:03:29Z'>
		I could not reproduce the above error on my machine. Please try
&lt;denchmark-code&gt;CFLAGS="-std=c99" python setup.py install
&lt;/denchmark-code&gt;

		</comment>
		<comment id='5' author='SoonminHwang' date='2018-03-21T15:09:53Z'>
		Hi &lt;denchmark-link:https://github.com/cbelth&gt;@cbelth&lt;/denchmark-link&gt;
, I got the same issue and I solve it as follows,

change line 5 in encoding/make.sh to cmake -DCUDA_NVCC_FLAGS='-std=c++11' .. as suggested by @liruilong940607
Then the error become to ImportError: No module named 'tqdm' . I solve it using pip install tqdm

It works for me, my machine environment is Ubuntu 14.04, cuda 8.0, python 3.6 with Anaconda3 .
		</comment>
		<comment id='6' author='SoonminHwang' date='2018-03-21T16:43:34Z'>
		Thanks for the efforts and comments! This has been addressed in PR &lt;denchmark-link:https://github.com/zhanghang1989/PyTorch-Encoding/pull/27&gt;#27&lt;/denchmark-link&gt;
 . Feel free to reopen it if still getting the trouble.
		</comment>
	</comments>
</bug>