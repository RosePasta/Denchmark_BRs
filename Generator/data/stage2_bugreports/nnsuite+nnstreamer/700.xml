<bug id='700' author='myungjoo' open_date='2018-10-24T05:12:20Z' closed_time='2018-11-16T13:53:42Z'>
	<summary>[Pipeviz] Crashes when pipeviz uses nnstreamer</summary>
	<description>
Somebody, anyone who's got free hands, please test a full nnstreamer stream (video-&gt;t-converter-&gt;t-filter-&gt;t-decoder-&gt;videosink) and fix related issues (crashes).

 decoder cannot get-property in pipeviz to edit its properties #796

&lt;denchmark-code&gt;failed to get the current screen resources
QXcbConnection: XCB error: 170 (Unknown), sequence: 163, resource id: 90, major code: 146 (Unknown), minor code: 20
**
ERROR:/source/AutoDrv/NNStreamer/gst/tensor_decoder/tensordec.c:774:gst_tensordec_get_property: assertion failed: (self-&gt;mode &lt; DECODE_MODE_UNKNOWN)
Aborted (core dumped)
&lt;/denchmark-code&gt;


 decoder cannot set-property in pipeviz: #798

&lt;denchmark-code&gt;mzx@kohaku:/source/AutoDrv/pipeviz$ ./pipeviz
failed to get the current screen resources
QXcbConnection: XCB error: 170 (Unknown), sequence: 163, resource id: 90, major code: 146 (Unknown), minor code: 20
**
ERROR:/source/AutoDrv/NNStreamer/gst/tensor_decoder/tensordec.c:724:gst_tensordec_set_property: assertion failed: (key &gt;= 0)
Aborted (core dumped)
&lt;/denchmark-code&gt;


 videotestsrc-&gt;t_c-&gt;t_d-&gt;videoconvert-&gt;ximagesink FAIL #799

&lt;denchmark-code&gt;ERROR:/source/AutoDrv/NNStreamer/gst/tensor_decoder/tensordec-directvideo.c:130:dv_decode: assertion failed: (gst_buffer_get_size (outbuf) == 0)
Aborted (core dumped)
&lt;/denchmark-code&gt;


 Drawing t_c-&gt;t_f-&gt;t_d (direct_video) FAIL  #800

&lt;denchmark-code&gt;Thread 1 "pipeviz" received signal SIGSEGV, Segmentation fault.
0x00007fffe1aede0b in gst_tensor_filter_load_tensor_info (self=0xbae0d0) at /source/AutoDrv/NNStreamer/gst/tensor_filter/tensor_filter.c:770
770	    if (self-&gt;fw-&gt;getInputDimension) {
(gdb) 
&lt;/denchmark-code&gt;


 video -&gt; t_c -&gt; t_f (1:1) -&gt; t_d (direct_video) -&gt; videoconvert -&gt; ximagesink  #816 Fixed!
When model path is given to tensor_filter after configuring framework as custom

&lt;denchmark-code&gt;ERROR:/source/AutoDrv/NNStreamer/gst/tensor_filter/tensor_filter.c:507:gst_tensor_filter_set_property: assertion failed: (prop-&gt;custom_properties == NULL &amp;&amp; value)
&lt;/denchmark-code&gt;

(after applying workaround)
&lt;denchmark-code&gt;ERROR:/source/AutoDrv/NNStreamer/gst/tensor_filter/tensor_filter.c:399:gst_tensor_filter_set_property: assertion failed: (prop-&gt;nnfw == _T_F_UNDEFINED &amp;&amp; value)
&lt;/denchmark-code&gt;

(after yet another workaround)
&lt;denchmark-code&gt;Thread 1 "pipeviz" received signal SIGSEGV, Segmentation fault.
0x00007fffe038f9e3 in custom_loadlib (filter=0xfec0d0, private_data=0xfec310) at /source/AutoDrv/NNStreamer/gst/tensor_filter/tensor_filter_custom.c:78
78	      *((NNStreamer_custom_class **) dlsym (ptr-&gt;handle, "NNStreamer_custom"));
&lt;/denchmark-code&gt;

Then...
&lt;denchmark-code&gt;[New Thread 0x7fffe2068700 (LWP 28929)]
**
ERROR:/source/AutoDrv/NNStreamer/gst/tensor_filter/tensor_filter.c:433:gst_tensor_filter_set_property: assertion failed: (prop-&gt;model_file == NULL &amp;&amp; value)

&lt;/denchmark-code&gt;

After fixing them all with workarounds;;;
&lt;denchmark-code&gt;** (pipeviz:29391): WARNING **: /source/AutoDrv/NNStreamer/gst/tensor_filter/tensor_filter.c:1049 Cannot get the output tensor info.
**
ERROR:/source/AutoDrv/NNStreamer/gst/tensor_filter/tensor_filter.c:1050:gst_tensor_filter_transform_caps: assertion failed: (0)

Thread 6 "videotestsrc0:s" received signal SIGABRT, Aborted.
&lt;/denchmark-code&gt;


 [NOT TESTED] video -&gt; tee X -&gt; videoscale -&gt; t_c -&gt; t_f (label) -&gt; t_d (label) -&gt; textmixer (X) -&gt; videoconvert -&gt; ximagesink THE DEMO-1 / Need to Test

&lt;denchmark-code&gt;**
ERROR:/source/AutoDrv/NNStreamer/gst/tensor_converter/tensor_converter.c:340:gst_tensor_converter_set_property: assertion failed: (self-&gt;tensor_info.type != _NNS_END)
&lt;/denchmark-code&gt;

	</description>
	<comments>
		<comment id='1' author='myungjoo' date='2018-10-24T05:12:21Z'>
		 : Thank you for posting issue &lt;denchmark-link:https://github.com/nnstreamer/nnstreamer/issues/700&gt;#700&lt;/denchmark-link&gt;
. The person in charge will reply soon.
		</comment>
		<comment id='2' author='myungjoo' date='2018-10-24T06:31:40Z'>
		one of reason for this crash, as I tested before,
assertion fails when change property of element(ex tensor filter)
because, as of now, changing property on running time is prohibited in tensor filter.
gst launch and nnstreamer examples set properties before run-time
but when use pipeviz, first you have to choose element form elements list, at this time, elements set property as init property values, after that when user changes properties(ex tensorflow-lite model path),
it crashes with assertion in element's 'set property' function.
		</comment>
		<comment id='3' author='myungjoo' date='2018-11-16T13:53:42Z'>
		Done. and Pipeviz commits upstreamed.
		</comment>
	</comments>
</bug>