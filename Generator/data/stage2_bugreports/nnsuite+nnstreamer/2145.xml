<bug id='2145' author='myungjoo' open_date='2020-03-10T03:41:47Z' closed_time='2020-03-18T01:02:07Z'>
	<summary>[REGRESSION] TF-Lite/TF</summary>
	<description>
&lt;denchmark-link:https://github.com/gichan-jang&gt;@gichan-jang&lt;/denchmark-link&gt;
 and &lt;denchmark-link:https://github.com/anyj0527&gt;@anyj0527&lt;/denchmark-link&gt;
 has reported a regression in the behavior of TF-Lite/TF with recent commits.
&lt;denchmark-link:https://github.com/gichan-jang&gt;@gichan-jang&lt;/denchmark-link&gt;
 / &lt;denchmark-link:https://github.com/anyj0527&gt;@anyj0527&lt;/denchmark-link&gt;
 Please describe the issue and its progress here.
	</description>
	<comments>
		<comment id='1' author='myungjoo' date='2020-03-10T03:41:49Z'>
		 : Thank you for posting issue &lt;denchmark-link:https://github.com/nnstreamer/nnstreamer/issues/2145&gt;#2145&lt;/denchmark-link&gt;
. The person in charge will reply soon.
		</comment>
		<comment id='2' author='myungjoo' date='2020-03-10T03:54:40Z'>
		After &lt;denchmark-link:https://github.com/nnstreamer/nnstreamer/pull/2135&gt;#2135&lt;/denchmark-link&gt;
,
3 Native tflite examples from nnstreamer-example got segmentation faults.

speech-command-tflite
object-detection-tflite
pose-estimation-tflite

The output of speech-command example:
$ ./nnstreamer_example_speech_command_tflite  ** ERROR:/home/yongjoo/nnstreamer/gst/nnstreamer/tensor_filter/tensor_filter.c:641:gst_tensor_filter_configure_tensor: assertion failed: (gst_tensors_config_is_equal (&amp;priv-&gt;out_config, &amp;out_config))
		</comment>
		<comment id='3' author='myungjoo' date='2020-03-10T04:41:01Z'>
		It's the  same as &lt;denchmark-link:https://github.com/anyj0527&gt;@anyj0527&lt;/denchmark-link&gt;

$ ./nnstreamer_example_pose_estimation_tflite
Segmentation fault (core dumped)
$ ./nnstreamer_example_speech_command_tflite
**
ERROR:/home/gichan/workspace/nnstreamer/gst/nnstreamer/tensor_filter/tensor_filter.c:641:gst_tensor_filter_configure_tensor: assertion failed: (gst_tensors_config_is_equal (&amp;priv-&gt;out_config, &amp;out_config))
Aborted (core dumped)
		</comment>
		<comment id='4' author='myungjoo' date='2020-03-11T00:50:58Z'>
		&lt;denchmark-link:https://github.com/anyj0527&gt;@anyj0527&lt;/denchmark-link&gt;
 We'll need a fix this week, preferably submitted by today.
		</comment>
		<comment id='5' author='myungjoo' date='2020-03-11T03:21:03Z'>
		IMO, at least for the case of speech-command-tflite, it is not related to the tf-lite tensor filter. PTAL, &lt;denchmark-link:https://github.com/jaeyun-jung&gt;@jaeyun-jung&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/myungjoo&gt;@myungjoo&lt;/denchmark-link&gt;
.
		</comment>
		<comment id='6' author='myungjoo' date='2020-03-11T06:18:27Z'>
		I found that when a tflite model has output tensors of more than one and big model size (about more than 3.X MB),
tensor_ptr = interpreter-&gt;tensor (tensor_idx)
has different value after the first invoke().
(This was not happened when the model has one output tensor or the model size is small)
IMO, &lt;denchmark-link:https://github.com/nnstreamer/nnstreamer/pull/2135&gt;#2135&lt;/denchmark-link&gt;
 assumes that pointers to input/output tensor are not changed, causing this issue.
		</comment>
		<comment id='7' author='myungjoo' date='2020-03-12T13:24:24Z'>
		&lt;denchmark-link:https://github.com/gichan-jang&gt;@gichan-jang&lt;/denchmark-link&gt;
 and &lt;denchmark-link:https://github.com/anyj0527&gt;@anyj0527&lt;/denchmark-link&gt;
 Thanks for figuring out this issue and solving it.
		</comment>
		<comment id='8' author='myungjoo' date='2020-03-17T04:15:33Z'>
		We need to revert &lt;denchmark-link:https://github.com/nnstreamer/nnstreamer/pull/2135&gt;#2135&lt;/denchmark-link&gt;
 but it seems that object-detection-tflite also has some bugs itself.
		</comment>
		<comment id='9' author='myungjoo' date='2020-03-17T05:15:22Z'>
		&lt;denchmark-link:https://github.com/wooksong&gt;@wooksong&lt;/denchmark-link&gt;
 Thank you for the report, I'll check the object-detection-tflite example
		</comment>
	</comments>
</bug>