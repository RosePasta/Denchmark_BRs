<bug id='1908' author='jungwook' open_date='2019-08-24T04:41:22Z' closed_time='2019-09-28T19:31:08Z'>
	<summary>Cannot save then load LSTM layers model</summary>
	<description>
To get help from the community, we encourage using Stack Overflow and the &lt;denchmark-link:https://stackoverflow.com/questions/tagged/tensorflow.js&gt;tensorflow.js&lt;/denchmark-link&gt;
 tag.
&lt;denchmark-h:h4&gt;TensorFlow.js version&lt;/denchmark-h&gt;

1.2.7
&lt;denchmark-h:h4&gt;Browser version&lt;/denchmark-h&gt;

N/A. using node
&lt;denchmark-h:h4&gt;Describe the problem or feature request&lt;/denchmark-h&gt;

Cannot load a saved model with LSTM layers.
&lt;denchmark-h:h4&gt;Code to reproduce the bug / link to feature request&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;const model = tf.sequential();
model.add(tf.layers.dense({units: 1, inputShape: [10, 20]}));
const cells = [
    tf.layers.lstmCell({units: 4}),
    tf.layers.lstmCell({units: 8}),
];
const rnn = tf.layers.rnn({cell: cells, returnSequences: true});
model.add(rnn);

model.save('file://test1').then( _ =&gt;{
    tf.loadLayersModel('file://test1/model.json').then(m2=&gt;{
        console.log(m2);
    })
})  
&lt;/denchmark-code&gt;

Then you get something like the following.
(node:20145) UnhandledPromiseRejectionWarning: Error: Duplicate weight name: rnn_RNN1/kernel at new ValueError (/Users/jungwook/Documents/Development/Tensor/node_modules/@tensorflow/tfjs-layers/dist/errors.js:68:28)at Sequential.Container.loadWeights (/Users/jungwook/Documents/Development/Tensor/node_modules/@tensorflow/tfjs-layers/dist/engine/container. at /Users/jungwook/Documents/Development/Tensor/node_modules/@tensorflow/tfjs-layers/dist/models.js:302:27 at step (/Users/jungwook/Documents/Development/Tensor/node_modules/@tensorflow/tfjs-layers/dist/models.js:54:23) at Object.next (/Users/jungwook/Documents/Development/Tensor/node_modules/@tensorflow/tfjs-layers/dist/models.js:35:53) at fulfilled (/Users/jungwook/Documents/Development/Tensor/node_modules/@tensorflow/tfjs-layers/dist/models.js:26:58)
	</description>
	<comments>
		<comment id='1' author='jungwook' date='2019-08-27T21:55:06Z'>
		&lt;denchmark-link:https://github.com/caisq&gt;@caisq&lt;/denchmark-link&gt;
 there is a fix which was merged earlier &lt;denchmark-link:https://github.com/tensorflow/tfjs-layers/pull/547&gt;here&lt;/denchmark-link&gt;
 , but the issue still persists , can you please check again. Thank you related issues
&lt;denchmark-link:https://github.com/tensorflow/tfjs/issues/1476&gt;#1476&lt;/denchmark-link&gt;
 , &lt;denchmark-link:https://github.com/tensorflow/tfjs/issues/1721&gt;#1721&lt;/denchmark-link&gt;

		</comment>
		<comment id='2' author='jungwook' date='2019-08-27T22:04:07Z'>
		Still not working. Iâ€™m using the latest version of tfjs but same error persists
		</comment>
		<comment id='3' author='jungwook' date='2019-08-29T20:56:49Z'>
		Hey guys, hope to contribute a little as well!
Version: "@tensorflow/tfjs-node": "^1.2.8"
Error:
&lt;denchmark-code&gt;Error: Duplicate weight name: rnn_RNN1/kernel
at new ValueError (/Users/myuser/Projects/test/tf_proj/node_modules/@tensorflow/tfjs-layers/src/errors.ts:48:5)
at Sequential.Container.loadWeights (/Users/myuser/Projects/test/tf_proj/node_modules/@tensorflow/tfjs-layers/src/engine/container.ts:583:17)
at /Users/myuser/Projects/test/tf_proj/node_modules/@tensorflow/tfjs-layers/src/models.ts:324:11
at step (/Users/myuser/Projects/test/tf_proj/node_modules/@tensorflow/tfjs-layers/dist/models.js:54:23)
at Object.next (/Users/myuser/Projects/test/tf_proj/node_modules/@tensorflow/tfjs-layers/dist/models.js:35:53)
at fulfilled (/Users/myuser/Projects/test/tf_proj/node_modules/@tensorflow/tfjs-layers/dist/models.js:26:58)
&lt;/denchmark-code&gt;

		</comment>
		<comment id='4' author='jungwook' date='2019-09-21T20:20:45Z'>
		Still not working.
Tenserflow 1.2.9.
Tested in Chrome 76, Win x64.
		</comment>
		<comment id='5' author='jungwook' date='2019-09-27T21:13:38Z'>
		The root cause of the problem is that the s of the weights of different RNN cells clashed.
&lt;denchmark-link:https://github.com/tensorflow/tfjs/pull/2105&gt;#2105&lt;/denchmark-link&gt;
 should fix it.
Sorry for the delay.
		</comment>
	</comments>
</bug>