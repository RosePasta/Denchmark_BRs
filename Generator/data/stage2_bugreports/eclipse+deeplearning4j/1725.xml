<bug id='1725' author='fac2003' open_date='2016-06-21T17:37:57Z' closed_time='2016-07-07T09:33:44Z'>
	<summary>DL4J unable to use multiple GPUs</summary>
	<description>
We are benchmarking DL4J on a linux box with 8 K80 GPUs. When running the spark Graves example, only one GPU sees utilization, ranging from 5-63% usage.
We enabled the multi-GPU setting with  CudaEnvironment.getInstance().getConfiguration().allowMultiGPU(true);
Here's a trace: &lt;denchmark-link:https://gist.github.com/fac2003/44d17565a7f95691c8097d964a440beb&gt;https://gist.github.com/fac2003/44d17565a7f95691c8097d964a440beb&lt;/denchmark-link&gt;

We built from source using ND4J commit:
commit &lt;denchmark-link:https://github.com/eclipse/deeplearning4j/commit/d74bb5dee7741fc8e8b32f771a4cc47ac2625fa5&gt;d74bb5d&lt;/denchmark-link&gt;

Author: Samuel Audet &lt;denchmark-link:mailto:samuel.audet@gmail.com&gt;samuel.audet@gmail.com&lt;/denchmark-link&gt;

Date:   Mon Jun 6 10:11:10 2016 +0900
	</description>
	<comments>
		<comment id='1' author='fac2003' date='2016-06-21T17:42:56Z'>
		Please, build from current libnd4j and nd4j master.
Also, use following configuration:
CudaEnvironment.getInstance().getConfiguration().allowMultiGPU(true).setMemoryModel(MemoryModel.DELAYED);
		</comment>
		<comment id='2' author='fac2003' date='2016-06-21T18:26:50Z'>
		We just built from the latest masters, added  CudaEnvironment.getInstance().getConfiguration().allowMultiGPU(true).setMemoryModel(MemoryModel.DELAYED); and got this:
&lt;denchmark-code&gt;
o.n.n.NativeOps - Number of threads used for linear algebra 32
Using existing text file at /tmp/Shakespeare.txt
o.n.j.a.c.i.BasicContextPool - Creating new context...
o.n.j.a.c.i.BasicContextPool - Creating new stream for device [0]...
o.n.j.a.c.i.BasicContextPool - Creating new cuBLAS handle for device [0]...
o.n.j.a.c.i.BasicContextPool - Creating new stream for device [0]...
o.n.j.h.i.CudaZeroHandler - Creating bucketID: 5
o.n.j.h.i.CudaZeroHandler - Creating bucketID: 4
o.n.j.h.i.CudaZeroHandler - Creating bucketID: 2
o.n.j.h.i.CudaZeroHandler - Creating bucketID: 3
o.n.j.h.i.CudaZeroHandler - Creating bucketID: 1
o.n.j.h.i.CudaZeroHandler - Creating bucketID: 0
o.d.o.s.BaseOptimizer - Objective function automatically set to minimize. Set stepFunction in neural net configuration to change default settings.
o.d.s.i.m.SparkDl4jMultiLayer - Running distributed training:  (averaging each iteration = true), (iterations = 1), (num partions = 16)
o.n.j.a.c.i.BasicContextPool - Creating new context...
o.n.j.a.c.i.BasicContextPool - Creating new stream for device [0]...
o.n.j.a.c.i.BasicContextPool - Reusing blas here...
o.n.j.a.c.i.BasicContextPool - Creating new context...
o.n.j.a.c.i.BasicContextPool - Creating new stream for device [0]...
o.n.j.a.c.i.BasicContextPool - Reusing blas here...
o.d.s.i.m.SparkDl4jMultiLayer - Broadcasting initial parameters of length 559877
o.n.j.a.c.i.BasicContextPool - Creating new context...
o.n.j.a.c.i.BasicContextPool - Creating new stream for device [0]...
o.n.j.a.c.i.BasicContextPool - Reusing blas here...
o.n.j.a.c.i.BasicContextPool - Creating new context...
Exception in thread "UniGC thread 3" o.n.j.a.c.i.BasicContextPool - Creating new stream for device [0]...
java.lang.IllegalStateException: Can't happen ever
    at org.nd4j.jita.handler.impl.CudaZeroHandler.purgeDeviceObject(CudaZeroHandler.java:912)
    at org.nd4j.jita.allocator.impl.AtomicAllocator.purgeDeviceObject(AtomicAllocator.java:418)
    at org.nd4j.jita.allocator.impl.AtomicAllocator$UnifiedGarbageCollectorThread.run(AtomicAllocator.java:591)
&lt;/denchmark-code&gt;

		</comment>
		<comment id='3' author='fac2003' date='2016-06-21T20:33:56Z'>
		Confirming this one.
		</comment>
		<comment id='4' author='fac2003' date='2016-06-22T15:53:42Z'>
		Please build things from sources from my branches in libnd4j, nd4j, and dl4j. Branch name is the same everywhere: r119_various.
Things are fixed/improved there.
		</comment>
		<comment id='5' author='fac2003' date='2016-06-22T16:19:48Z'>
		I was able to rebuild libdn4j with your r119_various branch, but when I tried building nd4j I got a lot of test failures:
mvn clean package
&lt;denchmark-code&gt;Failed tests: 
  OpExecutionerTests.testAddBroadcast:383 expected:&lt;[[2.00, 5.00, 8.00],
 [3.00, 6.00, 9.00]]&gt; but was:&lt;[[0.00, 1.10, 1.61],
 [0.69, 1.39, 1.79]]&gt;
  OpExecutionerTests.testMaxMin:189 expected:&lt;1.0&gt; but was:&lt;0.0&gt;
  OpExecutionerTests.testOtherSoftmax:340 expected:&lt;[[0.00, 0.00, 0.00, 0.00, 0.05, 0.95],
 [0.00, 0.00, 0.00, 0.00, 0.05, 0.95],
 [0.00, 0.00, 0.00, 0.00, 0.05, 0.95]]&gt; but was:&lt;[[0.17, 0.17, 0.17, 0.17, 0.17, 0.17],
 [0.17, 0.17, 0.17, 0.17, 0.17, 0.17],
 [0.17, 0.17, 0.17, 0.17, 0.17, 0.17]]&gt;
  OpExecutionerTests.testSoftmax:326 expected:&lt;[[0.02, 0.12, 0.87],
 [0.02, 0.12, 0.87]]&gt; but was:&lt;[[0.33, 0.33, 0.33],
 [0.33, 0.33, 0.33]]&gt;
Tests in error: 
  NDArrayTestsFortran.testAddMatrix:651 » IllegalState MemcpyAsync relocate H2D ...
  NDArrayTestsFortran.testAddScalar:849 » IllegalState MemcpyAsync relocate H2D ...
  NDArrayTestsFortran.testAppendBias:773 » Runtime Can't allocate [HOST] memory:...
  NDArrayTestsFortran.testAssignOffset:456 » Runtime Can't allocate [HOST] memor...
  NDArrayTestsFortran.testAssign:833 » IllegalState MemcpyAsync relocate H2D fai...
  NDArrayTestsFortran.testBroadCast:888 » IllegalState MemcpyAsync H2H failed: [...
  NDArrayTestsFortran.testBroadCasting:215 » IllegalState MemcpyAsync H2H failed...
  NDArrayTestsFortran.testColumnMmul:111 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayTestsFortran.testColumnVectorOpsFortran:807 » Runtime Can't allocate [H...
  NDArrayTestsFortran.testColumns:464 » IllegalState MemcpyAsync H2H failed: [14...
  NDArrayTestsFortran.testCosineSim:341 » IllegalState MemcpyAsync H2H failed: [...
  NDArrayTestsFortran.testDim1:697 » Runtime Can't allocate [HOST] memory: 8
  NDArrayTestsFortran.testDimShuffle:284 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayTestsFortran.testDivide:308 » IllegalState MemcpyAsync H2H failed: [140...
  NDArrayTestsFortran.testDupAndDupWithOrder:1086 » IllegalState MemcpyAsync H2H...
  NDArrayTestsFortran.testElementWiseOps:1010 » IllegalState MemcpyAsync H2H fai...
  NDArrayTestsFortran.testEps:705 » IllegalState MemcpyAsync relocate H2D failed...
  NDArrayTestsFortran.testExp:356 » IllegalState MemcpyAsync H2H failed: [140591...
  NDArrayTestsFortran.testGetColumnFortran:421 » IllegalState MemcpyAsync H2H fa...
  NDArrayTestsFortran.testGetColumnGetRow:1071 » IllegalState MemcpyAsync reloca...
  NDArrayTestsFortran.testGetColumns:435 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayTestsFortran.testGetRowFortran:408 » IllegalState MemcpyAsync H2H faile...
  NDArrayTestsFortran.testIdentity:796 » Runtime Can't allocate [HOST] memory: 1...
  NDArrayTestsFortran.testInplaceTranspose:567 » Runtime Can't allocate [HOST] m...
  NDArrayTestsFortran.testLogDouble:714 » IllegalState MemcpyAsync relocate H2D ...
  NDArrayTestsFortran.testMMul:663 » IllegalState MemcpyAsync H2H failed: [14059...
  NDArrayTestsFortran.testMatrix:909 » IllegalState MemcpyAsync H2H failed: [140...
  NDArrayTestsFortran.testMmulF:588 » IllegalState MemcpyAsync H2H failed: [1405...
  NDArrayTestsFortran.testMultiThreading:206 » Execution java.lang.IllegalStateE...
  NDArrayTestsFortran.testNeg:331 » IllegalState MemcpyAsync H2H failed: [140591...
  NDArrayTestsFortran.testNegativeShape:1059 » IllegalState MemcpyAsync H2H fail...
  NDArrayTestsFortran.testNumVectorsAlongDimension:875 » Runtime Can't allocate ...
  NDArrayTestsFortran.testPermute:741 » IllegalState MemcpyAsync H2H failed: [14...
  NDArrayTestsFortran.testPutRowFortran:993 » IllegalState MemcpyAsync H2H faile...
  NDArrayTestsFortran.testPutRowGetRowOrdering:919 » IllegalState MemcpyAsync H2...
  NDArrayTestsFortran.testPutRow:504 » IllegalState MemcpyAsync H2H failed: [140...
  NDArrayTestsFortran.testPutSlice:678 » Runtime Can't allocate [HOST] memory: 1...
  NDArrayTestsFortran.testRDivi:865 » Runtime Can't allocate [HOST] memory: 8
  NDArrayTestsFortran.testRSubi:818 » Runtime Can't allocate [HOST] memory: 8
  NDArrayTestsFortran.testRand:781 » Runtime Can't allocate [HOST] memory: 100
  NDArrayTestsFortran.testRdivScalar:857 » Runtime Can't allocate [HOST] memory:...
  NDArrayTestsFortran.testReadWriteDouble:183 » Runtime Can't allocate [HOST] me...
  NDArrayTestsFortran.testReadWrite:168 » Runtime Can't allocate [HOST] memory: ...
  NDArrayTestsFortran.testRepmat:154 » IllegalState MemcpyAsync H2H failed: [140...
  NDArrayTestsFortran.testRollAxis:1033 » Runtime Can't allocate [HOST] memory: ...
  NDArrayTestsFortran.testRowVectorGemm:143 » IllegalState MemcpyAsync H2H faile...
  NDArrayTestsFortran.testRowsColumns:611 » IllegalState MemcpyAsync H2H failed:...
  NDArrayTestsFortran.testScalarOps:91 » Runtime Can't allocate [HOST] memory: 1...
  NDArrayTestsFortran.testScalar:370 » IllegalState MemcpyAsync H2H failed: [140...
  NDArrayTestsFortran.testSigmoid:322 » IllegalState MemcpyAsync H2H failed: [14...
  NDArrayTestsFortran.testSmallSum:728 » Runtime Can't allocate [HOST] memory: 8
  NDArrayTestsFortran.testSortWithIndicesDescending:237 » IllegalState MemcpyAsy...
  NDArrayTestsFortran.testSortWithIndices:251 » IllegalState MemcpyAsync H2H fai...
  NDArrayTestsFortran.testSumWithRow1:940 » IllegalState MemcpyAsync relocate H2...
  NDArrayTestsFortran.testSumWithRow2:971 » Runtime Can't allocate [HOST] memory...
  NDArrayTestsFortran.testSwapAxesFortranOrder:264 » Runtime Can't allocate [HOS...
  NDArrayTestsFortran.testTensorDot:1041 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayTestsFortran.testTensorStats:1138 » Runtime Can't allocate [HOST] memor...
  NDArrayTestsFortran.testToOffsetZeroCopy:1108 » IllegalState MemcpyAsync H2H f...
  NDArrayTestsFortran.testTranspose:622 » IllegalState MemcpyAsync relocate H2D ...
  NDArrayTestsFortran.testVectorInit:449 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayTestsFortran.testVectorSum:722 » IllegalState MemcpyAsync relocate H2D ...
  NDArrayTestsFortran.testWrap:384 » IllegalState MemcpyAsync H2H failed: [14059...
  Nd4jTestsC.test2DArraySlice:1923 » Runtime Can't allocate [HOST] memory: 140
  Nd4jTestsC.test2dMatrixOrderingSwitch:223 » Runtime Can't allocate [HOST] memo...
  Nd4jTestsC.testAddMatrix:1786 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testAddScalar:2674 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testAddVectorWithOffset:918 » Runtime Can't allocate [HOST] memory:...
  Nd4jTestsC.testAddiRowVectorWithScalar:286 » Runtime Can't allocate [HOST] mem...
  Nd4jTestsC.testArgMaxSameValues:2645 » IllegalState MemcpyAsync H2H failed: [1...
  Nd4jTestsC.testArgMax:144 » Runtime Can't allocate [HOST] memory: 96
  Nd4jTestsC.testAssignNumber:3016 » Runtime Can't allocate [HOST] memory: 800
  Nd4jTestsC.testAssignOffset:2666 » Runtime Can't allocate [HOST] memory: 100
  Nd4jTestsC.testAssign:3061 » Runtime Can't allocate [HOST] memory: 384
  Nd4jTestsC.testBroadCast:2742 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testBroadCasting:347 » IllegalState MemcpyAsync H2H failed: [140592...
  Nd4jTestsC.testBroadcast1d:1070 » Runtime Can't allocate [HOST] memory: 96
  Nd4jTestsC.testBroadcastAdd:2471 » IllegalState MemcpyAsync H2H failed: [14059...
  Nd4jTestsC.testBroadcastDiv:2410 » Runtime Can't allocate [HOST] memory: 128
  Nd4jTestsC.testBroadcastIllegalArgument[0: backend »  Unexpected exception, ex...
  Nd4jTestsC.testBroadcastMult:2431 » IllegalState MemcpyAsync H2H failed: [1405...
  Nd4jTestsC.testBroadcastRepeated:706 » Runtime Can't allocate [HOST] memory: 1...
  Nd4jTestsC.testBroadcastSub:2451 » IllegalState MemcpyAsync H2H failed: [14059...
  Nd4jTestsC.testColumns:1397 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testCompareAndSet1:3171 » Runtime Can't allocate [HOST] memory: 100
  Nd4jTestsC.testConcatHorizontally:2629 » Runtime Can't allocate [HOST] memory:...
  Nd4jTestsC.testConcat:2615 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testCosineSim:1296 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testCreateUnitialized:3089 » Runtime Can't allocate [HOST] memory: ...
  Nd4jTestsC.testDimShuffle:1206 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testDimension:2492 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testDivide:1230 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testDot:2544 » IllegalState MemcpyAsync H2H failed: [14059269152372...
  Nd4jTestsC.testDupAndDupWithOrder:2901 » IllegalState MemcpyAsync relocate H2D...
  Nd4jTestsC.testDup:1140 » IllegalState MemcpyAsync H2H failed: [14059168204043...
  Nd4jTestsC.testElementWiseAdd:2703 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testElementWiseOps:2789 » IllegalState MemcpyAsync H2H failed: [140...
  Nd4jTestsC.testEps2:1849 » IllegalState MemcpyAsync H2H failed: [1405916820404...
  Nd4jTestsC.testEps3:772 » IllegalState MemcpyAsync H2H failed: [14059168203712...
  Nd4jTestsC.testEps:1841 » IllegalState MemcpyAsync H2H failed: [14059168203712...
  Nd4jTestsC.testExp:1327 » IllegalState MemcpyAsync H2H failed: [14059269152372...
  Nd4jTestsC.testFTimesCAddiRow:2058 » IllegalState MemcpyAsync relocate H2D fai...
  Nd4jTestsC.testGetColumns:370 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testGetDouble:202 » Runtime Can't allocate [HOST] memory: 120
  Nd4jTestsC.testGetFromRowVector:1174 » Runtime Can't allocate [HOST] memory: 1...
  Nd4jTestsC.testGetIntervalEdgeCase2:1663 » Runtime Can't allocate [HOST] memor...
  Nd4jTestsC.testGetIntervalEdgeCase:1623 » Runtime Can't allocate [HOST] memory...
  Nd4jTestsC.testGetPermuteReshapeSub:1992 » Runtime Can't allocate [HOST] memor...
  Nd4jTestsC.testGetRow:1980 » Runtime Can't allocate [HOST] memory: 160
  Nd4jTestsC.testGetVsGetScalar:1217 » IllegalState MemcpyAsync H2H failed: [140...
  Nd4jTestsC.testIMaxSingleDim1:684 » Runtime Can't allocate [HOST] memory: 24
  Nd4jTestsC.testIdentity:2557 » Runtime Can't allocate [HOST] memory: 100
  Nd4jTestsC.testInplaceTranspose:1530 » Runtime Can't allocate [HOST] memory: 6...
  Nd4jTestsC.testIsMax2:544 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testIsMaxAlongDimensionSimple:865 » IllegalState MemcpyAsync H2H fa...
  Nd4jTestsC.testIsMaxAlongDimension:617 » Runtime Can't allocate [HOST] memory:...
  Nd4jTestsC.testIsMaxEqualValues:597 » IllegalState MemcpyAsync H2H failed: [14...
  Nd4jTestsC.testIsMaxSingleDim1:693 » IllegalState MemcpyAsync H2H failed: [140...
  Nd4jTestsC.testIsMax:136 » IllegalState MemcpyAsync H2H failed: [1405926915237...
  Nd4jTestsC.testIterator:1872 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testLeakyRelu2:2883 » IllegalState MemcpyAsync H2H failed: [1405916...
  Nd4jTestsC.testLeakyRelu:2859 » Runtime Can't allocate [HOST] memory: 40
  Nd4jTestsC.testLength:324 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testLinearViewGetAndPut:931 » Runtime Can't allocate [HOST] memory:...
  Nd4jTestsC.testLogDouble:1865 » IllegalState MemcpyAsync relocate H2D failed: ...
  Nd4jTestsC.testMMulColVectorRowVectorMixedOrder:2150 » Runtime Can't allocate ...
  Nd4jTestsC.testMMulFTimesC:2129 » Runtime Can't allocate [HOST] memory: 36
  Nd4jTestsC.testMMulMatrixTimesColVector:2021 » IllegalState MemcpyAsync reloca...
  Nd4jTestsC.testMMulMixedOrder:2035 » Runtime Can't allocate [HOST] memory: 40
  Nd4jTestsC.testMMulRowColVectorMixedOrder:2102 » IllegalState MemcpyAsync H2H ...
  Nd4jTestsC.testMMul:255 » IllegalState MemcpyAsync H2H failed: [14059269152372...
  Nd4jTestsC.testMatrix:234 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testMeans:2584 » IllegalState MemcpyAsync H2H failed: [140591682037...
  Nd4jTestsC.testMmulGet:2086 » Runtime Can't allocate [HOST] memory: 88
  Nd4jTestsC.testMmul:1683 » Runtime Can't allocate [HOST] memory: 40
  Nd4jTestsC.testMulRowVector:1505 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testMuliRowVector:2285 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testMultiSum:967 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testNaNEquality:3204 » Runtime Can't allocate [HOST] memory: 100
  Nd4jTestsC.testNdArrayCreation:2811 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testNeg:1252 » IllegalState MemcpyAsync H2H failed: [14059168204043...
  Nd4jTestsC.testNegativeOneReshape:1905 » IllegalState MemcpyAsync H2H failed: ...
  Nd4jTestsC.testNewAxis:2732 » Runtime Can't allocate [HOST] memory: 40
  Nd4jTestsC.testNorm2Double:1262 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testNorm2:1278 » IllegalState MemcpyAsync H2H failed: [140592691523...
  Nd4jTestsC.testNullPointerDataBuffer:1833 » Runtime Can't allocate [HOST] memo...
  Nd4jTestsC.testNumVectorsAlongDimension:2725 » Runtime Can't allocate [HOST] m...
  Nd4jTestsC.testPermute:2177 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testPermutei:2190 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testPutAtIntervalIndexWithStride:2011 » Runtime Can't allocate [HOS...
  Nd4jTestsC.testPutRowGetRowOrdering:2767 » IllegalState MemcpyAsync H2H failed...
  Nd4jTestsC.testPutRow:1438 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testPutSlice:1797 » Runtime Can't allocate [HOST] memory: 108
  Nd4jTestsC.testRDivi:2690 » Runtime Can't allocate [HOST] memory: 8
  Nd4jTestsC.testRSubi:2606 » Runtime Can't allocate [HOST] memory: 8
  Nd4jTestsC.testRdivScalar:2682 » Runtime Can't allocate [HOST] memory: 8
  Nd4jTestsC.testReplaceNaNs:3186 » Runtime Can't allocate [HOST] memory: 100
  Nd4jTestsC.testReshape:2529 » Runtime Can't allocate [HOST] memory: 96
  Nd4jTestsC.testRowVectorGemm:943 » IllegalState MemcpyAsync H2H failed: [14059...
  Nd4jTestsC.testRowVectorMultipleIndices:1814 » Runtime Can't allocate [HOST] m...
  Nd4jTestsC.testRowsColumns:1745 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testScal:1312 » IllegalState MemcpyAsync H2H failed: [1405926914961...
  Nd4jTestsC.testScalarOps:160 » Runtime Can't allocate [HOST] memory: 108
  Nd4jTestsC.testScalar:1346 » IllegalState MemcpyAsync H2H failed: [14059269150...
  Nd4jTestsC.testSerialization:110 » Runtime Can't allocate [HOST] memory: 1
  Nd4jTestsC.testShapeEqualsOnElementWise[0: backend »  Unexpected exception, ex...
  Nd4jTestsC.testSigmoid:1244 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testSignXZ:2344 » IllegalState MemcpyAsync H2H failed: [14059269151...
  Nd4jTestsC.testSize[0: backend »  Unexpected exception, expected&lt;java.lang.Ill...
  Nd4jTestsC.testSliceConstructor:2310 » IllegalState MemcpyAsync H2H failed: [1...
  Nd4jTestsC.testSlices:1336 » Runtime Can't allocate [HOST] memory: 96
  Nd4jTestsC.testSmallSum:1913 » Runtime Can't allocate [HOST] memory: 8
  Nd4jTestsC.testSoftmaxDerivative:730 » Runtime Can't allocate [HOST] memory: 4...
  Nd4jTestsC.testSoftmaxRow:2875 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testSoftmaxStability:2657 » Runtime Can't allocate [HOST] memory: 4...
  Nd4jTestsC.testSortColumns:893 » Runtime Can't allocate [HOST] memory: 200
  Nd4jTestsC.testSortRows:395 » Runtime Can't allocate [HOST] memory: 200
  Nd4jTestsC.testSortWithIndicesDescending:1161 » Runtime Can't allocate [HOST] ...
  Nd4jTestsC.testSort:378 » IllegalState MemcpyAsync H2H failed: [14059168203712...
  Nd4jTestsC.testSquareMatrix:2712 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testStdev0:2322 » Runtime Can't allocate [HOST] memory: 36
  Nd4jTestsC.testStdev1:2332 » Runtime Can't allocate [HOST] memory: 36
  Nd4jTestsC.testSubRowVector:1181 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testSubiRowVector:275 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testSum2:1609 » IllegalState MemcpyAsync H2H failed: [1405916820404...
  Nd4jTestsC.testSum2dv2:1004 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testSum3Of4_2222:1027 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testSum3Of4_3322:1101 » Runtime Can't allocate [HOST] memory: 144
  Nd4jTestsC.testSumDifferentOrdersSquareMatrix:3044 » Runtime Can't allocate [H...
  Nd4jTestsC.testSumDifferentOrders:3077 » IllegalState MemcpyAsync H2H failed: ...
  Nd4jTestsC.testSumNumberRepeatability:446 » Runtime Can't allocate [HOST] memo...
  Nd4jTestsC.testSum:1518 » IllegalState MemcpyAsync H2H failed: [14059168203712...
  Nd4jTestsC.testSums:2596 » IllegalState MemcpyAsync H2H failed: [1405916820371...
  Nd4jTestsC.testSwapAxes:2267 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testTADMMulLeadingOne:1577 » Runtime Can't allocate [HOST] memory: ...
  Nd4jTestsC.testTADMMul:1545 » Runtime Can't allocate [HOST] memory: 40
  Nd4jTestsC.testTADOnVector:301 » Runtime Can't allocate [HOST] memory: 40
  Nd4jTestsC.testTadShape:723 » IllegalState MemcpyAsync H2H failed: [1405974404...
  Nd4jTestsC.testTanhXZ:2375 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testTemp:2568 » Runtime Can't allocate [HOST] memory: 40
  Nd4jTestsC.testTensorAlongDimension2:124 » IllegalState MemcpyAsync H2H failed...
  Nd4jTestsC.testTensorAlongDimension:179 » Runtime Can't allocate [HOST] memory...
  Nd4jTestsC.testTensorDot:1949 » IllegalState MemcpyAsync H2H failed: [14059168...
  Nd4jTestsC.testTensorStats:2952 » Runtime Can't allocate [HOST] memory: 468
  Nd4jTestsC.testTile:1883 » IllegalState MemcpyAsync H2H failed: [1405916820404...
  Nd4jTestsC.testToFlattened2:470 » IllegalState MemcpyAsync relocate H2D failed...
  Nd4jTestsC.testToFlattened3:570 » Runtime Can't allocate [HOST] memory: 4000
  Nd4jTestsC.testToFlattenedOnViews:505 » Runtime Can't allocate [HOST] memory: ...
  Nd4jTestsC.testToFlattenedOrder:423 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testToFlattenedWithOrder:2827 » Runtime Can't allocate [HOST] memor...
  Nd4jTestsC.testToFlattened:1123 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testToOffsetZeroCopy:2920 » IllegalState MemcpyAsync relocate H2D f...
  Nd4jTestsC.testTranspose:1760 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testVPull1:3143 » Runtime Can't allocate [HOST] memory: 100
  Nd4jTestsC.testVPull2:3156 » Runtime Can't allocate [HOST] memory: 96
  Nd4jTestsC.testVStackDifferentOrders:739 » Runtime Can't allocate [HOST] memor...
  Nd4jTestsC.testVStackEdgeCase:758 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testVarConst:3107 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testVectorInit:1384 » Runtime Can't allocate [HOST] memory: 16
  Nd4jTestsC.testWrap:1357 » Runtime Can't allocate [HOST] memory: 32
  Nd4jTestsC.testWriteTxt:211 » IllegalState MemcpyAsync H2H failed: [1405916820...
  Nd4jTestsC.testZero:438 » Runtime Can't allocate [HOST] memory: 44
  Nd4jTestsComparisonFortran.testAddSubtractWithOpsCommonsMath:209 » IllegalState
  Nd4jTestsComparisonFortran.testGemmWithOpsCommonsMath:99 » IllegalState Memcpy...
  Nd4jTestsComparisonFortran.testGemvApacheCommons:163 » IllegalState MemcpyAsyn...
  Nd4jTestsComparisonFortran.testMmulWithOpsCommonsMath:84 » IllegalState Memcpy...
  Nd4jTestsComparisonFortran.testMulDivOnCheckUtilMatrices:227 » IllegalState Me...
  ParamsTestsF.testGemm:26 » IllegalState MemcpyAsync H2H failed: [1405916868206...
  IndexingIterationTests.testAll:29 » IllegalState MemcpyAsync H2H failed: [1405...
  IndexingTests.testArangeMul:47 » IllegalState MemcpyAsync H2H failed: [1405916...
  IndexingTests.testGetIndicesVector:63 » Runtime Can't allocate [HOST] memory: ...
  IndexingTests.testSlicing:39 » IllegalState MemcpyAsync H2H failed: [140591682...
  IndexingTestsC.testArangeMul:173 » IllegalState MemcpyAsync H2H failed: [14059...
  IndexingTestsC.testConcatColumns:156 » Runtime Can't allocate [HOST] memory: 8
  IndexingTestsC.testGetColumnEdgeCase:147 » IllegalState MemcpyAsync H2H failed...
  IndexingTestsC.testGetIndices2d:103 » IllegalState MemcpyAsync H2H failed: [14...
  IndexingTestsC.testGetIndicesVector:165 » IllegalState MemcpyAsync H2H failed:...
  IndexingTestsC.testGetPointRowVector:29 » Runtime Can't allocate [HOST] memory...
  IndexingTestsC.testGetRowEdgeCase:138 » IllegalState MemcpyAsync H2H failed: [...
  IndexingTestsC.testGetRow:124 » IllegalState MemcpyAsync H2H failed: [14059168...
  IndexingTestsC.testGetScalar:79 » IllegalState MemcpyAsync H2H failed: [140591...
  IndexingTestsC.testNegativeIndices:96 » Runtime Can't allocate [HOST] memory: ...
  IndexingTestsC.testOffsetsC:54 » IllegalState MemcpyAsync H2H failed: [1405916...
  IndexingTestsC.testVectorIndexing2:39 » IllegalState MemcpyAsync H2H failed: [...
  IndexingTestsC.testVectorIndexing:88 » IllegalState MemcpyAsync H2H failed: [1...
  ShapeResolutionTestsC.testColumnVectorShapeOneOffset:105 » IllegalState Memcpy...
  ShapeResolutionTestsC.testColumnVectorShapeZeroOffset:94 » IllegalState Memcpy...
  ShapeResolutionTestsC.testFlatIndexPointInterval:193 » IllegalState MemcpyAsyn...
  ShapeResolutionTestsC.testIndexAll:149 » IllegalState MemcpyAsync H2H failed: ...
  ShapeResolutionTestsC.testIntervalFirstShapeResolution:52 » IllegalState Memcp...
  ShapeResolutionTestsC.testOutOfRangeIndices2:137 » IllegalState MemcpyAsync H2...
  ShapeResolutionTestsC.testOutOfRangeIndices:125 » IllegalState MemcpyAsync H2H...
  ShapeResolutionTestsC.testPartiallyOutOfRangeIndices:117 » IllegalState Memcpy...
  ShapeResolutionTestsC.testRowVectorShapeOneOneOffset:61 » IllegalState MemcpyA...
  ShapeResolutionTestsC.testRowVectorShapeOneZeroOffset:36 » IllegalState Memcpy...
  ShapeResolutionTestsC.testRowVectorShapeTwoOneOffset:77 » IllegalState MemcpyA...
  ShapeResolutionTestsC.testVectorIndexPointPointOutOfRange2:234 » IllegalState ...
  ShapeResolutionTestsC.testVectorIndexPointPointOutOfRange:220 » IllegalState M...
  ShapeResolutionTestsC.testVectorIndexPointPoint:205 » IllegalState MemcpyAsync...
  NDArrayIndexResolveTests.testResolvePoint:29 » IllegalState MemcpyAsync H2H fa...
  RngTests.testRandomWithOrder:35 » IllegalState MemcpyAsync H2H failed: [140591...
  ConvolutionTests.testCol2Im:459 » Runtime Can't allocate [HOST] memory: 32
  ConvolutionTests.testIm2ColKnownValuesMiniBatch3:223 » Runtime Can't allocate ...
  ConvolutionTests.testIm2ColKnownValues:106 » Runtime Can't allocate [HOST] mem...
  ConvolutionTests.testIm2Col:294 » Runtime Can't allocate [HOST] memory: 32
  ConvolutionTests.testimcolim:481 » Runtime Can't allocate [HOST] memory: 1176
  ConvolutionTestsC.testCol2Im:201 » Runtime Can't allocate [HOST] memory: 32
  ConvolutionTestsC.testIm2Col2:80 » IllegalState MemcpyAsync H2H failed: [14059...
  ConvolutionTestsC.testIm2Col:55 » Runtime Can't allocate [HOST] memory: 32
  ConvolutionTestsC.testMoreIm2Col2:179 » IllegalState MemcpyAsync H2H failed: [...
  ConvolutionTestsC.testimcolim:220 » Runtime Can't allocate [HOST] memory: 1176
  LossFunctionTests.testMcXent:66 » IllegalState MemcpyAsync H2H failed: [140597...
  LossFunctionTests.testNegativeLogLikelihood:74 » IllegalState MemcpyAsync H2H ...
  LossFunctionTests.testRMseXent:58 » IllegalState MemcpyAsync H2H failed: [1405...
  OpExecutionerTestsC.testAdd:149 » IllegalState MemcpyAsync H2H failed: [140591...
  OpExecutionerTestsC.testAddiRowVector:259 » IllegalState MemcpyAsync H2H faile...
  OpExecutionerTestsC.testColumnMean:372 » IllegalState MemcpyAsync H2H failed: ...
  OpExecutionerTestsC.testColumnStd:396 » IllegalState MemcpyAsync failed
  OpExecutionerTestsC.testColumnVar:383 » IllegalState MemcpyAsync H2H failed: [...
  OpExecutionerTestsC.testComparisonOps:288 » IllegalState MemcpyAsync relocate ...
  OpExecutionerTestsC.testCosineSimilarity:67 » IllegalState MemcpyAsync H2H fai...
  OpExecutionerTestsC.testDescriptiveStatsDouble:220 » IllegalState MemcpyAsync ...
  OpExecutionerTestsC.testDescriptiveStats:237 » IllegalState MemcpyAsync H2H fa...
  OpExecutionerTestsC.testDim1:401 » Runtime Can't allocate [HOST] memory: 8
  OpExecutionerTestsC.testDimensionMax:306 » IllegalState MemcpyAsync H2H failed...
  OpExecutionerTestsC.testDimensionSoftMax:363 » IllegalState MemcpyAsync H2H fa...
  OpExecutionerTestsC.testEpsOps:653 » IllegalState MemcpyAsync H2H failed: [140...
  OpExecutionerTestsC.testEuclideanDistance:95 » Runtime Can't allocate [HOST] m...
  OpExecutionerTestsC.testExecutioner:170 » IllegalState MemcpyAsync H2H failed:...
  OpExecutionerTestsC.testIMax:408 » IllegalState MemcpyAsync H2H failed: [14059...
  OpExecutionerTestsC.testIMin:420 » IllegalState MemcpyAsync H2H failed: [14059...
  OpExecutionerTestsC.testLogSoftmaxVector:583 » IllegalState MemcpyAsync H2H fa...
  OpExecutionerTestsC.testLogSoftmax:607 » IllegalState MemcpyAsync H2H failed: ...
  OpExecutionerTestsC.testLog:76 » IllegalState MemcpyAsync relocate H2D failed:...
  OpExecutionerTestsC.testMaxMin:187 » IllegalState MemcpyAsync H2H failed: [140...
  OpExecutionerTestsC.testMeanSumSimple:433 » IllegalState MemcpyAsync H2H faile...
  OpExecutionerTestsC.testMean:479 » Runtime Can't allocate [HOST] memory: 128
  OpExecutionerTestsC.testMul:159 » IllegalState MemcpyAsync H2H failed: [140591...
  OpExecutionerTestsC.testNorm1AlongDimension:84 » IllegalState MemcpyAsync H2H ...
  OpExecutionerTestsC.testNorm2:141 » IllegalState MemcpyAsync H2H failed: [1405...
  OpExecutionerTestsC.testNormMax:131 » IllegalState MemcpyAsync H2H failed: [14...
  OpExecutionerTestsC.testPow:277 » IllegalState MemcpyAsync H2H failed: [140591...
  OpExecutionerTestsC.testProd:200 » IllegalState MemcpyAsync relocate H2D faile...
  OpExecutionerTestsC.testRowSoftmax:253 » IllegalState MemcpyAsync relocate H2D...
  OpExecutionerTestsC.testScalarMaxOp:103 » IllegalState MemcpyAsync relocate H2...
  OpExecutionerTestsC.testSetRange:111 » IllegalState MemcpyAsync H2H failed: [1...
  OpExecutionerTestsC.testSoftMax:348 » IllegalState MemcpyAsync H2H failed: [14...
  OpExecutionerTestsC.testSoftmax:620 » IllegalState MemcpyAsync H2H failed: [14...
  OpExecutionerTestsC.testStdev:629 » IllegalState MemcpyAsync H2H failed: [1405...
  OpExecutionerTestsC.testStridedExp:336 » IllegalState MemcpyAsync H2H failed: ...
  OpExecutionerTestsC.testStridedLog:325 » IllegalState MemcpyAsync H2H failed: ...
  OpExecutionerTestsC.testSubColumnVector:573 » IllegalState MemcpyAsync H2H fai...
  OpExecutionerTestsC.testSum5d:522 » IllegalState MemcpyAsync H2H failed: [1405...
  OpExecutionerTestsC.testSum6d:468 » IllegalState MemcpyAsync H2H failed: [1405...
  OpExecutionerTestsC.testSumDifferentOrder:593 » IllegalState MemcpyAsync H2H f...
  OpExecutionerTestsC.testSum:206 » IllegalState MemcpyAsync H2H failed: [140591...
  OpExecutionerTestsC.testTad:268 » IllegalState MemcpyAsync H2H failed: [140591...
  OpExecutionerTestsC.testVariance:641 » IllegalState MemcpyAsync H2H failed: [1...
  RowVectorOpsC.testAddi:25 » IllegalState MemcpyAsync H2H failed: [140591686849...
  NDArrayMathTests.testLengthPerSlice:46 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayMathTests.testMapOntoVector:61 » IllegalState MemcpyAsync H2H failed: [...
  NDArrayMathTests.testMatricesPerSlice:40 » IllegalState MemcpyAsync H2H failed...
  NDArrayMathTests.testNumVectors:67 » IllegalState MemcpyAsync H2H failed: [140...
  NDArrayMathTests.testOddDimensions:111 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayMathTests.testOffsetForSlice:76 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayMathTests.testTotalVectors:118 » IllegalState MemcpyAsync H2H failed: [...
  NDArrayMathTests.testVectorPerSlice:27 » IllegalState MemcpyAsync H2H failed: ...
  NDArrayMathTests.toffsetForSlice:53 » IllegalState MemcpyAsync H2H failed: [14...
  ShapeBufferTests.testArrCreationShape:48 » IllegalState MemcpyAsync H2H failed...
  ShapeBufferTests.testBuff:77 » IllegalState MemcpyAsync H2H failed: [140591686...
  ShapeBufferTests.testRank:39 » IllegalState MemcpyAsync H2H failed: [140591682...
  ShapeBufferTests.testShape:61 » IllegalState MemcpyAsync H2H failed: [14059168...
  ShapeTests.testDimShuffle:203 » IllegalState MemcpyAsync H2H failed: [14059168...
  ShapeTests.testEight:220 » IllegalState MemcpyAsync H2H failed: [1405916820180...
  ShapeTests.testNewAxis:164 » IllegalState MemcpyAsync H2H failed: [14059168201...
  ShapeTests.testNoCopy:136 » IllegalState MemcpyAsync H2H failed: [140591686919...
  ShapeTests.testSixteenFirstDim:179 » IllegalState MemcpyAsync H2H failed: [140...
  ShapeTests.testSixteenSecondDim:59 » IllegalState MemcpyAsync H2H failed: [140...
  ShapeTests.testSixteenZeroOne:28 » IllegalState MemcpyAsync H2H failed: [14059...
  ShapeTests.testThreeTwoTwoTwo:143 » IllegalState MemcpyAsync H2H failed: [1405...
  ShapeTests.testThreeTwoTwo:115 » IllegalState MemcpyAsync H2H failed: [1405916...
  ShapeTests.testVectorAlongDimension1:47 » Runtime Can't allocate [HOST] memory...
  ShapeTests.testVectorAlongDimension:84 » Runtime Can't allocate [HOST] memory:...
  ShapeTestsC.testColumnSumDouble:303 » IllegalState MemcpyAsync H2H failed: [14...
  ShapeTestsC.testColumnSum:273 » IllegalState MemcpyAsync H2H failed: [14059168...
  ShapeTestsC.testColumnVariance:313 » IllegalState MemcpyAsync H2H failed: [140...
  ShapeTestsC.testCumSum:323 » IllegalState MemcpyAsync H2H failed: [14059269053...
  ShapeTestsC.testEight:169 » IllegalState MemcpyAsync H2H failed: [140591686849...
  ShapeTestsC.testOtherReshape:183 » IllegalState MemcpyAsync H2H failed: [14059...
  ShapeTestsC.testPermuteReshape:375 » IllegalState MemcpyAsync H2H failed: [140...
  ShapeTestsC.testPutRow:119 » IllegalState MemcpyAsync H2H failed: [14059168422...
  ShapeTestsC.testPutScalar:411 » IllegalState MemcpyAsync H2H failed: [14059168...
  ShapeTestsC.testRavel:387 » IllegalState MemcpyAsync H2H failed: [140591682023...
  ShapeTestsC.testReshapePermute:155 » IllegalState MemcpyAsync H2H failed: [140...
  ShapeTestsC.testRowMean:282 » IllegalState MemcpyAsync H2H failed: [1405916820...
  ShapeTestsC.testRowStd:292 » IllegalState MemcpyAsync H2H failed: [14059168201...
  ShapeTestsC.testSixteenFirstDim:132 » IllegalState MemcpyAsync H2H failed: [14...
  ShapeTestsC.testSixteenSecondDim:55 » IllegalState MemcpyAsync H2H failed: [14...
  ShapeTestsC.testSixteenZeroOne:37 » IllegalState MemcpyAsync H2H failed: [1405...
  ShapeTestsC.testSum2d:357 » IllegalState MemcpyAsync H2H failed: [140591686849...
  ShapeTestsC.testSum2dv2:367 » IllegalState MemcpyAsync H2H failed: [1405916820...
  ShapeTestsC.testSumColumn:349 » IllegalState MemcpyAsync H2H failed: [14059168...
  ShapeTestsC.testSumRow:341 » IllegalState MemcpyAsync H2H failed: [14059168201...
  ShapeTestsC.testThreeTwoTwoTwo:99 » IllegalState MemcpyAsync H2H failed: [1405...
  ShapeTestsC.testThreeTwoTwo:78 » IllegalState MemcpyAsync H2H failed: [1405916...
  ShapeTestsC.testVectorAlongDimension:196 » Runtime Can't allocate [HOST] memor...
  StaticShapeTests.testBufferToIntShapeStrideMethods:63 » IllegalState MemcpyAsy...
  ConcatTests.testConcat3d:108 » Runtime Can't allocate [HOST] memory: 96
  ConcatTests.testConcatHorizontally:44 » IllegalState MemcpyAsync relocate H2D ...
  ConcatTests.testConcatMatrices:78 » IllegalState MemcpyAsync H2H failed: [1405...
  ConcatTests.testConcatRowVectors:93 » IllegalState MemcpyAsync H2H failed: [14...
  ConcatTests.testConcatScalars:65 » IllegalState MemcpyAsync H2H failed: [14059...
  ConcatTests.testConcat:35 » IllegalState MemcpyAsync H2H failed: [140591686820...
  ConcatTests.testVStackColumn:55 » IllegalState MemcpyAsync H2H failed: [140591...
  ConcatTestsC.testAssign:120 » IllegalState MemcpyAsync H2H failed: [1405916868...
  ConcatTestsC.testConcat3d:152 » Runtime Can't allocate [HOST] memory: 96
  ConcatTestsC.testConcatMatrices:101 » IllegalState MemcpyAsync H2H failed: [14...
  ConcatTestsC.testConcatRowVectors:137 » IllegalState MemcpyAsync H2H failed: [...
  ConcatTestsC.testConcatScalars1:70 » IllegalState MemcpyAsync H2H failed: [140...
  ConcatTestsC.testConcatScalars:60 » IllegalState MemcpyAsync H2H failed: [1405...
  ConcatTestsC.testConcatVector[0: backend »  Unexpected exception, expected&lt;jav...
  ConcatTestsC.testConcatVectors1:83 » IllegalState MemcpyAsync H2H failed: [140...
  ConcatTestsC.testConcatVertically:35 » IllegalState MemcpyAsync H2H failed: [1...
  PaddingTests.testAppend:28 » Runtime Can't allocate [HOST] memory: 36
  PaddingTests.testPad:65 » Runtime Can't allocate [HOST] memory: 36
  PaddingTests.testPrepend:46 » Runtime Can't allocate [HOST] memory: 36
  PaddingTestsC.testAppend2:71 » IllegalState MemcpyAsync H2H failed: [140591682...
  PaddingTestsC.testAppend:109 » IllegalState MemcpyAsync H2H failed: [140591686...
  PaddingTestsC.testPaddingOneThrougFour:49 » IllegalState MemcpyAsync H2H faile...
  PaddingTestsC.testPaddingTensor:91 » IllegalState MemcpyAsync H2H failed: [140...
  PaddingTestsC.testPrepend:30 » IllegalState MemcpyAsync H2H failed: [140591686...
  IndexingTests.testFirstColumn:74 » IllegalState MemcpyAsync H2H failed: [14059...
  IndexingTests.testGetRows:61 » Runtime Can't allocate [HOST] memory: 36
  IndexingTests.testLinearIndex:88 » IllegalState MemcpyAsync H2H failed: [14059...
  IndexingTests.testShape:51 » IllegalState MemcpyAsync H2H failed: [14059268958...
  IndexingTests.testTensorGet:26 » IllegalState MemcpyAsync H2H failed: [1405916...
  IndexingTestsC.testExecSubArray:28 » IllegalState MemcpyAsync H2H failed: [140...
  IndexingTestsC.testFirstColumn:62 » IllegalState MemcpyAsync H2H failed: [1405...
  IndexingTestsC.testGetRows:49 » Runtime Can't allocate [HOST] memory: 36
  IndexingTestsC.testGetWithVariedStride:115 » IllegalState MemcpyAsync H2H fail...
  IndexingTestsC.testLinearViewElementWiseMatching:41 » IllegalState MemcpyAsync...
  IndexingTestsC.testMultiRow:74 » Runtime Can't allocate [HOST] memory: 36
  IndexingTestsC.testPointIndexes:85 » Runtime Can't allocate [HOST] memory: 96
  IndexingTestsC.testRowVectorInterval:172 » Runtime Can't allocate [HOST] memor...
  LeadingAndTrailingOnes.testCreateLeadingAndTrailingOnes:46 » IllegalState Memc...
  LeadingAndTrailingOnes.testLeadAndTrail:38 » Runtime Can't allocate [HOST] mem...
  LeadingAndTrailingOnes.testSliceConstructor:29 » IllegalState MemcpyAsync H2H ...
  LeadingAndTrailingOnesC.testCreateLeadingAndTrailingOnes:25 » IllegalState Mem...
  LeadingAndTrailingOnesC.testMatrix:32 » IllegalState MemcpyAsync H2H failed: [...
  LeadingAndTrailingOnesC.testMultipleOnesInMiddle:47 » Runtime Can't allocate [...
  LeadingAndTrailingOnesC.testOnesInMiddleTensor:55 » Runtime Can't allocate [HO...
  ReshapeTests.testColumnVectorReshape:53 » IllegalState MemcpyAsync H2H failed:...
  ReshapeTests.testThreeTwoTwoTwo:26 » IllegalState MemcpyAsync H2H failed: [140...
  SlicingTests.testSlice:39 » Runtime Can't allocate [HOST] memory: 96
  SlicingTests.testSlices:24 » Runtime Can't allocate [HOST] memory: 96
  SlicingTestsC.testGetRow:90 » IllegalState MemcpyAsync H2H failed: [1405974391...
  SlicingTestsC.testSliceAssertion:28 » Runtime Can't allocate [HOST] memory: 12...
  SlicingTestsC.testSliceShape:40 » Runtime Can't allocate [HOST] memory: 120
  SlicingTestsC.testSwapReshape:69 » Runtime Can't allocate [HOST] memory: 120
  SlicingTestsC.testVectorIndexing:111 » Runtime Can't allocate [HOST] memory: 1...
  ShapeTestC.testElementWiseCompareOnesInMiddle:45 » IllegalState MemcpyAsync H2...
  ShapeTestC.testToOffsetZero:27 » IllegalState MemcpyAsync H2H failed: [1405916...
&lt;/denchmark-code&gt;

		</comment>
		<comment id='6' author='fac2003' date='2016-06-22T16:25:02Z'>
		Are you running tests on multi-gpu system?
		</comment>
		<comment id='7' author='fac2003' date='2016-06-22T16:25:46Z'>
		Yes. Now trying to skip the test and check DL4J.
		</comment>
		<comment id='8' author='fac2003' date='2016-06-22T16:32:17Z'>
		Tbh, i hadn't run those test with multiple gpus. On single gpu i have only 1 test failing, but that failure doesn't matter right now.
		</comment>
		<comment id='9' author='fac2003' date='2016-06-22T18:36:51Z'>
		I was able to build libnd4j and nd4j, but dl4j in your branch requires:
The following artifacts could not be resolved: org.nd4j:canova-nd4j-common:jar:0.0.0.17-SNAPSHOT, org.nd4j:canova-api:jar:0.0.0.17-SNAPSHOT, org.nd4j:canova-nd4j-image:jar:0.0.0.17-SNAPSHOT: Could not find artifact org.nd4j:canova-nd4j-common:jar:0.0.0.17-SNAPSHOT in sonatype-nexus-snapshots (&lt;denchmark-link:https://oss.sonatype.org/content/repositories/snapshots&gt;https://oss.sonatype.org/content/repositories/snapshots&lt;/denchmark-link&gt;
) -&gt; [Help 1]
You don't distribute these snapshots so I can't build this project for your branch.
Downgrading to the latest stable release 0.0.0.16 does not compile because of some constructors missing in canova:
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.1:compile (default-compile) on project deeplearning4j-core: Compilation failure: Compilation failure:
[ERROR] /home/mas2182/DL4J/sources/deeplearning4j/deeplearning4j-core/src/main/java/org/deeplearning4j/datasets/iterator/impl/CifarDataSetIterator.java:[78,23] no suitable constructor found for CifarLoader(int,int,int,org.canova.image.transform.ImageTransform,int,boolean)
		</comment>
		<comment id='10' author='fac2003' date='2016-06-22T19:21:23Z'>
		there's Canova repo: &lt;denchmark-link:https://github.com/deeplearning4j/Canova&gt;https://github.com/deeplearning4j/Canova&lt;/denchmark-link&gt;

		</comment>
		<comment id='11' author='fac2003' date='2016-06-22T19:54:29Z'>
		I managed to compile DL4J, but the new master breaks compatibility with the code we used for benchmarking. For instance, we use AsyncIterator for performance, but its signature or inheritance graph has changed. Will have to look into it more or try other examples, if we can compile them.
incompatible types: org.deeplearning4j.datasets.iterator.AsyncDataSetIterator cannot be converted to org.deeplearning4j.datasets.iterator.DataSetIterator
Similar compilation errors are found with dl4j examples:
[ERROR] dl4j-0.4-examples/src/main/java/org/deeplearning4j/examples/unsupervised/deepbelief/DBNMnistFullExample.java:[44,32] incompatible types: org.deeplearning4j.datasets.iterator.impl.MnistDataSetIterator cannot be converted to org.deeplearning4j.datasets.iterator.DataSetIterator
		</comment>
		<comment id='12' author='fac2003' date='2016-06-22T20:24:17Z'>
		that's the change coming in next release, we had DataSetIterator interfaces defined in both Dl4j and Nd4j, and different methods/classes were using different interfaces. Now it'll be only one interface for everything.
So that's actually cosmetic change.
		</comment>
		<comment id='13' author='fac2003' date='2016-06-22T20:27:00Z'>
		I'm sure it's fine. It just does not make it easy to just compile our benchmark with the new version to give you feedback.
		</comment>
		<comment id='14' author='fac2003' date='2016-06-22T20:28:18Z'>
		Could you just change import for DataSetIterator impl?
import org.nd4j.linalg.dataset.api.iterator.DataSetIterator;
		</comment>
		<comment id='15' author='fac2003' date='2016-06-22T20:48:24Z'>
		I would have to change the code on my desktop, where I did not compile from master. I'll have to pass. I have other obligations this week.
		</comment>
		<comment id='16' author='fac2003' date='2016-06-22T20:49:10Z'>
		Ok, anyway thanks for your help. We'll test it internally at morning :)
		</comment>
		<comment id='17' author='fac2003' date='2016-07-07T09:33:44Z'>
		Initial multi-gpu support implemented and will be available in next release.
		</comment>
		<comment id='18' author='fac2003' date='2019-01-20T23:52:46Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>