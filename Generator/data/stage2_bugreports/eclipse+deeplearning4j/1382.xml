<bug id='1382' author='wutzebaer' open_date='2016-04-08T23:46:56Z' closed_time='2016-05-06T07:58:12Z'>
	<summary>Problem with loaded network</summary>
	<description>
After loading a saved network i got a JVM crash when i call the fit function with the commits from 7.4.
With the commits of the 8.4. the behaviour changes from run to run (without changing the code) i observed these 4:
-the program exits without any output
-sometimes with the jvmcrash output.
-sometimes with the java exception Exception in thread "main" java.lang.IllegalArgumentException: Length must be &gt;= 1
when reducing the time series:
&lt;denchmark-code&gt;INDArray input = Nd4j.zeros(10, 3, 10);
INDArray labels = Nd4j.zeros(10, 3, 10);
&lt;/denchmark-code&gt;

Exception in thread "main" java.lang.IllegalArgumentException: Length must be &gt;= 1
i compiled on windows10 and on 3.8 the code works
commits, jvm exception and sample java-code following:
&lt;denchmark-code&gt;
used on 7.4.2016
libnd4j 2c240326a8a62e65624a3daefe412ef0c5066145
nd4j e0a23d2d0b2c04513abcdc3c33f63666a991650d
dl4j d1e8f1f8f34bcbeb8da02df3b5fbabc911da45b9
canova 4bebd4cb4aa912f3bd9771bac0f89f6d668c8779

used on 8.4.2016
canova 4bebd4cb4aa912f3bd9771bac0f89f6d668c8779
dl4j 859bdd0f302444ac04c33179afc8af500e959b89
libnd4j afafc7c859d81b05bf016d3edc5dead6b7cb9325
nd4j c1c4b01d36c1fa257ae10f6c4071197f16f569af
&lt;/denchmark-code&gt;

&lt;denchmark-code&gt;#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x000000006c08468d, pid=1064, tid=3260
#
# JRE version: Java(TM) SE Runtime Environment (8.0_45-b15) (build 1.8.0_45-b15)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.45-b02 mixed mode windows-amd64 compressed oops)
# Problematic frame:
# C  [libnd4j.dll+0x468d]
#
# Failed to write core dump. Minidumps are not enabled by default on client versions of Windows
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.java.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#

---------------  T H R E A D  ---------------

Current thread (0x000000000236c000):  JavaThread "main" [_thread_in_native, id=3260, stack(0x0000000002260000,0x0000000002360000)]

siginfo: ExceptionCode=0xc0000005, reading address 0x00000000239f2480

Registers:
RAX=0x000000006c0f2dd8, RBX=0x000000000235ebf0, RCX=0x0000000023914600, RDX=0x00000000000377a0
RSP=0x000000000235eb20, RBP=0x0000000022b86470, RSI=0x000000000000020f, RDI=0x0000000000009cd6
R8 =0x0000000000000000, R9 =0x0000000000000000, R10=0x0000000000000000, R11=0x000000000235e870
R12=0x00000000239f2480, R13=0x0000000000000002, R14=0x0000000000000000, R15=0x0000000000027358
RIP=0x000000006c08468d, EFLAGS=0x0000000000010206

Top of Stack: (sp=0x000000000235eb20)
0x000000000235eb20:   0000000000000018 000000006c084610
0x000000000235eb30:   000000000235ebf0 0000000000000004
0x000000000235eb40:   000000006c084610 000000000235ebf0
0x000000000235eb50:   0000000000000004 00000000000001b0
0x000000000235eb60:   00000000000001b0 00000000636044e2
0x000000000235eb70:   000000006c084610 000000000235ebf0
0x000000000235eb80:   0000000000000004 00000000765c8d17
0x000000000235eb90:   00000000238fc7d0 000000006c0c3daa
0x000000000235eba0:   0000904bfdfe1596 0000000002360000
0x000000000235ebb0:   0000000023914600 0000000022b86470
0x000000000235ebc0:   0000000019d6b050 000000006c09b9ae
0x000000000235ebd0:   00000000226d0810 000000000236c000
0x000000000235ebe0:   0000000000000000 000000001a43aa00
0x000000000235ebf0:   0000000022b86470 0000000023914600
0x000000000235ec00:   0000000023914600 0000000000000000
0x000000000235ec10:   0000000000027358 000001b0000001b0 

Instructions: (pc=0x000000006c08468d)
0x000000006c08466d:   8b 4b 18 48 0f af d6 c5 fa 10 53 30 4c 8d 24 90
0x000000006c08467d:   48 63 53 28 48 8b 45 00 48 0f af d6 48 83 c6 01
0x000000006c08468d:   c5 fa 10 0c 91 48 89 e9 ff 10 c4 c1 7a 11 04 24
0x000000006c08469d:   48 39 f7 75 be 48 83 c4 20 5b 5e 5f 5d 41 5c c3 


Register to memory mapping:

RAX=0x000000006c0f2dd8 is an unknown value
RBX=0x000000000235ebf0 is pointing into the stack for thread: 0x000000000236c000
RCX=0x0000000023914600 is an unknown value
RDX=0x00000000000377a0 is an unknown value
RSP=0x000000000235eb20 is pointing into the stack for thread: 0x000000000236c000
RBP=0x0000000022b86470 is an unknown value
RSI=0x000000000000020f is an unknown value
RDI=0x0000000000009cd6 is an unknown value
R8 =0x0000000000000000 is an unknown value
R9 =0x0000000000000000 is an unknown value
R10=0x0000000000000000 is an unknown value
R11=0x000000000235e870 is pointing into the stack for thread: 0x000000000236c000
R12=0x00000000239f2480 is an unknown value
R13=0x0000000000000002 is an unknown value
R14=0x0000000000000000 is an unknown value
R15=0x0000000000027358 is an unknown value


Stack: [0x0000000002260000,0x0000000002360000],  sp=0x000000000235eb20,  free space=1018k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
C  [libnd4j.dll+0x468d]
C  [libgomp-1.dll+0x44e2]
C  [libnd4j.dll+0x1b9ae]
C  [jniNativeOps.dll+0x99ea]
C  0x000000000247dfcc

Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
j  org.nd4j.nativeblas.NativeOps.execScalarFloat([JIJIJIDJJ)V+0
j  org.nd4j.linalg.cpu.nativecpu.ops.NativeOpExecutioner.exec(Lorg/nd4j/linalg/api/ops/ScalarOp;)V+425
j  org.nd4j.linalg.cpu.nativecpu.ops.NativeOpExecutioner.exec(Lorg/nd4j/linalg/api/ops/Op;)Lorg/nd4j/linalg/api/ops/Op;+14
j  org.nd4j.linalg.api.ndarray.BaseNDArray.muli(Ljava/lang/Number;Lorg/nd4j/linalg/api/ndarray/INDArray;)Lorg/nd4j/linalg/api/ndarray/INDArray;+38
j  org.nd4j.linalg.api.ndarray.BaseNDArray.muli(Ljava/lang/Number;)Lorg/nd4j/linalg/api/ndarray/INDArray;+3
j  org.nd4j.linalg.learning.RmsProp.getGradient(Lorg/nd4j/linalg/api/ndarray/INDArray;I)Lorg/nd4j/linalg/api/ndarray/INDArray;+31
j  org.deeplearning4j.nn.updater.BaseUpdater.update(Lorg/deeplearning4j/nn/api/Layer;Lorg/deeplearning4j/nn/gradient/Gradient;II)V+134
j  org.deeplearning4j.nn.updater.MultiLayerUpdater.update(Lorg/deeplearning4j/nn/api/Layer;Lorg/deeplearning4j/nn/gradient/Gradient;II)V+232
j  org.deeplearning4j.optimize.solvers.BaseOptimizer.updateGradientAccordingToParams(Lorg/deeplearning4j/nn/gradient/Gradient;Lorg/deeplearning4j/nn/api/Model;I)V+84
j  org.deeplearning4j.optimize.solvers.BaseOptimizer.gradientAndScore()Lorg/deeplearning4j/berkeley/Pair;+62
j  org.deeplearning4j.optimize.solvers.StochasticGradientDescent.optimize()Z+14
j  org.deeplearning4j.optimize.Solver.optimize()V+19
j  org.deeplearning4j.nn.multilayer.MultiLayerNetwork.fit(Lorg/nd4j/linalg/api/ndarray/INDArray;Lorg/nd4j/linalg/api/ndarray/INDArray;)V+125
j  org.deeplearning4j.nn.multilayer.MultiLayerNetwork.fit(Lorg/nd4j/linalg/dataset/api/DataSet;)V+84
j  bitcoin.BitcoinRNNExampleHilo.main([Ljava/lang/String;)V+395
v  ~StubRoutines::call_stub

---------------  P R O C E S S  ---------------

Java Threads: ( =&gt; current thread )
  0x0000000018ca7000 JavaThread "Service Thread" daemon [_thread_blocked, id=13124, stack(0x0000000019240000,0x0000000019340000)]
  0x0000000016fee000 JavaThread "C1 CompilerThread2" daemon [_thread_blocked, id=10580, stack(0x0000000019140000,0x0000000019240000)]
  0x0000000016fec800 JavaThread "C2 CompilerThread1" daemon [_thread_blocked, id=10468, stack(0x0000000019040000,0x0000000019140000)]
  0x0000000016fc6000 JavaThread "C2 CompilerThread0" daemon [_thread_blocked, id=10708, stack(0x0000000018b40000,0x0000000018c40000)]
  0x0000000016fb8000 JavaThread "JDWP Command Reader" daemon [_thread_in_native, id=6852, stack(0x0000000018a40000,0x0000000018b40000)]
  0x0000000016fb7000 JavaThread "JDWP Event Helper Thread" daemon [_thread_blocked, id=1168, stack(0x0000000018940000,0x0000000018a40000)]
  0x0000000016fa7000 JavaThread "JDWP Transport Listener: dt_socket" daemon [_thread_blocked, id=2340, stack(0x0000000018840000,0x0000000018940000)]
  0x0000000016f9b000 JavaThread "Attach Listener" daemon [_thread_blocked, id=1084, stack(0x0000000018400000,0x0000000018500000)]
  0x0000000016f98000 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=7920, stack(0x0000000018300000,0x0000000018400000)]
  0x000000000245c000 JavaThread "Finalizer" daemon [_thread_blocked, id=2172, stack(0x0000000018200000,0x0000000018300000)]
  0x0000000002458800 JavaThread "Reference Handler" daemon [_thread_blocked, id=4852, stack(0x0000000018100000,0x0000000018200000)]
=&gt;0x000000000236c000 JavaThread "main" [_thread_in_native, id=3260, stack(0x0000000002260000,0x0000000002360000)]

Other Threads:
  0x0000000016f58800 VMThread [stack: 0x0000000018000000,0x0000000018100000] [id=7484]
  0x0000000018cde000 WatcherThread [stack: 0x0000000019340000,0x0000000019440000] [id=10312]

VM state:not at safepoint (normal execution)

VM Mutex/Monitor currently owned by a thread: None

Heap:
 PSYoungGen      total 272896K, used 128753K [0x00000000d5f00000, 0x00000000f1300000, 0x0000000100000000)
  eden space 266240K, 45% used [0x00000000d5f00000,0x00000000dd6405e8,0x00000000e6300000)
  from space 6656K, 99% used [0x00000000e6300000,0x00000000e697c010,0x00000000e6980000)
  to   space 10240K, 0% used [0x00000000f0900000,0x00000000f0900000,0x00000000f1300000)
 ParOldGen       total 87552K, used 8930K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 10% used [0x0000000081c00000,0x00000000824b88f0,0x0000000087180000)
 Metaspace       used 15902K, capacity 16089K, committed 16256K, reserved 1062912K
  class space    used 1791K, capacity 1822K, committed 1920K, reserved 1048576K

Card table byte_map: [0x0000000011820000,0x0000000011c20000] byte_map_base: 0x0000000011412000

Marking Bits: (ParMarkBitMap*) 0x0000000075384040
 Begin Bits: [0x00000000122d0000, 0x0000000014260000)
 End Bits:   [0x0000000014260000, 0x00000000161f0000)

Polling page: 0x0000000000510000

CodeCache: size=245760Kb used=7999Kb max_used=8020Kb free=237760Kb
 bounds [0x0000000002460000, 0x0000000002c40000, 0x0000000011460000]
 total_blobs=2201 nmethods=1701 adapters=420
 compilation: enabled

Compilation events (10 events):
Event: 18.875 Thread 0x0000000016fc6000 nmethod 1699 0x0000000002c05350 code [0x0000000002c054e0, 0x0000000002c05a08]
Event: 18.901 Thread 0x0000000016fc6000 1700       4       org.nd4j.linalg.cpu.nativecpu.ops.NativeOpExecutioner::exec (1441 bytes)
Event: 18.915 Thread 0x0000000016fec800 nmethod 1697 0x0000000002c310d0 code [0x0000000002c31480, 0x0000000002c340d8]
Event: 18.916 Thread 0x0000000016fec800 1701       4       org.nd4j.linalg.api.ops.BaseAccumulation::setZ (6 bytes)
Event: 18.916 Thread 0x0000000016fec800 nmethod 1701 0x0000000002badf50 code [0x0000000002bae080, 0x0000000002bae118]
Event: 18.974 Thread 0x0000000016fc6000 nmethod 1700 0x0000000002c38c90 code [0x0000000002c390c0, 0x0000000002c3c0a0]
Event: 18.978 Thread 0x0000000016fee000 1702       1       java.nio.DirectIntBufferU::ix (10 bytes)
Event: 18.978 Thread 0x0000000016fee000 nmethod 1702 0x0000000002be1890 code [0x0000000002be19e0, 0x0000000002be1af0]
Event: 19.029 Thread 0x0000000016fee000 1703       1       org.nd4j.linalg.indexing.IntervalIndex::offset (5 bytes)
Event: 19.029 Thread 0x0000000016fee000 nmethod 1703 0x0000000002bf4f10 code [0x0000000002bf5060, 0x0000000002bf5170]

GC Heap History (10 events):
Event: 2.485 GC heap before
{Heap before GC invocations=5 (full 0):
 PSYoungGen      total 71680K, used 70642K [0x00000000d5f00000, 0x00000000daa00000, 0x0000000100000000)
  eden space 66560K, 100% used [0x00000000d5f00000,0x00000000da000000,0x00000000da000000)
  from space 5120K, 79% used [0x00000000da500000,0x00000000da8fcaa8,0x00000000daa00000)
  to   space 5120K, 0% used [0x00000000da000000,0x00000000da000000,0x00000000da500000)
 ParOldGen       total 87552K, used 441K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 0% used [0x0000000081c00000,0x0000000081c6e650,0x0000000087180000)
 Metaspace       used 13432K, capacity 13565K, committed 13696K, reserved 1060864K
  class space    used 1539K, capacity 1588K, committed 1664K, reserved 1048576K
Event: 2.489 GC heap after
Heap after GC invocations=5 (full 0):
 PSYoungGen      total 71680K, used 2711K [0x00000000d5f00000, 0x00000000dee00000, 0x0000000100000000)
  eden space 66560K, 0% used [0x00000000d5f00000,0x00000000d5f00000,0x00000000da000000)
  from space 5120K, 52% used [0x00000000da000000,0x00000000da2a5f80,0x00000000da500000)
  to   space 6656K, 0% used [0x00000000de780000,0x00000000de780000,0x00000000dee00000)
 ParOldGen       total 87552K, used 449K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 0% used [0x0000000081c00000,0x0000000081c70650,0x0000000087180000)
 Metaspace       used 13432K, capacity 13565K, committed 13696K, reserved 1060864K
  class space    used 1539K, capacity 1588K, committed 1664K, reserved 1048576K
}
Event: 2.542 GC heap before
{Heap before GC invocations=6 (full 0):
 PSYoungGen      total 71680K, used 69271K [0x00000000d5f00000, 0x00000000dee00000, 0x0000000100000000)
  eden space 66560K, 100% used [0x00000000d5f00000,0x00000000da000000,0x00000000da000000)
  from space 5120K, 52% used [0x00000000da000000,0x00000000da2a5f80,0x00000000da500000)
  to   space 6656K, 0% used [0x00000000de780000,0x00000000de780000,0x00000000dee00000)
 ParOldGen       total 87552K, used 449K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 0% used [0x0000000081c00000,0x0000000081c70650,0x0000000087180000)
 Metaspace       used 13433K, capacity 13565K, committed 13696K, reserved 1060864K
  class space    used 1539K, capacity 1588K, committed 1664K, reserved 1048576K
Event: 2.546 GC heap after
Heap after GC invocations=6 (full 0):
 PSYoungGen      total 139776K, used 2663K [0x00000000d5f00000, 0x00000000dee00000, 0x0000000100000000)
  eden space 133120K, 0% used [0x00000000d5f00000,0x00000000d5f00000,0x00000000de100000)
  from space 6656K, 40% used [0x00000000de780000,0x00000000dea19f90,0x00000000dee00000)
  to   space 6656K, 0% used [0x00000000de100000,0x00000000de100000,0x00000000de780000)
 ParOldGen       total 87552K, used 457K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 0% used [0x0000000081c00000,0x0000000081c72650,0x0000000087180000)
 Metaspace       used 13433K, capacity 13565K, committed 13696K, reserved 1060864K
  class space    used 1539K, capacity 1588K, committed 1664K, reserved 1048576K
}
Event: 8.824 GC heap before
{Heap before GC invocations=7 (full 0):
 PSYoungGen      total 139776K, used 135783K [0x00000000d5f00000, 0x00000000dee00000, 0x0000000100000000)
  eden space 133120K, 100% used [0x00000000d5f00000,0x00000000de100000,0x00000000de100000)
  from space 6656K, 40% used [0x00000000de780000,0x00000000dea19f90,0x00000000dee00000)
  to   space 6656K, 0% used [0x00000000de100000,0x00000000de100000,0x00000000de780000)
 ParOldGen       total 87552K, used 457K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 0% used [0x0000000081c00000,0x0000000081c72650,0x0000000087180000)
 Metaspace       used 14796K, capacity 14953K, committed 15104K, reserved 1062912K
  class space    used 1702K, capacity 1750K, committed 1792K, reserved 1048576K
Event: 8.829 GC heap after
Heap after GC invocations=7 (full 0):
 PSYoungGen      total 139776K, used 2002K [0x00000000d5f00000, 0x00000000e7000000, 0x0000000100000000)
  eden space 133120K, 0% used [0x00000000d5f00000,0x00000000d5f00000,0x00000000de100000)
  from space 6656K, 30% used [0x00000000de100000,0x00000000de2f4888,0x00000000de780000)
  to   space 6656K, 0% used [0x00000000e6980000,0x00000000e6980000,0x00000000e7000000)
 ParOldGen       total 87552K, used 2521K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 2% used [0x0000000081c00000,0x0000000081e765c8,0x0000000087180000)
 Metaspace       used 14796K, capacity 14953K, committed 15104K, reserved 1062912K
  class space    used 1702K, capacity 1750K, committed 1792K, reserved 1048576K
}
Event: 13.303 GC heap before
{Heap before GC invocations=8 (full 0):
 PSYoungGen      total 139776K, used 135122K [0x00000000d5f00000, 0x00000000e7000000, 0x0000000100000000)
  eden space 133120K, 100% used [0x00000000d5f00000,0x00000000de100000,0x00000000de100000)
  from space 6656K, 30% used [0x00000000de100000,0x00000000de2f4888,0x00000000de780000)
  to   space 6656K, 0% used [0x00000000e6980000,0x00000000e6980000,0x00000000e7000000)
 ParOldGen       total 87552K, used 2521K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 2% used [0x0000000081c00000,0x0000000081e765c8,0x0000000087180000)
 Metaspace       used 15459K, capacity 15641K, committed 16000K, reserved 1062912K
  class space    used 1776K, capacity 1822K, committed 1920K, reserved 1048576K
Event: 13.306 GC heap after
Heap after GC invocations=8 (full 0):
 PSYoungGen      total 272896K, used 1173K [0x00000000d5f00000, 0x00000000e7000000, 0x0000000100000000)
  eden space 266240K, 0% used [0x00000000d5f00000,0x00000000d5f00000,0x00000000e6300000)
  from space 6656K, 17% used [0x00000000e6980000,0x00000000e6aa56a8,0x00000000e7000000)
  to   space 6656K, 0% used [0x00000000e6300000,0x00000000e6300000,0x00000000e6980000)
 ParOldGen       total 87552K, used 3054K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 3% used [0x0000000081c00000,0x0000000081efb808,0x0000000087180000)
 Metaspace       used 15459K, capacity 15641K, committed 16000K, reserved 1062912K
  class space    used 1776K, capacity 1822K, committed 1920K, reserved 1048576K
}
Event: 17.735 GC heap before
{Heap before GC invocations=9 (full 0):
 PSYoungGen      total 272896K, used 267413K [0x00000000d5f00000, 0x00000000e7000000, 0x0000000100000000)
  eden space 266240K, 100% used [0x00000000d5f00000,0x00000000e6300000,0x00000000e6300000)
  from space 6656K, 17% used [0x00000000e6980000,0x00000000e6aa56a8,0x00000000e7000000)
  to   space 6656K, 0% used [0x00000000e6300000,0x00000000e6300000,0x00000000e6980000)
 ParOldGen       total 87552K, used 3054K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 3% used [0x0000000081c00000,0x0000000081efb808,0x0000000087180000)
 Metaspace       used 15852K, capacity 16025K, committed 16256K, reserved 1062912K
  class space    used 1788K, capacity 1822K, committed 1920K, reserved 1048576K
Event: 17.761 GC heap after
Heap after GC invocations=9 (full 0):
 PSYoungGen      total 272896K, used 6640K [0x00000000d5f00000, 0x00000000f1300000, 0x0000000100000000)
  eden space 266240K, 0% used [0x00000000d5f00000,0x00000000d5f00000,0x00000000e6300000)
  from space 6656K, 99% used [0x00000000e6300000,0x00000000e697c010,0x00000000e6980000)
  to   space 10240K, 0% used [0x00000000f0900000,0x00000000f0900000,0x00000000f1300000)
 ParOldGen       total 87552K, used 8930K [0x0000000081c00000, 0x0000000087180000, 0x00000000d5f00000)
  object space 87552K, 10% used [0x0000000081c00000,0x00000000824b88f0,0x0000000087180000)
 Metaspace       used 15852K, capacity 16025K, committed 16256K, reserved 1062912K
  class space    used 1788K, capacity 1822K, committed 1920K, reserved 1048576K
}

Deoptimization events (10 events):
Event: 15.996 Thread 0x000000000236c000 Uncommon trap: reason=speculate_class_check action=maybe_recompile pc=0x0000000002a924b4 method=org.bytedeco.javacpp.Pointer.sizeof()I @ 8
Event: 17.307 Thread 0x000000000236c000 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000002845a00 method=org.nd4j.linalg.api.shape.Shape.getOffset(J[I[I[I)J @ 80
Event: 17.307 Thread 0x000000000236c000 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000002843288 method=org.nd4j.linalg.api.shape.Shape.getOffset(J[I[I[I)J @ 80
Event: 17.311 Thread 0x000000000236c000 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000002b49b94 method=org.nd4j.linalg.cpu.nativecpu.ops.NativeOpExecutioner.exec(Lorg/nd4j/linalg/api/ops/TransformOp;)V @ 598
Event: 17.315 Thread 0x000000000236c000 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000002ba09c8 method=org.nd4j.linalg.indexing.ShapeOffsetResolution.tryShortCircuit([Lorg/nd4j/linalg/indexing/INDArrayIndex;)Z @ 309
Event: 17.761 Thread 0x000000000236c000 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000002a52974 method=org.bytedeco.javacpp.Pointer.deallocateReferences()V @ 17
Event: 19.158 Thread 0x000000000236c000 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002c10ea0 method=org.nd4j.linalg.cpu.nativecpu.ops.NativeOpExecutioner.exec(Lorg/nd4j/linalg/api/ops/TransformOp;)V @ 1014
Event: 19.159 Thread 0x000000000236c000 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000002c3b47c method=org.nd4j.linalg.api.shape.Shape.wholeArrayDimension([I)Z @ 11
Event: 19.160 Thread 0x000000000236c000 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000002ac824c method=org.nd4j.linalg.api.shape.Shape.elementWiseStride([I[IZ)I @ 184
Event: 19.160 Thread 0x000000000236c000 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000002a4f50c method=org.nd4j.linalg.cpu.nativecpu.ops.NativeOpExecutioner.exec(Lorg/nd4j/linalg/api/ops/Op;)Lorg/nd4j/linalg/api/ops/Op; @ 4

Internal exceptions (10 events):
Event: 5.641 Thread 0x000000000236c000 Exception &lt;a 'java/lang/ArrayIndexOutOfBoundsException': 3&gt; (0x00000000d9c93510) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\interpreter\interpreterRuntime.cpp, line 366]
Event: 5.642 Thread 0x000000000236c000 Exception &lt;a 'java/lang/ArrayIndexOutOfBoundsException': 28&gt; (0x00000000d9c95b48) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\interpreter\interpreterRuntime.cpp, line 366]
Event: 5.644 Thread 0x000000000236c000 Exception &lt;a 'java/lang/ArrayIndexOutOfBoundsException': 3&gt; (0x00000000d9ca57f8) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\interpreter\interpreterRuntime.cpp, line 366]
Event: 5.658 Thread 0x000000000236c000 Exception &lt;a 'java/lang/ArrayIndexOutOfBoundsException': 57&gt; (0x00000000d9d83960) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\interpreter\interpreterRuntime.cpp, line 366]
Event: 5.659 Thread 0x000000000236c000 Exception &lt;a 'java/lang/ArrayIndexOutOfBoundsException': 57&gt; (0x00000000d9d84fb8) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\interpreter\interpreterRuntime.cpp, line 366]
Event: 5.660 Thread 0x000000000236c000 Exception &lt;a 'java/lang/ArrayIndexOutOfBoundsException': 3&gt; (0x00000000d9d93758) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\interpreter\interpreterRuntime.cpp, line 366]
Event: 8.937 Thread 0x000000000236c000 Exception &lt;a 'java/lang/NoSuchMethodError': &lt;clinit&gt;&gt; (0x00000000dd85a800) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\prims\jni.cpp, line 1598]
Event: 8.948 Thread 0x000000000236c000 Exception &lt;a 'java/lang/NoSuchMethodError': &lt;clinit&gt;&gt; (0x00000000dd9217a8) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\prims\jni.cpp, line 1598]
Event: 8.950 Thread 0x000000000236c000 Exception &lt;a 'java/lang/NoSuchMethodError': &lt;clinit&gt;&gt; (0x00000000dd92dd48) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\prims\jni.cpp, line 1598]
Event: 8.954 Thread 0x000000000236c000 Exception &lt;a 'java/lang/NoSuchMethodError': &lt;clinit&gt;&gt; (0x00000000dd962bd8) thrown at [C:\re\workspace\8-2-build-windows-amd64-cygwin\jdk8u45\3627\hotspot\src\share\vm\prims\jni.cpp, line 1598]

Events (10 events):
Event: 19.160 Thread 0x000000000236c000 DEOPT PACKING pc=0x0000000002a4f50c sp=0x000000000235ef50
Event: 19.160 Thread 0x000000000236c000 DEOPT UNPACKING pc=0x00000000024a582a sp=0x000000000235eef0 mode 2
Event: 19.160 loading class org/nd4j/linalg/ops/transforms/Transforms
Event: 19.160 loading class org/nd4j/linalg/ops/transforms/Transforms done
Event: 19.160 Thread 0x000000000236c000 DEOPT PACKING pc=0x0000000002651d01 sp=0x000000000235da40
Event: 19.160 Thread 0x000000000236c000 DEOPT UNPACKING pc=0x00000000024a787f sp=0x000000000235d790 mode 1
Event: 19.160 Thread 0x000000000236c000 DEOPT PACKING pc=0x000000000287e264 sp=0x000000000235dac0
Event: 19.160 Thread 0x000000000236c000 DEOPT UNPACKING pc=0x00000000024a787f sp=0x000000000235d8e0 mode 1
Event: 19.161 Thread 0x000000000236c000 DEOPT PACKING pc=0x000000000287dffc sp=0x000000000235dc50
Event: 19.161 Thread 0x000000000236c000 DEOPT UNPACKING pc=0x00000000024a787f sp=0x000000000235da70 mode 1


Dynamic libraries:
0x00007ff60e190000 - 0x00007ff60e1c7000     C:\Program Files\Java\jre1.8.0_45\bin\javaw.exe
0x00007ffb2bc50000 - 0x00007ffb2be11000     C:\WINDOWS\SYSTEM32\ntdll.dll
0x00007ffb2b3e0000 - 0x00007ffb2b48d000     C:\WINDOWS\system32\KERNEL32.DLL
0x00007ffb287a0000 - 0x00007ffb28988000     C:\WINDOWS\system32\KERNELBASE.dll
0x00007ffb2b7d0000 - 0x00007ffb2b877000     C:\WINDOWS\system32\ADVAPI32.dll
0x00007ffb2b730000 - 0x00007ffb2b7cd000     C:\WINDOWS\system32\msvcrt.dll
0x00007ffb290b0000 - 0x00007ffb2910b000     C:\WINDOWS\system32\sechost.dll
0x00007ffb2b490000 - 0x00007ffb2b5ac000     C:\WINDOWS\system32\RPCRT4.dll
0x00007ffb29110000 - 0x00007ffb29266000     C:\WINDOWS\system32\USER32.dll
0x00007ffb2b930000 - 0x00007ffb2bab6000     C:\WINDOWS\system32\GDI32.dll
0x00007ffb1f4d0000 - 0x00007ffb1f744000     C:\WINDOWS\WinSxS\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.10586.0_none_8c15ae12515e1c22\COMCTL32.dll
0x00007ffb29850000 - 0x00007ffb29acd000     C:\WINDOWS\system32\combase.dll
0x00007ffb28fe0000 - 0x00007ffb2904a000     C:\WINDOWS\system32\bcryptPrimitives.dll
0x00007ffb2bac0000 - 0x00007ffb2bafb000     C:\WINDOWS\system32\IMM32.DLL
0x0000000076560000 - 0x0000000076632000     C:\Program Files\Java\jre1.8.0_45\bin\msvcr100.dll
0x0000000074b80000 - 0x0000000075403000     C:\Program Files\Java\jre1.8.0_45\bin\server\jvm.dll
0x00007ffb2b300000 - 0x00007ffb2b308000     C:\WINDOWS\system32\PSAPI.DLL
0x00007ffb26710000 - 0x00007ffb26733000     C:\WINDOWS\SYSTEM32\WINMM.dll
0x00007ffb25a90000 - 0x00007ffb25a99000     C:\WINDOWS\SYSTEM32\WSOCK32.dll
0x00007ffb29bc0000 - 0x00007ffb29c2b000     C:\WINDOWS\system32\WS2_32.dll
0x00007ffb214f0000 - 0x00007ffb214fa000     C:\WINDOWS\SYSTEM32\VERSION.dll
0x00007ffb266e0000 - 0x00007ffb2670c000     C:\WINDOWS\SYSTEM32\WINMMBASE.dll
0x00007ffb283b0000 - 0x00007ffb283f3000     C:\WINDOWS\system32\cfgmgr32.dll
0x0000000076f60000 - 0x0000000076f6f000     C:\Program Files\Java\jre1.8.0_45\bin\verify.dll
0x00000000766d0000 - 0x00000000766f9000     C:\Program Files\Java\jre1.8.0_45\bin\java.dll
0x0000000076fc0000 - 0x0000000076ff5000     C:\Program Files\Java\jre1.8.0_45\bin\jdwp.dll
0x00000000771a0000 - 0x00000000771a8000     C:\Program Files\Java\jre1.8.0_45\bin\npt.dll
0x00000000766b0000 - 0x00000000766c6000     C:\Program Files\Java\jre1.8.0_45\bin\zip.dll
0x00007ffb29c30000 - 0x00007ffb2b18c000     C:\WINDOWS\system32\SHELL32.dll
0x00007ffb28990000 - 0x00007ffb28fd5000     C:\WINDOWS\system32\windows.storage.dll
0x00007ffb29b00000 - 0x00007ffb29b52000     C:\WINDOWS\system32\shlwapi.dll
0x00007ffb282d0000 - 0x00007ffb282df000     C:\WINDOWS\system32\kernel.appcore.dll
0x00007ffb286e0000 - 0x00007ffb28795000     C:\WINDOWS\system32\shcore.dll
0x00007ffb28280000 - 0x00007ffb282cb000     C:\WINDOWS\system32\powrprof.dll
0x00007ffb282e0000 - 0x00007ffb282f4000     C:\WINDOWS\system32\profapi.dll
0x0000000076fb0000 - 0x0000000076fb9000     C:\Program Files\Java\jre1.8.0_45\bin\dt_socket.dll
0x00007ffb16f20000 - 0x00007ffb16f36000     C:\WINDOWS\system32\napinsp.dll
0x00007ffb171c0000 - 0x00007ffb171da000     C:\WINDOWS\system32\pnrpnsp.dll
0x00007ffb26390000 - 0x00007ffb263a8000     C:\WINDOWS\system32\NLAapi.dll
0x00007ffb27b70000 - 0x00007ffb27bcc000     C:\WINDOWS\System32\mswsock.dll
0x00007ffb26980000 - 0x00007ffb26a2a000     C:\WINDOWS\SYSTEM32\DNSAPI.dll
0x00007ffb29af0000 - 0x00007ffb29af8000     C:\WINDOWS\system32\NSI.dll
0x00007ffb17fa0000 - 0x00007ffb17fad000     C:\WINDOWS\System32\winrnr.dll
0x00007ffb17d60000 - 0x00007ffb17d75000     C:\WINDOWS\System32\wshbth.dll
0x00007ffb216f0000 - 0x00007ffb21757000     C:\WINDOWS\System32\fwpuclnt.dll
0x00007ffb280b0000 - 0x00007ffb280d9000     C:\WINDOWS\SYSTEM32\bcrypt.dll
0x00007ffb1aa20000 - 0x00007ffb1aa2a000     C:\Windows\System32\rasadhlp.dll
0x0000000076690000 - 0x00000000766aa000     C:\Program Files\Java\jre1.8.0_45\bin\net.dll
0x00007ffb216a0000 - 0x00007ffb216d8000     C:\WINDOWS\SYSTEM32\IPHLPAPI.DLL
0x000000006c080000 - 0x000000006c318000     C:\Users\LuckyPC\AppData\Local\Temp\javacpp788911799137250\libnd4j.dll
0x000000006d7c0000 - 0x000000006f8d0000     D:\msys64\mingw64\bin\libopenblas.dll
0x0000000061440000 - 0x000000006145c000     D:\msys64\mingw64\bin\libgcc_s_seh-1.dll
0x0000000063600000 - 0x0000000063624000     D:\msys64\mingw64\bin\libgomp-1.dll
0x000000006fc40000 - 0x000000006fda2000     D:\msys64\mingw64\bin\libstdc++-6.dll
0x000000001bd10000 - 0x000000001be50000     D:\msys64\mingw64\bin\libgfortran-3.dll
0x0000000064940000 - 0x0000000064955000     D:\msys64\mingw64\bin\libwinpthread-1.dll
0x000000006cf00000 - 0x000000006cf58000     D:\msys64\mingw64\bin\libquadmath-0.dll
0x000000006ff40000 - 0x000000006ff59000     C:\Users\LuckyPC\AppData\Local\Temp\javacpp788911799137250\jniNativeOps.dll
0x0000000069f40000 - 0x0000000069f5d000     C:\Users\LuckyPC\AppData\Local\Temp\javacpp788911799137250\jniNd4jBlas.dll
0x00007ffb13d60000 - 0x00007ffb13eec000     C:\WINDOWS\SYSTEM32\dbghelp.dll

VM Arguments:
jvm_args: -agentlib:jdwp=transport=dt_socket,suspend=y,address=localhost:65383 -Dfile.encoding=UTF-8 
java_command: bitcoin.BitcoinRNNExampleHilo
java_class_path (initial): D:\git\dl4j-0.4-examples\target\classes;C:\Users\LuckyPC\.m2\repository\org\json\json\20141113\json-20141113.jar;C:\Users\LuckyPC\.m2\repository\org\deeplearning4j\deeplearning4j-nlp\0.4-rc3.9-SNAPSHOT\deeplearning4j-nlp-0.4-rc3.9-SNAPSHOT.jar;C:\Users\LuckyPC\.m2\repository\org\apache\lucene\lucene-analyzers-common\5.3.1\lucene-analyzers-common-5.3.1.jar;C:\Users\LuckyPC\.m2\repository\org\apache\lucene\lucene-core\5.3.1\lucene-core-5.3.1.jar;C:\Users\LuckyPC\.m2\repository\org\apache\lucene\lucene-queryparser\5.3.1\lucene-queryparser-5.3.1.jar;C:\Users\LuckyPC\.m2\repository\org\apache\lucene\lucene-queries\5.3.1\lucene-queries-5.3.1.jar;C:\Users\LuckyPC\.m2\repository\org\apache\lucene\lucene-sandbox\5.3.1\lucene-sandbox-5.3.1.jar;C:\Users\LuckyPC\.m2\repository\org\deeplearning4j\deeplearning4j-scaleout-akka\0.4-rc3.9-SNAPSHOT\deeplearning4j-scaleout-akka-0.4-rc3.9-SNAPSHOT.jar;C:\Users\LuckyPC\.m2\repository\javax\ws\rs\javax.ws.rs-api\2.0.1\javax.ws.rs-api-2.0.1.jar;C:\Users\LuckyPC\.m2\repository\io\dropwizard\dropwizard-core\0.8.0\dropwizard-core-0.8.0.jar;C:\Users\LuckyPC\.m2\repository\io\dropwizard\dropwizard-util\0.8.0\dropwizard-util-0.8.0.jar;C:\Users\LuckyPC\.m2\repository\com\google\code\findbugs\jsr305\3.0.0\jsr305-3.0.0.jar;C:\Users\LuckyPC\.m2\repository\joda-time\joda-time\2.7\joda-time-2.7.jar;C:\Users\LuckyPC\.m2\repository\io\dropwizard\dropwizard-jackson\0.8.0\dropwizard-jackson-0.8.0.jar;C:\Users\LuckyPC\.m2\repository\com\fasterxml\jackson\datatype\jackson-datatype-jdk7\2.5.1\jackson-datatype-jdk7-2.5.1.jar;C:\Users\LuckyPC\.m2\repository\com\fasterxml\jackson\datatype\jackson-datatype-guava\2.5.1\jackson-datatype-guava-2.5.1.jar;C:\Users\LuckyPC\.m2\repository\com\fasterxml\jackson\module\jackson-module-afterburner\2.5.1\jackson-module-afterburner-2.5.1.jar;C:\Users\LuckyPC\.m2\repository\com\fasterxml\jackson\datatype\jackson-datatype-joda\2.5.1\jackson-datatype-joda-2.5.1.jar;C:\Users\LuckyPC\.m2\repository\i
Launcher Type: SUN_STANDARD

Environment Variables:
PATH=C:/Program Files/Java/jre1.8.0_45/bin/server;C:/Program Files/Java/jre1.8.0_45/bin;C:/Program Files/Java/jre1.8.0_45/lib/amd64;C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v7.5\bin;C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v7.5\libnvvp;C:\ProgramData\Oracle\Java\javapath;C:\Program Files (x86)\Intel\iCLS Client\;C:\Program Files\Intel\iCLS Client\;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\Intel\Intel(R) Management Engine Components\DAL;C:\Program Files\Intel\Intel(R) Management Engine Components\IPT;C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\DAL;C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\IPT;C:\Program Files\Condusiv Technologies\ExpressCache\;C:\Program Files (x86)\QuickTime\QTSystem\;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Program Files\MongoDB\Server\3.0\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program Files\TortoiseGit\bin;C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\;C:\Program Files\Microsoft SQL Server\110\Tools\Binn\;C:\Program Files (x86)\Microsoft SDKs\TypeScript\1.0\;D:\apache-maven-3.3.9\bin;D:\msys64\mingw64\bin;;C:\Program Files\Docker Toolbox;D:\eclipse;
USERNAME=LuckyPC
OS=Windows_NT
PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 69 Stepping 1, GenuineIntel



---------------  S Y S T E M  ---------------

OS: Windows 10.0 , 64 bit Build 10586 (10.0.10586.0)

CPU:total 4 (2 cores per cpu, 2 threads per core) family 6 model 69 stepping 1, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3, sse4.1, sse4.2, popcnt, avx, avx2, aes, clmul, erms, lzcnt, ht, tsc, tscinvbit, bmi1, bmi2

Memory: 4k page, physical 8268996k(4090524k free), swap 18830396k(13042168k free)

vm_info: Java HotSpot(TM) 64-Bit Server VM (25.45-b02) for windows-amd64 JRE (1.8.0_45-b15), built on Apr 30 2015 12:40:44 by "java_re" with MS VC++ 10.0 (VS2010)

time: Sat Apr 09 00:31:19 2016
elapsed time: 19 seconds (0d 0h 0m 19s)


&lt;/denchmark-code&gt;

&lt;denchmark-code&gt;
package test;

import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.List;
import java.util.Random;

import org.apache.commons.io.FileUtils;
import org.deeplearning4j.nn.api.OptimizationAlgorithm;
import org.deeplearning4j.nn.conf.MultiLayerConfiguration;
import org.deeplearning4j.nn.conf.NeuralNetConfiguration;
import org.deeplearning4j.nn.conf.NeuralNetConfiguration.ListBuilder;
import org.deeplearning4j.nn.conf.Updater;
import org.deeplearning4j.nn.conf.distribution.UniformDistribution;
import org.deeplearning4j.nn.conf.layers.GravesLSTM;
import org.deeplearning4j.nn.conf.layers.RnnOutputLayer;
import org.deeplearning4j.nn.multilayer.MultiLayerNetwork;
import org.deeplearning4j.nn.weights.WeightInit;
import org.deeplearning4j.optimize.listeners.ScoreIterationListener;
import org.nd4j.linalg.api.ndarray.INDArray;
import org.nd4j.linalg.dataset.DataSet;
import org.nd4j.linalg.factory.Nd4j;
import org.nd4j.linalg.lossfunctions.LossFunctions.LossFunction;

/**
 * @author Peter Gro�mann
 */
public class SaveLoad {

    public static final int HIDDEN_LAYER_WIDTH = 200;
    public static final int HIDDEN_LAYER_CONT = 2;
    public static final Random r = new Random(78945);

    public static void main(String[] args) throws NumberFormatException, IOException, ClassNotFoundException {

        NeuralNetConfiguration.Builder builder = new NeuralNetConfiguration.Builder();
        builder.iterations(1);
        builder.learningRate(0.01);
        builder.optimizationAlgo(OptimizationAlgorithm.STOCHASTIC_GRADIENT_DESCENT);
        builder.seed(123);

        builder.biasInit(0);
        builder.miniBatch(true);
        builder.updater(Updater.RMSPROP);

        builder.weightInit(WeightInit.DISTRIBUTION);
        builder.dist(new UniformDistribution(-1, 1));

        ListBuilder listBuilder = builder.list(HIDDEN_LAYER_CONT + 1);

        for (int i = 0; i &lt; HIDDEN_LAYER_CONT; i++) {
            GravesLSTM.Builder hiddenLayerBuilder = new GravesLSTM.Builder();
            hiddenLayerBuilder.nIn(i == 0 ? 3 : HIDDEN_LAYER_WIDTH);
            hiddenLayerBuilder.nOut(HIDDEN_LAYER_WIDTH);
            hiddenLayerBuilder.activation("tanh");
            listBuilder.layer(i, hiddenLayerBuilder.build());
        }

        RnnOutputLayer.Builder outputLayerBuilder = new RnnOutputLayer.Builder(LossFunction.MCXENT);
        outputLayerBuilder.activation("softmax");
        outputLayerBuilder.nIn(HIDDEN_LAYER_WIDTH);
        outputLayerBuilder.nOut(3);
        listBuilder.layer(HIDDEN_LAYER_CONT, outputLayerBuilder.build());

        listBuilder.pretrain(false);
        listBuilder.backprop(true);
        listBuilder.build();

        MultiLayerConfiguration conf = listBuilder.build();
        MultiLayerNetwork net = new MultiLayerNetwork(conf);
        net.init();

        INDArray input = Nd4j.zeros(10, 3, 144*3);
        INDArray labels = Nd4j.zeros(10, 3, 144*3);

        net.fit(new DataSet(input, labels));
        net.fit(new DataSet(input, labels));
        save(net);

        net = load();
        net.fit(new DataSet(input, labels));
        System.out.println("works");
    }

    private static void save(MultiLayerNetwork net) throws IOException {
        // Write the network parameters:
        try (DataOutputStream dos = new DataOutputStream(Files.newOutputStream(Paths.get("coefficients.bin")))) {
            Nd4j.write(net.params(), dos);
        }

        // Write the network configuration:
        FileUtils.write(new File("conf.json"), net.getLayerWiseConfigurations().toJson());

        // Save the updater:
        try (ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("updater.bin"))) {
            oos.writeObject(net.getUpdater());
        }
    }

    private static MultiLayerNetwork load() throws FileNotFoundException, IOException, ClassNotFoundException {
        // Load network configuration from disk:
        MultiLayerConfiguration confFromJson = MultiLayerConfiguration.fromJson(FileUtils.readFileToString(new File("conf.json")));

        // Load parameters from disk:
        INDArray newParams;
        try (DataInputStream dis = new DataInputStream(new FileInputStream("coefficients.bin"))) {
            newParams = Nd4j.read(dis);
        }

        // Create a MultiLayerNetwork from the saved configuration and
        // parameters
        MultiLayerNetwork savedNetwork = new MultiLayerNetwork(confFromJson);
        savedNetwork.init();
        // must be set before setUpdater()
        savedNetwork.setParameters(newParams);

        // Load the updater:
        org.deeplearning4j.nn.api.Updater updater;
        try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream("updater.bin"))) {
            updater = (org.deeplearning4j.nn.api.Updater) ois.readObject();
        }

        // Set the updater in the network
        savedNetwork.setUpdater(updater);

        return savedNetwork;
    }

}


&lt;/denchmark-code&gt;

	</description>
	<comments>
		<comment id='1' author='wutzebaer' date='2016-04-14T04:38:00Z'>
		Can confirm that this is still a problem, as of latest nd4j/libnd4j.
		</comment>
		<comment id='2' author='wutzebaer' date='2016-04-14T05:04:17Z'>
		Appears to be a serialization issue with INDArrays: &lt;denchmark-link:https://github.com/deeplearning4j/nd4j/issues/832&gt;deeplearning4j/nd4j#832&lt;/denchmark-link&gt;

		</comment>
		<comment id='3' author='wutzebaer' date='2016-05-06T07:58:12Z'>
		A lot has been fixed. Closing this.
		</comment>
		<comment id='4' author='wutzebaer' date='2019-01-21T03:53:10Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>