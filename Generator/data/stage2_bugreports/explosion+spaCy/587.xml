<bug id='587' author='sadovnychyi' open_date='2016-10-28T13:04:39Z' closed_time='2016-10-28T15:44:15Z'>
	<summary>Segmentation fault while using matcher</summary>
	<description>
As mentioned in &lt;denchmark-link:https://github.com/explosion/spaCy/issues/429&gt;#429&lt;/denchmark-link&gt;
. I have manually installed spacy with &lt;denchmark-link:https://github.com/explosion/spaCy/commit/301f3cc8981407d7c69099f5bc706b3ac035bdc8&gt;this&lt;/denchmark-link&gt;
 fix which you did yesterday. It took me a lot of time to catch this.. so here we are:
import spacy
import spacy.matcher

nlp = spacy.load('en', parser=False, entity=False)
matcher = spacy.matcher.Matcher(nlp.vocab)
content = u'''a b; c'''
matcher.add(entity_key='1', label='TEST', attrs={}, specs=[[{65: 'a'}, {65: 'b'}]])
matcher(nlp(content))
matcher.add(entity_key='2', label='TEST', attrs={}, specs=[[{65: 'a'}, {65: 'b'}, {5: True}, {65: 'c'}]])
matcher(nlp(content))
matcher.add(entity_key='3', label='TEST', attrs={}, specs=[[{65: 'a'}, {65: 'b'}, {5: True}, {65: 'd'}]])
matcher(nlp(content))
-&gt;
&lt;denchmark-code&gt;Segmentation fault: 11
&lt;/denchmark-code&gt;

Thrown from the last line.
	</description>
	<comments>
		<comment id='1' author='sadovnychyi' date='2016-10-28T15:44:11Z'>
		Hm, was silently ignoring an error condition.
Fixed now, but looking at this, I doubt this will be the last error. Hopefully they should report more cleanly now though.
		</comment>
		<comment id='2' author='sadovnychyi' date='2016-10-28T18:18:32Z'>
		Thanks!
&lt;denchmark-code&gt;Traceback (most recent call last):
  File "word2vec/matcher.py", line 118, in &lt;module&gt;
    matches = matcher(doc)
  File "spacy/matcher.pyx", line 315, in spacy.matcher.Matcher.__call__ (spacy/matcher.cpp:8519)
Exception: Error selecting action in matcher
&lt;/denchmark-code&gt;

How do I go from here? Seems like there's no debug logs available.
		</comment>
		<comment id='3' author='sadovnychyi' date='2016-10-28T18:37:04Z'>
		Ok, got it. Hope you don't mind if I'll leave it here.
import spacy
import spacy.matcher

nlp = spacy.load('en', parser=False, entity=False)
matcher = spacy.matcher.Matcher(nlp.vocab)
content = u'''a b; c'''
matcher.add(entity_key='1', label='TEST', attrs={}, specs=[[]])
matcher(nlp(content))
-&gt;
&lt;denchmark-code&gt;Traceback (most recent call last): 
  File "word2vec/matcher_bla.py", line 8, in &lt;module&gt;
    matcher(nlp(content))
  File "spacy/matcher.pyx", line 315, in spacy.matcher.Matcher.__call__ (spacy/matcher.cpp:8519)
Exception: Error selecting action in matcher
&lt;/denchmark-code&gt;

Caused by empty specs. While I understand that this is a mistake in my data it's better to check this when entity is being added.
		</comment>
		<comment id='4' author='sadovnychyi' date='2016-11-10T07:38:40Z'>
		I had that last week but it disappeared when I updated the data. I was suspecting empty pattern/key caused it. Thanks for the explanation!
		</comment>
		<comment id='5' author='sadovnychyi' date='2018-05-09T06:38:39Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>