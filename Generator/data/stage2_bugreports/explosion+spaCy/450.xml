<bug id='450' author='ahelaatabi' open_date='2016-07-07T14:20:00Z' closed_time='2016-10-23T14:07:48Z'>
	<summary>error token/spans (spacy/tokens/doc.cpp:4890)</summary>
	<description>
Hey,
I came across this error :
if token.nbor(i=1) : File "spacy/tokens/token.pyx", line 94, in spacy.tokens.token.Token.nbor (spacy/tokens/token.cpp:4699) return self.doc[self.i+i] File "spacy/tokens/doc.pyx", line 100, in spacy.tokens.doc.Doc.__getitem__ (spacy/tokens/doc.cpp:4890) if self._py_tokens[i] is not None: IndexError: list index out of range
What I was trying to do is run this small:
for sent in doc.sents: for token in sent: if token.nbor(i=1) : print token,token.nbor(i=1)
The purpose of this small code was to merge in the "doc" span the consecutive nouns &lt;the ones with tag have 'NN'&gt;. All this before passing it to a relation extraction algorithm.
Thanks in advance,
	</description>
	<comments>
		<comment id='1' author='ahelaatabi' date='2016-07-07T15:49:47Z'>
		I've kind of managed to get pass that by limiting my code to the first Noun phrases.. The problem is that using :
nn=doc[list(doc).index(token):list(doc).index(token)+1] doc.merge( token.idx , token.nbor(i = 1).idx + len(token.nbor(i = 1)) , nn.root.tag , nn.text , nn.ent_type_)
Even the merge doesn't have any effect on the doc object itself
Would appreciate any indications to solve this
		</comment>
		<comment id='2' author='ahelaatabi' date='2016-08-16T13:07:22Z'>
		Same here. This code from the docs seems to be broken.
for ent in doc.ents:
    ent.merge(ent.root.tag_, ent.text, ent.label_)
for np in doc.noun_chunks:
    while len(np) &gt; 1 and np[0].dep_ not in ('advmod', 'amod', 'compound'):
        np = np[1:]
    np.merge(np.root.tag_, np.text, np.root.ent_type_)
		</comment>
		<comment id='3' author='ahelaatabi' date='2016-10-12T13:15:25Z'>
		same problem
		</comment>
		<comment id='4' author='ahelaatabi' date='2016-10-12T13:20:58Z'>
		You can actually use list(doc.noun_chunks) as a temporary workaround.
		</comment>
		<comment id='5' author='ahelaatabi' date='2016-10-23T14:07:47Z'>
		This should be fixed in 1.0.
		</comment>
		<comment id='6' author='ahelaatabi' date='2018-05-09T07:39:09Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>