<bug id='626' author='sadovnychyi' open_date='2016-11-12T18:46:34Z' closed_time='2017-09-21T18:16:53Z'>
	<summary>PhraseMatcher seems to modify the vocabulary somehow</summary>
	<description>
import spacy

doc_text = u'Withholding'
doc_bytes = b'\n\x00\x00\x00\x01\x00\x00\x00F\xfc,\xb52\x02'
nlp = spacy.load('en', parser=False, entity=False, tagger=False, matcher=False)
# nlp(doc_text).to_bytes()
matcher = spacy.matcher.PhraseMatcher(nlp.vocab, [
  spacy.tokens.Doc(nlp.vocab, words=['a', 'Indemnitee']),
  spacy.tokens.Doc(nlp.vocab, words=['a', 'Setoff']),
  spacy.tokens.Doc(nlp.vocab, words=['Intercreditor', 'Agreement']),
  spacy.tokens.Doc(nlp.vocab, words=['c', 'Clawback']),
])
doc = spacy.tokens.Doc(nlp.vocab).from_bytes(doc_bytes)
if doc.text != doc_text:
  raise ValueError('wrong document: %s', doc.text)
Witholding becomes workbooks. Does not happens without all of phrases in the matcher presented and if we convert save document into the bytes before. Seems really strange for me, have no idea how to narrow this down.
&lt;denchmark-h:h2&gt;Your Environment&lt;/denchmark-h&gt;


Operating System:  macOS
Python Version Used: 3.5.2
spaCy Version Used: 1.2.0
Environment Information: NA

	</description>
	<comments>
		<comment id='1' author='sadovnychyi' date='2016-11-12T18:54:22Z'>
		Vocabulary modification happens here:
&lt;denchmark-link:https://github.com/explosion/spaCy/blob/master/spacy/matcher.pyx#L507&gt;https://github.com/explosion/spaCy/blob/master/spacy/matcher.pyx#L507&lt;/denchmark-link&gt;

Not sure what the best solution will be. Will think about this.
		</comment>
		<comment id='2' author='sadovnychyi' date='2017-09-21T18:16:53Z'>
		Closing this, because the problem should no longer be relevant for spaCy 2.
		</comment>
		<comment id='3' author='sadovnychyi' date='2018-05-08T16:27:53Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>