<bug id='5494' author='jenspedde' open_date='2020-05-24T07:49:38Z' closed_time='2020-05-25T07:53:46Z'>
	<summary>AttributeError: module 'cupy' has no attribute 'resize' while using  retokenizer.merge with CUDA</summary>
	<description>
if model has vectors and gpu is used, spacy calls retokenizer.merge( ) an unsupported cupy method resize as mentioned in
&lt;denchmark-link:url&gt;https://docs-cupy.chainer.org/en/stable/reference/comparison.html&lt;/denchmark-link&gt;

&lt;denchmark-h:h2&gt;prerequisites&lt;/denchmark-h&gt;



CUDA


model with vectors


&lt;denchmark-h:h2&gt;How to reproduce the behaviour&lt;/denchmark-h&gt;

import spacy
spacy.require_gpu()
nlp = spacy.load("en_core_web_md")
doc = nlp("just an example")
spans = list(doc.noun_chunks)
spans = spacy.util.filter_spans(spans)
with doc.retokenize() as retokenizer:
for span in spans:
retokenizer.merge(span)
&lt;denchmark-h:h2&gt;Stack&lt;/denchmark-h&gt;

_retokenize.pyx in spacy.tokens._retokenize.Retokenizer.exit()
_retokenize.pyx in spacy.tokens._retokenize._merge()
vocab.pyx in spacy.vocab.Vocab.set_vector()
vectors.pyx in spacy.vectors.Vectors.resize()
AttributeError: module 'cupy' has no attribute 'resize'
&lt;denchmark-h:h2&gt;Environment&lt;/denchmark-h&gt;

spaCy version    2.2.4
Platform         Windows-10-10.0.18362-SP0
Python version   3.7.4
cupy-cuda102                       7.4.0
	</description>
	<comments>
		<comment id='1' author='jenspedde' date='2020-05-25T07:53:45Z'>
		Thanks for the report! This has been fixed in &lt;denchmark-link:https://github.com/explosion/spaCy/pull/5216&gt;#5216&lt;/denchmark-link&gt;
 and the fix will be included in the upcoming v2.3.0 release.
		</comment>
		<comment id='2' author='jenspedde' date='2020-06-24T19:02:32Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>