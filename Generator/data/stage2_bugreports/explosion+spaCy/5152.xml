<bug id='5152' author='Raibows' open_date='2020-03-14T16:24:47Z' closed_time='2020-03-29T12:05:39Z'>
	<summary>doc.similarity(token) got a confusing results betwwen different tokens</summary>
	<description>
&lt;denchmark-h:h2&gt;How to reproduce the behaviour&lt;/denchmark-h&gt;

Hi,
I'm trying to get a similarity between a sentence and a word.
&lt;denchmark-code&gt;import spacy
text = "Talk about being boring!&lt;br /&gt;&lt;br /&gt;I got this expecting a fascinating insight into the life of the man who wrote the mythical Night on the Galactic Railroad. I expected to see crazy stories and hijinks of an eccentric man and to discover his inspirations for such bizarre material. Boy, was I wrong.&lt;br /&gt;&lt;br /&gt;Spring and Chaos is mostly boring with only sporadic moments of innovative animation. It's certainly nothing to write home about and nowhere near as good as NOTGR which is something that I suggest you watch instead. Leave this bore alone. If you absolutely MUST see then either rent it or find it somewhere cheap. Do not pay top dollar."
nlp = spacy.load('en')
x = nlp('Talk')
y = nlp('let')
print(type(y))
print(type(y[0]))
print(len(y))
doc = nlp(text)
print(doc[0:x[0].i + 3].similarity(y[0])) ## error occured
&lt;/denchmark-code&gt;

The consoles prints erros as below if you take :
&lt;denchmark-link:https://user-images.githubusercontent.com/37944786/76685984-e5625680-6652-11ea-9b28-6ac0adca7c62.jpg&gt;&lt;/denchmark-link&gt;

What makes me confused is it works well if you take  or  or other words. The console prints well like below
&lt;denchmark-link:https://user-images.githubusercontent.com/37944786/76685753-12156e80-6651-11ea-88b1-4b5d8e43a3d7.png&gt;&lt;/denchmark-link&gt;

&lt;denchmark-h:h2&gt;Your Environment&lt;/denchmark-h&gt;


Operating System: Ubuntu 18.04
Python Version Used: 3.7.4
spaCy Version Used: 2.0.16
Environment Information: Anaconda, x64
model compatibility is as below


	</description>
	<comments>
		<comment id='1' author='Raibows' date='2020-03-14T19:49:44Z'>
		Thanks for the detailed report and analysis, it's very useful! This certainly looks like a bug - I can replicate it on my end. I'll have a look :-)
		</comment>
		<comment id='2' author='Raibows' date='2020-03-14T22:23:03Z'>
		Fun bug. The reason it crashes on that specific case 'let' and not on 'spell' is because it only crashes when the number of characters in the token equals the number of tokens in the span (i.e. 3 in your example). Yes, I know that doesn't make sense, bugs rarely do ;-)
Fixed in &lt;denchmark-link:https://github.com/explosion/spaCy/pull/5155&gt;#5155&lt;/denchmark-link&gt;
, will be incorporated in spaCy v.3.0 onwards.
Thanks for the nice find!
		</comment>
		<comment id='3' author='Raibows' date='2020-05-05T21:50:49Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>