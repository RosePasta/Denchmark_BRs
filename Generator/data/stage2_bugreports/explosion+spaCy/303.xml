<bug id='303' author='wx-chevalier' open_date='2016-03-23T09:33:15Z' closed_time='2016-04-26T19:15:08Z'>
	<summary>IOError: when use nlp=English(data_dir=data_dir)</summary>
	<description>
when i use :
&lt;denchmark-code&gt;nlp = English()
&lt;/denchmark-code&gt;

it works well,but when i set the data_dir params, it reports IOError:
&lt;denchmark-code&gt;data_dir = os.environ.get('SPACY_DATA', LOCAL_DATA_DIR)
nlp = English(data_dir=data_dir)
&lt;/denchmark-code&gt;

&lt;denchmark-code&gt;---------------------------------------------------------------------------
IOError                                   Traceback (most recent call last)
&lt;ipython-input-20-d41df14def99&gt; in &lt;module&gt;()
----&gt; 1 nlp = English(data_dir=data_dir)

/Users/apple/anaconda/envs/word2vec/lib/python2.7/site-packages/spacy/language.pyc in __init__(self, data_dir, vocab, tokenizer, tagger, parser, entity, matcher, serializer, load_vectors, package, vectors_package)
    237         self.tokenizer = tokenizer
    238         if tagger in (None, True):
--&gt; 239             tagger = Tagger.from_package(package, self.vocab)
    240         self.tagger = tagger
    241         if entity in (None, True):

/Users/apple/anaconda/envs/word2vec/lib/python2.7/site-packages/spacy/tagger.pyx in spacy.tagger.Tagger.from_package (spacy/tagger.cpp:5102)()
    159         model = TaggerModel(templates)
    160         if pkg.has_file('pos', 'model'):
--&gt; 161             model.load(pkg.file_path('pos', 'model'))
    162         return cls(vocab, model)
    163 

/Users/apple/anaconda/envs/word2vec/lib/python2.7/site-packages/thinc/linear/avgtron.pyx in thinc.linear.avgtron.AveragedPerceptron.load (thinc/linear/avgtron.cpp:3120)()
     89         self.weights = PreshMap(reader.nr_feat)
     90         cdef int i = 0
---&gt; 91         while reader.read(self.mem, &amp;feat_id, &amp;feature):
     92             self.weights.set(feat_id, feature)
     93             if i % 1000 == 0:

/Users/apple/anaconda/envs/word2vec/lib/python2.7/site-packages/thinc/linear/serialize.pyx in thinc.linear.serialize.Reader.read (thinc/linear/serialize.cpp:2616)()
    100         if status &lt; 1:
    101             if errno:
--&gt; 102                 PyErr_SetFromErrno(IOError)
    103             return 0  # end of file
    104 
&lt;/denchmark-code&gt;

i use 0.100.6
	</description>
	<comments>
		<comment id='1' author='wx-chevalier' date='2016-03-24T11:59:04Z'>
		Thanks for the report. We've noticed this too today, and it's puzzling us. I think the choice of IOError might be misleading here. It looks to me like the file exists, but that there's some formatting problem, possibly introduced when we were working on the perceptron code to reduce the model loading time.
We'll keep you posted.
		</comment>
		<comment id='2' author='wx-chevalier' date='2016-03-25T11:31:54Z'>
		Just pushed thinc 5.0.7, which should have this fixed. Try
&lt;denchmark-code&gt;pip install --upgrade thinc
&lt;/denchmark-code&gt;

And let me know whether you still have problems.
		</comment>
		<comment id='3' author='wx-chevalier' date='2016-04-04T22:25:10Z'>
		&lt;denchmark-link:https://github.com/syllog1sm&gt;@syllog1sm&lt;/denchmark-link&gt;
   I tried pip install --upgrade thinc but I still get the IOError
		</comment>
		<comment id='4' author='wx-chevalier' date='2016-04-05T07:26:49Z'>
		I think I figured out what's wrong here.  is deprecated (see &lt;denchmark-link:https://github.com/spacy-io/spaCy/blob/master/spacy/en/__init__.py#L036&gt;https://github.com/spacy-io/spaCy/blob/master/spacy/en/__init__.py#L036&lt;/denchmark-link&gt;
) and points to the old data directory .
It seems you still have some old files lying around there even though they should have been migrated by a run of python -m spacy.en.download. On a fresh install I also get an IOError, but about not being able to find the model files, not a thinc loading error.
Could you please try the following:
&lt;denchmark-code&gt;import spacy
from spacy.en import English
import sputnik
pkg = sputnik.package(spacy.about.__title__, spacy.about.__version__, 'en')
nlp = English(data_dir=pkg.path)
&lt;/denchmark-code&gt;

data_dir points to a model directory. In this sample we construct it via sputnik from the installed package, but normally you would use this parameter when you have the model files stored outside the spacy directory.
I hope that helped. Sorry, some code and docs might have not been kept up to date. Any pointers to outdated information is greatly appreciated.
		</comment>
		<comment id='5' author='wx-chevalier' date='2018-05-09T13:12:23Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>