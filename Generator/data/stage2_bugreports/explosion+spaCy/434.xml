<bug id='434' author='latkins' open_date='2016-06-22T08:12:29Z' closed_time='2016-10-22T15:09:21Z'>
	<summary>doc.from_array fails if document is of length 1.</summary>
	<description>
Not a huge deal, but to reproduce:
&lt;denchmark-code&gt;import spacy
from spacy.attrs import ENT_TYPE, ENT_IOB
from spacy.symbols import PERSON, ORG
from numpy import ndarray

nlp = spacy.load('en')

doc = nlp(u'Hi', entity=False)

columns = [ENT_TYPE, ENT_IOB]
values = ndarray(shape=(len(columns), len(doc)), dtype='int32')

values[0] = [1]
values[1] = [0]
doc.from_array(columns, values)
&lt;/denchmark-code&gt;

Results in the error:
&lt;denchmark-code&gt;---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
&lt;ipython-input-50-96041689f6b2&gt; in &lt;module&gt;()
     14 values[0] = [1]
     15 values[1] = [0]
---&gt; 16 doc.from_array(columns, values)

/home/vagrant/miniconda3/lib/python3.5/site-packages/spacy/tokens/doc.pyx in spacy.tokens.doc.Doc.from_array (spacy/tokens/doc.cpp:9955)()

IndexError: index 1 is out of bounds for axis 1 with size 1

&lt;/denchmark-code&gt;

This is using spacy 0.100.6.
	</description>
	<comments>
		<comment id='1' author='latkins' date='2016-06-22T09:32:59Z'>
		Looking a bit closer, this might be more of an error in the Named Entities section of the tutorial.
&lt;denchmark-code&gt;import spacy
from spacy.attrs import ENT_TYPE, ENT_IOB
from spacy.symbols import PERSON, ORG
from numpy import ndarray

nlp = spacy.load('en')

# Get the Doc object, and apply the pipeline except the entity recognizer
doc = nlp(u'My name is Matt.', entity=False)

columns = [ENT_TYPE, ENT_IOB]
values = ndarray(shape=(len(columns), len(doc)), dtype='int32')
# IOB values are 0=missing, 1=I, 2=O, 3=B 
values[0] = [1, 1, 1, 3, 1]
values[1] = [0, 0, 0, PERSON, 0]
doc.from_array(columns, values)
print(doc.ents)
&lt;/denchmark-code&gt;

Adding print(doc.ents) to the tutorial results in the error:
&lt;denchmark-code&gt;---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
&lt;ipython-input-131-972e90a7fe5d&gt; in &lt;module&gt;()
     15 values[1] = [0, 0, 0, PERSON, 0]
     16 doc.from_array(columns, values)
---&gt; 17 print(doc.ents)

/home/vagrant/miniconda3/lib/python3.5/site-packages/spacy/tokens/doc.pyx in spacy.tokens.doc.Doc.ents.__get__ (spacy/tokens/doc.cpp:6934)()

AssertionError: 
&lt;/denchmark-code&gt;

		</comment>
		<comment id='2' author='latkins' date='2016-06-22T09:48:24Z'>
		I think that the values array should actually be of shape (len(doc), len(columns)). The IOB values in the array in the tutorial also seem to be wrong. They should be 2, rather than 1, for the O tokens.
&lt;denchmark-code&gt;doc = nlp(u'My name is Matt.', entity=False)

columns = [ENT_TYPE, ENT_IOB]
values = ndarray(shape=(len(doc), len(columns)), dtype='int32')
# IOB values are 0=missing, 1=I, 2=O, 3=B 
values[:, 1] = [2, 2, 2, 3, 2]
values[:, 0] = [0, 0, 0, PERSON, 0]
doc.from_array(columns, values)
for i, t in enumerate(doc):
    print(values[i, :], t.ent_type, t.ent_iob)
print(doc.ents)
&lt;/denchmark-code&gt;

Gives:
&lt;denchmark-code&gt;[0 2] 0 2
[0 2] 0 2
[0 2] 0 2
[346   3] 346 3
[0 2] 0 2
(Matt,)
&lt;/denchmark-code&gt;

		</comment>
		<comment id='3' author='latkins' date='2018-05-09T08:12:37Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>