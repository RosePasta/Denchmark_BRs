<bug id='5926' author='GruffPrys' open_date='2020-08-17T16:20:42Z' closed_time='2020-09-09T19:08:53Z'>
	<summary>Training a model with the simple training method adds '_SP' tags to the TAG_MAP used resulting in misaligned tagging.</summary>
	<description>
For, more details and the workaround suggested by &lt;denchmark-link:https://github.com/honnibal&gt;@honnibal&lt;/denchmark-link&gt;
., see:
&lt;denchmark-link:https://support.prodi.gy/t/problem-creating-a-new-language-to-serve-as-a-base-model-for-further-improvement-in-prodigy/3296&gt;https://support.prodi.gy/t/problem-creating-a-new-language-to-serve-as-a-base-model-for-further-improvement-in-prodigy/3296&lt;/denchmark-link&gt;

Possibly related to &lt;denchmark-link:https://github.com/explosion/spaCy/issues/5648&gt;#5648&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/adrianeboyd&gt;@adrianeboyd&lt;/denchmark-link&gt;

&lt;denchmark-h:h2&gt;Your Environment&lt;/denchmark-h&gt;


Operating System: Ubuntu 18
Python Version Used: 3.6
spaCy Version Used: 2.3.2
Environment Information:

	</description>
	<comments>
		<comment id='1' author='GruffPrys' date='2020-08-24T12:56:35Z'>
		It's probably related to the simple training method, which we don't use internally so it doesn't get tested as well. I will take a look...
(I think removing _SP from the tag map may cause bugs when your text actually contains space characters, but I'm not entirely sure off the top of my head whether it will raise an error or just do something weird.)
		</comment>
		<comment id='2' author='GruffPrys' date='2020-08-24T13:42:18Z'>
		Let's see, I realized I'm not sure what you mean by "simple training method". This example tagger training script here uses what's frequently called something like "simple training method" within spacy:
&lt;denchmark-link:https://github.com/explosion/spaCy/blob/b10c7bc56ed74ae205f5e136c6dae59d70b27925/examples/training/train_tagger.py&gt;https://github.com/explosion/spaCy/blob/b10c7bc56ed74ae205f5e136c6dae59d70b27925/examples/training/train_tagger.py&lt;/denchmark-link&gt;

Is this what you mean? Or do you mean prodigy train?
I tested both and I can't immediately replicate this problem either with this script or with prodigy train. How does this compare in terms of how you're adding labels and training? What does your tag map look like? (You can also send me a link or code snippet separately at adriane@explosion.ai.)
If you remove the space mappings you will get errors if your texts contain space tokens, so I wouldn't really recommend that, maybe only if you're 100% sure you're preprocessing your texts so that you don't have space tokens. The error would look like this:
&lt;denchmark-code&gt;  File "morphology.pyx", line 301, in spacy.morphology.Morphology.assign_tag_id
KeyError: 6893682062797376370
&lt;/denchmark-code&gt;

And it's also possible there's some TAG vs. POS weirdness in prodigy or maybe _SP vs. SPACE when you're using UPOS tags but with the tagger. What are the exact commands you're using with prodigy to annotate and to train?
		</comment>
		<comment id='3' author='GruffPrys' date='2020-09-09T19:08:52Z'>
		This issue has been automatically closed because there has been no response to a request for more information from the original author. With only the information that is currently in the issue, there's not enough information to take action. If you're the original author, feel free to reopen the issue if you have or find the answers needed to investigate further.
		</comment>
	</comments>
</bug>