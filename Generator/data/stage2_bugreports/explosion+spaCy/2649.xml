<bug id='2649' author='kbulygin' open_date='2018-08-09T11:23:24Z' closed_time='2018-12-08T11:06:23Z'>
	<summary>`a/DET` has `going to` as its lemma</summary>
	<description>
&lt;denchmark-h:h2&gt;How to reproduce the behaviour&lt;/denchmark-h&gt;

While processing a list of words, I've stumbled upon the word i'ma (it's probably I'm a). The word is divided into three tokens (i, 'm, a). The reported lemma of the last token (going to) is problematic in several aspects:

This meaning of a is unlikely here.
The lemma is inconsisted with the guessed POS (DET).
The lemma contains a space.

&gt;&gt;&gt; nlp = spacy.load('en_core_web_sm')
&gt;&gt;&gt; doc = nlp("i'ma")
&gt;&gt;&gt; list(doc)
[i, 'm, a]
&gt;&gt;&gt; [t.lemma_ for t in doc]
['-PRON-', 'be', 'going to']
&gt;&gt;&gt; [t.pos_ for t in doc]
['PRON', 'VERB', 'DET']

&gt;&gt;&gt; nlp = spacy.load('en_core_web_lg')
&gt;&gt;&gt; doc = nlp("i'ma")
&gt;&gt;&gt; list(doc)
[i, 'm, a]
&gt;&gt;&gt; [t.lemma_ for t in doc]
['-PRON-', 'be', 'going to']
&gt;&gt;&gt; [t.pos_ for t in doc]
['PRON', 'VERB', 'DET']
&lt;denchmark-h:h2&gt;Info about spaCy&lt;/denchmark-h&gt;


spaCy version: 2.0.11
Platform: Linux-3.16.0-4-amd64-x86_64-with-debian-8.8
Python version: 3.6.0
Models: en_core_web_lg, en_core_web_sm

	</description>
	<comments>
		<comment id='1' author='kbulygin' date='2018-08-09T11:40:41Z'>
		Thanks for the report – this is a good point!
It looks like "im'a" uses the same tokenizer exception as "imma", which is supposed to handle cases like  "imma let you finish" → "i am going to let you finish". Because the ORTH values of the split tokens always need to match the original string, we end up with tokens [i, 'm, a].
It makes sense that the tagger predicts DET for "a" (even in cases where this would be incorrect). We'll have to think about how we want to handle that kinda stuff going forward, but for now, I think it'd make the most sense to just remove the pre-set LEMMA from that tokenizer exception.
		</comment>
		<comment id='2' author='kbulygin' date='2018-08-09T12:11:11Z'>
		Thanks for the reply. With cases like "imma = I'm gonna", the behavior starts to make some sense.
By the way, the word  is processed like , but  (listed on &lt;denchmark-link:https://www.urbandictionary.com/define.php?term=imma&gt;https://www.urbandictionary.com/define.php?term=imma&lt;/denchmark-link&gt;
 and &lt;denchmark-link:https://en.wiktionary.org/wiki/Imma&gt;https://en.wiktionary.org/wiki/Imma&lt;/denchmark-link&gt;
 as the "main" contraction of ) is processed as a single token.
Also, gonna is processed not as a single token with the lemma going to, but as two tokens (gon=go na=to).
IMHO, it makes more sense to process only /[Ii]'?mma/ as I=I 'm=am m=go a=to.
		</comment>
		<comment id='3' author='kbulygin' date='2018-10-30T13:30:21Z'>
		I also found a similar problem/bug, this time with a completely innocuous sentence, "this is a test":
nlp = spacy.load("en_core_web_md")
for x in nlp("This is a test."):
    print(x.text, x.tag_, x.norm_)
gives a very strange result for the normalised form of a/DET:
&lt;denchmark-code&gt;This DT This
is VBZ is
a DT gonna
test NN test
&lt;/denchmark-code&gt;

		</comment>
		<comment id='4' author='kbulygin' date='2018-12-08T11:06:19Z'>
		See here for the explanation for this weird bug: &lt;denchmark-link:https://github.com/explosion/spaCy/pull/3029&gt;#3029&lt;/denchmark-link&gt;

Thanks for reporting; will be fixed in the next nightly.
		</comment>
		<comment id='5' author='kbulygin' date='2019-01-07T11:28:09Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>