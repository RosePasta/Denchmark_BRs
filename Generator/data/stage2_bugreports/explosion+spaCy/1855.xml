<bug id='1855' author='GregDubbin' open_date='2018-01-16T20:27:34Z' closed_time='2018-01-20T16:34:24Z'>
	<summary>The * operator exhibits strange behavior</summary>
	<description>
&lt;denchmark-h:h2&gt;Your Environment&lt;/denchmark-h&gt;


Python version: 2.7.14
Platform: Darwin-17.2.0-x86_64-i386-64bit
spaCy version: 2.0.5
Models: en_core_web_sm

The '+' and '*' operators are not behaving as expected.  For example
doc = en_tokenizer("( A B B A A A A A B ) .")
matcher = Matcher(doc.vocab)
matcher.add('A+',None, [
        {
            'ORTH':u'A',
            'OP':'1'
        },
        {
            'ORTH':u'A',
            'OP':'*'
        }
    ])
print matcher(doc)
expected:
&lt;denchmark-code&gt;[(16885048410399321887L, 1, 2), (16885048410399321887L, 4, 9)]
&lt;/denchmark-code&gt;

actual:
&lt;denchmark-code&gt;[(16885048410399321887L, 1, 2),
 (16885048410399321887L, 4, 6),
 (16885048410399321887L, 5, 7),
 (16885048410399321887L, 6, 8),
 (16885048410399321887L, 7, 9),
 (16885048410399321887L, 8, 9)]
&lt;/denchmark-code&gt;

The matcher captures every pair of A's but fails to merge the contiguous block of A's.  Additionally, the matches are overlapping, which isn't consistent with the behavior of re.findall.
	</description>
	<comments>
		<comment id='1' author='GregDubbin' date='2018-01-16T20:41:13Z'>
		I have created a fix for this bug in my own fork of spaCy with some additional enhancements to allow greedy matching on the '*' operator regardless of it's location in the pattern.  The fact that each spec in a pattern can only have one operator and patterns don't allow grouping means that this can be done without backtracking.
Let me know if you would like me to create a Pull Request
		</comment>
		<comment id='2' author='GregDubbin' date='2018-01-20T16:18:48Z'>
		&lt;denchmark-link:https://github.com/GregDubbin&gt;@GregDubbin&lt;/denchmark-link&gt;
 This would be hugely helpful! Further discussion of the current matcher problems can be found here: &lt;denchmark-link:https://github.com/explosion/spaCy/issues/1503&gt;#1503&lt;/denchmark-link&gt;

		</comment>
		<comment id='3' author='GregDubbin' date='2018-01-20T16:34:24Z'>
		Merging this with &lt;denchmark-link:https://github.com/explosion/spaCy/issues/1503&gt;#1503&lt;/denchmark-link&gt;
!
		</comment>
		<comment id='4' author='GregDubbin' date='2018-05-08T01:55:43Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>