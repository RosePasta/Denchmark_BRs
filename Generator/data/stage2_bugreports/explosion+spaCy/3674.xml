<bug id='3674' author='jeffoneill' open_date='2019-05-04T03:25:13Z' closed_time='2019-05-04T11:44:11Z'>
	<summary>Bug in init_model.py read_vectors()</summary>
	<description>
This is the current code for read_vectors:
&lt;denchmark-code&gt;def read_vectors(vectors_loc):
    f = open_file(vectors_loc)
    shape = tuple(int(size) for size in next(f).split())
    vectors_data = numpy.zeros(shape=shape, dtype="f")
    vectors_keys = []
    for i, line in enumerate(tqdm(f)):
        line = line.rstrip()
        pieces = line.rsplit(" ", vectors_data.shape[1] + 1)
        word = pieces.pop(0)
        if len(pieces) != vectors_data.shape[1]:
            msg.fail(Errors.E094.format(line_num=i, loc=vectors_loc), exits=1)
        vectors_data[i] = numpy.asarray(pieces, dtype="f")
        vectors_keys.append(word)
    return vectors_data, vectors_keys
&lt;/denchmark-code&gt;

The +1 should be removed from rsplit because n+1 splits results in n+2 things but we only want n+1 things (the word and the vector of length n).
This bug only manifests itself when there is whitespace in the word since the parameter is the maximum number of splits.
Bonus bug: when you have a word with whitespace, and do this:
&lt;denchmark-code&gt;python -m spacy init-model en w2vdir --vectors-loc w2v.txt.gz
&lt;/denchmark-code&gt;

you get this error:
&lt;denchmark-code&gt;✘ [E094] Error reading line 3345 in vectors file w2vtmp.txt.
&lt;/denchmark-code&gt;

but execution of the Python script never stops and you see this on the command line:
&lt;denchmark-code&gt;⠴ Reading vectors from w2vtmp.txt.gz
&lt;/denchmark-code&gt;

At first I thought the script was still running though it was actually hung.
	</description>
	<comments>
		<comment id='1' author='jeffoneill' date='2019-05-04T11:43:46Z'>
		Thanks for the report – I think this might be the same issue as &lt;denchmark-link:https://github.com/explosion/spaCy/issues/3667&gt;#3667&lt;/denchmark-link&gt;
, right? I'll merge those two together, since they're both about the same function in the same command.
		</comment>
		<comment id='2' author='jeffoneill' date='2019-06-03T11:59:36Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>