<bug id='3974' author='tedgoddard' open_date='2019-07-16T16:15:12Z' closed_time='2019-07-16T16:32:54Z'>
	<summary>Transient segmentation fault in noun_chunks and as_doc()</summary>
	<description>
This crash was observed on macOS but also occurs on Ubuntu 18.04 on docker. The error reported on linux is slightly more informative than "segmentation fault", it's "corrupted size vs. prev_size" or "corrupted double-linked list". The crash is being called transient because it only occurs after many invocations, hence the while loop. It also seems to occur less often (never?) for short text input.
As a workaround, I am using nlp(chunk.text) rather than as_doc(), but this is significantly slower.
&lt;denchmark-h:h2&gt;How to reproduce the behaviour&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;import spacy

nlp = spacy.load('en_core_web_sm')

while True:
    text = "Goku is introduced in the Dragon Ball manga and anime at 12 years of age[23] (initially, he claims to be 14,[22] but it is later clarified during the Tournament Saga that this is because Goku had trouble counting), as a young boy living in obscurity on Mount Paozu. Goku owns the Power Pole and the four-star Dragon Ball, inheritances from his grandfather."
    doc = nlp(text)
    result = [ [token.text for token in chunk.as_doc()] for chunk in doc.noun_chunks ]
    print(result)
&lt;/denchmark-code&gt;

&lt;denchmark-h:h2&gt;Your Environment&lt;/denchmark-h&gt;


spaCy version: 2.1.6
Platform: Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic
Python version: 3.6.8
Models: en

	</description>
	<comments>
		<comment id='1' author='tedgoddard' date='2019-07-16T16:32:51Z'>
		Thanks for the report. We have a fix for this in the works, see &lt;denchmark-link:https://github.com/explosion/spaCy/pull/3969&gt;#3969&lt;/denchmark-link&gt;
.
		</comment>
		<comment id='2' author='tedgoddard' date='2019-08-15T16:42:28Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>