<bug id='3182' author='ykeuter' open_date='2019-01-21T16:48:49Z' closed_time='2019-02-08T16:27:37Z'>
	<summary>Reproduce spaCy training results</summary>
	<description>
It would be nice if there is a way to reproduce training result in spaCy. Below snippet trains a trivial NER component, but shows different results in separate runs, even while using fix_random_seed. Is this expected behaviour?
&lt;denchmark-code&gt;import spacy

spacy.util.fix_random_seed()

nlp = spacy.blank("en")

ner = nlp.create_pipe("ner")
ner.add_label("TEST")
nlp.add_pipe(ner)

losses = {}
nlp.begin_training()
nlp.update(
    ["test"],  # batch of texts
    [{"entities": [(0, 4, "TEST")]}],  # batch of annotations
    losses=losses,
)
print(losses)
&lt;/denchmark-code&gt;

Environment:
&lt;denchmark-code&gt;* **spaCy version:** 2.0.18
* **Platform:** Linux-4.9.125-linuxkit-x86_64-with-debian-buster-sid
* **Python version:** 3.6.7
* **Models:** nl_core_news_sm
&lt;/denchmark-code&gt;

	</description>
	<comments>
		<comment id='1' author='ykeuter' date='2019-01-29T23:05:52Z'>
		I am having the same issue with spacy.util.fix_random_seed() I am trying to train the model for text categorization however (using textcat).
&lt;denchmark-code&gt;  `  import spacy
    spacy.util.fix_random_seed()
    nlp = spacy.load('en_core_web_sm')
    textclass = nlp.create_pipe('textcat')
    nlp.add_pipe(textclass, last=True)
    textclass.add_label('NotAtFault')
    
   
    optimizer = nlp.begin_training()`
&lt;/denchmark-code&gt;

I have experimented with the location of the seed setting but to no avail.
For me:
spaCy version: 2.0.18
Platform: Windows 10
Python version: 3.6.8
Models: en_core_web_sm
		</comment>
		<comment id='2' author='ykeuter' date='2019-02-07T08:56:27Z'>
		The three sources of randomization should be:
&lt;denchmark-code&gt;numpy.random.seed(i)
cupy.random.seed(i)
&lt;/denchmark-code&gt;

I think currently cupy.random.seed isn't being set, so if you're using GPU, that would be the problem.
		</comment>
		<comment id='3' author='ykeuter' date='2019-02-08T16:27:37Z'>
		Closing this, since this is already fixed on develop!
		</comment>
		<comment id='4' author='ykeuter' date='2019-03-10T16:43:39Z'>
		This thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.
		</comment>
	</comments>
</bug>