<bug id='474' author='davudadiguezel' open_date='2015-11-18T10:58:23Z' closed_time='2015-11-18T17:05:19Z'>
	<summary>Segmentation faults for hmm_generate, hmm_viterbi and hmm_loglik</summary>
	<description>
Hi,
I am trying to run hmm_viterbi and get Segment faults. I run it like this:
./hmm_viterbi -i test.csv -m hmm_gmm_testout.xml -o viterbi_out_test.txt
gdb gives me this error message:
Program received signal SIGSEGV, Segmentation fault.
__GI___libc_free (mem=0x100000001) at malloc.c:2929
2929    malloc.c: No such file or directory.
(gdb) bt
#0  __GI___libc_free (mem=0x100000001) at malloc.c:2929
&lt;denchmark-link:https://github.com/mlpack/mlpack/issues/1&gt;#1&lt;/denchmark-link&gt;
  0x00007ffff7b89aef in mlpack::util::SaveRestoreUtility::LoadParameter(arma::Mat&amp;, std::string const&amp;) () from /org/share/home/adigueze/mlpack-1.0.12/bin/lib/libmlpack.so.1
&lt;denchmark-link:https://github.com/mlpack/mlpack/pull/2&gt;#2&lt;/denchmark-link&gt;
  0x00000000004100fc in void mlpack::hmm::LoadHMM&lt;mlpack::gmm::GMM&lt;mlpack::gmm::EMFit&lt;mlpack::kmeans::KMeans&lt;mlpack::metric::LMetric&lt;2, false&gt;, mlpack::kmeans::RandomPartition, mlpack::kmeans::MaxVarianceNewCluster&gt;, mlpack::gmm::PositiveDefiniteConstraint&gt; &gt; &gt;(mlpack::hmm::HMM&lt;mlpack::gmm::GMM&lt;mlpack::gmm::EMFit&lt;mlpack::kmeans::KMeans&lt;mlpack::metric::LMetric&lt;2, false&gt;, mlpack::kmeans::RandomPartition, mlpack::kmeans::MaxVarianceNewCluster&gt;, mlpack::gmm::PositiveDefiniteConstraint&gt; &gt; &gt;&amp;, mlpack::util::SaveRestoreUtility&amp;) ()
&lt;denchmark-link:https://github.com/mlpack/mlpack/issues/3&gt;#3&lt;/denchmark-link&gt;
  0x000000000040b8a0 in main ()
But I don't understand it. Don't know which file is missing, because all files in the command above do exist. Hmm_generate and _viterbi give the same error.
Thanks for any help!
Greetings
Davud
	</description>
	<comments>
		<comment id='1' author='davudadiguezel' date='2015-11-18T14:30:07Z'>
		Hi Davud,
I see you're using mlpack-1.0.12 here, which is a little old now.  Is it possible for you to try the current git master branch?  The load/save functionality has been rewritten, and I think this may solve your issue.  If that's not possible, I can try to dig a bit deeper into what's going on here.
		</comment>
		<comment id='2' author='davudadiguezel' date='2015-11-18T15:00:16Z'>
		Thanks, I will try.
		</comment>
		<comment id='3' author='davudadiguezel' date='2015-11-18T15:51:53Z'>
		I just updated and now I get this:
./hmm_train -i test.csv -n 3 -l labels.csv -t gmm -g 1 -o hmm.xml
[DEBUG] Compiled with debugging symbols.
[FATAL] Parameter '--label_file' does not exist in this program.
terminate called after throwing an instance of 'std::runtime_error'
what():  fatal error; see Log::Fatal output
Aborted (core dumped)
But the paramater still exists in hmm_train or was it removed? when I do the same without labels I get the same error.
		</comment>
		<comment id='4' author='davudadiguezel' date='2015-11-18T16:08:48Z'>
		I added in line 313 in hmm_train_main.cpp an 's'  because I guess it should be labels_file and not label_file, right?
Now I get this error:
[FATAL] Unknown extension '' for HMM model file.
Do I have to give a hmm model? I pass a number of hidden states. So this shouldn't be needed, right?
		</comment>
		<comment id='5' author='davudadiguezel' date='2015-11-18T17:05:19Z'>
		Hi there Davud,
I'm sorry that you had these problems.  I did a little debugging and committed a few changes (&lt;denchmark-link:https://github.com/mlpack/mlpack/commit/a435e75e7115bd0848272e0e12e9a09a3b815dfc&gt;a435e75&lt;/denchmark-link&gt;
..713fa60) that should fix your issues.  You were correct that there was a misspelling;  should have been .  I went a bit further and ensured that  and  and  all work with an HMM generated by , and in my trials it seems to work.  So I think that if you update to the latest git master revision and recompile, you should not have any problems.
One note is that any HMM you trained earlier with  will not load right; there was a bug that prevented the initial state probabilities from being properly saved (fixed in &lt;denchmark-link:https://github.com/mlpack/mlpack/commit/7bbe7359987e5d95566864f4b51952b4c024d7da&gt;7bbe735&lt;/denchmark-link&gt;
).
Please, let me know if you have any more issues, and again, sorry for the inconvenience.
Thanks,
Ryan
		</comment>
		<comment id='6' author='davudadiguezel' date='2015-11-19T09:43:18Z'>
		works like a charm! Thanks for the quick fix!
Greetings,
Davud
		</comment>
	</comments>
</bug>