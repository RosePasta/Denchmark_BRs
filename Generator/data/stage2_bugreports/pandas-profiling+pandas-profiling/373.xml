<bug id='373' author='rushikesh79' open_date='2020-02-10T12:48:25Z' closed_time='2020-07-23T00:02:11Z'>
	<summary>While calling through rest api : RuntimeError: main thread is not in main loop</summary>
	<description>
I tried with both version of pandas profiling 2.3 and 2.4
When I try to hit the api for profiling it generate a html file correactly, when i hit that api for 2nd time I got an error:
Exception ignored in: &lt;function Image.del at 0x0D771C48&gt;
Traceback (most recent call last):
File "C:\Users\RS54863\AppData\Local\Programs\Python\Python37-32\lib\tkinter_init_.py", line 3507, in del
self.tk.call('image', 'delete', self.name)
RuntimeError: main thread is not in main loop
Exception ignored in: &lt;function Image.del at 0x0D771C48&gt;
Traceback (most recent call last):
File "C:\Users\RS54863\AppData\Local\Programs\Python\Python37-32\lib\tkinter_init_.py", line 3507, in del
self.tk.call('image', 'delete', self.name)
RuntimeError: main thread is not in main loop
Exception ignored in: &lt;function Image.del at 0x0D771C48&gt;
Traceback (most recent call last):
File "C:\Users\RS54863\AppData\Local\Programs\Python\Python37-32\lib\tkinter_init_.py", line 3507, in del
self.tk.call('image', 'delete', self.name)
RuntimeError: main thread is not in main loop
Exception ignored in: &lt;function Image.del at 0x0D771C48&gt;
Traceback (most recent call last):
File "C:\Users\RS54863\AppData\Local\Programs\Python\Python37-32\lib\tkinter_init_.py", line 3507, in del
self.tk.call('image', 'delete', self.name)
RuntimeError: main thread is not in main loop
Tcl_AsyncDelete: async handler deleted by the wrong thread
	</description>
	<comments>
		<comment id='1' author='rushikesh79' date='2020-02-10T12:54:53Z'>
		Could you provide the minimal information to reproduce this error?

the minimal code you are using to generate the report
which environment you are using (jupyter notebook, console or IDE) and packages (pip freeze &gt; packages.txt)
a sample or description of the dataset (df.head(), df.info())

		</comment>
		<comment id='2' author='rushikesh79' date='2020-02-10T13:01:48Z'>
		def generateAnalysisReport(df, fileReference):
try:
result = {}
profile = df.profile_report(title='Pandas Profiling Report')
reportFileName= fileReference.split('.pkl')[0] + ".html"
reportFilePath= REPORTS_FOLDER_PATH + reportFileName
profile.to_file(output_file=reportFilePath)
result['reportFile'] = reportFileName
return result
except Exception as e:
logger.error("{0}".format(e))
raise e
Environment:  console
&lt;denchmark-link:https://github.com/pandas-profiling/pandas-profiling/files/4180858/packages.txt&gt;packages.txt&lt;/denchmark-link&gt;

I run that script over flask server
Acutally it is not dataset issue. its showing correct output for first call. When I hit API for 2nd time it terminates.
		</comment>
		<comment id='3' author='rushikesh79' date='2020-02-10T13:03:11Z'>
		This is not related to pandas-profiling...
&lt;denchmark-link:https://stackoverflow.com/questions/14694408/runtimeerror-main-thread-is-not-in-main-loop&gt;https://stackoverflow.com/questions/14694408/runtimeerror-main-thread-is-not-in-main-loop&lt;/denchmark-link&gt;

		</comment>
		<comment id='4' author='rushikesh79' date='2020-02-15T11:17:20Z'>
		Hi &lt;denchmark-link:https://github.com/sbrugman&gt;@sbrugman&lt;/denchmark-link&gt;

I was having the same problem when calling  from a secondary Thread.
I solved it by changing the matplotlib backend to .
Here’s how it looks on my code:
class PandasProfilingThread(QtCore.QThread):
    def __init__(self, parent, df):
        super().__init__()
        self.parent = parent
        self.df = df
        self.error = None

    def run(self):
		# Without these lines the same error occurs, adding them solves the issue
        import matplotlib
        matplotlib.use('Agg')
		# ----------------------------------------------------------------------
        try:
            # Generates
            self.profile = ProfileReport(self.df, title='Summary Report', html={'style': {'full_width': True}})
            # Saves html to temporary folder
            self.profile.to_file(os.path.join(self.parent.temp_dir, self.parent.name + '.html'), silent=True)
            self.error = None
        except Exception as error:
            self.error = error
You’re right that’s not strictly speaking a pandasprofiling error… but still an issue that will recur if people start using it outside the main threads, e.g. just to generate the html files and render them independently thereafter, like &lt;denchmark-link:https://github.com/rushikesh79&gt;@rushikesh79&lt;/denchmark-link&gt;
 and I are doing.
Perhaps it could be controlled by pandas profiling, setting the matplotlib backend with and optional arg or something?
		</comment>
		<comment id='5' author='rushikesh79' date='2020-03-10T11:25:33Z'>
		Same problem, If you guys help us, thanks a ton.

Flask APP has-&gt;GET API like user/profile/filename
Then try to profile
`import numpy as np
import pandas as pd
from pandas_profiling import ProfileReport

df = pd.DataFrame(
np.random.rand(100, 5),
columns=['a', 'b', 'c', 'd', 'e']
)
profile = ProfileReport(df,progress_bar=False, title='Pandas Profiling Report', html={'style':{'full_width':True}})
profile.to_file(output_file="your_report.html")
`
It got stuck there. Is there any way to achieve that? Please advice. Thanks!
It stuck
		</comment>
		<comment id='6' author='rushikesh79' date='2020-03-24T05:41:10Z'>
		Hi &lt;denchmark-link:https://github.com/vijayakumarmariyappan&gt;@vijayakumarmariyappan&lt;/denchmark-link&gt;

I solve this error by doing this,
Import this three lines at top of your code

Thanks,
		</comment>
		<comment id='7' author='rushikesh79' date='2020-03-24T06:32:13Z'>
		&lt;denchmark-link:https://github.com/rushikesh79&gt;@rushikesh79&lt;/denchmark-link&gt;

Thank you for your help! I will check and update you :)
		</comment>
		<comment id='8' author='rushikesh79' date='2020-05-09T16:33:23Z'>
		
Hi @vijayakumarmariyappan
I solve this error by doing this,
Import this three lines at top of your code
import matplotlib matplotlib.use('Agg') import matplotlib.pyplot as plt
Thanks,

Thank you! I faced the same issue, but adding those three lines worked for me!
		</comment>
		<comment id='9' author='rushikesh79' date='2020-05-15T19:30:26Z'>
		
Hi @sbrugman
I was having the same problem when calling ProfileReport from a secondary Thread.
I solved it by changing the matplotlib backend to Agg.

I had the same issue and your suggestion saved my day. Thank you very much!
		</comment>
		<comment id='10' author='rushikesh79' date='2020-07-15T00:02:22Z'>
		Stale issue
		</comment>
	</comments>
</bug>