<bug id='715' author='tvst' open_date='2019-11-20T10:21:41Z' closed_time='2019-12-04T20:15:28Z'>
	<summary>Streamlit __installation_id__ is not guaranteed unique in Docker</summary>
	<description>
&lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;

Streamlit creates an "installation ID" used for anonymous logging. This is supposed to be unique for each machine, since it's calculated from a hash of the MAC of the primary network interface (uuid.getnode()). However, when in Docker that MAC is very often the same for every user, which means we get the same installation ID!
&lt;denchmark-h:h1&gt;Steps to reproduce&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;$ docker run -it ubuntu:19.10
$ apt update &amp;&amp; apt install python3 python3-pip &amp;&amp; pip3 install streamlit
$ python3
&gt;&gt;&gt; import streamlit as st
&gt;&gt;&gt; st.__installation_id__
&lt;/denchmark-code&gt;

&lt;denchmark-h:h2&gt;Expected behavior:&lt;/denchmark-h&gt;

You should see some unique number.
&lt;denchmark-h:h2&gt;Actual behavior:&lt;/denchmark-h&gt;

You'll see 43bd5192-96a1-5e7d-a429-dd34cc685181
&lt;denchmark-h:h2&gt;Is this a regression?&lt;/denchmark-h&gt;

No.
&lt;denchmark-h:h1&gt;Debug info&lt;/denchmark-h&gt;


Streamlit version: any
Python version: any

&lt;denchmark-h:h1&gt;Possible solution&lt;/denchmark-h&gt;

Instead of getnode(), on Linux we should use /etc/machine-id or /var/lib/dbus/machine-id (whichever exists). To improve the chances that one of them exist, first call dbus-uuidgen --ensure. If that fails, just use getnode() as a fallback.
On non-Linux OSes this is less important, but if you want to go the extra mile try doing the same as this Node module that gets machine IDs in all Linux, BSD, Mac, Windows: &lt;denchmark-link:https://github.com/automation-stack/node-machine-id/blob/master/index.js&gt;https://github.com/automation-stack/node-machine-id/blob/master/index.js&lt;/denchmark-link&gt;

Also, while we're at it, why not make the ID robust to multiple-user environments by including the current user name or userid in the hash? For example: getpass.getuser()
	</description>
	<comments>
	</comments>
</bug>