<bug id='217' author='treuille' open_date='2019-09-30T23:13:23Z' closed_time='2019-09-30T23:55:00Z'>
	<summary>`st.line_chart` no longer works in Ubuntu</summary>
	<description>
&lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;

Type here a clear and concise description of the bug. Aim for 2-3 sentences.
&lt;denchmark-h:h2&gt;Steps to reproduce&lt;/denchmark-h&gt;

Run this code in Ubuntu and Mac:
import streamlit as st
import numpy as np

st.line_chart(np.random.randn(200, 1))
&lt;denchmark-h:h1&gt;Behavior&lt;/denchmark-h&gt;

&lt;denchmark-h:h2&gt;Actual Behavior (Mac)&lt;/denchmark-h&gt;

The code works properly on mac:
&lt;denchmark-link:https://user-images.githubusercontent.com/1673013/65923258-26b0c380-e39d-11e9-93d0-458b8175d7f4.png&gt;&lt;/denchmark-link&gt;

&lt;denchmark-h:h3&gt;Mac System Info&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;$ streamlit version &amp;&amp; python --version &amp;&amp; pyenv --version &amp;&amp; sw_vers &amp;&amp; "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome" --version
Streamlit, version 0.47.0
Python 2.7.10
pyenv 1.2.3
ProductName:	Mac OS X
ProductVersion:	10.14.6
BuildVersion:	18G95
Google Chrome 77.0.3865.90 
&lt;/denchmark-code&gt;

&lt;denchmark-h:h2&gt;Actual behavior (Ubuntu)&lt;/denchmark-h&gt;

Since v0.47 the code is broken on ubuntu.
&lt;denchmark-link:https://user-images.githubusercontent.com/1673013/65923265-2e706800-e39d-11e9-91c2-f5888b43f9f2.png&gt;&lt;/denchmark-link&gt;

The text of the error is as follows:
&lt;denchmark-code&gt;ValueError: index encoding field is specified without a type; the type cannot be automatically inferred because the data is not specified as a pandas.DataFrame.
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/streamlit/ScriptRunner.py", line 306, in _run_script exec(code, module.__dict__)
File "/home/ubuntu/insight/demo1/src/tl_gan/line_chart.py", line 4, in &lt;module&gt; st.line_chart(np.random.randn(200, 1))
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/streamlit/__init__.py", line 126, in wrapped_method return method(dg, *args, **kwargs)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 122, in wrapped_method marshall_element, delta_type, last_index)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 317, in _enqueue_new_element_delta rv = marshall_element(msg.delta.new_element)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 119, in marshall_element return method(dg, element, *args, **kwargs)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/streamlit/DeltaGenerator.py", line 825, in line_chart altair.marshall(element.vega_lite_chart, chart, width, height=height)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/streamlit/elements/altair.py", line 73, in marshall chart_dict = altair_chart.to_dict()
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/vegalite/v3/api.py", line 369, in to_dict dct = super(TopLevelMixin, copy).to_dict(*args, **kwargs)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/utils/schemapi.py", line 285, in to_dict validate=sub_validate, context=context)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/utils/schemapi.py", line 50, in _todict return {k: _todict(v, validate, context) for k, v in obj.items()
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/utils/schemapi.py", line 51, in &lt;dictcomp&gt; if v is not Undefined}
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/utils/schemapi.py", line 46, in _todict return obj.to_dict(validate=validate, context=context)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/utils/schemapi.py", line 285, in to_dict validate=sub_validate, context=context)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/utils/schemapi.py", line 50, in _todict return {k: _todict(v, validate, context) for k, v in obj.items()
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/utils/schemapi.py", line 51, in &lt;dictcomp&gt; if v is not Undefined}
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/utils/schemapi.py", line 46, in _todict return obj.to_dict(validate=validate, context=context)
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/vegalite/v3/schema/channels.py", line 28, in to_dict for shorthand in self.shorthand]
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/vegalite/v3/schema/channels.py", line 28, in &lt;listcomp&gt; for shorthand in self.shorthand]
File "/home/ubuntu/anaconda3/envs/insight/lib/python3.7/site-packages/altair/vegalite/v3/schema/channels.py", line 48, in to_dict "".format(self.shorthand))
&lt;/denchmark-code&gt;

&lt;denchmark-h:h3&gt;Ubuntu System Info&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;$ streamlit version &amp;&amp; python --version &amp;&amp; conda --version &amp;&amp; lsb_release -a
Streamlit, version 0.47.0
Python 3.7.3
conda 4.6.11
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 18.04.2 LTS
Release:        18.04
Codename:       bionic
&lt;/denchmark-code&gt;

&lt;denchmark-h:h2&gt;Expected behavior&lt;/denchmark-h&gt;

The behavior on mac is correct. The behavior on Ubuntu is incorrect.
&lt;denchmark-h:h2&gt;Is this a regression?&lt;/denchmark-h&gt;

YES, this worked in 0.46.
	</description>
	<comments>
		<comment id='1' author='treuille' date='2019-09-30T23:28:46Z'>
		&lt;denchmark-link:https://github.com/tvst&gt;@tvst&lt;/denchmark-link&gt;
 figured this out. The problem is .
We should require altair&gt;=3.2.0.
		</comment>
		<comment id='2' author='treuille' date='2019-09-30T23:55:00Z'>
		This will be fixed in 0.47.1 tonight
		</comment>
	</comments>
</bug>