<bug id='691' author='treuille' open_date='2019-11-14T22:48:31Z' closed_time='2019-12-04T20:15:09Z'>
	<summary>st.bar_chart should work with indices with names besides "index"</summary>
	<description>
&lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;

Right now, it seems that st.bar_chart requires the index column to be called "index". We should allow arbitrarily named indices.
Note: We should make sure that this fix also applies to Streamlit's other built-in charting functions, line_chart, area_chart, ... anything else?
&lt;denchmark-h:h2&gt;Steps to reproduce&lt;/denchmark-h&gt;

&lt;denchmark-h:h3&gt;Example 1&lt;/denchmark-h&gt;

This works:
import streamlit as st
import pandas as pd

data = pd.DataFrame({
    'index': ['Cincinnati', 'San Francisco', 'Pittsburgh'],
    'sports_teams': [6, 8, 9],
}).set_index('index')

st.write(data)
st.bar_chart(data)
&lt;denchmark-link:https://user-images.githubusercontent.com/1673013/68902656-c2985380-06ed-11ea-87fa-cff1417399b2.png&gt;&lt;/denchmark-link&gt;

&lt;denchmark-h:h3&gt;Example 2&lt;/denchmark-h&gt;

But this doesn't work:
import streamlit as st
import pandas as pd

data = pd.DataFrame({
    'city': ['Cincinnati', 'San Francisco', 'Pittsburgh'],
    'sports_teams': [6, 8, 9],
}).set_index('city')

st.write(data)
st.bar_chart(data)
&lt;denchmark-link:https://user-images.githubusercontent.com/1673013/68902666-c75d0780-06ed-11ea-9860-ebe0c80bd0de.png&gt;&lt;/denchmark-link&gt;

(The full stack trace is reproduced below.)
&lt;denchmark-h:h1&gt;Behavior&lt;/denchmark-h&gt;

&lt;denchmark-h:h2&gt;Actual behavior&lt;/denchmark-h&gt;

Example 2 doesn't work, even though the only difference with Example 1 is substituting "city" for "index."
&lt;denchmark-h:h2&gt;Expected behavior&lt;/denchmark-h&gt;

Both examples should behave identically.
&lt;denchmark-h:h2&gt;Is this a regression?&lt;/denchmark-h&gt;

Unknwn
&lt;denchmark-h:h1&gt;Debug info&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;$ streamlit version &amp;&amp; python --version &amp;&amp; pyenv --version &amp;&amp; sw_vers &amp;&amp; "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome" --version

Streamlit, version 0.50.2
Python 3.6.3
pyenv 1.2.3
ProductName:	Mac OS X
ProductVersion:	10.15.1
BuildVersion:	19B88
Google Chrome 78.0.3904.97 

&lt;/denchmark-code&gt;

&lt;denchmark-h:h1&gt;Additional information&lt;/denchmark-h&gt;

Here is the full stack tracke for Example 2:
&lt;denchmark-code&gt;KeyError: 'index'
Traceback:
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/streamlit/ScriptRunner.py", line 311, in _run_script
    exec(code, module.__dict__)
  File "/Users/adrien/Desktop/answers/bar.py", line 10, in &lt;module&gt;
    st.bar_chart(data)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/streamlit/__init__.py", line 127, in wrapped_method
    return method(dg, *args, **kwargs)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/streamlit/DeltaGenerator.py", line 123, in wrapped_method
    return dg._enqueue_new_element_delta(marshall_element, delta_type, last_index)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/streamlit/DeltaGenerator.py", line 381, in _enqueue_new_element_delta
    rv = marshall_element(msg.delta.new_element)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/streamlit/DeltaGenerator.py", line 121, in marshall_element
    return method(dg, element, *args, **kwargs)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/streamlit/DeltaGenerator.py", line 999, in bar_chart
    chart = altair.generate_chart("bar", data)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/streamlit/elements/altair.py", line 38, in generate_chart
    data = pd.melt(data.reset_index(), id_vars=["index"])
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/pandas/core/reshape/melt.py", line 75, in melt
    id_data = frame.pop(col)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/pandas/core/generic.py", line 759, in pop
    result = self[item]
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/pandas/core/frame.py", line 2688, in __getitem__
    return self._getitem_column(key)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/pandas/core/frame.py", line 2695, in _getitem_column
    return self._get_item_cache(key)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/pandas/core/generic.py", line 2486, in _get_item_cache
    values = self._data.get(item)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/pandas/core/internals.py", line 4115, in get
    loc = self.items.get_loc(item)
  File "/Users/adrien/.pyenv/versions/3.6.3/envs/streamlit-staging/lib/python3.6/site-packages/pandas/core/indexes/base.py", line 3066, in get_loc
    return self._engine.get_loc(self._maybe_cast_indexer(key))
  File "pandas/_libs/index.pyx", line 140, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 162, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1492, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1500, in pandas._libs.hashtable.PyObjectHashTable.get_item
&lt;/denchmark-code&gt;

	</description>
	<comments>
		<comment id='1' author='treuille' date='2019-11-18T21:09:07Z'>
		PR: &lt;denchmark-link:https://github.com/streamlit/streamlit/pull/706&gt;#706&lt;/denchmark-link&gt;

		</comment>
	</comments>
</bug>