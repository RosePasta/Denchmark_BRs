<bug id='1472' author='nassmim' open_date='2020-05-18T18:52:00Z' closed_time='2020-05-19T16:08:54Z'>
	<summary>module xlwings import fails</summary>
	<description>
&lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;

When I streamlit run my .py script, I get an error message in the browser window : ' Couldn't find a license key.' This concerns the module 'xlwings'.
At first the module was not found but then I installed streamlit and xlwings in the correct virtual env. But now the issue concerns the licence key for the pro usage that offers xlwings.  However, I do not have any issue when using my script without streamlit.
&lt;denchmark-h:h1&gt;Steps to reproduce&lt;/denchmark-h&gt;


install xlwings in anaconda
activate the venv where xlwings has been installed and install streamlit via pip
streamlit run the .py script

&lt;denchmark-h:h2&gt;Expected behavior:&lt;/denchmark-h&gt;

To display the web page with the created title and markdown without any errors
&lt;denchmark-h:h2&gt;Actual behavior:&lt;/denchmark-h&gt;

The web page opens with the error message and nothing else:
SystemExit: Couldn't find a license key.
Traceback:
File "c:\users\nezzakraoui\appdata\local\continuum\anaconda3\envs\insurance_work\lib\site-packages\streamlit\ScriptRunner.py", line 322, in run_script
exec(code, module.dict)
File "C:\Users\nezzakraoui\La Parisienne Assurances\LPA PÃ´le Produits - Documents\01. Presales\2020\QOVER REVOLUT\Pricing\automate_pricing.py", line 2, in 
import xlwings
File "c:\users\nezzakraoui\appdata\local\continuum\anaconda3\envs\insurance_work\lib\site-packages\xlwings_init.py", line 30, in 
from . import pro
File "c:\users\nezzakraoui\appdata\local\continuum\anaconda3\envs\insurance_work\lib\site-packages\xlwings\pro_init_.py", line 9, in 
from .embedded_code import runpython_embedded_code
File "c:\users\nezzakraoui\appdata\local\continuum\anaconda3\envs\insurance_work\lib\site-packages\xlwings\pro\embedded_code.py", line 11, in 
LicenseHandler.validate_license('pro')
File "c:\users\nezzakraoui\appdata\local\continuum\anaconda3\envs\insurance_work\lib\site-packages\xlwings\pro\utils.py", line 43, in validate_license
key = LicenseHandler.get_license()
File "c:\users\nezzakraoui\appdata\local\continuum\anaconda3\envs\insurance_work\lib\site-packages\xlwings\pro\utils.py", line 25, in get_license
sys.exit("Couldn't find a license key.")
&lt;denchmark-h:h1&gt;Debug info&lt;/denchmark-h&gt;


Streamlit version: 0.59.0
Python version: 3.7.6
Browser version: 81.0.4044.138

	</description>
	<comments>
		<comment id='1' author='nassmim' date='2020-05-19T13:43:18Z'>
		Hi @nassmim10 -
Unfortunately, problems like these are hard to debug, since we don't have an xlwings license to test with. If I had to guess, I suspect this is a PATH issue of some sort. Unfortunately, not sure I can suggest more about what to do about it.
Best,
Randy
		</comment>
		<comment id='2' author='nassmim' date='2020-05-19T14:11:33Z'>
		Hi @nassmim10 , looking at the xlwings code.. maybe you can verify that the path to the config_file is being created correctly for your environment.
&lt;denchmark-code&gt;class LicenseHandler:
    @staticmethod
    def get_license():
        if os.getenv('XLWINGS_LICENSE_KEY'):
            return os.environ['XLWINGS_LICENSE_KEY']
        if sys.platform.startswith('darwin'):
            config_file = os.path.join(os.path.expanduser("~"), 'Library', 'Containers',
                                       'com.microsoft.Excel', 'Data', 'xlwings.conf')
        else:
            config_file = os.path.join(os.path.expanduser("~"), '.xlwings', 'xlwings.conf')
        if not os.path.exists(config_file):
            sys.exit("Couldn't find a license key.")
&lt;/denchmark-code&gt;

		</comment>
		<comment id='3' author='nassmim' date='2020-05-19T16:08:49Z'>
		Hi,
Thanks for your answers.
I actually reran all commands from scratch, checking I was in the same env etc. and it works!
Thanks again,
		</comment>
	</comments>
</bug>