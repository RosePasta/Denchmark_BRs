<bug id='253' author='MashtiPepe' open_date='2019-10-03T17:18:18Z' closed_time='2020-06-16T13:29:24Z'>
	<summary>line_chart crashes on update</summary>
	<description>
&lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;

I am adding new data to a numpy array and removing the oldest element.  I then call line_chart() to display the new data in an infinite loop.  The program crashes sometimes soon and sometimes after running for a while.
&lt;denchmark-h:h1&gt;Steps to reproduce&lt;/denchmark-h&gt;

import streamlit as st
import numpy as np
import pandas
import time
import random
st.title('first app');
holder = st.empty()
data = np.zeros(shape=(1, 12*24))
new_data = np.zeros(shape=(1,1))
while True:
new_data[0,0] = random.random()
data = np.append(data, new_data)[1:]
holder.line_chart(data)
time.sleep(0.1)
&lt;denchmark-h:h2&gt;Expected behavior:&lt;/denchmark-h&gt;

Works fine for a bit and then crashes.  Sometimes it crashes sooner and sometimes it crashes later.
&lt;denchmark-h:h2&gt;Actual behavior:&lt;/denchmark-h&gt;

Crashes as seen in the attached image.
&lt;denchmark-h:h2&gt;Is this a regression?&lt;/denchmark-h&gt;

no
&lt;denchmark-h:h1&gt;Debug info&lt;/denchmark-h&gt;



Streamlit version: 0.47.2


Python version: 3.7.3


Using installed streamlit using pip3


OS version:  Raspbian 10



Browser version:


&lt;denchmark-h:h1&gt;Additional information&lt;/denchmark-h&gt;

If needed, add any other context about the problem here.
	</description>
	<comments>
		<comment id='1' author='MashtiPepe' date='2019-10-05T21:00:27Z'>
		Thanks for the bug report &lt;denchmark-link:https://github.com/MashtiPepe&gt;@MashtiPepe&lt;/denchmark-link&gt;
 !
I can't reproduce the bug locally, but at a first glance this looks like a bug in our VegaLite component. We'll look into this ASAP.
		</comment>
		<comment id='2' author='MashtiPepe' date='2019-10-16T18:51:20Z'>
		Hey &lt;denchmark-link:https://github.com/MashtiPepe&gt;@MashtiPepe&lt;/denchmark-link&gt;
 -
I've been trying to repro this and I'm also unable to. I've got Streamlit set up on my own Raspberry Pi, to more closely mimic your setup, and have been running your script for about 40 minutes now, but no problems so far.
I'm running on the latest version of Streamlit (0.48.1) - but I also tried the script with Streamlit 0.47.2, and couldn't repro it there. So it may be a tricky Heisenbug.
(The one major difference between my setup and yours is that it looks like you're using Chromium on your Raspberry Pi, whereas I'm connecting to the running script via Chrome, on my Mac.)
It does look like our Vega-Lite dependencies are out of date, so I'm going to update those for the next Streamlit release, in the hopes that that'll fix what you're seeing.
		</comment>
		<comment id='3' author='MashtiPepe' date='2019-10-16T21:18:39Z'>
		&lt;denchmark-link:https://github.com/tvst&gt;@tvst&lt;/denchmark-link&gt;
 suggested that perhaps something is up with the dataset name generation here:



streamlit/lib/streamlit/elements/altair.py


         Line 72
      in
      8b2481b






 datasets[id(data)] = data 





		</comment>
		<comment id='4' author='MashtiPepe' date='2020-04-05T17:48:10Z'>
		&lt;denchmark-link:https://github.com/MashtiPepe&gt;@MashtiPepe&lt;/denchmark-link&gt;
 are you still seeing this with the latest version of streamlit?
		</comment>
	</comments>
</bug>