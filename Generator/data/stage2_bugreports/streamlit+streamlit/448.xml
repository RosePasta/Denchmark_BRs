<bug id='448' author='CooperData' open_date='2019-10-17T13:33:04Z' closed_time='2019-12-06T01:29:48Z'>
	<summary>Hashing connections to DB failed</summary>
	<description>
&lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;

I am caching loading some data. It uses a sqlalchemy engine and pandas. The engine connection is defined outside of the functions to load the data. This gives error when loading the data. If I move the engine connection inside the function, it would work fine.
My apologies if this is duplicate to &lt;denchmark-link:https://github.com/streamlit/streamlit/issues/242&gt;#242&lt;/denchmark-link&gt;

&lt;denchmark-h:h1&gt;Steps to reproduce&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;engine = connections.get_snowflake_engine()
@st.cache
def get_drs():
    sql =   """
            select *
            from table
            limit 10
            """
    data = pd.read_sql(sql, engine)
    return data
&lt;/denchmark-code&gt;

&lt;denchmark-h:h2&gt;Expected behavior:&lt;/denchmark-h&gt;

I expect the function to work fine while using a connection defined outside the context of the function. However, I get the error:

Streamlit cannot hash an object of type &lt;class 'snowflake.connector.connection.SnowflakeConnection'&gt;.,

&lt;denchmark-h:h2&gt;Actual behavior:&lt;/denchmark-h&gt;

&lt;denchmark-link:https://user-images.githubusercontent.com/1518908/67013324-e6ea1b80-f0c0-11e9-9fb1-661b63b4a1c8.png&gt;&lt;/denchmark-link&gt;

&lt;denchmark-h:h2&gt;Is this a regression?&lt;/denchmark-h&gt;

no
&lt;denchmark-h:h1&gt;Debug info&lt;/denchmark-h&gt;


Streamlit version: 0.48.1
Python version: 3.7.4
Using Conda
OS version: MacOS Mojave 10.14.6
Browser version: Chrome

	</description>
	<comments>
		<comment id='1' author='CooperData' date='2019-11-13T20:35:22Z'>
		Hi &lt;denchmark-link:https://github.com/CooperData&gt;@CooperData&lt;/denchmark-link&gt;
,
Streamlit's caching mechanism does some interesting things under the hood, such as hashing the contents of the function itself, to determine if there have been any changes made to it.
We're working on improving the caching docs to provide a better understanding of what's happening and also making a number of improvements to caching itself.
For your case, &lt;denchmark-link:https://github.com/streamlit/streamlit/issues/551&gt;issue 551&lt;/denchmark-link&gt;
 looks like a good solution and should land on develop relatively soon.
We'll leave a comment here when it does!
		</comment>
		<comment id='2' author='CooperData' date='2019-11-14T03:02:14Z'>
		Thanks &lt;denchmark-link:https://github.com/jrhone&gt;@jrhone&lt;/denchmark-link&gt;
 - I just subscribe to the other issue to receive notifications as well... awesome product!
		</comment>
		<comment id='3' author='CooperData' date='2019-12-06T01:29:48Z'>
		Closing this one as a duplicate. Feel free to reopen if you think this is not correct.
		</comment>
	</comments>
</bug>