<bug id='130' author='tvst' open_date='2019-09-18T06:06:01Z' closed_time='2019-09-18T07:04:40Z'>
	<summary>st.cache hashing fails when script is run from certain folders</summary>
	<description>
I don't have the user's actual script, but here is what he's seeing:
&lt;denchmark-h:h2&gt;When cwd is ~&lt;/denchmark-h&gt;


cd ~
streamlit run ~/foo.py
What happens: Streamlit crashes with the error below.

&lt;denchmark-h:h2&gt;When cwd is /home&lt;/denchmark-h&gt;


cd /home
streamlit run ~/foo.py
What happens: Same error.

&lt;denchmark-h:h2&gt;When cwd is ~/anaconda3&lt;/denchmark-h&gt;


cd ~/anaconda3
streamlit run ~/foo.py
What happens: No error!

&lt;denchmark-h:h2&gt;When cwd is ~/anaconda3/envs&lt;/denchmark-h&gt;


cd ~/anaconda3/envs
streamlit run ~/foo.py
What happens: No error!

&lt;denchmark-h:h2&gt;The actual error&lt;/denchmark-h&gt;

&lt;denchmark-code&gt;KeyError: 'start'
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/ScriptRunner.py", line 317, in _run_script exec(code, module.__dict__)
File "/home/theuser/abc.py", line 20, in &lt;module&gt; data = load_data(10000)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/caching.py", line 393, in wrapped_func code_hasher.update(func)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 159, in update self._update(self.hasher, obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 259, in _to_bytes h.update(self._code_to_bytes(obj.__code__, context))
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 316, in _code_to_bytes self._update(h, ref, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 259, in _to_bytes h.update(self._code_to_bytes(obj.__code__, context))
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 316, in _code_to_bytes self._update(h, ref, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 259, in _to_bytes h.update(self._code_to_bytes(obj.__code__, context))
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 316, in _code_to_bytes self._update(h, ref, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 259, in _to_bytes h.update(self._code_to_bytes(obj.__code__, context))
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 316, in _code_to_bytes self._update(h, ref, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 259, in _to_bytes h.update(self._code_to_bytes(obj.__code__, context))
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 316, in _code_to_bytes self._update(h, ref, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 259, in _to_bytes h.update(self._code_to_bytes(obj.__code__, context))
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 316, in _code_to_bytes self._update(h, ref, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 259, in _to_bytes h.update(self._code_to_bytes(obj.__code__, context))
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 311, in _code_to_bytes self._update(h, consts, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 215, in _to_bytes self._update(h, e, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 266, in _to_bytes return self._code_to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 311, in _code_to_bytes self._update(h, consts, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 215, in _to_bytes self._update(h, e, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 190, in _update b = self.to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 179, in to_bytes b = self._to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 266, in _to_bytes return self._code_to_bytes(obj, context)
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing.py", line 315, in _code_to_bytes for ref in get_referenced_objects(code, context):
File "/home/theuser/anaconda3/envs/datascience-v1.2/lib/python3.7/site-packages/streamlit/hashing_py3.py", line 49, in get_referenced_objects set_tos(context.cells[op.argval])
&lt;/denchmark-code&gt;

	</description>
	<comments>
		<comment id='1' author='tvst' date='2019-09-18T06:11:38Z'>
		Looks like an instance of &lt;denchmark-link:https://github.com/streamlit/streamlit/issues/62&gt;#62&lt;/denchmark-link&gt;

		</comment>
	</comments>
</bug>