<bug id='1453' author='NMC-DAVE' open_date='2020-05-15T06:43:29Z' closed_time='2020-05-19T00:54:07Z'>
	<summary>Streamlit exit with error!</summary>
	<description>
Hi:
I want to cache the xarray object. But when I exit streamlit app with 'Ctrl + C' commandï¼Œthe fellowing errors show. So How can I cache the xarray object, thanks very much.
The code:
import xarray as xr
import streamlit as st

def  main():
    # application title
    st.title("Map analysis")

    # load data
    @st.cache(hash_funcs={xr.core.dataset.Dataset: id}, allow_output_mutation=True)
    def load_data():
        filepath = 'http://thredds.atmos.albany.edu:8080/thredds/dodsC/CFSR/2020/pwat.2020.0p5.anl.nc'
        data = xr.open_dataset(filepath)
        return data
    data = load_data()

if __name__ == "__main__":
    main()
The error:
  You can now view your Streamlit app in your browser.

  Network URL: 
  External URL: 

^C  Stopping...
Exception ignored in: &lt;function CachingFileManager.__del__ at 0x7f53c01493b0&gt;
Traceback (most recent call last):
  File "/home/kan-dai/miniconda3/envs/MET/lib/python3.7/site-packages/xarray/backends/file_manager.py", line 243, in __del__
  File "/home/kan-dai/miniconda3/envs/MET/lib/python3.7/site-packages/xarray/backends/file_manager.py", line 217, in close
  File "/home/kan-dai/miniconda3/envs/MET/lib/python3.7/contextlib.py", line 239, in helper
TypeError: 'NoneType' object is not callable
	</description>
	<comments>
		<comment id='1' author='NMC-DAVE' date='2020-05-17T07:00:18Z'>
		Hi, problem was solved. I should close the data connection. like:
import xarray as xr
import streamlit as st

def  main():
    # application title
    st.title("Map analysis")

    # load data
    @st.cache(hash_funcs={xr.core.dataset.Dataset: id}, allow_output_mutation=True)
    def load_data():
        filepath = 'http://thredds.atmos.albany.edu:8080/thredds/dodsC/CFSR/2020/pwat.2020.0p5.anl.nc'
        data = xr.open_dataset(filepath)
        return data
    data = load_data()
    data.close()

if __name__ == "__main__":
    main()
		</comment>
		<comment id='2' author='NMC-DAVE' date='2020-05-17T15:16:25Z'>
		Nice &lt;denchmark-link:https://github.com/NMC-DAVE&gt;@NMC-DAVE&lt;/denchmark-link&gt;
 :) glad to see you worked this out.
If this is solved, could you close the issue ? Thanks !
		</comment>
	</comments>
</bug>