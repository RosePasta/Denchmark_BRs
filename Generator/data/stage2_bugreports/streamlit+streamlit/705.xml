<bug id='705' author='astraldawn' open_date='2019-11-18T03:41:23Z' closed_time='2019-11-18T06:08:57Z'>
	<summary>Streamlit 0.49+ crashes in Docker</summary>
	<description>
&lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;

Streamlit is crashing in Docker
&lt;denchmark-h:h1&gt;Steps to reproduce&lt;/denchmark-h&gt;


Install streamlit in Docker (within a virtualenv).
Attempt to run streamlit hello

&lt;denchmark-h:h2&gt;Expected behavior:&lt;/denchmark-h&gt;

The sample app should run.
&lt;denchmark-h:h2&gt;Actual behavior:&lt;/denchmark-h&gt;

Streamlit crashes with the following trace
&lt;denchmark-code&gt;Did not auto detect external IP.
Please go to https://streamlit.io/docs/ for debugging hints.

Please report this bug at https://github.com/streamlit/streamlit/issues.

EXCEPTION! 'NoneType' object has no attribute 'strip'
  File "/home/user/venv/bin/streamlit", line 8, in &lt;module&gt;
    sys.exit(main())
  File "/home/user/venv/lib/python3.7/site-packages/click/core.py", line 764, in __call__
    return self.main(*args, **kwargs)
  File "/home/user/venv/lib/python3.7/site-packages/click/core.py", line 717, in main
    rv = self.invoke(ctx)
  File "/home/user/venv/lib/python3.7/site-packages/click/core.py", line 1137, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/user/venv/lib/python3.7/site-packages/click/core.py", line 956, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/user/venv/lib/python3.7/site-packages/click/core.py", line 555, in invoke
    return callback(*args, **kwargs)
  File "/home/user/venv/lib/python3.7/site-packages/streamlit/cli.py", line 226, in main_run
    _main_run(target, args)
  File "/home/user/venv/lib/python3.7/site-packages/streamlit/cli.py", line 251, in _main_run
    bootstrap.run(file, command_line, args)
  File "/home/user/venv/lib/python3.7/site-packages/streamlit/bootstrap.py", line 189, in run
    ioloop.start()
  File "/home/user/venv/lib/python3.7/site-packages/tornado/platform/asyncio.py", line 132, in start
    self.asyncio_loop.run_forever()
  File "/usr/local/lib/python3.7/asyncio/base_events.py", line 534, in run_forever
    self._run_once()
  File "/usr/local/lib/python3.7/asyncio/base_events.py", line 1771, in _run_once
    handle._run()
  File "/usr/local/lib/python3.7/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/home/user/venv/lib/python3.7/site-packages/tornado/ioloop.py", line 758, in _run_callback
    ret = callback()
  File "/home/user/venv/lib/python3.7/site-packages/tornado/stack_context.py", line 300, in null_wrapper
    return fn(*args, **kwargs)
  File "/home/user/venv/lib/python3.7/site-packages/tornado/gen.py", line 326, in wrapper
    yielded = next(result)
  File "/home/user/venv/lib/python3.7/site-packages/streamlit/server/Server.py", line 342, in _loop_coroutine
    traceback.print_stack(file=sys.stdout)

&lt;/denchmark-code&gt;

&lt;denchmark-h:h2&gt;Is this a regression?&lt;/denchmark-h&gt;

Yes, verified that the sample app runs in versions 0.47.3, 0.47.4 and 0.48.0
&lt;denchmark-h:h1&gt;Debug info&lt;/denchmark-h&gt;

Docker images  used: python:3.7.4-slim-buster, python:3.7.5-slim-buster



Streamlit version
Docker version
virtualenv version
OS




0.49.0
18.06.1-ce
16.0.0
Centos 7


0.50.2
18.06.1-ce
16.0.0
Centos 7


0.49.0
18.09.0
16.7.7
Ubuntu 18.04


0.50.2
18.09.0
16.7.7
Ubuntu 18.04



No browser used.
	</description>
	<comments>
		<comment id='1' author='astraldawn' date='2019-11-18T06:08:57Z'>
		Fixed by following config from &lt;denchmark-link:https://github.com/MarcSkovMadsen/awesome-streamlit/blob/master/.streamlit/config.prod.toml&gt;https://github.com/MarcSkovMadsen/awesome-streamlit/blob/master/.streamlit/config.prod.toml&lt;/denchmark-link&gt;

		</comment>
		<comment id='2' author='astraldawn' date='2019-11-21T08:29:35Z'>
		Hi,
what is the option, that prevents this error exactly? Because I am getting the same error message when running streamlit in a virtual network with no internet connection (which I guess is similiar to running it in a container). Is this desired behaviour or a bug?
		</comment>
		<comment id='3' author='astraldawn' date='2019-11-21T08:52:36Z'>
		
Hi,
what is the option, that prevents this error exactly? Because I am getting the same error message when running streamlit in a virtual network with no internet connection (which I guess is similiar to running it in a container). Is this desired behaviour or a bug?

I set serverAddress = "127.0.0.1" instead of localhost, which had the effect of making the service available to localhost without having streamlit searching for an external IP-Address it could not get without internet connection.
Still: Bug or feature?
		</comment>
		<comment id='4' author='astraldawn' date='2020-01-25T16:35:41Z'>
		Hi. I was trying to run streamlit remotely from an ssh session.
Fixed by:

Creating a folder '.streamlit' in the home folder
Placing the contents of config.prod.toml in .streamlit/config.toml
Placing the contents of credentials.prod.toml in .streamlit/credentials.toml
Changing the port from 80 to 8000 in .streamlit/config.toml (Just so I could run the app as a non-root user)
Most importantly, setting headless to false in .streamlit/config.toml and running the following:

&lt;denchmark-code&gt;$ export DISPLAY=:0
$ streamlit hello
&lt;/denchmark-code&gt;

Hope this helps!
		</comment>
	</comments>
</bug>