<bug id='487' author='tvst' open_date='2019-10-21T19:02:16Z' closed_time='2020-02-26T21:37:06Z'>
	<summary>st.cache warnings/errors too numerous and traceback useless</summary>
	<description>
&lt;denchmark-h:h2&gt;Steps to repro&lt;/denchmark-h&gt;

Try this in Python 3
import streamlit as st
import os

def return_unhashable_object():
    return os.environ # This object is not hashable in Python 3

@st.cache
def this_will_fail_with_a_useless_trace():
    return return_unhashable_object()

this_will_fail_with_a_useless_trace()
&lt;denchmark-h:h2&gt;Issue 1: There are too many warnings and errors&lt;/denchmark-h&gt;

What you see today:
&lt;denchmark-link:https://user-images.githubusercontent.com/690814/67234191-8bd66280-f3f9-11e9-99c4-fd4e1156282b.png&gt;&lt;/denchmark-link&gt;

Desired: show only 1 warning instead. It should include the warning text we have today plus a traceback.
&lt;denchmark-h:h2&gt;Issue 2: The current traceback is useless&lt;/denchmark-h&gt;

This is the current traceback:
&lt;denchmark-code&gt;ile "/home/tvst/.local/share/virtualenvs/prod-g-ag5BPd/lib/python3.8/site-packages/streamlit/ScriptRunner.py", line 310, in _run_script exec(code, module.__dict__)
File "/home/tvst/Projects/streamlit/prod/cache_error_message.py", line 11, in &lt;module&gt; this_will_fail_with_a_useless_trace()
File "/home/tvst/.local/share/virtualenvs/prod-g-ag5BPd/lib/python3.8/site-packages/streamlit/caching.py", line 548, in wrapped_func return get_or_set_cache()
File "/home/tvst/.local/share/virtualenvs/prod-g-ag5BPd/lib/python3.8/site-packages/streamlit/caching.py", line 513, in get_or_set_cache code_hasher.update(func)
File "/home/tvst/.local/share/virtualenvs/prod-g-ag5BPd/lib/python3.8/site-packages/streamlit/hashing.py", line 209, in update self._update(self.hasher, obj, context)
File "/home/tvst/.local/share/virtualenvs/prod-g-ag5BPd/lib/python3.8/site-packages/streamlit/hashing.py", line 241, in _update hasher.update(b)
&lt;/denchmark-code&gt;

We'd like the traceback to say something like this instead

Streamlit failed to hash object os.environ of type os._Environ in "/home/tvst/Projects/streamlit/prod/cache_error_message.py", line Y:
   return os.environ # This object is not hashable in Python 3
(... Explanation goes here)
Traceback:
File "/home/tvst/Projects/streamlit/prod/cache_error_message.py", line X, this_will_fail_with_a_useless_trace()
File "/home/tvst/Projects/streamlit/prod/cache_error_message.py", line Y, return_unhashable_object()

&lt;denchmark-code&gt;&lt;/denchmark-code&gt;

	</description>
	<comments>
		<comment id='1' author='tvst' date='2019-10-22T02:04:59Z'>
		It would be very helpfull if it is very, very clear which st.cache annotated function that fail,
i.e. this_will_fail_with_a_useless_trace here.
I always spend time on tracing back which function causes the problem. And if I have many this can take time.
And &lt;denchmark-link:https://github.com/tvst&gt;@tvst&lt;/denchmark-link&gt;
 congrats on having posted open issue number 200 :-)
&lt;denchmark-link:https://user-images.githubusercontent.com/42288570/67255230-4e1d1c80-f481-11e9-8a39-e144c9932d5d.png&gt;&lt;/denchmark-link&gt;

		</comment>
		<comment id='2' author='tvst' date='2019-11-01T15:52:44Z'>
		&lt;denchmark-link:https://docs.python.org/3/library/dis.html#dis.Instruction&gt;https://docs.python.org/3/library/dis.html#dis.Instruction&lt;/denchmark-link&gt;

		</comment>
		<comment id='3' author='tvst' date='2020-01-10T21:55:48Z'>
		&lt;denchmark-link:https://github.com/streamlit/streamlit/issues/768&gt;#768&lt;/denchmark-link&gt;
 supersedes part 1
Delaying part 2 until further notice
		</comment>
		<comment id='4' author='tvst' date='2020-02-26T21:37:06Z'>
		Pretty sure this has now been fixed!
		</comment>
	</comments>
</bug>