<bug id='399' author='Vopaaz' open_date='2019-10-14T02:15:03Z' closed_time='2019-10-17T19:29:36Z'>
	<summary>'gbk' codec can't decode byte</summary>
	<description>
&lt;denchmark-h:h1&gt;Summary&lt;/denchmark-h&gt;

Issue &lt;denchmark-link:https://github.com/streamlit/streamlit/issues/281&gt;#281&lt;/denchmark-link&gt;
 not solved after upgrading.
Getting a similar Script execution error:
&lt;denchmark-code&gt;'gbk' codec can't decode byte 0x94 in position 987: illegal multibyte sequence
&lt;/denchmark-code&gt;

after upgrading to streamlit-0.48.1
&lt;denchmark-h:h1&gt;Steps to reproduce&lt;/denchmark-h&gt;

Run streamlit hello.
&lt;denchmark-h:h2&gt;Expected behavior:&lt;/denchmark-h&gt;

Streamlit hello examples
&lt;denchmark-h:h2&gt;Actual behavior:&lt;/denchmark-h&gt;

Explain the buggy behavior you experience when you go through the steps above.
If applicable, add screenshots to help explain your problem.
&lt;denchmark-h:h2&gt;Is this a regression?&lt;/denchmark-h&gt;

No
&lt;denchmark-h:h1&gt;Debug info&lt;/denchmark-h&gt;


Streamlit version: Streamlit, version 0.48.1
Python version: Python 3.7.2
OS version: Windows 10
Browser version: Google Chrome 77.0.3865.90

	</description>
	<comments>
		<comment id='1' author='Vopaaz' date='2019-10-14T03:05:56Z'>
		same as before with streamlit hello get 'gbk' codec can't decode issue
but Chinese character would not produce this error now in my own script, although it didn't decode in right way
&lt;denchmark-h:h3&gt;Debug info&lt;/denchmark-h&gt;


streamlit version: 0.48.1
python version: 3.6.2
OS: windows10
Browser: Chromium 74.0.3729.169

		</comment>
		<comment id='2' author='Vopaaz' date='2019-10-14T06:00:05Z'>
		Could it possibly be fixed by adding encoding="utf-8" (or other encoding your hello example is using) to the following with open statement?



streamlit/lib/streamlit/ScriptRunner.py


         Line 247
      in
      71f1889






 with open(self._report.script_path) as f: 





On your contributing wiki page, there are no instructions on developing on Windows machine (and I have tried it but failed), so I am not able to test it.
		</comment>
		<comment id='3' author='Vopaaz' date='2019-10-17T05:17:40Z'>
		Hi all
I can reproduce this issue on my Windows VM, but I'm having a hard time finding a solution. Just setting the encoding as proposed by &lt;denchmark-link:https://github.com/Vopaaz&gt;@Vopaaz&lt;/denchmark-link&gt;
 doesn't seem to work.
Even worse, even this simple test fails for me:

Write a file called "chinese_characters.txt" and enter a chinese character there, like 例
On a terminal, navigate to the folder where the file above lives
Type python -m http.server
Go to localhost:8000/chinese_characters.txt on your browser

Expected: you should see 例 in the browser
Actual: you see ä¾‹ in the browser
This test doesn't even use Streamlit. Just pure Python. So I'm at a loss regarding how to solve it...
We'll keep testing over here but if anyone has any other ideas, please let us know!
		</comment>
		<comment id='4' author='Vopaaz' date='2019-10-17T05:20:49Z'>
		Actually, I just realized I didn't test &lt;denchmark-link:https://github.com/Vopaaz&gt;@Vopaaz&lt;/denchmark-link&gt;
's solution correctly.
Trying it out again, it actually works!
So I'll send out a pull request right now.
Thanks &lt;denchmark-link:https://github.com/Vopaaz&gt;@Vopaaz&lt;/denchmark-link&gt;
 !
		</comment>
		<comment id='5' author='Vopaaz' date='2019-10-17T05:36:11Z'>
		&lt;denchmark-link:https://github.com/tvst&gt;@tvst&lt;/denchmark-link&gt;
 You are welcome!
I have already submitted a PR right before you made these comments. Please take a look at the Python 2 issue I mentioned here &lt;denchmark-link:https://github.com/streamlit/streamlit/pull/440#issuecomment-543005498&gt;#440 (comment)&lt;/denchmark-link&gt;
. Please feel free to make any modifications as I am not familiar with Python 2!
		</comment>
		<comment id='6' author='Vopaaz' date='2019-10-17T07:10:41Z'>
		when use st.echo(): include Chinese chars flow this error:
&lt;denchmark-code&gt;UnicodeDecodeError: 'gbk' codec can't decode byte 0xae in position 40: illegal multibyte sequence
File "d:\anaconda3\envs\demo-machine\lib\site-packages\streamlit\ScriptRunner.py", line 312, in _run_script exec(code, module.__dict__)
File "E:\pass\demo\demo-machine-learn\pytorchdemo\demo-3-6-softmax-1.py", line 54, in &lt;module&gt; b.requires_grad_(requires_grad=True)
File "d:\anaconda3\envs\demo-machine\lib\contextlib.py", line 88, in __exit__ next(self.gen)
File "d:\anaconda3\envs\demo-machine\lib\site-packages\streamlit\__init__.py", line 542, in echo source_lines = source_file.readlines()
&lt;/denchmark-code&gt;

flow is the demo.py  content
&lt;denchmark-code&gt;# encoding: utf-8
# -*- coding: utf8 -*-
'''
中文
'''
import streamlit as st
with st.echo():
  num_inputs = 784

&lt;/denchmark-code&gt;

&lt;denchmark-h:h1&gt;Debug info&lt;/denchmark-h&gt;


Streamlit version: Streamlit, version 0.48.1
Python version: Python 3.6.9 :: Anaconda, Inc.
Using Conda
OS version:  Windows 10 (GBK)
Browser version: google chrome 77.0.3865.120

		</comment>
		<comment id='7' author='Vopaaz' date='2019-10-17T07:50:56Z'>
		Thanks for the bug report &lt;denchmark-link:https://github.com/mengyou658&gt;@mengyou658&lt;/denchmark-link&gt;
 , I've added that fix to my PR &lt;denchmark-link:https://github.com/streamlit/streamlit/pull/441&gt;here&lt;/denchmark-link&gt;

		</comment>
	</comments>
</bug>