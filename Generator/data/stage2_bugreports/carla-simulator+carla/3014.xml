<bug id='3014' author='little9999' open_date='2020-07-01T13:54:01Z' closed_time='2020-09-12T20:20:38Z'>
	<summary>Can not synchronize the vehicle light with street light</summary>
	<description>
Hi Calra team,
I'm using the calra 0.9.9 on Ubuntu 18.04.
Today I wanna to control automatically the vehicle light in function of the weather. So I have one server active, and then I run "dynamic_weather.py" to simulate the weather changes. THen I modifed the "spawn_npc.py" to check the street light status, and turn on/off the vehicle light.
Here is the code that I added :
while True:
    # Get the light manager
    light_manager = world.get_lightmanager()
    street_lights = light_manager.get_all_lights(carla.LightGroup.Street)
    light_is_on = light_manager.is_active(street_lights)
    if light_is_on[0]:
        for vehicle_id in vehicles_list:
            world.get_actor(vehicle_id).set_light_state(carla.VehicleLightState.All)
    else:
        for vehicle_id in vehicles_list:
            world.get_actor(vehicle_id).set_light_state(carla.VehicleLightState.NONE)

    if args.sync and synchronous_master:
        world.tick()
    else:
        world.wait_for_tick()
Visually i can observe the street light turns on / off, however the light_manager.is_active(street_lights)) return always the same value, dose not updated.
Please check it.
	</description>
	<comments>
		<comment id='1' author='little9999' date='2020-07-02T01:16:37Z'>
		&lt;denchmark-link:https://github.com/XGodina&gt;@XGodina&lt;/denchmark-link&gt;
 could you please have a look at this?
		</comment>
		<comment id='2' author='little9999' date='2020-07-06T14:46:47Z'>
		Hi &lt;denchmark-link:https://github.com/little9999&gt;@little9999&lt;/denchmark-link&gt;
 sorry but I'm not able to reproduce it, the function  works fine for me and returns what I expect, maybe you are testing on a town where the  is not set to "on" for any reason? Instead of checking the street lights, I recommend you to check for the sun altitude since they don't need to be all "on".
Furthermore, I encourage you to use the
light_manager = world.get_lightmanager()
outside the loop.
		</comment>
		<comment id='3' author='little9999' date='2020-07-06T14:57:45Z'>
		Hi &lt;denchmark-link:https://github.com/little9999&gt;@little9999&lt;/denchmark-link&gt;
,
Perhaps is a problem on the map, which map are you using? If the lights are not tagged properly the group filter will not work.
How many elements are you getting from the call?
		</comment>
		<comment id='4' author='little9999' date='2020-07-07T09:37:54Z'>
		hi &lt;denchmark-link:https://github.com/marcgpuig&gt;@marcgpuig&lt;/denchmark-link&gt;
 &lt;denchmark-link:https://github.com/doterop&gt;@doterop&lt;/denchmark-link&gt;

I've tested with Town01, Town04, Town10HD.
None of them switch the light_manager.is_active(street_lights) status.
I've test with numpy.unique instead of light_is_on[0], all the street lights are off.
And for your proposition of  sun altitude, &lt;denchmark-link:https://github.com/marcgpuig&gt;@marcgpuig&lt;/denchmark-link&gt;
 . It works well.
Thanks for your time.
		</comment>
		<comment id='5' author='little9999' date='2020-09-05T19:51:43Z'>
		This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.
		</comment>
	</comments>
</bug>