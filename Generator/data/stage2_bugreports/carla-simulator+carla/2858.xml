<bug id='2858' author='ocean1211' open_date='2020-05-15T12:15:24Z' closed_time='2020-10-04T13:32:27Z'>
	<summary>Carla 0.9.9 crashes with Segmentation Fault error</summary>
	<description>
I use the Nvidia 1080Ti.
And the Nvidia driver for me 440, OS is 18.04LTS, OpenGL is 4.6
It always raises the error: signal 11 when I spawn the pedestrians.
Here is the detailed report:
4.24.3-0+++UE4+Release-4.24 518 0
Disabling core dumps.
LowLevelFatalError [File:Unknown] [Line: 772]
VulkanRHI::vkCreateBufferView(GetParent()-&gt;GetInstanceHandle(), &amp;ViewInfo, VULKAN_CPU_ALLOCATOR, &amp;View) failed, VkResult=-2
at /home/jenkins/UnrealEngine_4.24/Engine/Source/Runtime/VulkanRHI/Private/VulkanRHI.cpp:1423
with error VK_ERROR_OUT_OF_DEVICE_MEMORY
Signal 11 caught.
Malloc Size=65538 LargeMemoryPoolOffset=65554
CommonUnixCrashHandler: Signal=11
Malloc Size=65535 LargeMemoryPoolOffset=131119
Malloc Size=148816 LargeMemoryPoolOffset=279952
Engine crash handling finished; re-raising signal 11 for the default handler. Good bye.
Segmentation fault (core dumped)
Is there any solution?
	</description>
	<comments>
		<comment id='1' author='ocean1211' date='2020-05-15T12:16:22Z'>
		And actually I have faced the same problem with CARLA 0.9.7 and CARLA0.9.8 with the driver 390 and OpenGL3.1
		</comment>
		<comment id='2' author='ocean1211' date='2020-05-15T12:17:08Z'>
		I use the compiled .tar.gz version of CARLA 0.9.9
		</comment>
		<comment id='3' author='ocean1211' date='2020-05-17T19:51:46Z'>
		I had a similar crash when launching (Carla 0.99 binary installed via apt-get, Ubuntu 18.04). It looks like the GPU does not have enough memory to load all the assets. I have two GPUs on my Ubuntu 18.04, one with 2GB and another with 4GB memory. If I use the 2GB card for the primary display, Carla will crash (and without any meaningful error message). When I switch the 4GB card as the primary display, Carla can start without crashing. Checking with nvidia-smi, Carla uses 2.7 GB of video memory after launch.
		</comment>
		<comment id='4' author='ocean1211' date='2020-05-18T06:52:59Z'>
		
I had a similar crash when launching (Carla 0.99 binary installed via apt-get, Ubuntu 18.04). It looks like the GPU does not have enough memory to load all the assets. I have two GPUs on my Ubuntu 18.04, one with 2GB and another with 4GB memory. If I use the 2GB card for the primary display, Carla will crash (and without any meaningful error message). When I switch the 4GB card as the primary display, Carla can start without crashing. Checking with nvidia-smi, Carla uses 2.7 GB of video memory after launch.

Thanks a lot. But it doesn't work for me...
The memory of my GPU is 11GB and the launching process does not fail.
When I try to spawn pedestrians, it often gets crashed.
Are there any suggestions?
		</comment>
		<comment id='5' author='ocean1211' date='2020-06-17T15:08:46Z'>
		
crash when launching (Carla 0.99 binary installed via apt-get, Ubuntu 18.04). It looks like the GPU does not have enough memory to load all the assets. I have two GPUs on my Ubuntu 18.04, one with 2GB and another with 4GB memory. If I use the 2GB card for the primary display, Carla will crash (and without any meaningful error message). When I switch the 4GB card as the primary display, Carla can start without crashing. Checking with nvidia-smi, Carla uses 2.7 GB of video memor

Hi, &lt;denchmark-link:https://github.com/tianli&gt;@tianli&lt;/denchmark-link&gt;
 . I met the same problem as that issue. How do you specify the GPU id?
		</comment>
		<comment id='6' author='ocean1211' date='2020-06-17T16:29:47Z'>
		I didn't select, I just removed the 2GB card and move the 4GB one to the spot. If you don't want to physically swap the card, maybe you can try this &lt;denchmark-link:https://www.linuxbabe.com/desktop-linux/switch-intel-nvidia-graphics-card-ubuntu&gt;https://www.linuxbabe.com/desktop-linux/switch-intel-nvidia-graphics-card-ubuntu&lt;/denchmark-link&gt;

		</comment>
		<comment id='7' author='ocean1211' date='2020-06-26T06:32:43Z'>
		&lt;denchmark-link:https://github.com/bernatx&gt;@bernatx&lt;/denchmark-link&gt;
 could you help &lt;denchmark-link:https://github.com/ocean1211&gt;@ocean1211&lt;/denchmark-link&gt;
 with this issue?
		</comment>
		<comment id='8' author='ocean1211' date='2020-07-06T10:24:33Z'>
		&lt;denchmark-link:https://github.com/ocean1211&gt;@ocean1211&lt;/denchmark-link&gt;
 can you detail a bit more about how many pedestrians you are trying to spawn, and how many vehicles are in the scene?
Also, if you are using a custom map, did yu rebuild the binary file for pedestrians navigation?
		</comment>
		<comment id='9' author='ocean1211' date='2020-07-06T11:00:57Z'>
		
@ocean1211 can you detail a bit more about how many pedestrians you are trying to spawn, and how many vehicles are in the scene?
Also, if you are using a custom map, did yu rebuild the binary file for pedestrians navigation?

&lt;denchmark-link:https://github.com/bernatx&gt;@bernatx&lt;/denchmark-link&gt;
 I have tried to spawn 10 to 200 pedestrians randomly in every iteration. With the number of iterations increasing, the program will be stopped by this error. The number of vehicles is one.
I have not rebuild the binary file. And I use the compiled version for Linux and Town05.
Thanks a lot!
		</comment>
		<comment id='10' author='ocean1211' date='2020-07-06T14:35:08Z'>
		What do you mean by iterations?
You create and destroy pedestrians in the same script?
Are you sure you are destroying the pedestrians? Because there is an static limiation around 400 pedestrians and vehicles, altogether.
Probably we will resize this limitation in next version.
		</comment>
		<comment id='11' author='ocean1211' date='2020-07-07T14:50:35Z'>
		
What do you mean by iterations?
You create and destroy pedestrians in the same script?
Are you sure you are destroying the pedestrians? Because there is an static limiation around 400 pedestrians and vehicles, altogether.
Probably we will resize this limitation in next version.

Yes, I create and destroy pedestrians in the same script.
The program consists of many iterations.
In every iteration, pedestrians and the vehicle are spawned, and destroyed at the end of the iteration.
Sometimes when I don't spawn pedestrians in the environment, only spawning the vehicle repeatedly also raises the same error.
		</comment>
		<comment id='12' author='ocean1211' date='2020-07-26T16:24:15Z'>
		

What do you mean by iterations?
You create and destroy pedestrians in the same script?
Are you sure you are destroying the pedestrians? Because there is an static limiation around 400 pedestrians and vehicles, altogether.
Probably we will resize this limitation in next version.

Yes, I create and destroy pedestrians in the same script.
The program consists of many iterations.
In every iteration, pedestrians and the vehicle are spawned, and destroyed at the end of the iteration.
Sometimes when I don't spawn pedestrians in the environment, only spawning the vehicle repeatedly also raises the same error.

I think I have a similar problem. The same script works for Town01, but for Town02, I get Segmentation fault (core dumped) error. I use around 18 vehicles and 15 pedestrians for spawning.
		</comment>
		<comment id='13' author='ocean1211' date='2020-09-27T12:51:29Z'>
		This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.
		</comment>
		<comment id='14' author='ocean1211' date='2020-11-06T06:12:37Z'>
		And actually I have faced the same problem with CARLA 0.9.10 and CARLA0.9.9 with the nvidisa driver 450.66
		</comment>
		<comment id='15' author='ocean1211' date='2020-11-14T00:27:23Z'>
		Any solution regarding this? I am facing the same error! version 0.9.10
		</comment>
		<comment id='16' author='ocean1211' date='2020-11-14T02:13:11Z'>
		&lt;denchmark-link:https://github.com/yasser-h-khalil&gt;@yasser-h-khalil&lt;/denchmark-link&gt;

I have work in docker running 0.9.10ï¼Œ refer to &lt;denchmark-link:https://github.com/carla-simulator/carla/issues/3555&gt;#3555&lt;/denchmark-link&gt;

		</comment>
	</comments>
</bug>