<bug id='3052' author='dsche' open_date='2020-07-13T13:10:10Z' closed_time='2020-09-20T03:34:22Z'>
	<summary>Segfault when loading large OpenDRIVE map</summary>
	<description>
I am experiencing a segmentation fault on loading of a large (~38M) OpenDRIVE map via the Python API. The segfault seems to happen somewhere in the string conversion on RPC call, even before the string is being meaningfully parsed, let alone a map constructed:
&lt;denchmark-code&gt;Thread 1 "CarlaUE4-Linux-" received signal SIGSEGV, Segmentation fault.
__memmove_avx_unaligned_erms () at ../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:384
384     ../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S: Datei oder Verzeichnis nicht gefunden.
(gdb) bt
#0  __memmove_avx_unaligned_erms () at ../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:384
#1  0x0000000001e8728a in FGenericPlatformString::Convert&lt;char16_t, char16_t&gt; (Dest=0x7fff658b0000 u"", 
    Src=&lt;optimized out&gt;, BogusChar=63 u'?', DestSize=&lt;optimized out&gt;, SrcSize=&lt;optimized out&gt;)
    at Runtime/Core/Public/GenericPlatform/GenericPlatformString.h:126
#2  FString::FString&lt;char16_t, void&gt; (this=&lt;optimized out&gt;, 
    InSrc=0x7fffc69a0000 u"&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;OpenDRIVE&gt;\n    &lt;header revMajor=\"1\" revMinor=\"4\" name=\"\" version=\"1.00\" date=\"Mon May 25 11:04:31 2020\" north=\"3642.90\" south=\"0.00\" east=\"3629.47\" west=\"0.00\"/"..., InCount=&lt;optimized out&gt;) at Runtime/Core/Public/Containers/UnrealString.h:141
#3  carla::rpc::ToLongFString (str=...)
    at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/carla/rpc/String.h:54
#4  0x0000000001ee4866 in FCarlaServer::FPimpl::BindActions()::$_26::operator()(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters) const (
    this=&lt;optimized out&gt;, opendrive=..., Params=...)
    at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/Source/Carla/Server/CarlaServer.cpp:242
#5  carla::rpc::detail::FunctionWrapper&lt;carla::rpc::Response&lt;void&gt; (*)(std::__1::basic_string&lt;char, std::__1::char_t--Type &lt;RET&gt; for more, q to quit, c to continue without paging--c
raits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters)&gt;::WrapSyncCall&lt;FCarlaServer::FPimpl::BindActions()::$_26&amp;&gt;(boost::asio::io_context&amp;, FCarlaServer::FPimpl::BindActions()::$_26&amp;)::{lambda(carla::rpc::Metadata, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters)#1}::operator()(carla::rpc::Metadata, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters) const::{lambda()#1}::operator()() const (this=&lt;optimized out&gt;) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/carla/rpc/Server.h:106
#6  std::__1::__invoke&lt;carla::rpc::detail::FunctionWrapper&lt;carla::rpc::Response&lt;void&gt; (*)(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters)&gt;::WrapSyncCall&lt;FCarlaServer::FPimpl::BindActions()::$_26&amp;&gt;(boost::asio::io_context&amp;, FCarlaServer::FPimpl::BindActions()::$_26&amp;)::{lambda(carla::rpc::Metadata, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters)#1}::operator()(carla::rpc::Metadata, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters) const::{lambda()#1}&amp;&gt; (__f=...) at ThirdParty/Linux/LibCxx/include/c++/v1/type_traits:4353
#7  std::__1::__packaged_task_func&lt;carla::rpc::detail::FunctionWrapper&lt;carla::rpc::Response&lt;void&gt; (*)(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters)&gt;::WrapSyncCall&lt;FCarlaServer::FPimpl::BindActions()::$_26&amp;&gt;(boost::asio::io_context&amp;, FCarlaServer::FPimpl::BindActions()::$_26&amp;)::{lambda(carla::rpc::Metadata, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters)#1}::operator()(carla::rpc::Metadata, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters) const::{lambda()#1}, std::__1::allocator&lt;{lambda(carla::rpc::Metadata, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, carla::rpc::OpendriveGenerationParameters)#1}&gt;, carla::rpc::Response&lt;void&gt; ()&gt;::operator()() (this=&lt;optimized out&gt;) at ThirdParty/Linux/LibCxx/include/c++/v1/future:1821
#8  0x0000000001ee3772 in std::__1::__packaged_task_function&lt;carla::rpc::Response&lt;void&gt; ()&gt;::operator()() const (this=0x7fffffffda90) at ThirdParty/Linux/LibCxx/include/c++/v1/future:1998
#9  std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt;::operator()() (this=0x7fffffffda90) at ThirdParty/Linux/LibCxx/include/c++/v1/future:2089
#10 0x0000000001ee3668 in boost::asio::asio_handler_invoke&lt;carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt; &gt;(carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt;&amp;, ...) (function=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/handler_invoke_hook.hpp:69
#11 boost_asio_handler_invoke_helpers::invoke&lt;carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt;, carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt; &gt;(carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt;&amp;, carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt;&amp;) (function=..., context=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/detail/handler_invoke_helpers.hpp:37
#12 boost::asio::detail::handler_work&lt;carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt;, boost::asio::system_executor, boost::asio::system_executor&gt;::complete&lt;carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt; &gt;(carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt;&amp;, carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt;&amp;) (this=&lt;optimized out&gt;, function=..., handler=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/detail/handler_work.hpp:100
#13 boost::asio::detail::completion_handler&lt;carla::detail::MoveWrapper&lt;std::__1::packaged_task&lt;carla::rpc::Response&lt;void&gt; ()&gt; &gt; &gt;::do_complete(void*, boost::asio::detail::scheduler_operation*, boost::system::error_code const&amp;, unsigned long) (owner=0x7fffb2c6d100, base=0x7fff47712c40) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/detail/completion_handler.hpp:70
#14 0x0000000001f1d8c0 in boost::asio::detail::scheduler_operation::complete (this=&lt;optimized out&gt;, owner=0x7fffb2c6d100, ec=..., bytes_transferred=&lt;optimized out&gt;) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/detail/scheduler_operation.hpp:40
#15 boost::asio::detail::scheduler::do_wait_one (this=0x7fffb2c6d100, lock=..., this_thread=..., usec=&lt;optimized out&gt;, ec=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/detail/impl/scheduler.ipp:527
#16 0x0000000001f1d2a1 in boost::asio::detail::scheduler::wait_one (this=0x7fffb2c6d100, usec=9999, ec=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/detail/impl/scheduler.ipp:239
#17 0x0000000001f1d10e in boost::asio::io_context::run_one_until&lt;std::__1::chrono::steady_clock, std::__1::chrono::duration&lt;long long, std::__1::ratio&lt;1l, 1000000000l&gt; &gt; &gt; (this=0x7fff42bc36d8, abs_time=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/impl/io_context.hpp:115
#18 0x0000000001e841fb in boost::asio::io_context::run_until&lt;std::__1::chrono::steady_clock, std::__1::chrono::duration&lt;long long, std::__1::ratio&lt;1l, 1000000000l&gt; &gt; &gt; (this=&lt;optimized out&gt;, abs_time=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/impl/io_context.hpp:90
#19 boost::asio::io_context::run_for&lt;long long, std::__1::ratio&lt;1l, 1000l&gt; &gt; (this=&lt;optimized out&gt;, rel_time=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/boost/asio/impl/io_context.hpp:82
#20 carla::rpc::Server::SyncRunFor (this=&lt;optimized out&gt;, duration=...) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/CarlaDependencies/include/carla/rpc/Server.h:54
#21 FCarlaServer::RunSome (this=0x7fffb1ad2b78, Milliseconds=10) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/Source/Carla/Server/CarlaServer.cpp:1169
#22 FCarlaEngine::OnPostTick (this=0x7fffb1ad2b70) at /home/jenkins/workspace/carla_master/Unreal/CarlaUE4/Plugins/Carla/Source/Carla/Game/CarlaEngine.cpp:120
#23 0x0000000001f2e05f in TMemberFunctionCaller&lt;FCarlaEngine, void (FCarlaEngine::*)(UWorld*, ELevelTick, float)&gt;::operator()&lt;UWorld*&amp;, ELevelTick&amp;, float&amp;&gt; (this=&lt;optimized out&gt;, Args=&lt;optimized out&gt;, Args=&lt;optimized out&gt;, Args=&lt;optimized out&gt;) at Runtime/Core/Public/Delegates/DelegateInstanceInterface.h:156
#24 UE4Tuple_Private::TTupleImpl&lt;TIntegerSequence&lt;unsigned int&gt;&gt;::ApplyAfter&lt;TMemberFunctionCaller&lt;FCarlaEngine, void (FCarlaEngine::*)(UWorld*, ELevelTick, float)&gt;, UWorld*&amp;, ELevelTick&amp;, float&amp;&gt;(TMemberFunctionCaller&lt;FCarlaEngine, void (FCarlaEngine::*)(UWorld*, ELevelTick, float)&gt;&amp;&amp;, UWorld*&amp;, ELevelTick&amp;, float&amp;) const (this=&lt;optimized out&gt;, Func=..., Args=&lt;optimized out&gt;, Args=&lt;optimized out&gt;, Args=&lt;optimized out&gt;) at Runtime/Core/Public/Templates/Tuple.h:285
#25 TBaseRawMethodDelegateInstance&lt;false, FCarlaEngine, TTypeWrapper&lt;void&gt; (UWorld*, ELevelTick, float)&gt;::Execute(UWorld*, ELevelTick, float) const (this=&lt;optimized out&gt;, Params=0, Params=0, Params=0) at Runtime/Core/Public/Delegates/DelegateInstancesImpl.h:481
#26 TBaseRawMethodDelegateInstance&lt;false, FCarlaEngine, void (UWorld*, ELevelTick, float)&gt;::ExecuteIfSafe(UWorld*, ELevelTick, float) const (this=&lt;optimized out&gt;, Params=0, Params=0, Params=0) at Runtime/Core/Public/Delegates/DelegateInstancesImpl.h:539
#27 0x000000000385399a in TBaseMulticastDelegate&lt;void, UWorld*, ELevelTick, float&gt;::Broadcast (this=0x5236868 &lt;FWorldDelegates::OnWorldPostActorTick&gt;, Params=0.0118845906, Params=0.0118845906, Params=0.0118845906) at Runtime/Core/Public/Delegates/DelegateSignatureImpl.inl:1013
#28 0x0000000003853351 in UWorld::Tick (this=&lt;optimized out&gt;, TickType=LEVELTICK_All, DeltaSeconds=0.0118845906) at Runtime/Engine/Private/LevelTick.cpp:1684
#29 0x000000000375fce9 in UGameEngine::Tick (this=0x7fffd36f0100, DeltaSeconds=&lt;optimized out&gt;, bIdleMode=&lt;optimized out&gt;) at Runtime/Engine/Private/GameEngine.cpp:1665
#30 0x0000000001e50e8e in FEngineLoop::Tick (this=0x50303b0 &lt;GEngineLoop&gt;) at Runtime/Launch/Private/LaunchEngineLoop.cpp:4479
#31 0x0000000001e5220a in EngineTick () at Runtime/Launch/Private/Launch.cpp:62
#32 GuardedMain (CmdLine=&lt;optimized out&gt;) at Runtime/Launch/Private/Launch.cpp:175
#33 0x0000000003f21828 in CommonUnixMain (argc=&lt;optimized out&gt;, argv=0x7fffffffe2e8, RealMain=0x1e51fc0 &lt;GuardedMain(char16_t const*)&gt;, AppExitCallback=0x1e5b310 &lt;LaunchUnix_FEngineLoop_AppExit()&gt;) at Runtime/Unix/UnixCommonStartup/Private/UnixCommonStartup.cpp:264
#34 0x00007ffff76b80b3 in __libc_start_main (main=0x1e5b300 &lt;main(int, char**)&gt;, argc=2, argv=0x7fffffffe2e8, init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, stack_end=0x7fffffffe2d8) at ../csu/libc-start.c:308
#35 0x0000000001e4f029 in _start ()
&lt;/denchmark-code&gt;

&lt;denchmark-link:https://github.com/carla-simulator/carla/files/4912609/map.xodr.zip&gt;map.xodr.zip&lt;/denchmark-link&gt;

	</description>
	<comments>
		<comment id='1' author='dsche' date='2020-07-14T06:28:42Z'>
		&lt;denchmark-link:https://github.com/marcgpuig&gt;@marcgpuig&lt;/denchmark-link&gt;
 could you take a look?
		</comment>
		<comment id='2' author='dsche' date='2020-09-12T10:20:28Z'>
		This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.
		</comment>
	</comments>
</bug>