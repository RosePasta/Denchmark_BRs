{"BR": {"BR_id": "29856", "BR_author": "mindlapse", "BRopenT": "2019-06-17T01:49:41Z", "BRcloseT": "2019-06-27T02:58:15Z", "BR_text": {"BRsummary": "tf.keras.layers.UpSampling2D(interpolation='bilinear') has a smearing defect on the right & bottom edges", "BRdescription": "\n Please make sure that this is a bug. As per our GitHub Policy, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template\n System information\n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow): I've provided a link to a Colab notebook demonstrating the issue below, comparing keras upsampling to what it should look like with a correct implementation as seen in tf.image.resize.\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colab\n Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\n TensorFlow installed from (source or binary): binary\n TensorFlow version (use command below): v2.0.0-beta0-16-g1d91213fe7\n Python version: 3\n Bazel version (if compiling from source): n/a\n GCC/Compiler version (if compiling from source): n/a\n CUDA/cuDNN version: n/a\n GPU model and memory: n/a\n \n You can collect some of this information using our environment capture\n <denchmark-link:https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh>script</denchmark-link>\n \n You can also obtain the TensorFlow version with: 1. TF 1.0:  2. TF 2.0: \n Describe the current behavior\n Upsampling using tf.keras.layers.UpSampling2D() results in unnatural smearing of the right and bottom edges of the image.  This problem is amplified when the upsampling is repeated.\n Describe the expected behavior\n Keras layers should use sensible default behaviour and not have this smearing issue.  This causes serious problems for autoencoders, GANs, and cost months of time.  Correct behaviour is seen with tf.image.resize(o, size=size, method=tf.image.ResizeMethod.BILINEAR).  Keras upsampling should use this as the default instead of the current defective behaviour.  Note: In TensorFlow 1.x, the tf.image.resize method had an 'align_corners' parameter that toggled between defective and proper behaviour and was set to False (defective behaviour) by default.  In TensorFlow 2, this parameter has been removed and the correct behaviour (align_corners=True behaviour) is now the default.  The keras layer should follow the same path.\n \n Here is a Colab notebook that demonstrates the issue:\n <denchmark-link:https://colab.research.google.com/drive/1rgCzJcMo4DN_9_hutr9l2vSrTRPfcd6K>https://colab.research.google.com/drive/1rgCzJcMo4DN_9_hutr9l2vSrTRPfcd6K</denchmark-link>\n \n Other info / logs\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "mindlapse", "commentT": "2019-06-17T07:42:50Z", "comment_text": "\n \t\tActually, I think it's even worse than that, it seems bilinear doesn't work\n <denchmark-link:https://colab.research.google.com/drive/1BG1gRC86Hj9CqyLTD9quyW0vtNJWZK3j>https://colab.research.google.com/drive/1BG1gRC86Hj9CqyLTD9quyW0vtNJWZK3j</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "mindlapse", "commentT": "2019-06-18T09:05:10Z", "comment_text": "\n \t\tHave tried with code snippet provided and was able to reproduce the issue on Colab with TensorFlow version 2.0beta.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "mindlapse", "commentT": "2019-06-27T02:58:16Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=29856>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=29856>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "15f6c30d7977c92ba452eb5c1873b8c9f0968a5f", "commit_author": "Martin Wicke", "commitT": "2019-06-26 19:53:26-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\keras\\backend.py", "file_new_name": "tensorflow\\python\\keras\\backend.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "2613,2614,2616,2617", "deleted_lines": "2613,2615"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\ops\\image_ops_impl.py", "file_new_name": "tensorflow\\python\\ops\\image_ops_impl.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "1212", "deleted_lines": "1212"}}}}}}