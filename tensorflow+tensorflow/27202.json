{"BR": {"BR_id": "27202", "BR_author": "Xiadalei", "BRopenT": "2019-03-27T15:42:29Z", "BRcloseT": "2019-04-06T00:44:28Z", "BR_text": {"BRsummary": "Tflite JNI wraps seems failing to release int array.", "BRdescription": "\n Hi, it seems that current impl of tflite jni overlooked ref release for array, And the current tflite really could make JNI reference table overflow some phones with Android 4.4.4 (API 19).\n How:\n Just invoke resizeInput every time you run interpreter, even put the same int array to it. You can see the reference table is booming.\n version:\n I've tried 1.13.1 and 0.0.0-nightly, it's the same.\n the relevant code is <denchmark-link:https://github.com/tensorflow/tensorflow/blob/c18034bc927f733e5e5a43d0c421775f969e0d04/tensorflow/lite/java/src/main/native/nativeinterpreterwrapper_jni.cc#L104>here</denchmark-link>\n \n The strange thing is the code above, althrough didn't deal with release in some situation, should work fine with same int array.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "Xiadalei", "commentT": "2019-04-05T21:27:22Z", "comment_text": "\n \t\tYou're absolutely right, will push a fix shortly.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "Xiadalei", "commentT": "2019-04-06T00:44:28Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=27202>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=27202>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "009fde664530e6616e5aa1f882ff497e9e435924", "commit_author": "Jared Duke", "commitT": "2019-04-05 17:40:01-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tensorflow\\lite\\java\\src\\main\\native\\nativeinterpreterwrapper_jni.cc", "file_new_name": "tensorflow\\lite\\java\\src\\main\\native\\nativeinterpreterwrapper_jni.cc", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "104,112,114,115,116,117,118,119,120", "deleted_lines": "104,113,114,115,116,117,121", "method_info": {"method_name": "areDimsDifferent", "method_params": "env,tensor,dims", "method_startline": "104", "method_endline": "122"}}, "hunk_1": {"Ismethod": 1, "added_lines": "104,112,114,115,116,117,118,119,120,124", "deleted_lines": "104,113,114,115,116,117,121", "method_info": {"method_name": "AreDimsDifferent", "method_params": "env,tensor,dims", "method_startline": "104", "method_endline": "125"}}, "hunk_2": {"Ismethod": 1, "added_lines": "452", "deleted_lines": "449", "method_info": {"method_name": "Java_org_tensorflow_lite_NativeInterpreterWrapper_resizeInput", "method_params": "env,clazz,interpreter_handle,error_handle,input_idx,dims", "method_startline": "433", "method_endline": "464"}}}}}}}