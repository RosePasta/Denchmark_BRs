{"BR": {"BR_id": "13506", "BR_author": "kcolford", "BRopenT": "2017-10-05T18:06:45Z", "BRcloseT": "2017-10-17T21:35:52Z", "BR_text": {"BRsummary": "tf.image.pad_to_bounding_box crashes when passed bounds with dtype int64", "BRdescription": "\n <denchmark-h:h3>System information</denchmark-h>\n \n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\n TensorFlow installed from (source or binary):from pip in virtualenv\n TensorFlow version (use command below):v1.3.0-rc2-20-g0787eee 1.3.0\n Python version: '3.5.2 (default, Nov 17 2016, 17:05:23) \\n[GCC 5.4.0 20160609]'\n Bazel version (if compiling from source):\n CUDA/cuDNN version:\n GPU model and memory:\n Exact command to reproduce:\n \n <denchmark-h:h2>Description</denchmark-h>\n \n Passing arguments of type int64 to tf.image.pad_to_bounding_box triggers a crash of the python interpreter. This is a bug because the type required by tf.image.pad_to_bounding_box not documented anywhere and just causes a crash with a cryptic error message.\n <denchmark-h:h2>Sources/Logs</denchmark-h>\n \n The following snippet crashes the whole python interpreter with a core dump.\n <denchmark-code>import tensorflow as tf\n i = tf.constant([0, 0, 3, 3], dtype=tf.int64)\n img = tf.ones([1,1,1], dtype=tf.float32)\n sess = tf.Session()\n sess.run(tf.image.pad_to_bounding_box(img, i[0], i[1], i[2], i[3]))\n </denchmark-code>\n \n And leaves the following\n <denchmark-code>2017-10-05 13:51:24.789715: F tensorflow/core/framework/tensor.cc:493] Check failed: dtype() == expected_dtype (9 vs. 3)\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "kcolford", "commentT": "2017-10-05T21:54:21Z", "comment_text": "\n \t\tthis is bad, it shouldn't crash Python even if type is wrong\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "kcolford", "commentT": "2017-10-06T05:23:31Z", "comment_text": "\n \t\tThe crash is caused by the fact that int64 was never registered in the kernel of tf.image.pad_to_bounding_box. Instead, the int64 of the Tpadding is directly used as int32 without appropriate processing.\n A PR <denchmark-link:https://github.com/tensorflow/tensorflow/pull/13517>#13517</denchmark-link>\n  has been created to address the crash.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "kcolford", "commentT": "2017-10-09T07:26:04Z", "comment_text": "\n \t\tThanks for debugging and the PR <denchmark-link:https://github.com/yongtang>@yongtang</denchmark-link>\n  !\n Marking as \"Contributions Welcome\", though it seems the contribution has already been sent :)\n \t\t"}}}, "commit": {"commit_id": "cbb705f10149a11b8d17182343ef12ab2dbfd7a8", "commit_author": "Yong Tang", "commitT": "2017-10-17 14:35:51-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tensorflow\\core\\kernels\\pad_op.cc", "file_new_name": "tensorflow\\core\\kernels\\pad_op.cc", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "85,87,88,89", "deleted_lines": "85,87,88", "method_info": {"method_name": "tensorflow::PadOp::Compute", "method_params": "context", "method_startline": "50", "method_endline": "140"}}, "hunk_1": {"Ismethod": 1, "added_lines": "146,150,154", "deleted_lines": "145,149,153", "method_info": {"method_name": "tensorflow::PadOp::Operate", "method_params": "context,input,paddings,pad_value,output", "method_startline": "144", "method_endline": "157"}}, "hunk_2": {"Ismethod": 1, "added_lines": "146,150,154", "deleted_lines": "145,149,153", "method_info": {"method_name": "tensorflow::PadOp::Operate", "method_params": "context,input,paddings,pad_value,output", "method_startline": "143", "method_endline": "156"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tensorflow\\core\\kernels\\pad_op.h", "file_new_name": "tensorflow\\core\\kernels\\pad_op.h", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "34", "deleted_lines": "34", "method_info": {"method_name": "tensorflow::functor::Pad::operator ( )", "method_params": "d,output,input,paddings,pad_value", "method_startline": "32", "method_endline": "42"}}, "hunk_1": {"Ismethod": 1, "added_lines": "50", "deleted_lines": "50", "method_info": {"method_name": "tensorflow::functor::Pad<Device,T,0>::operator ( )", "method_params": "d,output,input,array,T", "method_startline": "48", "method_endline": "52"}}, "hunk_2": {"Ismethod": 1, "added_lines": "34", "deleted_lines": "34", "method_info": {"method_name": "tensorflow::functor::Pad::operator ( )", "method_params": "d,output,input,paddings,pad_value", "method_startline": "32", "method_endline": "42"}}, "hunk_3": {"Ismethod": 1, "added_lines": "50", "deleted_lines": "50", "method_info": {"method_name": "tensorflow::functor::Pad<Device,T,Tpadding,0>::operator ( )", "method_params": "d,output,input,array,T", "method_startline": "48", "method_endline": "52"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\core\\kernels\\pad_op_gpu.cu.cc", "file_new_name": "tensorflow\\core\\kernels\\pad_op_gpu.cu.cc", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "29,30,31,32,33,34,35,36,37,38,39,40", "deleted_lines": "29,30,31,32,33,34,35,36"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\python\\kernel_tests\\pad_op_test.py", "file_new_name": "tensorflow\\python\\kernel_tests\\pad_op_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "287,288,289,290,291,292,293,294,295", "deleted_lines": null, "method_info": {"method_name": "testPadTypes", "method_params": "self", "method_startline": "287", "method_endline": "295"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\python\\ops\\image_ops_test.py", "file_new_name": "tensorflow\\python\\ops\\image_ops_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1377,1378,1379,1380,1381,1382,1383,1384,1385,1386,1387,1388,1389,1390,1391,1392,1393,1394", "deleted_lines": null, "method_info": {"method_name": "testInt64", "method_params": "self", "method_startline": "1377", "method_endline": "1394"}}}}}}}