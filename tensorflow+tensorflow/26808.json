{"BR": {"BR_id": "26808", "BR_author": "alper111", "BRopenT": "2019-03-17T17:41:40Z", "BRcloseT": "2019-03-27T21:01:15Z", "BR_text": {"BRsummary": "[TF 2.0]\u00a0unconnected_gradients = 'zero' does not work", "BRdescription": "\n System information\n \n OS Platform and Distribution: MacOS 10.14.3\n TensorFlow installed from binary\n TensorFlow version: 2.0.0a0\n Python version: 3.7.2\n \n I try to get gradients w.r.t. model parameters. Though I was getting None values. Here is an example:\n <denchmark-code>> import tensorflow as tf\n > import tensorflow.keras.layers as layers\n \n > model = tf.keras.Sequential()\n > model.add(layers.Dense(10, input_shape=(2,)))\n > with tf.GradientTape() as tape:\n >   loss = tf.random.normal((10, 10))\n > grads = tape.gradient(loss, model.trainable_variables, unconnected_gradients='zero')\n > print(grads)\n [None, None]\n </denchmark-code>\n \n I expect these values to be zero. Though they are not.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "alper111", "commentT": "2019-03-26T23:37:52Z", "comment_text": "\n \t\tWe need to add special treatment for DT_RESOURCE tensors when building the zeros tensors <denchmark-link:https://github.com/tensorflow/tensorflow/blob/919b38007ea755a5b5ec87af324c91f55dce6717/tensorflow/python/eager/pywrap_tfe_src.cc#L1764>here</denchmark-link>\n . Maybe we can return a float32 with zeros here? <denchmark-link:https://github.com/akshaym>@akshaym</denchmark-link>\n  could you look into this?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "alper111", "commentT": "2019-03-27T21:01:16Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=26808>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=26808>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "a79ed9c304bf9c1971fe3df4f61a0d0ab515eff9", "commit_author": "Akshay Modi", "commitT": "2019-03-27 13:58:46-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\eager\\backprop.py", "file_new_name": "tensorflow\\python\\eager\\backprop.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "949,961", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\python\\eager\\backprop_test.py", "file_new_name": "tensorflow\\python\\eager\\backprop_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "861,862,863,864,865,866,867,868,869,870,871", "deleted_lines": null, "method_info": {"method_name": "testUnconnectedGradientsVariablesZeros", "method_params": "self", "method_startline": "861", "method_endline": "871"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tensorflow\\python\\eager\\imperative_grad.py", "file_new_name": "tensorflow\\python\\eager\\imperative_grad.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "32,33,34,35,36,37", "deleted_lines": "32,33,34,35,36,37", "method_info": {"method_name": "imperative_grad", "method_params": "tape,target,sources,output_gradients,unconnected_gradients", "method_startline": "32", "method_endline": "37"}}, "hunk_1": {"Ismethod": 1, "added_lines": "32,33,34,35,36,37", "deleted_lines": "32,33,34,35,36,37", "method_info": {"method_name": "imperative_grad", "method_params": "tape,target,sources,output_gradients,sources_raw,unconnected_gradients", "method_startline": "32", "method_endline": "37"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\eager\\pywrap_tfe.h", "file_new_name": "tensorflow\\python\\eager\\pywrap_tfe.h", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "184", "deleted_lines": null}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\eager\\pywrap_tfe_src.cc", "file_new_name": "tensorflow\\python\\eager\\pywrap_tfe_src.cc", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "1677,1755,1756,1757", "deleted_lines": "1754"}}}}}}