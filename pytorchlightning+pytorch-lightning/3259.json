{"BR": {"BR_id": "3259", "BR_author": "maxjeblick", "BRopenT": "2020-08-29T22:01:59Z", "BRcloseT": "2020-09-09T08:51:43Z", "BR_text": {"BRsummary": "Cap batch size by number of training samples when using auto_scale_batch_size", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n The batch size finder sets an unrealistically high batch size if all samples of the training dataset fit into one batch.\n <denchmark-code>...\n Batch size 8388608 succeeded, trying batch size 16777216\n Batch size 16777216 succeeded, trying batch size 33554432\n Batch size 33554432 succeeded, trying batch size 67108864\n Finished batch size finder, will continue with full run using batch size 67108864\n </denchmark-code>\n \n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n Steps to reproduce the behavior:\n \n Run Mnist Example with auto_scale_batch_size=True (one needs to remove hardcoded batch size and set self.batch_size).\n \n <denchmark-h:h3>Expected behavior</denchmark-h>\n \n Batch size search space should not be larger than number of available training samples.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "maxjeblick", "commentT": "2020-08-29T22:02:38Z", "comment_text": "\n \t\tHi! thanks for your contribution!, great first issue!\n \t\t"}}}, "commit": {"commit_id": "e245065fbcc7701da528fbe2568242d50586a0a3", "commit_author": "Adrian W\u00e4lchli", "commitT": "2020-09-09 10:51:43+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "44,45", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "pytorch_lightning\\trainer\\training_tricks.py", "file_new_name": "pytorch_lightning\\trainer\\training_tricks.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "15,16,18,26,27,28,29,30"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "pytorch_lightning\\tuner\\batch_size_scaling.py", "file_new_name": "pytorch_lightning\\tuner\\batch_size_scaling.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "176,182,186,187,188", "deleted_lines": "168,174", "method_info": {"method_name": "_run_power_scaling", "method_params": "trainer,model,new_size,batch_arg_name,max_trials,fit_kwargs", "method_startline": "166", "method_endline": "189"}}, "hunk_1": {"Ismethod": 1, "added_lines": "213,215,216,217,218,219,227,232", "deleted_lines": "202,204,212,224,225,226,227,228,229", "method_info": {"method_name": "_run_binsearch_scaling", "method_params": "trainer,model,new_size,batch_arg_name,max_trials,fit_kwargs", "method_startline": "192", "method_endline": "233"}}, "hunk_2": {"Ismethod": 1, "added_lines": "240", "deleted_lines": null, "method_info": {"method_name": "_adjust_batch_size", "method_params": "trainer,str,float,None,str", "method_startline": "236", "method_endline": "240"}}, "hunk_3": {"Ismethod": 1, "added_lines": "274,275", "deleted_lines": null, "method_info": {"method_name": "_is_valid_batch_size", "method_params": "current_size,dataloader", "method_startline": "274", "method_endline": "275"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\trainer\\test_trainer_tricks.py", "file_new_name": "tests\\trainer\\test_trainer_tricks.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "242,244", "deleted_lines": "241", "method_info": {"method_name": "test_auto_scale_batch_size_set_model_attribute", "method_params": "tmpdir,use_hparams", "method_startline": "215", "method_endline": "247"}}}}}}}