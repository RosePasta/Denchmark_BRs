{"BR": {"BR_id": "1665", "BR_author": "tshrjn", "BRopenT": "2020-04-29T15:59:49Z", "BRcloseT": "2020-05-12T12:53:27Z", "BR_text": {"BRsummary": "Trainer add args doesn't add default root dir", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n \n When using parser = Trainer.add_argparse_args(parser), it's supposed to put all Trainer's arguments in the argparse with default values. Though currently it doesn't add default_root_dir and you get the error:\n \n <denchmark-code>'Namespace' object has no attribute 'default_root_dir'\n </denchmark-code>\n \n It does add default_save_path which is deprecated.\n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n <denchmark-h:h4>Code Sample</denchmark-h>\n \n import argparse\n from pytorch_lightning import Trainer\n \n parser = argparse.ArgumentParser(description='demo')\n parser = Trainer.add_argparse_args(parser)\n args = parser.parse_args()\n \n print(args.default_root_dir)\n A similar unit test could also be made, if not there already.\n <denchmark-h:h3>Environment</denchmark-h>\n \n <denchmark-code>* CUDA:\n         - GPU:\n                 - GeForce RTX 2080 Ti\n                 - GeForce RTX 2080 Ti\n                 - GeForce RTX 2080 Ti\n                 - GeForce RTX 2080 Ti\n                 - GeForce RTX 2080 Ti\n                 - GeForce RTX 2080 Ti\n                 - GeForce RTX 2080 Ti\n                 - GeForce RTX 2080 Ti\n         - available:         True\n         - version:           10.1\n * Packages:\n         - numpy:             1.18.1\n         - pyTorch_debug:     False\n         - pyTorch_version:   1.4.0\n         - pytorch-lightning: 0.7.3\n         - tensorboard:       2.2.0\n         - tqdm:              4.45.0\n * System:\n         - OS:                Linux\n         - architecture:\n                 - 64bit\n                 -\n         - processor:         x86_64\n         - python:            3.6.7\n         - version:           #75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "tshrjn", "commentT": "2020-04-30T11:46:49Z", "comment_text": "\n \t\tDid you tried to update to 0.7.5. Maybe it is already solved.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "tshrjn", "commentT": "2020-05-04T07:15:14Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/olineumann>@olineumann</denchmark-link>\n , yes updating did resolve this. However, the  arg is now broken. The same demo code above with  gives the same error .\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "tshrjn", "commentT": "2020-05-04T08:57:26Z", "comment_text": "\n \t\tWhat do you mean 'with profiler'? Do you mean Trainer(..., profiler=True)? But you don't initialize a Trainer.\n Running your code or this below didn't crash with any error on my machine.\n import argparse\n from pytorch_lightning import Trainer\n \n parser = argparse.ArgumentParser(description='demo')\n trainer = Trainer(profiler=True)\n parser = trainer.add_argparse_args(parser)\n args = parser.parse_args()\n \n print(args.default_root_dir)\n Maybe you could post the complete error message from the python interpreter.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "tshrjn", "commentT": "2020-05-06T22:12:44Z", "comment_text": "\n \t\tadd_argparse_args  is supposed to add the args from trainer to parser. But it doesn't do that for a few args. In this case profiler, previously the issue was for default_root_dir.\n Try the following code by running:\n python demo.py --profiler True or  other possibly accepted way python demo.py --profiler  with the following code:\n import argparse\n from pytorch_lightning import Trainer\n \n trainer = Trainer()\n parser = argparse.ArgumentParser(description='demo')\n parser = trainer.add_argparse_args(parser)\n args = parser.parse_args()\n \n print(args.profiler)\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "tshrjn", "commentT": "2020-05-12T03:12:23Z", "comment_text": "\n \t\tAny update?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "tshrjn", "commentT": "2020-05-12T10:43:03Z", "comment_text": "\n \t\tI just created a PR. After looking at the code I found out that add_argparse_args is checking the argument types and is only adding attributes of type str, float, int or bool. The profiler attribute could be of type bool so it should be a bug.\n I saw that get_init_arguments_and_types() is returning profiler as argument but only of type BaseProfiler. After updating typing annotation of profiler argument it worked. Should be available in the next version.\n See PR <denchmark-link:https://github.com/PyTorchLightning/pytorch-lightning/pull/1794>#1794</denchmark-link>\n \n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "tshrjn", "commentT": "2020-05-12T21:06:28Z", "comment_text": "\n \t\tA similar issue is with the pickling of the profiler when it's a Profile object & the trainer tries to save the hparams.\n TypeError: can't pickle Profile objects\n Example code:\n import argparse\n from pytorch_lightning import Trainer\n from pytorch_lightning import profiler\n from pl_bolts.models.gans import BasicGAN\n \n trainer = Trainer()\n parser = argparse.ArgumentParser(description='demo')\n parser = trainer.add_argparse_args(parser)\n args = parser.parse_args()\n model = BasicGAN()\n \n trainer = Trainer.from_argparse_args(\n         args, profiler=profiler.AdvancedProfiler())\n trainer.fit(model)\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "tshrjn", "commentT": "2020-05-13T08:02:45Z", "comment_text": "\n \t\tCan't reproduce your issue with pl version 0.7.6rc1. On my machine your code runs and saves checkpoints without crashing. Also this wouldn't belong to the topic of this issue imo. This would be a bug in the saving routine.\n \t\t"}}}, "commit": {"commit_id": "9059d21042a5f18fcb18a1792a901e8e62a3b61a", "commit_author": "Oliver Neumann", "commitT": "2020-05-12 08:53:26-04:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "65,66", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "pytorch_lightning\\trainer\\trainer.py", "file_new_name": "pytorch_lightning\\trainer\\trainer.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "587", "deleted_lines": null, "method_info": {"method_name": "get_init_arguments_and_types", "method_params": "cls", "method_startline": "559", "method_endline": "604"}}, "hunk_1": {"Ismethod": 1, "added_lines": "127", "deleted_lines": "127", "method_info": {"method_name": "__init__", "method_params": "self,LightningLoggerBase,True,ModelCheckpoint,True,EarlyStopping,False,None,None,float,int,int,int,str,None,bool,None,None,int,float,int,int,bool,int,int,1,int,int,None,None,float,float,float,float,int,int,add_row_log_interval,None,int,bool,None,int,None,None,BaseProfiler,None,bool,bool,bool,bool,False,bool,ProgressBarBase,True,bool,None,str,default_save_path,gradient_clip,nb_gpu_nodes,max_nb_epochs,min_nb_epochs,use_amp,show_progress_bar,nb_sanity_val_steps,kwargs", "method_startline": "87", "method_endline": "145"}}, "hunk_2": {"Ismethod": 1, "added_lines": "127", "deleted_lines": "127", "method_info": {"method_name": "__init__", "method_params": "self,LightningLoggerBase,True,ModelCheckpoint,True,EarlyStopping,False,None,None,float,int,int,int,str,None,bool,None,None,int,float,int,int,bool,int,int,1,int,int,None,None,float,float,float,float,int,int,add_row_log_interval,None,int,bool,None,int,None,None,None,bool,bool,bool,bool,False,bool,ProgressBarBase,True,bool,None,str,default_save_path,gradient_clip,nb_gpu_nodes,max_nb_epochs,min_nb_epochs,use_amp,show_progress_bar,nb_sanity_val_steps,kwargs", "method_startline": "87", "method_endline": "145"}}, "hunk_3": {"Ismethod": 1, "added_lines": "626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651", "deleted_lines": null, "method_info": {"method_name": "add_argparse_args", "method_params": "cls,ArgumentParser", "method_startline": "616", "method_endline": "682"}}}}}}}