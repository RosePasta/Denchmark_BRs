{"BR": {"BR_id": "3619", "BR_author": "carmocca", "BRopenT": "2020-09-23T02:00:38Z", "BRcloseT": "2020-09-29T13:36:46Z", "BR_text": {"BRsummary": "ModelCheckpoint period should not always save on the first epoch", "BRdescription": "\n <denchmark-h:h2>\ud83d\ude80 Feature</denchmark-h>\n \n period should work so:\n <denchmark-code># ModelCheckpoint on_validation_end\n if (epoch + 1) % period:\n     # do not save\n     return\n </denchmark-code>\n \n e.g:\n \n period == 1: save on epoch 0, 1, 2...\n period == 2: save on epoch 1, 3, 5...\n period == 3: save on epoch 2, 5, 8...\n \n currently, it always runs on the first epoch and then runs every period epochs\n e.g:\n \n period == 1: save on epoch 0, 1, 2...\n period == 2: save on epoch 0, 2, 4...\n period == 3: save on epoch 0, 3, 6...\n \n This would also allow having period = 0 which would never save, just as save_top_k = 0\n <denchmark-h:h3>Motivation</denchmark-h>\n \n I want to save a checkpoint every period epochs but current behaviour forces to always save on the first one.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "carmocca", "commentT": "2020-09-23T02:34:00Z", "comment_text": "\n \t\tmakes sense. submit a PR?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "carmocca", "commentT": "2020-09-23T17:05:57Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/williamFalcon>@williamFalcon</denchmark-link>\n  why is epoch 0-indexed in one place and 1-indexed in other places? can it be consistent across lightning instead of these +1s? I think the same issue affects batch indices too\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "carmocca", "commentT": "2020-09-23T17:43:14Z", "comment_text": "\n \t\tyes, we did a refactor a while to make everything zero indexed. where did we miss spots?\n \t\t"}}}, "commit": {"commit_id": "3b2efe5b2afe664d88c9d5eda127774bba4cff4c", "commit_author": "Carlos Mochol\u00ed", "commitT": "2020-09-29 15:36:45+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "82,83", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "pytorch_lightning\\callbacks\\model_checkpoint.py", "file_new_name": "pytorch_lightning\\callbacks\\model_checkpoint.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "486,487,488,489", "deleted_lines": null, "method_info": {"method_name": "_save_top_k_checkpoints", "method_params": "self,metrics,trainer,pl_module,epoch,filepath", "method_startline": "476", "method_endline": "496"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "293", "method_info": {"method_name": "_save_model", "method_params": "self,str,trainer,pl_module", "method_startline": "292", "method_endline": "304"}}, "hunk_2": {"Ismethod": 1, "added_lines": "313", "deleted_lines": null, "method_info": {"method_name": "check_monitor_top_k", "method_params": "self,current", "method_startline": "299", "method_endline": "313"}}, "hunk_3": {"Ismethod": 1, "added_lines": "184,186,187,188,189,190,191,192,193", "deleted_lines": "184,185,186,187,188,189,190,191,192,193,194,196,197,203,204", "method_info": {"method_name": "save_checkpoint", "method_params": "self,trainer,pl_module", "method_startline": "180", "method_endline": "218"}}, "hunk_4": {"Ismethod": 1, "added_lines": null, "deleted_lines": "446,447,448", "method_info": {"method_name": "_should_skip_epoch", "method_params": "self,trainer", "method_startline": "446", "method_endline": "448"}}, "hunk_5": {"Ismethod": 1, "added_lines": "275", "deleted_lines": null, "method_info": {"method_name": "__init_monitor_mode", "method_params": "self,monitor,mode", "method_startline": "263", "method_endline": "280"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tests\\callbacks\\test_model_checkpoint.py", "file_new_name": "tests\\callbacks\\test_model_checkpoint.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "320", "deleted_lines": null, "method_info": {"method_name": "test_model_checkpoint_topk_zero", "method_params": "tmpdir", "method_startline": "301", "method_endline": "320"}}, "hunk_1": {"Ismethod": 1, "added_lines": "184,190", "deleted_lines": "189,190", "method_info": {"method_name": "test_model_checkpoint_save_last", "method_params": "tmpdir", "method_startline": "173", "method_endline": "191"}}, "hunk_2": {"Ismethod": 1, "added_lines": "264,276,277", "deleted_lines": "275,276", "method_info": {"method_name": "test_model_checkpoint_none_monitor", "method_params": "tmpdir", "method_startline": "251", "method_endline": "277"}}, "hunk_3": {"Ismethod": 1, "added_lines": "281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297", "deleted_lines": null, "method_info": {"method_name": "test_model_checkpoint_period", "method_params": "tmpdir,period", "method_startline": "281", "method_endline": "298"}}}}}}}