{"BR": {"BR_id": "6213", "BR_author": "xiptos", "BRopenT": "2018-08-20T09:39:02Z", "BRcloseT": "2018-08-20T16:07:45Z", "BR_text": {"BRsummary": "Attempting to permute dimensions other thanspatial dimensions (height and width) in Permute layer", "BRdescription": "\n When importing a Keras model, I get the following exception:\n [main] INFO org.deeplearning4j.nn.modelimport.keras.Hdf5Archive - Unexpected end-of-input: expected close marker for ARRAY (from [Source: {\"class_name\": \"Model\", \"config\": {\"layers\": [{\"class_name\": \"InputLayer\", \"config\": {\"dtype\": \"float32\", \"batch_input_shape\": [null, 48, 48, 3], \"name\": \"input_1\", \"sparse\": false}, \"inbound_nodes\": [], \"name\": \"input_1\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv1\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 32, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[[\"input_1\", 0, 0, {}]]], \"name\": \"conv1\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu1\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv1\", 0, 0, {}]]], \"name\": \"prelu1\"}, {\"class_name\": \"MaxPooling2D\", \"config\": {\"name\": \"max_pooling2d_1\", \"trainable\": true, \"data_format\": \"channels_last\", \"pool_size\": [3, 3], \"padding\": \"same\", \"strides\": [2, 2]}, \"inbound_nodes\": [[[\"prelu1\", 0, 0, {}]]], \"name\": \"max_pooling2d_1\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv2\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 64, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[; line: 1, column: 1999])\n at [Source: {\"class_name\": \"Model\", \"config\": {\"layers\": [{\"class_name\": \"InputLayer\", \"config\": {\"dtype\": \"float32\", \"batch_input_shape\": [null, 48, 48, 3], \"name\": \"input_1\", \"sparse\": false}, \"inbound_nodes\": [], \"name\": \"input_1\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv1\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 32, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[[\"input_1\", 0, 0, {}]]], \"name\": \"conv1\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu1\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv1\", 0, 0, {}]]], \"name\": \"prelu1\"}, {\"class_name\": \"MaxPooling2D\", \"config\": {\"name\": \"max_pooling2d_1\", \"trainable\": true, \"data_format\": \"channels_last\", \"pool_size\": [3, 3], \"padding\": \"same\", \"strides\": [2, 2]}, \"inbound_nodes\": [[[\"prelu1\", 0, 0, {}]]], \"name\": \"max_pooling2d_1\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv2\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 64, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[; line: 1, column: 4001]\n [main] INFO org.deeplearning4j.nn.modelimport.keras.Hdf5Archive - Unexpected end-of-input within/between OBJECT entries\n at [Source: {\"class_name\": \"Model\", \"config\": {\"layers\": [{\"class_name\": \"InputLayer\", \"config\": {\"dtype\": \"float32\", \"batch_input_shape\": [null, 48, 48, 3], \"name\": \"input_1\", \"sparse\": false}, \"inbound_nodes\": [], \"name\": \"input_1\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv1\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 32, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[[\"input_1\", 0, 0, {}]]], \"name\": \"conv1\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu1\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv1\", 0, 0, {}]]], \"name\": \"prelu1\"}, {\"class_name\": \"MaxPooling2D\", \"config\": {\"name\": \"max_pooling2d_1\", \"trainable\": true, \"data_format\": \"channels_last\", \"pool_size\": [3, 3], \"padding\": \"same\", \"strides\": [2, 2]}, \"inbound_nodes\": [[[\"prelu1\", 0, 0, {}]]], \"name\": \"max_pooling2d_1\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv2\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 64, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[[\"max_pooling2d_1\", 0, 0, {}]]], \"name\": \"conv2\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu2\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv2\", 0, 0, {}]]], \"name\": \"prelu2\"}, {\"class_name\": \"MaxPooling2D\", \"config\": {\"name\": \"max_pooling2d_2\", \"trainable\": true, \"data_format\": \"channels_last\", \"pool_size\": [3, 3], \"padding\": \"valid\", \"strides\": [2, 2]}, \"inbound_nodes\": [[[\"prelu2\", 0, 0, {}]]], \"name\": \"max_pooling2d_2\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv3\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 64, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[[\"max_pooling2d_2\", 0, 0, {}]]], \"name\": \"conv3\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu3\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv3\", 0, 0, {}]]], \"name\": \"prelu3\"}, {\"class_name\": \"MaxPooling2D\", \"config\": {\"name\": \"max_pooling2d_3\", \"trainable\": true, \"data_format\": \"channels_last\", \"pool_size\": [2, 2], \"padding\": \"valid\", \"strides\": [2, 2]}, \"inbound_nodes\": [[[\"prelu3\", 0, 0, {}]]], \"name\": \"max_pooling2d_3\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv4\", \"bias_regularizer\": null,; line: 1, column: 8001]\n [main] INFO org.deeplearning4j.nn.modelimport.keras.Hdf5Archive - Unexpected end-of-input: was expecting closing '\"' for name\n at [Source: {\"class_name\": \"Model\", \"config\": {\"layers\": [{\"class_name\": \"InputLayer\", \"config\": {\"dtype\": \"float32\", \"batch_input_shape\": [null, 48, 48, 3], \"name\": \"input_1\", \"sparse\": false}, \"inbound_nodes\": [], \"name\": \"input_1\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv1\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 32, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[[\"input_1\", 0, 0, {}]]], \"name\": \"conv1\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu1\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv1\", 0, 0, {}]]], \"name\": \"prelu1\"}, {\"class_name\": \"MaxPooling2D\", \"config\": {\"name\": \"max_pooling2d_1\", \"trainable\": true, \"data_format\": \"channels_last\", \"pool_size\": [3, 3], \"padding\": \"same\", \"strides\": [2, 2]}, \"inbound_nodes\": [[[\"prelu1\", 0, 0, {}]]], \"name\": \"max_pooling2d_1\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv2\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 64, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[[\"max_pooling2d_1\", 0, 0, {}]]], \"name\": \"conv2\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu2\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv2\", 0, 0, {}]]], \"name\": \"prelu2\"}, {\"class_name\": \"MaxPooling2D\", \"config\": {\"name\": \"max_pooling2d_2\", \"trainable\": true, \"data_format\": \"channels_last\", \"pool_size\": [3, 3], \"padding\": \"valid\", \"strides\": [2, 2]}, \"inbound_nodes\": [[[\"prelu2\", 0, 0, {}]]], \"name\": \"max_pooling2d_2\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv3\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 64, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [3, 3]}, \"inbound_nodes\": [[[\"max_pooling2d_2\", 0, 0, {}]]], \"name\": \"conv3\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu3\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv3\", 0, 0, {}]]], \"name\": \"prelu3\"}, {\"class_name\": \"MaxPooling2D\", \"config\": {\"name\": \"max_pooling2d_3\", \"trainable\": true, \"data_format\": \"channels_last\", \"pool_size\": [2, 2], \"padding\": \"valid\", \"strides\": [2, 2]}, \"inbound_nodes\": [[[\"prelu3\", 0, 0, {}]]], \"name\": \"max_pooling2d_3\"}, {\"class_name\": \"Conv2D\", \"config\": {\"kernel_constraint\": null, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv4\", \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"data_format\": \"channels_last\", \"padding\": \"valid\", \"strides\": [1, 1], \"dilation_rate\": [1, 1], \"kernel_regularizer\": null, \"filters\": 128, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"use_bias\": true, \"activity_regularizer\": null, \"kernel_size\": [2, 2]}, \"inbound_nodes\": [[[\"max_pooling2d_3\", 0, 0, {}]]], \"name\": \"conv4\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu4\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": [1, 2]}, \"inbound_nodes\": [[[\"conv4\", 0, 0, {}]]], \"name\": \"prelu4\"}, {\"class_name\": \"Permute\", \"config\": {\"dims\": [3, 2, 1], \"trainable\": true, \"name\": \"permute_1\"}, \"inbound_nodes\": [[[\"prelu4\", 0, 0, {}]]], \"name\": \"permute_1\"}, {\"class_name\": \"Flatten\", \"config\": {\"trainable\": true, \"name\": \"flatten_1\", \"data_format\": \"channels_last\"}, \"inbound_nodes\": [[[\"permute_1\", 0, 0, {}]]], \"name\": \"flatten_1\"}, {\"class_name\": \"Dense\", \"config\": {\"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"conv5\", \"kernel_constraint\": null, \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"linear\", \"trainable\": true, \"kernel_regularizer\": null, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"units\": 256, \"use_bias\": true, \"activity_regularizer\": null}, \"inbound_nodes\": [[[\"flatten_1\", 0, 0, {}]]], \"name\": \"conv5\"}, {\"class_name\": \"PReLU\", \"config\": {\"name\": \"prelu5\", \"alpha_constraint\": null, \"trainable\": true, \"alpha_regularizer\": null, \"alpha_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"shared_axes\": null}, \"inbound_nodes\": [[[\"conv5\", 0, 0, {}]]], \"name\": \"prelu5\"}, {\"class_name\": \"Dense\", \"config\": {\"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"nam; line: 1, column: 12001]\n [main] INFO org.nd4j.linalg.factory.Nd4jBackend - Loaded [CpuBackend] backend\n [main] INFO org.nd4j.nativeblas.NativeOpsHolder - Number of threads used for NativeOps: 2\n [main] INFO org.nd4j.nativeblas.Nd4jBlas - Number of threads used for BLAS: 2\n [main] INFO org.nd4j.linalg.api.ops.executioner.DefaultOpExecutioner - Backend used: [CPU]; OS: [Mac OS X]\n [main] INFO org.nd4j.linalg.api.ops.executioner.DefaultOpExecutioner - Cores: [4]; Memory: [1.8GB];\n [main] INFO org.nd4j.linalg.api.ops.executioner.DefaultOpExecutioner - Blas vendor: [MKL]\n Exception in thread \"main\" org.deeplearning4j.nn.modelimport.keras.exceptions.InvalidKerasConfigurationException: Attempting to permute dimensions other thanspatial dimensions (height and width) in Permute layer, got [3, 2, 1]. For more information, see http://deeplearning4j.org/model-import-keras.\n at org.deeplearning4j.nn.modelimport.keras.layers.core.KerasPermute.getInputPreprocessor(KerasPermute.java:115)\n at org.deeplearning4j.nn.modelimport.keras.layers.core.KerasPermute.getOutputType(KerasPermute.java:143)\n at org.deeplearning4j.nn.modelimport.keras.KerasModel.inferOutputTypes(KerasModel.java:306)\n at org.deeplearning4j.nn.modelimport.keras.KerasModel.(KerasModel.java:181)\n at org.deeplearning4j.nn.modelimport.keras.KerasModel.(KerasModel.java:98)\n at org.deeplearning4j.nn.modelimport.keras.utils.KerasModelBuilder.buildModel(KerasModelBuilder.java:305)\n at org.deeplearning4j.nn.modelimport.keras.KerasModelImport.importKerasModelAndWeights(KerasModelImport.java:127)\n at pt.ipb.face.Mtcnn2Dl4j.main(Mtcnn2Dl4j.java:15)\n The source code in in attach, as well as the keras model file. The operating system is macOS High Sierra 10.13.6, with\n java version \"1.8.0_151\"\n Java(TM) SE Runtime Environment (build 1.8.0_151-b12)\n Java HotSpot(TM) 64-Bit Server VM (build 25.151-b12, mixed mode)\n Is the problem related to the keras model or some problem with keras_import?\n <denchmark-link:https://github.com/deeplearning4j/deeplearning4j/files/2301895/48net_complete.h5.zip>48net_complete.h5.zip</denchmark-link>\n \n <denchmark-link:https://github.com/deeplearning4j/deeplearning4j/files/2301896/Mtcnn2Dl4j.java.zip>Mtcnn2Dl4j.java.zip</denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "xiptos", "commentT": "2018-08-20T10:18:29Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/xiptos>@xiptos</denchmark-link>\n  can you explain what your model is supposed to do? So you want to flip the input completely from (1,2,3) to (3,2,1)? We have some safeguards in DL4J to prevent users from doing stuff that is allowed in keras.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "xiptos", "commentT": "2018-08-20T10:43:37Z", "comment_text": "\n \t\tI'm trying to implement (by importing) the MTCNN approach to detect human faces, from the python project <denchmark-link:https://github.com/xiangrufan/keras-mtcnn/blob/master/MTCNN.py>https://github.com/xiangrufan/keras-mtcnn/blob/master/MTCNN.py</denchmark-link>\n  and based on the paper <denchmark-link:https://kpzhang93.github.io/papers/spl.pdf>https://kpzhang93.github.io/papers/spl.pdf</denchmark-link>\n \n There are two more models, and I'm also having some exceptions importing them.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "xiptos", "commentT": "2018-08-20T11:54:21Z", "comment_text": "\n \t\ti discover the same problem on conv2D model imported from keras but my model charge and predict bad.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "xiptos", "commentT": "2018-08-20T12:27:23Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/xiptos>@xiptos</denchmark-link>\n  thanks for the reference. I'll check it out. in principle there's nothing preventing us from relaxing the restrictions, I just want to understand it better first.\n <denchmark-link:https://github.com/Arkariian>@Arkariian</denchmark-link>\n  please open another issue for your stuff, and include all relevant data (your model, dl4j version, full(!) stack trace). doesn't help to throw this into another, only slightly similar issue. :)\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "xiptos", "commentT": "2018-08-20T14:38:44Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/xiptos>@xiptos</denchmark-link>\n  maybe you can help me out here. what's the supposed effect of permuting right before a flatten layer?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "xiptos", "commentT": "2018-08-20T15:11:58Z", "comment_text": "\n \t\tI may be wrong, but I believe it has something to do with the optimisation of learning of symmetric or symmetry invariant situations.\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "xiptos", "commentT": "2018-09-21T09:21:21Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "40ce47102d926a1fa33bf0a23617471633a27cd3", "commit_author": "Max Pumperla", "commitT": "2018-08-20 18:07:40+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-modelimport\\src\\main\\java\\org\\deeplearning4j\\nn\\modelimport\\keras\\layers\\core\\KerasPermute.java", "file_new_name": "deeplearning4j\\deeplearning4j-modelimport\\src\\main\\java\\org\\deeplearning4j\\nn\\modelimport\\keras\\layers\\core\\KerasPermute.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "102,106,107,108", "deleted_lines": "102,103,104,105,106,110,111,112,113,114,115", "method_info": {"method_name": "KerasPermute::getInputPreprocessor", "method_params": "inputType", "method_startline": "93", "method_endline": "122"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-modelimport\\src\\test\\java\\org\\deeplearning4j\\nn\\modelimport\\keras\\e2e\\KerasModelEndToEndTest.java", "file_new_name": "deeplearning4j\\deeplearning4j-modelimport\\src\\test\\java\\org\\deeplearning4j\\nn\\modelimport\\keras\\e2e\\KerasModelEndToEndTest.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "562,563,564", "deleted_lines": null, "method_info": {"method_name": "KerasModelEndToEndTest::importMTCNN", "method_params": "", "method_startline": "562", "method_endline": "564"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\conf\\layers\\PReLULayer.java", "file_new_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\conf\\layers\\PReLULayer.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "85,86,87", "deleted_lines": null, "method_info": {"method_name": "PReLULayer::setNIn", "method_params": "inputType,override", "method_startline": "85", "method_endline": "87"}}, "hunk_1": {"Ismethod": 1, "added_lines": "96,97,98", "deleted_lines": null, "method_info": {"method_name": "PReLULayer::isPretrain", "method_params": "", "method_startline": "96", "method_endline": "98"}}, "hunk_2": {"Ismethod": 1, "added_lines": "90,91,92,93", "deleted_lines": null, "method_info": {"method_name": "PReLULayer::getPreProcessorForInputType", "method_params": "inputType", "method_startline": "90", "method_endline": "93"}}, "hunk_3": {"Ismethod": 1, "added_lines": "101,102,103,104,105,106,107,108", "deleted_lines": null, "method_info": {"method_name": "PReLULayer::getL1ByParam", "method_params": "paramName", "method_startline": "101", "method_endline": "108"}}, "hunk_4": {"Ismethod": 1, "added_lines": "121,122,123", "deleted_lines": null, "method_info": {"method_name": "PReLULayer::isPretrainParam", "method_params": "paramName", "method_startline": "121", "method_endline": "123"}}, "hunk_5": {"Ismethod": 1, "added_lines": "111,112,113,114,115,116,117,118", "deleted_lines": null, "method_info": {"method_name": "PReLULayer::getL2ByParam", "method_params": "paramName", "method_startline": "111", "method_endline": "118"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\params\\PReLUParamInitializer.java", "file_new_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\params\\PReLUParamInitializer.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "107", "deleted_lines": "107", "method_info": {"method_name": "PReLUParamInitializer::init", "method_params": "conf,paramsView,initializeParams", "method_startline": "106", "method_endline": "123"}}, "hunk_1": {"Ismethod": 1, "added_lines": "141", "deleted_lines": "141", "method_info": {"method_name": "PReLUParamInitializer::createWeightMatrix", "method_params": "conf,weightParamView,initializeParameters", "method_startline": "138", "method_endline": "149"}}}}}}}