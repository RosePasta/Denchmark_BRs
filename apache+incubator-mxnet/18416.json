{"BR": {"BR_id": "18416", "BR_author": "ZheyuYe", "BRopenT": "2020-05-27T12:00:58Z", "BRcloseT": "2020-06-03T07:17:10Z", "BR_text": {"BRsummary": "[Numpy] np.where fails for scalar", "BRdescription": "\n As title described,  a fatal error occurs when this operation encounters a scalar.  Same operation nd.where does not support scalar but only nd.ndarray.\n <denchmark-code>import mxnet as mx\n mx.npx.set_np()\n condition = mx.np.array([1, 0, 1, 0, 1])\n x = mx.np.ones_like(condition)\n y = mx.np.zeros_like(condition)\n mx.np.where(condition, x, y)\n mx.np.where(condition, 1, 0)\n </denchmark-code>\n \n Output:\n <denchmark-code>array([1., 0., 1., 0., 1.])\n array([0., 0., 0., 0., 0.])\n </denchmark-code>\n \n A worse result emerged as\n <denchmark-code>mx.np.where(condition, 2, 103)\n <<< array([103.,   0., 103.,   0., 103.])\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ZheyuYe", "commentT": "2020-05-28T02:50:08Z", "comment_text": "\n \t\tI can confirm that there is a bug here.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ZheyuYe", "commentT": "2020-05-28T02:50:41Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/yzhliu>@yzhliu</denchmark-link>\n  I tagged it as 2.0 since it gives wrong result for .\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "ZheyuYe", "commentT": "2020-05-29T10:16:12Z", "comment_text": "\n \t\tI think this issue is because of the wrong param assignment in FFI\n \n param.x = args[1].operator double();\n param.x = args[2].operator double();\n \n I will add a quick fix to that.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "ZheyuYe", "commentT": "2020-06-03T07:17:10Z", "comment_text": "\n \t\tshould be fixed by <denchmark-link:https://github.com/apache/incubator-mxnet/pull/18451>#18451</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "85725066767255090b57aec7f3b03628656afbf0", "commit_author": "Minghao Liu", "commitT": "2020-06-03 00:16:24-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\api\\operator\\numpy\\np_where_op.cc", "file_new_name": "src\\api\\operator\\numpy\\np_where_op.cc", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "79", "deleted_lines": "79", "method_info": {"method_name": "mxnet::_npi_where_scalar2", "method_params": "args,ret", "method_startline": "72", "method_endline": "88"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\python\\unittest\\test_numpy_op.py", "file_new_name": "tests\\python\\unittest\\test_numpy_op.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "9159,9160,9161,9162,9163,9164,9165", "deleted_lines": null, "method_info": {"method_name": "test_np_where", "method_params": "", "method_startline": "9102", "method_endline": "9165"}}}}}}}