{"BR": {"BR_id": "14426", "BR_author": "anirudh2290", "BRopenT": "2019-03-14T02:19:47Z", "BRcloseT": "2019-04-08T07:21:37Z", "BR_text": {"BRsummary": "mx.random.seed with ctx failures on a gpu build when run with cpu context", "BRdescription": "\n Minimum reproducible example.\n <denchmark-code>import mxnet as mx\n \n def set_seed_variously_for_context(ctx, init_seed, num_init_seeds, final_seed):\n     end_seed = init_seed + num_init_seeds\n     for seed in range(init_seed, end_seed):\n         mx.random.seed(seed, ctx=ctx)\n     z = mx.random.seed(seed, ctx=ctx)\n     return end_seed\n \n dtype = 'float32'\n \n samples_imp = []\n samples_sym = []\n ctx = mx.cpu()\n shape = (200, 200)\n params = {'low': -1.5, 'high': 3.0}\n params.update(shape=shape, dtype=dtype)\n seed = set_seed_variously_for_context(ctx, 1, 1, 1234)\n mx.nd.waitall()\n </denchmark-code>\n \n To reproduce, this will require the exception handling support for waitall in this PR: <denchmark-link:https://github.com/apache/incubator-mxnet/pull/14397>#14397</denchmark-link>\n  . This issue was found because of CI failures when running test_random.py on windows. It was hidden earlier because waitall didnt have exception rethrow support. This issue may have been around since the PR was added: <denchmark-link:https://github.com/apache/incubator-mxnet/pull/10367>#10367</denchmark-link>\n \n Currently working on fixing this.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "anirudh2290", "commentT": "2019-03-14T02:19:50Z", "comment_text": "\n \t\tHey, this is the MXNet Label Bot.\n Thank you for submitting the issue! I will try and suggest some labels so that the appropriate MXNet community members can help resolve it.\n Here are my recommended labels: Bug\n \t\t"}}}, "commit": {"commit_id": "37818165a7d97031a3db613d98511284bcccfbc7", "commit_author": "Anirudh Subramanian", "commitT": "2019-04-08 15:21:36+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "cpp-package\\example\\resnet.cpp", "file_new_name": "cpp-package\\example\\resnet.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "188", "deleted_lines": "188", "method_info": {"method_name": "main", "method_params": "argc", "method_startline": "170", "method_endline": "283"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "cpp-package\\include\\mxnet-cpp\\ndarray.hpp", "file_new_name": "cpp-package\\include\\mxnet-cpp\\ndarray.hpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "236", "deleted_lines": "236", "method_info": {"method_name": "mxnet::cpp::NDArray::WaitToRead", "method_params": "", "method_startline": "235", "method_endline": "237"}}, "hunk_1": {"Ismethod": 1, "added_lines": "239", "deleted_lines": "239", "method_info": {"method_name": "mxnet::cpp::NDArray::WaitToWrite", "method_params": "", "method_startline": "238", "method_endline": "240"}}, "hunk_2": {"Ismethod": 1, "added_lines": "241", "deleted_lines": "241", "method_info": {"method_name": "mxnet::cpp::NDArray::WaitAll", "method_params": "", "method_startline": "241", "method_endline": "241"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\architecture\\exception_handling.md", "file_new_name": "docs\\architecture\\exception_handling.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "126,127,128"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\mxnet\\ndarray\\ndarray.py", "file_new_name": "python\\mxnet\\ndarray\\ndarray.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "161,163", "deleted_lines": "161,163,164,165", "method_info": {"method_name": "waitall", "method_params": "", "method_startline": "156", "method_endline": "165"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "src\\engine\\threaded_engine.cc", "file_new_name": "src\\engine\\threaded_engine.cc", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434", "deleted_lines": null, "method_info": {"method_name": "mxnet::engine::ThreadedEngine::WaitForAll", "method_params": "", "method_startline": "412", "method_endline": "435"}}, "hunk_1": {"Ismethod": 1, "added_lines": "448,449,450", "deleted_lines": null, "method_info": {"method_name": "mxnet::engine::ThreadedEngine::OnComplete", "method_params": "threaded_opr", "method_startline": "437", "method_endline": "490"}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "src\\engine\\threaded_engine.h", "file_new_name": "src\\engine\\threaded_engine.h", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "496,497,498,499,500,501,502,503", "deleted_lines": null, "method_info": {"method_name": "mxnet::engine::ThreadedEngine::AddToGlobalExceptions", "method_params": "opr_exception", "method_startline": "496", "method_endline": "503"}}, "hunk_1": {"Ismethod": 1, "added_lines": "475,483", "deleted_lines": null, "method_info": {"method_name": "mxnet::engine::ThreadedEngine::OnStart", "method_params": "threaded_opr", "method_startline": "471", "method_endline": "488"}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\resource.cc", "file_new_name": "src\\resource.cc", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "192,193,194,195,196,197,198,199", "deleted_lines": "192,193,194,195,196,197", "method_info": {"method_name": "mxnet::resource::ResourceManagerImpl::SeedRandom", "method_params": "ctx,seed", "method_startline": "188", "method_endline": "201"}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 15, "file_old_name": "tests\\python\\unittest\\test_exc_handling.py", "file_new_name": "tests\\python\\unittest\\test_exc_handling.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "41,61,62,63,64,66,67,68,69,71,72,73,74,75", "deleted_lines": "41,61,63,65,66,70", "method_info": {"method_name": "test_exc_symbolic", "method_params": "", "method_startline": "40", "method_endline": "75"}}, "hunk_1": {"Ismethod": 1, "added_lines": "101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126", "deleted_lines": "100,106,107,111,113,114,115,116,117,118,119", "method_info": {"method_name": "test_exc_multiple_waits", "method_params": "", "method_startline": "100", "method_endline": "126"}}, "hunk_2": {"Ismethod": 1, "added_lines": "71,72,73,74,75,79", "deleted_lines": "70,80", "method_info": {"method_name": "test_exc_gluon.gluon", "method_params": "exec_wait", "method_startline": "70", "method_endline": "81"}}, "hunk_3": {"Ismethod": 1, "added_lines": "41,61,62,63", "deleted_lines": "41,61,63", "method_info": {"method_name": "test_exc_symbolic.symbolic", "method_params": "exec_backward", "method_startline": "41", "method_endline": "63"}}, "hunk_4": {"Ismethod": 1, "added_lines": "115,116,117,118", "deleted_lines": "115,116,117,118", "method_info": {"method_name": "test_exc_mutable_var_fail.mutable_var_check", "method_params": "", "method_startline": "115", "method_endline": "118"}}, "hunk_5": {"Ismethod": 1, "added_lines": "130,131,132,133,134,135,136,137,138,139,140,141", "deleted_lines": null, "method_info": {"method_name": "test_exc_post_fail.post_fail", "method_params": "waitall", "method_startline": "130", "method_endline": "141"}}, "hunk_6": {"Ismethod": 1, "added_lines": "146,147,148,149,150,151,152,153,154,155", "deleted_lines": null, "method_info": {"method_name": "test_exc_mutable_var_fail", "method_params": "", "method_startline": "146", "method_endline": "155"}}, "hunk_7": {"Ismethod": 1, "added_lines": "147,148,149,150,151,152,153", "deleted_lines": null, "method_info": {"method_name": "test_exc_mutable_var_fail.mutable_var_check", "method_params": "waitall", "method_startline": "147", "method_endline": "153"}}, "hunk_8": {"Ismethod": 1, "added_lines": "41,61,62,63,64,66,67,68,69", "deleted_lines": "41,61,63,65,66", "method_info": {"method_name": "test_exc_symbolic.symbolic", "method_params": "exec_backward,waitall", "method_startline": "41", "method_endline": "69"}}, "hunk_9": {"Ismethod": 1, "added_lines": "158,161,162,166", "deleted_lines": null, "method_info": {"method_name": "test_multiple_waitalls", "method_params": "", "method_startline": "158", "method_endline": "166"}}, "hunk_10": {"Ismethod": 1, "added_lines": "37", "deleted_lines": "37", "method_info": {"method_name": "test_exc_imperative", "method_params": "", "method_startline": "28", "method_endline": "37"}}, "hunk_11": {"Ismethod": 1, "added_lines": "101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123", "deleted_lines": "106,107,111,113,114,115,116,117,118,119", "method_info": {"method_name": "test_exc_multiple_waits.multiple_waits", "method_params": "waitall", "method_startline": "101", "method_endline": "123"}}, "hunk_12": {"Ismethod": 1, "added_lines": "79,89,90,91", "deleted_lines": "80,84,88,89,90,91,92", "method_info": {"method_name": "test_exc_gluon.gluon", "method_params": "exec_wait,waitall", "method_startline": "79", "method_endline": "92"}}, "hunk_13": {"Ismethod": 1, "added_lines": "79,89,90,91,95,96,97", "deleted_lines": "80,84,88,89,90,91,92,93,94,95,96,97", "method_info": {"method_name": "test_exc_gluon", "method_params": "", "method_startline": "78", "method_endline": "97"}}, "hunk_14": {"Ismethod": 1, "added_lines": "130,131,132,133,134,135,136,137,138,139,140,141,142,143", "deleted_lines": null, "method_info": {"method_name": "test_exc_post_fail", "method_params": "", "method_startline": "129", "method_endline": "143"}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tests\\python\\unittest\\test_operator.py", "file_new_name": "tests\\python\\unittest\\test_operator.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "7218,7219,7220,7221,7222,7223", "deleted_lines": "7213", "method_info": {"method_name": "test_op_all_names_monitor.check_name", "method_params": "op_sym,expected_names", "method_startline": "7210", "method_endline": "7225"}}, "hunk_1": {"Ismethod": 1, "added_lines": "7218,7219,7220,7221,7222,7223", "deleted_lines": "7213", "method_info": {"method_name": "test_op_all_names_monitor", "method_params": "", "method_startline": "7209", "method_endline": "7258"}}, "hunk_2": {"Ismethod": 1, "added_lines": "7167,7168,7169,7170,7171,7172", "deleted_lines": "7167", "method_info": {"method_name": "test_op_output_names_monitor.check_name", "method_params": "op_sym,expected_names", "method_startline": "7159", "method_endline": "7174"}}, "hunk_3": {"Ismethod": 1, "added_lines": "7167,7168,7169,7170,7171,7172", "deleted_lines": "7167", "method_info": {"method_name": "test_op_output_names_monitor", "method_params": "", "method_startline": "7158", "method_endline": "7207"}}}}}}}