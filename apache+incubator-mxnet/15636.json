{"BR": {"BR_id": "15636", "BR_author": "chaofanl", "BRopenT": "2019-07-23T06:19:50Z", "BRcloseT": "2019-07-28T04:30:03Z", "BR_text": {"BRsummary": "Benchmark/opperf on CPU", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n I manually test with below mxnet version the op test is successful\n commit c8a1de4\n Author: Aaron Markham markhama@amazon.com\n Date:   Thu Jul 18 00:12:45 2019 -0700\n but with eec0fb4, 9a1a102 the test failed.\n <denchmark-h:h2>Environment info (Required)</denchmark-h>\n \n <denchmark-code>Architecture:          x86_64\n CPU op-mode(s):        32-bit, 64-bit\n Byte Order:            Little Endian\n CPU(s):                112\n On-line CPU(s) list:   0-111\n Thread(s) per core:    2\n Core(s) per socket:    28\n Socket(s):             2\n NUMA node(s):          2\n Vendor ID:             GenuineIntel\n CPU family:            6\n Model:                 85\n Model name:            Intel(R) Xeon(R) Platinum 8180 CPU @ 2.50GHz\n Stepping:              4\n CPU MHz:               999.908\n CPU max MHz:           3800.0000\n CPU min MHz:           1000.0000\n BogoMIPS:              5000.00\n Virtualization:        VT-x\n L1d cache:             32K\n L1i cache:             32K\n L2 cache:              1024K\n L3 cache:              39424K\n NUMA node0 CPU(s):     0-27,56-83\n NUMA node1 CPU(s):     28-55,84-111\n Flags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch epb cat_l3 cdp_l3 intel_ppin intel_pt mba tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local ibpb ibrs stibp dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req pku ospke spec_ctrl intel_stibp\n ----------Python Info----------\n Version      : 3.6.8\n Compiler     : GCC 7.3.0\n Build        : ('default', 'Dec 30 2018 01:22:34')\n Arch         : ('64bit', '')\n ------------Pip Info-----------\n Version      : 19.0.3\n Directory    : /home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/site-packages/pip\n ----------MXNet Info-----------\n Version      : 1.5.0\n Directory    : /home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/site-packages/mxnet-1.5.0-py3.6.egg/mxnet\n Commit hash file \"/home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/site-packages/mxnet-1.5.0-py3.6.egg/mxnet/COMMIT_HASH\" not found. Not installed from pre-built package or built from source.\n Library      : ['/home/mxnet/workspace/source/intel-mxnet/lib/libmxnet.so', '/home/mxnet/workspace/source/intel-mxnet/lib/libmxnet.so', '/home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/site-packages/mxnet-1.5.0-py3.6.egg/mxnet/libmxnet.so']\n Build features:\n \u2716 CUDA\n \u2716 CUDNN\n \u2716 NCCL\n \u2716 CUDA_RTC\n \u2716 TENSORRT\n \u2714 CPU_SSE\n \u2714 CPU_SSE2\n \u2714 CPU_SSE3\n \u2714 CPU_SSE4_1\n \u2714 CPU_SSE4_2\n \u2716 CPU_SSE4A\n \u2714 CPU_AVX\n \u2716 CPU_AVX2\n \u2716 OPENMP\n \u2716 SSE\n \u2714 F16C\n \u2716 JEMALLOC\n \u2716 BLAS_OPEN\n \u2716 BLAS_ATLAS\n \u2714 BLAS_MKL\n \u2716 BLAS_APPLE\n \u2716 LAPACK\n \u2714 MKLDNN\n \u2714 OPENCV\n \u2716 CAFFE\n \u2716 PROFILER\n \u2716 DIST_KVSTORE\n \u2716 CXX14\n \u2716 INT64_TENSOR_SIZE\n \u2716 SIGNAL_HANDLER\n \u2716 DEBUG\n \u2716 TVM_OP\n ----------System Info----------\n Platform     : Linux-3.10.0-862.el7.x86_64-x86_64-with-centos-7.5.1804-Core\n system       : Linux\n node         : mlt-pytorch-skx00\n release      : 3.10.0-862.el7.x86_64\n version      : #1 SMP Fri Apr 20 16:44:24 UTC 2018\n ----------Hardware Info----------\n machine      : x86_64\n processor    : x86_64\n ----------Network Test----------\n Setting timeout: 10\n Timing for MXNet: https://github.com/apache/incubator-mxnet, DNS: 5.0509 sec, LOAD: 4.2777 sec.\n Timing for Gluon Tutorial(en): http://gluon.mxnet.io, DNS: 0.0290 sec, LOAD: 2.6436 sec.\n Timing for Gluon Tutorial(cn): https://zh.gluon.ai, DNS: 0.0421 sec, LOAD: 7.2299 sec.\n Timing for FashionMNIST: https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/dataset/fashion-mnist/train-labels-idx1-ubyte.gz, DNS: 0.0474 sec, LOAD: 3.5120 sec.\n Timing for PYPI: https://pypi.python.org/pypi/pip, DNS: 0.0284 sec, LOAD: 20.1918 sec.\n Timing for Conda: https://repo.continuum.io/pkgs/free/, DNS: 5.1155 sec, LOAD: 5.1667 sec.\n \n </denchmark-code>\n \n Package used (Python/R/Scala/Julia):\n (I'm using Python)\n 1.Python version: python3.68\n <denchmark-h:h2>Build info (Required if built from source)</denchmark-h>\n \n Compiler :gcc 5.3.1\n MXNet commit hash:\n <denchmark-link:https://github.com/apache/incubator-mxnet/commit/309659d1275f70571201cd1e7a2efa802bb5af96>309659d</denchmark-link>\n \n Build config:\n (Paste the content of config.mk, or the build command.)\n make -j USE_MKLDNN=1 USE_BLAS=mkl USE_OPENCV=1 USE_GPERFTOOLS=0\n <denchmark-h:h2>Error Message:</denchmark-h>\n \n (Paste the complete error message, including stack trace.)\n Error message:\n INFO:root:Complete Benchmark - random_negative_binomial\n INFO:root:Begin Benchmark - random_normal\n INFO:root:Complete Benchmark - random_normal\n Traceback (most recent call last):\n File \"benchmark/opperf/opperf.py\", line 157, in \n sys.exit(main())\n File \"benchmark/opperf/opperf.py\", line 142, in main\n final_benchmark_results = run_all_mxnet_operator_benchmarks(ctx=ctx, dtype=dtype)\n File \"benchmark/opperf/opperf.py\", line 73, in run_all_mxnet_operator_benchmarks\n mxnet_operator_benchmark_results.append(run_mx_random_sampling_operators_benchmarks(ctx=ctx, dtype=dtype))\n File \"/home/mxnet/workspace/source/intel-mxnet/benchmark/opperf/nd_operations/random_sampling_operators.py\", line 60, in run_mx_random_sampling_operators_benchmarks\n mx_random_sample_op_results = run_op_benchmarks(mx_random_sample_ops, dtype, ctx, warmup, runs)\n File \"/home/mxnet/workspace/source/intel-mxnet/benchmark/opperf/utils/benchmark_utils.py\", line 127, in run_op_benchmarks\n warmup=warmup, runs=runs)\n File \"/home/mxnet/workspace/source/intel-mxnet/benchmark/opperf/utils/benchmark_utils.py\", line 109, in run_performance_test\n benchmark_result = _run_nd_operator_performance_test(op, inputs, run_backward, warmup, runs, kwargs_list)\n File \"/home/mxnet/workspace/source/intel-mxnet/benchmark/opperf/utils/benchmark_utils.py\", line 54, in _run_nd_operator_performance_test\n _, _ = benchmark_helper_func(op, warmup, kwargs_list[0])\n File \"/home/mxnet/workspace/source/intel-mxnet/benchmark/opperf/utils/profiler_utils.py\", line 169, in profile_it\n res = func(args, kwargs)\n File \"/home/mxnet/workspace/source/intel-mxnet/benchmark/opperf/utils/ndarray_utils.py\", line 79, in nd_forward_and_profile\n res = op(args, kwargs)\n File \"\", line 59, in random_pdf_dirichlet\n File \"/home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/site-packages/mxnet-1.5.0-py3.6.egg/mxnet/_ctypes/ndarray.py\", line 92, in _imperative_invoke\n ctypes.byref(out_stypes)))\n File \"/home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/site-packages/mxnet-1.5.0-py3.6.egg/mxnet/base.py\", line 253, in check_call\n raise MXNetError(py_str(_LIB.MXGetLastError()))\n mxnet.base.MXNetError: [09:07:10] src/c_api/../imperative/imperative_utils.h:369: Check failed: num_inputs == infered_num_inputs (1 vs. 2) : Operator _random_pdf_dirichlet expects 2 inputs, but got 1 instead.\n Stack trace:\n [bt] (0) /home/mxnet/workspace/source/intel-mxnet/lib/libmxnet.so(dmlc::LogMessageFatal::~LogMessageFatal()+0x2b) [0x7f40c979003b]\n [bt] (1) /home/mxnet/workspace/source/intel-mxnet/lib/libmxnet.so(mxnet::imperative::SetNumOutputs(nnvm::Op const, nnvm::NodeAttrs const&, int const&, int, int)+0x1fd) [0x7f40cc742d5d]\n [bt] (2) /home/mxnet/workspace/source/intel-mxnet/lib/libmxnet.so(MXImperativeInvokeImpl(void, int, void, int, void**, int, char const**, char const**)+0x403) [0x7f40cc740fe3]\n [bt] (3) /home/mxnet/workspace/source/intel-mxnet/lib/libmxnet.so(MXImperativeInvokeEx+0x6f) [0x7f40cc74169f]\n [bt] (4) /home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/lib-dynload/../../libffi.so.6(ffi_call_unix64+0x4c) [0x7f40dd8fbec0]\n [bt] (5) /home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/lib-dynload/../../libffi.so.6(ffi_call+0x22d) [0x7f40dd8fb87d]\n [bt] (6) /home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/lib-dynload/_ctypes.cpython-36m-x86_64-linux-gnu.so(_ctypes_callproc+0x2ce) [0x7f40ddb11ede]\n [bt] (7) /home/mxnet/anacondaenv/anaconda3_mxnet/envs/mxnet_daily_py3/lib/python3.6/lib-dynload/_ctypes.cpython-36m-x86_64-linux-gnu.so(+0x13915) [0x7f40ddb12915]\n [bt] (8) python(_PyObject_FastCallDict+0x8b) [0x55cf5544d92b]\n <denchmark-h:h2>Minimum reproducible example</denchmark-h>\n \n (If you are using your own code, please provide a short script that reproduces the error. Otherwise, please provide link to the existing example.)\n <denchmark-h:h2>Steps to reproduce</denchmark-h>\n \n (Paste the commands you ran that produced the error.)\n 1.export PYTHONPATH=$PYTHONPATH:/path/to/mxnet/code/\n 2.  python benchmark/opperf/opperf.py --output-format json --output-file mxnet_operator_benchmark_results.json\n <denchmark-h:h2>What have you tried to solve it?</denchmark-h>\n \n no\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "chaofanl", "commentT": "2019-07-23T06:19:53Z", "comment_text": "\n \t\tHey, this is the MXNet Label Bot.\n Thank you for submitting the issue! I will try and suggest some labels so that the appropriate MXNet community members can help resolve it.\n Here are my recommended labels: Test\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "chaofanl", "commentT": "2019-07-26T22:07:48Z", "comment_text": "\n \t\tcc: <denchmark-link:https://github.com/ChaiBapchya>@ChaiBapchya</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "33ea2dbe4cb179ab3f3a76cfd9dcfb0930887ed1", "commit_author": "Chaitanya Prakash Bapat", "commitT": "2019-07-27 21:30:01-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "benchmark\\opperf\\README.md", "file_new_name": "benchmark\\opperf\\README.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "78", "deleted_lines": "78"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "benchmark\\opperf\\rules\\default_params.py", "file_new_name": "benchmark\\opperf\\rules\\default_params.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "37,77,106", "deleted_lines": "104"}}}}}}