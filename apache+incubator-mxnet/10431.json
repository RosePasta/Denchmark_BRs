{"BR": {"BR_id": "10431", "BR_author": "anirudh2290", "BRopenT": "2018-04-06T01:34:19Z", "BRcloseT": "2018-04-12T22:49:21Z", "BR_text": {"BRsummary": "Elementwise multiplication of two ndarrays returns wrong results", "BRdescription": "\n Note: Providing complete information in the most concise form is the best way to get help. This issue template serves as the checklist for essential information to most of the technical issues and bug reports. For non-technical issues and feature requests, feel free to present the information in what you believe is the best form.\n For Q & A and discussion, please start a discussion thread at <denchmark-link:https://discuss.mxnet.io>https://discuss.mxnet.io</denchmark-link>\n \n <denchmark-h:h2>Description</denchmark-h>\n \n Elementwise multiplication of two ndarrays returns wrong results\n <denchmark-h:h2>Environment info (Required)</denchmark-h>\n \n python, built from source, USE_CUDA=OFF, USE_CUDNN=OFF\n MXNet commit hash:\n (Paste the output of  here.)\n <denchmark-link:https://github.com/apache/incubator-mxnet/commit/f60094053e5f2c233bb39b63bdd16503875a4551>f600940</denchmark-link>\n \n <denchmark-h:h2>Error Message:</denchmark-h>\n \n <denchmark-code>AssertionError:\n Items are not equal:\n Error 100000.000000 exceeds tolerance rtol=0.000010, atol=0.000000.  Location of maximum error:(0, 2), a=0.098160, b=-375054495907840.000000\n  a: array([[ 0.88395894,  0.0185979 ,  0.09815959,  0.24501987]], dtype=float32)\n  b: array([[  8.83958936e-01,   1.85978990e-02,  -3.75054496e+14,\n           2.45019868e-01]], dtype=float32)\n </denchmark-code>\n \n <denchmark-h:h2>Minimum reproducible example</denchmark-h>\n \n export MXNET_ENGINE_TYPE=NaiveEngine\n <denchmark-code>import mxnet as mx\n from mxnet.test_utils import *\n \n x = mx.nd.array(np.random.uniform(-1, 1, size=(1, 4)))\n x = x.tostype('csr')\n #x.attach_grad()\n print(x.asnumpy())\n z2 = x * x\n z1 = mx.nd.sparse.square(x)\n assert_almost_equal(z1.asnumpy(), z2.asnumpy())\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "anirudh2290", "commentT": "2018-04-06T02:02:38Z", "comment_text": "\n \t\tThis seems to work on the current nightly pip package which uses the commit <denchmark-link:https://github.com/apache/incubator-mxnet/commit/5245ef68191a6d47594bf331ec6e20ba6e93ad4c>5245ef6</denchmark-link>\n   from April 2.\n It also can't be reproduced on <denchmark-link:https://github.com/apache/incubator-mxnet/commit/44f4ebd5f49ad19f82f698a7e3411998ba6947ff>44f4ebd</denchmark-link>\n .\n Looks like the bug was introduced after that.\n Btw <denchmark-link:https://github.com/szha>@szha</denchmark-link>\n  The latest pip --pre package used the above commit from April 2. Is the package not built nighly?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "anirudh2290", "commentT": "2018-04-06T02:04:14Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/eric-haibin-lin>@eric-haibin-lin</denchmark-link>\n  please tag as bug.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "anirudh2290", "commentT": "2018-04-06T04:26:59Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/rahul003>@rahul003</denchmark-link>\n  can you try  instead of ?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "anirudh2290", "commentT": "2018-04-06T08:49:29Z", "comment_text": "\n \t\telemwise_mul has the same behavior crashes on the current master\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "anirudh2290", "commentT": "2018-04-12T22:01:55Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/anirudh2290>@anirudh2290</denchmark-link>\n  Could you close this? I thought that would be done automatically by linking PR to an issue?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "anirudh2290", "commentT": "2018-04-12T22:50:19Z", "comment_text": "\n \t\tYou have to add fix <PR_NO> in the PR for it to automatically close.\n \t\t"}}}, "commit": {"commit_id": "8b172d7fff080f8d3aa3596779a1e09e602fbe08", "commit_author": "Rahul Huilgol", "commitT": "2018-04-10 11:59:41-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\operator\\tensor\\elemwise_binary_op-inl.h", "file_new_name": "src\\operator\\tensor\\elemwise_binary_op-inl.h", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "291,295,297,299,300,338,339,340,341,342,343,344,345,346,347,348,349,350,370", "deleted_lines": "291,334,335,336,337,338,339,340,341,342,343,344,364", "method_info": {"method_name": "mxnet::op::ElemwiseBinaryOp::CsrCsrOp", "method_params": "s,attrs,ctx,lhs,rhs,req,output", "method_startline": "248", "method_endline": "375"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tests\\python\\unittest\\test_sparse_ndarray.py", "file_new_name": "tests\\python\\unittest\\test_sparse_ndarray.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "264", "deleted_lines": null, "method_info": {"method_name": "test_sparse_nd_binary", "method_params": "", "method_startline": "243", "method_endline": "277"}}, "hunk_1": {"Ismethod": 1, "added_lines": "264", "deleted_lines": null, "method_info": {"method_name": "test_sparse_nd_binary.check_binary", "method_params": "fn,stype", "method_startline": "245", "method_endline": "264"}}}}}}}