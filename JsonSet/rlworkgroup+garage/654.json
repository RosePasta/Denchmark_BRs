{"BR": {"BR_id": "654", "BR_author": "zequnyu", "BRopenT": "2019-05-13T18:44:54Z", "BRcloseT": "2019-05-24T22:48:18Z", "BR_text": {"BRsummary": "Master branch can't pass make test", "BRdescription": "\n Current master branch can't pass make test. However the failed tests will pass when running unittest separately.\n <denchmark-code>======================================================================\n ERROR: test_dm_control_tf_policy (tests.garage.envs.dm_control.test_dm_control_tf_policy.TestDmControlTfPolicy)\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"/root/code/garage/tests/garage/envs/dm_control/test_dm_control_tf_policy.py\", line 38, in test_dm_control_tf_policy\n     runner.train(n_epochs=1, batch_size=10)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n     start_epoch=0)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n     self.save(epoch, paths if store_paths else None)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n     snapshotter.save_itr_params(epoch, params)\n   File \"/root/code/garage/garage/logger/snapshotter.py\", line 85, in save_itr_params\n     with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpgplyc983/params.pkl'\n \n ======================================================================\n ERROR: test_cem_cartpole (tests.garage.np.algos.test_cem.TestCEM)\n Test CEM with Cartpole-v1 environment.\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"/root/code/garage/tests/garage/np/algos/test_cem.py\", line 35, in test_cem_cartpole\n     n_epochs=5, batch_size=2000, n_epoch_cycles=n_samples)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n     start_epoch=0)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n     self.save(epoch, paths if store_paths else None)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n     snapshotter.save_itr_params(epoch, params)\n   File \"/root/code/garage/garage/logger/snapshotter.py\", line 85, in save_itr_params\n     with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpgplyc983/params.pkl'\n \n ======================================================================\n ERROR: test_cma_es_cartpole (tests.garage.np.algos.test_cma_es.TestCMAES)\n Test CMAES with Cartpole-v1 environment.\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"/root/code/garage/tests/garage/np/algos/test_cma_es.py\", line 33, in test_cma_es_cartpole\n     runner.train(n_epochs=1, batch_size=1000, n_epoch_cycles=n_samples)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n     start_epoch=0)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n     self.save(epoch, paths if store_paths else None)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n     snapshotter.save_itr_params(epoch, params)\n   File \"/root/code/garage/garage/logger/snapshotter.py\", line 85, in save_itr_params\n     with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpgplyc983/params.pkl'\n \n ======================================================================\n FAIL: test_trpo_recurrent_cartpole (tests.garage.tf.algos.test_trpo_with_model.TestTRPO)\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"/root/code/garage/tests/garage/tf/algos/test_trpo_with_model.py\", line 39, in test_trpo_recurrent_cartpole\n     assert last_avg_ret > 90\n AssertionError\n \n ----------------------------------------------------------------------\n Ran 623 tests in 789.240s\n \n FAILED (failures=1, errors=3)\n Makefile:60: recipe for target 'run-headless' failed\n make: *** [run-headless] Error 1\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "zequnyu", "commentT": "2019-05-13T19:09:44Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/rlworkgroup/garage/pull/651>#651</denchmark-link>\n  should fix the last error.\n <denchmark-link:https://github.com/zequnyu>@zequnyu</denchmark-link>\n  can you debug the other 3? they are probably related to the snapshotter and/or experiment runner.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "zequnyu", "commentT": "2019-05-15T00:14:36Z", "comment_text": "\n \t\tSimilar issue with more tests on work machine\n \n Logs\n ```\n ======================================================================\n ERROR: test_cem_cartpole (tests.garage.np.algos.test_cem.TestCEM)\n Test CEM with Cartpole-v1 environment.\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"/root/code/garage/tests/garage/np/algos/test_cem.py\", line 35, in test_cem_cartpole\n     n_epochs=5, batch_size=2000, n_epoch_cycles=n_samples)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n     start_epoch=0)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n     self.save(epoch, paths if store_paths else None)\n   File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n     snapshotter.save_itr_params(epoch, params)\n   File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n     with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_cma_es_cartpole (tests.garage.np.algos.test_cma_es.TestCMAES)\n Test CMAES with Cartpole-v1 environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/np/algos/test_cma_es.py\", line 33, in test_cma_es_cartpole\n runner.train(n_epochs=1, batch_size=1000, n_epoch_cycles=n_samples)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_dm_control_tf_policy (tests.garage.envs.dm_control.test_dm_control_tf_policy.TestDmControlTfPolicy)\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/envs/dm_control/test_dm_control_tf_policy.py\", line 38, in test_dm_control_tf_policy\n runner.train(n_epochs=1, batch_size=10)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_categorical_policies:1\n <class 'garage.tf.policies.categorical_gru_policy.CategoricalGRUPolicy'> (tests.garage.tf.policies.test_categorical_policies.TestCategoricalPolicies)\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/policies/test_categorical_policies.py\", line 47, in test_categorical_policies\n runner.train(n_epochs=1, batch_size=4000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_categorical_policies:2\n <class 'garage.tf.policies.categorical_lstm_policy.CategoricalLSTMPolicy'> (tests.garage.tf.policies.test_categorical_policies.TestCategoricalPolicies)\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/policies/test_categorical_policies.py\", line 47, in test_categorical_policies\n runner.train(n_epochs=1, batch_size=4000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_categorical_policies:3\n <class 'garage.tf.policies.categorical_mlp_policy.CategoricalMLPPolicy'> (tests.garage.tf.policies.test_categorical_policies.TestCategoricalPolicies)\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/policies/test_categorical_policies.py\", line 47, in test_categorical_policies\n runner.train(n_epochs=1, batch_size=4000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_gaussian_policies:1\n <class 'garage.tf.policies.gaussian_gru_policy.GaussianGRUPolicy'> (tests.garage.tf.policies.test_gaussian_policies.TestGaussianPolicies)\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/policies/test_gaussian_policies.py\", line 43, in test_gaussian_policies\n runner.train(n_epochs=1, batch_size=4000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_gaussian_policies:2\n <class 'garage.tf.policies.gaussian_lstm_policy.GaussianLSTMPolicy'> (tests.garage.tf.policies.test_gaussian_policies.TestGaussianPolicies)\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/policies/test_gaussian_policies.py\", line 43, in test_gaussian_policies\n runner.train(n_epochs=1, batch_size=4000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_gaussian_policies:3\n <class 'garage.tf.policies.gaussian_mlp_policy.GaussianMLPPolicy'> (tests.garage.tf.policies.test_gaussian_policies.TestGaussianPolicies)\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/policies/test_gaussian_policies.py\", line 43, in test_gaussian_policies\n runner.train(n_epochs=1, batch_size=4000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_ddpg_pendulum (tests.garage.tf.algos.test_ddpg.TestDDPG)\n Test DDPG with Pendulum environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_ddpg.py\", line 52, in test_ddpg_pendulum\n n_epochs=10, n_epoch_cycles=20, batch_size=100)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_vpg_cartpole (tests.garage.tf.algos.test_vpg.TestVPG)\n Test VPG with CartPole-v1 environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_vpg.py\", line 31, in test_vpg_cartpole\n last_avg_ret = runner.train(n_epochs=10, batch_size=10000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_erwr_cartpole (tests.garage.tf.algos.test_erwr.TestERWR)\n Test ERWR with Cartpole-v1 environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_erwr.py\", line 29, in test_erwr_cartpole\n last_avg_ret = runner.train(n_epochs=10, batch_size=10000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_dqn_cartpole (tests.garage.tf.algos.test_dqn.TestDQN)\n Test DQN with CartPole environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_dqn.py\", line 57, in test_dqn_cartpole\n batch_size=sampler_batch_size)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_dqn_cartpole_double_q (tests.garage.tf.algos.test_dqn.TestDQN)\n Test DQN with CartPole environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_dqn.py\", line 101, in test_dqn_cartpole_double_q\n batch_size=sampler_batch_size)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_dqn_cartpole_grad_clip (tests.garage.tf.algos.test_dqn.TestDQN)\n Test DQN with CartPole environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_dqn.py\", line 146, in test_dqn_cartpole_grad_clip\n batch_size=sampler_batch_size)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_trpo_pendulum (tests.garage.tf.algos.test_trpo.TestTRPO)\n Test TRPO with Pendulum environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_trpo.py\", line 41, in test_trpo_pendulum\n last_avg_ret = runner.train(n_epochs=10, batch_size=2048)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_reps_cartpole (tests.garage.tf.algos.test_reps.TestREPS)\n Test REPS with gym Cartpole environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_reps.py\", line 38, in test_reps_cartpole\n last_avg_ret = runner.train(n_epochs=10, batch_size=4000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_tnpg_inverted_pendulum (tests.garage.tf.algos.test_tnpg.TestTNPG)\n Test TNPG with InvertedPendulum-v2 environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_tnpg.py\", line 33, in test_tnpg_inverted_pendulum\n last_avg_ret = runner.train(n_epochs=10, batch_size=10000)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_ppo_pendulum_with_model (tests.garage.tf.algos.test_ppo_with_models.TestPPOWithModel)\n Test PPO with model, with Pendulum environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_ppo_with_models.py\", line 42, in test_ppo_pendulum_with_model\n last_avg_ret = runner.train(n_epochs=10, batch_size=2048)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_ppo_pendulum (tests.garage.tf.algos.test_ppo.TestPPO)\n Test PPO with Pendulum environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_ppo.py\", line 41, in test_ppo_pendulum\n last_avg_ret = runner.train(n_epochs=10, batch_size=2048)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_ppo_pendulum_recurrent (tests.garage.tf.algos.test_ppo.TestPPO)\n Test PPO with Pendulum environment and recurrent policy.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_ppo.py\", line 66, in test_ppo_pendulum_recurrent\n last_avg_ret = runner.train(n_epochs=10, batch_size=2048)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_trpo_recurrent_cartpole (tests.garage.tf.algos.test_trpo_with_model.TestTRPO)\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_trpo_with_model.py\", line 38, in test_trpo_recurrent_cartpole\n last_avg_ret = runner.train(n_epochs=10, batch_size=2048)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_ppo_pendulum_with_model (tests.garage.tf.algos.test_ppo_with_model.TestPPOWithModel)\n Test PPO with model, with Pendulum environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_ppo_with_model.py\", line 42, in test_ppo_pendulum_with_model\n last_avg_ret = runner.train(n_epochs=10, batch_size=2048)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n ======================================================================\n ERROR: test_npo_pendulum (tests.garage.tf.algos.test_npo.TestNPO)\n Test NPO with Pendulum environment.\n Traceback (most recent call last):\n File \"/root/code/garage/tests/garage/tf/algos/test_npo.py\", line 41, in test_npo_pendulum\n last_avg_ret = runner.train(n_epochs=10, batch_size=2048)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 321, in train\n start_epoch=0)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 407, in _train\n self.save(epoch, paths if store_paths else None)\n File \"/root/code/garage/garage/experiment/local_tf_runner.py\", line 210, in save\n snapshotter.save_itr_params(epoch, params)\n File \"/root/code/garage/garage/experiment/snapshotter.py\", line 86, in save_itr_params\n with open(file_name, 'wb') as file:\n FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpc4b1c6zj/params.pkl'\n \n </details>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "zequnyu", "commentT": "2019-05-15T21:31:27Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/naeioi>@naeioi</denchmark-link>\n  do you have any ideas why? this seems related to snapshots.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "zequnyu", "commentT": "2019-05-15T22:13:24Z", "comment_text": "\n \t\tI'll try to debug it.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "zequnyu", "commentT": "2019-05-18T01:11:54Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/naeioi>@naeioi</denchmark-link>\n  Should (or can) we reset the snapshotter when initialise the LocalRunner? I think it may be related to it.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "zequnyu", "commentT": "2019-05-18T06:06:38Z", "comment_text": "\n \t\tSorry missed your ats. I think <denchmark-link:https://github.com/gitanshu>@gitanshu</denchmark-link>\n  can confirm that <denchmark-link:https://github.com/rlworkgroup/garage/commit/3cf14b76e91acda52a2a1aeb54558f750a12665f>3cf14b7</denchmark-link>\n  can pass . Let me see what's going on here...\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "zequnyu", "commentT": "2019-05-18T06:28:55Z", "comment_text": "\n \t\tThe only case when python fails to open a file for writing saying file does not exist is that some prefix folder of target path does not exist.\n The bug is mostly introduced by <denchmark-link:https://github.com/rlworkgroup/garage/commit/af9eb8925e7226f4649a2280172b0be1cc3cfb0b#diff-376aa7ef418e8ba410f6c145d3364fdaR10>af9eb89#diff-376aa7ef418e8ba410f6c145d3364fdaR10</denchmark-link>\n  and <denchmark-link:https://github.com/rlworkgroup/garage/commit/af9eb8925e7226f4649a2280172b0be1cc3cfb0b#diff-240273a5a2365c0a8e548b8aa4fcf011R127>af9eb89#diff-240273a5a2365c0a8e548b8aa4fcf011R127</denchmark-link>\n , where two snapshottors are created.\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "zequnyu", "commentT": "2019-05-20T19:53:15Z", "comment_text": "\n \t\tis this fixed?\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "zequnyu", "commentT": "2019-05-20T21:22:16Z", "comment_text": "\n \t\tStill working on it.\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "zequnyu", "commentT": "2019-05-21T18:38:59Z", "comment_text": "\n \t\tThe problem is because temp dir is deleted <denchmark-link:https://github.com/rlworkgroup/garage/blob/a5277f42912e654bc5f0cb541d4557ca3a2c0bb4/tests/garage/experiment/test_resume.py#L61>here</denchmark-link>\n  while the snapshotter () isn't reset. This causes problem for all the following tests using  for  <denchmark-link:https://github.com/rlworkgroup/garage/blob/a5277f42912e654bc5f0cb541d4557ca3a2c0bb4/garage/experiment/snapshotter.py#L59>here</denchmark-link>\n  should be None.\n <denchmark-link:https://github.com/gitanshu>@gitanshu</denchmark-link>\n  Please check if <denchmark-link:https://github.com/rlworkgroup/garage/commit/d32ee6865fd6302f370af544ae0a58f98d970a4d>this</denchmark-link>\n  fix works on your machine.\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "zequnyu", "commentT": "2019-05-21T19:32:01Z", "comment_text": "\n \t\tI think we should add something to let the  reset itself in due time. Otherwise we are at risk when the life cycle of  becomes longer than the . What's the plan for the future usage of ? Use one  to handle several Runner? <denchmark-link:https://github.com/naeioi>@naeioi</denchmark-link>\n \n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "zequnyu", "commentT": "2019-05-21T19:39:08Z", "comment_text": "\n \t\tInteresting. \n \n \n garage/tests/garage/experiment/test_resume.py\n \n \n          Line 61\n       in\n       a5277f4\n \n \n \n \n \n \n  shutil.rmtree(folder) \n \n \n \n \n  deletes a folder, but it is generated by tempfile, not directly from shopshotter. Why it breaks thing?\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "zequnyu", "commentT": "2019-05-21T19:59:00Z", "comment_text": "\n \t\t\n The problem is because temp dir is deleted here while the snapshotter (_snapshot_dir) isn't reset. This causes problem for all the following tests using  save_itr_params() for _snapshot_dir here should be None.\n @gitanshu Please check if this fix works on your machine.\n \n <denchmark-link:https://github.com/zequnyu>@zequnyu</denchmark-link>\n  no idea what's going on, but the patch works\n \t\t"}, "comments_13": {"comment_id": 14, "comment_author": "zequnyu", "commentT": "2019-05-21T20:32:01Z", "comment_text": "\n \t\tWe are currently instantiate the  inside its implementation <denchmark-link:https://github.com/rlworkgroup/garage/blob/a5277f42912e654bc5f0cb541d4557ca3a2c0bb4/garage/experiment/snapshotter.py#L127>class</denchmark-link>\n . When doing tests,  in LocalRunner will only import once. This means we are using the same  in tests. That's why I ask whether we plan to use one snapshotter to handle several Runner.\n I think it is because _snapshot_dir is not set to None so following tests mistake the path. So this breaks things instead of the delete.\n \t\t"}, "comments_14": {"comment_id": 15, "comment_author": "zequnyu", "commentT": "2019-05-22T03:13:31Z", "comment_text": "\n \t\tAh got your idea. Nice catch! Please make this a PR. <denchmark-link:https://github.com/zequnyu>@zequnyu</denchmark-link>\n \n \t\t"}, "comments_15": {"comment_id": 16, "comment_author": "zequnyu", "commentT": "2019-05-22T18:01:50Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/zequnyu>@zequnyu</denchmark-link>\n  Good catch!\n To solve this issue long-term, we should probably have the LocalRunner create a snapshotter instance it owns, rather than having the process-global snapshotter. It is process-global because of previous design decisions, but it doesn't have to be.\n <denchmark-link:https://github.com/naeioi>@naeioi</denchmark-link>\n  do you think it would be better just to eliminate the process-global snapshotter? It would make bugs like this impossible.\n \t\t"}, "comments_16": {"comment_id": 17, "comment_author": "zequnyu", "commentT": "2019-05-24T02:36:01Z", "comment_text": "\n \t\tI agree. This global process snapshotter is flaky. <denchmark-link:https://github.com/gautams3>@gautams3</denchmark-link>\n  also experienced a similar bug, that there were two instances of snapshotter, of which one is initialized and the other is not.\n Because we take snapshot only at LocalRunner, I think it will not be too much effort removing this global snapshotter.\n \t\t"}, "comments_17": {"comment_id": 18, "comment_author": "zequnyu", "commentT": "2019-05-24T16:19:25Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ryanjulian>@ryanjulian</denchmark-link>\n  Shall I file an issue and address the change?\n \t\t"}, "comments_18": {"comment_id": 19, "comment_author": "zequnyu", "commentT": "2019-05-24T16:40:50Z", "comment_text": "\n \t\tyes please!\n \t\t"}}}, "commit": {"commit_id": "4efb0e3798aa8480174573e67b926ae071e66721", "commit_author": "Anthony Yu", "commitT": "2019-05-23 23:38:18-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\fixtures\\fixtures.py", "file_new_name": "tests\\fixtures\\fixtures.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "37,38", "deleted_lines": null, "method_info": {"method_name": "tearDown", "method_params": "self", "method_startline": "32", "method_endline": "43"}}}}}}}