{"BR": {"BR_id": "366", "BR_author": "Aidan-OS", "BRopenT": "2020-06-27T21:48:53Z", "BRcloseT": "2020-06-29T20:57:53Z", "BR_text": {"BRsummary": "Photos Missing from \"Photos\" section", "BRdescription": "\n Almost 2 months ago I began working with your software and raised <denchmark-link:https://github.com/photoprism/photoprism/issues/296>this issue</denchmark-link>\n . Recently I have been able to start working on this project again, and am still having a similar error.\n I have restarted from scratch, and have made sure that the NSFW filters are correct (PHOTOPRISM_DETECT_NSFW is false and PHOTOPRISM_UPLOAD_NSFW is true).\n When I have uploaded the files through the browser (Chrome v83.0.4103.116), the \"Photos\" tab reports 83 photos, however when I go to browse and add tags to these photos, only 45 appear. Some of the photos that are missing are not in any way NSFW, and they are metadataless PNG files (as mentioned in the old issue, art of a friend's).\n Since my last work with the software, a new section has been added that allows me to see all the raw files under the \"Library\" tab. The \"Originals\" section of the 'Library\" tab reports 101 photos, and when I go to view them, I find that all 83 of the photos I have uploaded are there, but I am unable to categorize them, as they appear to not be indexed and are not shown in the \"Photos\" tab.\n I have tried re-indexing my entire library, with no change. Are there other things for me to try?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "Aidan-OS", "commentT": "2020-06-28T06:02:13Z", "comment_text": "\n \t\tIf you see the files in originals, they have been indexed. Maybe they are under review or grouped together?\n In every case, it's important to test with a fresh database.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "Aidan-OS", "commentT": "2020-06-28T06:12:11Z", "comment_text": "\n \t\tThis is a completely new database, and even a new installation of Linux.\n There is no \u201cFor Review\u201d section, as I have the low quality filter off, and when turning it on the new pictures do not show up. I have searched everywhere for the images, and I cannot find them in any location other than \u201cLibrary\u201d.\n Tomorrow I will start a new instance with different photos in an attempt to re-create the problem so that I can share my server link with you\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "Aidan-OS", "commentT": "2020-06-28T06:31:04Z", "comment_text": "\n \t\tYou can also try to create an album directly from the files / folders you see in originals.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "Aidan-OS", "commentT": "2020-06-28T16:53:24Z", "comment_text": "\n \t\tI have created an album, then added the photos to it. This is the result:\n <denchmark-link:https://user-images.githubusercontent.com/1919827/85953239-ef2b7380-b93c-11ea-9636-a6d74936ae91.png></denchmark-link>\n \n <denchmark-link:https://user-images.githubusercontent.com/1919827/85953251-ffdbe980-b93c-11ea-957f-be1174089e20.png></denchmark-link>\n \n If I add one of the images that I can see in the main \"Photos\" tab to the album, it shows up without issue.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "Aidan-OS", "commentT": "2020-06-28T17:41:18Z", "comment_text": "\n \t\tI agree, this is strange but can't confirm it with my own testing. All I can do is guess, like it might be a permission problem in the file system, photos might still be private as you didn't delete YAML sidecar files, etc...\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "Aidan-OS", "commentT": "2020-06-28T17:42:23Z", "comment_text": "\n \t\tAlso it might be an encoding issue. Do you see anything in Library > Hidden?\n <denchmark-link:https://user-images.githubusercontent.com/301686/85954531-68948780-b978-11ea-8c32-3a11fb28800c.png></denchmark-link>\n \n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "Aidan-OS", "commentT": "2020-06-28T19:02:15Z", "comment_text": "\n \t\tNope, nothing in Library > Hidden. I don't know how YAML sidecar files could still be there, as this is a new linux instance. There is absolutely nothing left over from my last attempt in May.\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "Aidan-OS", "commentT": "2020-06-28T19:32:30Z", "comment_text": "\n \t\tOkay. I have managed to recreate the error only using SFW images. I performed uploads from both my phone using Google Chrome and my Desktop, also using Google Chrome. I included one of the SFW known problematic images in my desktop upload and it has promptly not shown up properly.\n While I am not comfortable sharing the IP of the server publically, I am okay with sending it privately so that you can test. I did this on another completely new install of linux, specifically Ubuntu Bionic Beaver.\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "Aidan-OS", "commentT": "2020-06-28T19:58:05Z", "comment_text": "\n \t\tYou're welcome to contact us directly via <denchmark-link:mailto:hello@photoprism.org>hello@photoprism.org</denchmark-link>\n  :)\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "Aidan-OS", "commentT": "2020-06-29T05:46:29Z", "comment_text": "\n \t\tNot sure how you managed to index files without converting PNGs to JPEG and creating thumbs, but a rescan completely fixed it:\n <denchmark-link:https://user-images.githubusercontent.com/301686/85977207-6e23b900-b9dc-11ea-83c5-69a650ac4da0.png></denchmark-link>\n \n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "Aidan-OS", "commentT": "2020-06-29T14:07:21Z", "comment_text": "\n \t\tFirst of all, I went to check the server this morning and noticed that somehow it got some of the photos that I was using for testing on the previous server. I have no idea how that happened, and am sorry for unexpectedly possibly exposing you to that. I clearly do not know how certain aspects of the photo storing function, as things were left behind.\n As for using the complete re-scan, this did not work. It is understandable to think that it had worked because of what had happened, but that is not the case. When using the index function, it does not seem to convert pngs to jpeg thumbnails. All the images that became available upon indexing were the ones from my tests that worked, and there were still plenty of missing photos.\n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "Aidan-OS", "commentT": "2020-06-29T14:34:04Z", "comment_text": "\n \t\tI have now properly cleaned everything and re-indexed, and you can see that the single item in 2020/06 is not being given a thumbnail and only resides in the originals tab. This image was uploaded through chrome, and I have re-indexed since it was uploaded.\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "Aidan-OS", "commentT": "2020-06-29T14:57:44Z", "comment_text": "\n \t\tThanks, I can now see that the file type is \"png\" while the mime type is \"image/jpeg\", so it's probably a JPEG but with a wrong type extension. We should trust the mime type in this case and change the file type to \"jpg\", ignoring the extension.\n \t\t"}, "comments_13": {"comment_id": 14, "comment_author": "Aidan-OS", "commentT": "2020-06-29T15:08:53Z", "comment_text": "\n \t\tI have a feeling this is due to interactions with Google Drive and Apple Devices. While I do not have access to the exact images I am meant to be storing yet, I have gone through what my friend has done with their photos: Create on Apple mobile device, upload to Google Drive. Since I will eventually be downloading all the images off Google Drive and uploading them directly to Photoprism, I decided to test that first. Apple mobile devices appear to store as jpeg files, but they become png files when uploaded to google drive.\n This would also explain why I didn't appear to have problems testing the method of uploading that will be used after the shift, which is direct upload from Apple mobile device. They are properly stored as jpeg files in that case.\n \t\t"}, "comments_14": {"comment_id": 15, "comment_author": "Aidan-OS", "commentT": "2020-06-29T15:28:53Z", "comment_text": "\n \t\tChanges will be part of our next Docker build, probably tomorrow.\n \t\t"}, "comments_15": {"comment_id": 16, "comment_author": "Aidan-OS", "commentT": "2020-06-29T15:42:38Z", "comment_text": "\n \t\tFantastic! Notify me when that has been updated and I will test it out.\n \t\t"}, "comments_16": {"comment_id": 17, "comment_author": "Aidan-OS", "commentT": "2020-06-29T20:26:31Z", "comment_text": "\n \t\tLatest image contains the fix plus a password change form.\n \t\t"}, "comments_17": {"comment_id": 18, "comment_author": "Aidan-OS", "commentT": "2020-06-29T20:57:49Z", "comment_text": "\n \t\tWonderful! I have set everything back up, indexed my files, and everything appears!\n \t\t"}}}, "commit": {"commit_id": "1cf3d19f457d8087b04fe6b812708a359b177af0", "commit_author": "Michael Mayer", "commitT": "2020-06-29 17:25:52+02:00", "changed_files": {"file_0": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "assets\\examples\\this-is-a-jpeg.png", "file_new_name": "assets\\examples\\this-is-a-jpeg.png"}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "internal\\photoprism\\mediafile.go", "file_new_name": "internal\\photoprism\\mediafile.go", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "548,549,550,551", "deleted_lines": null, "method_info": {"method_name": "FileType", "method_params": "", "method_startline": "547", "method_endline": "553"}}, "hunk_1": {"Ismethod": 1, "added_lines": "561,562", "deleted_lines": "557,558,562", "method_info": {"method_name": "HasFileType", "method_params": "FileType", "method_startline": "557", "method_endline": "563"}}, "hunk_2": {"Ismethod": 1, "added_lines": "561,562,566", "deleted_lines": "562", "method_info": {"method_name": "HasFileType", "method_params": "FileType", "method_startline": "561", "method_endline": "567"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 45, "file_old_name": "internal\\photoprism\\mediafile_test.go", "file_new_name": "internal\\photoprism\\mediafile_test.go", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "305,306,307,314,315,316", "deleted_lines": "305,314", "method_info": {"method_name": "TestMediaFile_Exposure", "method_params": "T", "method_startline": "300", "method_endline": "319"}}, "hunk_1": {"Ismethod": 1, "added_lines": "529,530,531", "deleted_lines": "547", "method_info": {"method_name": "TestMediaFile_RelativeFilename", "method_params": "T", "method_startline": "525", "method_endline": "550"}}, "hunk_2": {"Ismethod": 1, "added_lines": "838,839,840,847,848,849,856,857,858,865,866,867", "deleted_lines": "836,843,853,860,870", "method_info": {"method_name": "TestMediaFile_IsJpeg", "method_params": "T", "method_startline": "833", "method_endline": "870"}}, "hunk_3": {"Ismethod": 1, "added_lines": "775,776,777,782,783,784,785,786,787,788,789,790", "deleted_lines": "774,781,791", "method_info": {"method_name": "TestMediaFile_Copy", "method_params": "T", "method_startline": "770", "method_endline": "792"}}, "hunk_4": {"Ismethod": 1, "added_lines": "1082,1083,1084,1092,1093,1094,1102,1103,1104,1112,1113,1114,1122,1123,1124,1132,1133,1134", "deleted_lines": "1128,1130,1136,1137", "method_info": {"method_name": "TestMediaFile_IsSidecar", "method_params": "T", "method_startline": "1070", "method_endline": "1137"}}, "hunk_5": {"Ismethod": 1, "added_lines": "1027,1028,1029,1036,1037,1038,1045,1046,1047,1054,1055,1056,1063,1064,1065", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_IsImageOther", "method_params": "T", "method_startline": "1022", "method_endline": "1068"}}, "hunk_6": {"Ismethod": 1, "added_lines": "516,517,518", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_SetFilename", "method_params": "T", "method_startline": "512", "method_endline": "523"}}, "hunk_7": {"Ismethod": 1, "added_lines": "877,878,879,886,887,888,895,896,897", "deleted_lines": "877,887,894", "method_info": {"method_name": "TestMediaFile_HasType", "method_params": "T", "method_startline": "872", "method_endline": "900"}}, "hunk_8": {"Ismethod": 1, "added_lines": "179,180,181,188,189,190", "deleted_lines": "178,188", "method_info": {"method_name": "TestMediaFile_CameraMake", "method_params": "T", "method_startline": "174", "method_endline": "193"}}, "hunk_9": {"Ismethod": 1, "added_lines": "799,800,801,808,809,810,817,818,819,826,827,828", "deleted_lines": "798,805,812,822,829", "method_info": {"method_name": "TestMediaFile_Extension", "method_params": "T", "method_startline": "794", "method_endline": "831"}}, "hunk_10": {"Ismethod": 1, "added_lines": "1340,1341,1342,1350,1351,1352", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_Width", "method_params": "T", "method_startline": "1335", "method_endline": "1356"}}, "hunk_11": {"Ismethod": 1, "added_lines": "739,740,741,746,747,748,749,750,751,752,753,754,758,759,760", "deleted_lines": "736,743,750,757,767", "method_info": {"method_name": "TestMediaFile_Move", "method_params": "T", "method_startline": "732", "method_endline": "768"}}, "hunk_12": {"Ismethod": 1, "added_lines": "669,670,671,677,678,679,686,687,688,694,695,696,702,703,704,710,711,712", "deleted_lines": "665,670,671,675,690,695,696,705,712", "method_info": {"method_name": "TestMediaFile_MimeType", "method_params": "T", "method_startline": "664", "method_endline": "715"}}, "hunk_13": {"Ismethod": 1, "added_lines": "721,722,723", "deleted_lines": "719,726", "method_info": {"method_name": "TestMediaFile_Exists", "method_params": "T", "method_startline": "717", "method_endline": "730"}}, "hunk_14": {"Ismethod": 1, "added_lines": "603,604,605", "deleted_lines": "603,604,610,611,618,619", "method_info": {"method_name": "TestMediaFile_RelativeBasename", "method_params": "T", "method_startline": "599", "method_endline": "620"}}, "hunk_15": {"Ismethod": 1, "added_lines": "1006,1007,1008,1015,1016,1017", "deleted_lines": "1003,1020", "method_info": {"method_name": "TestMediaFile_IsTiff", "method_params": "T", "method_startline": "1001", "method_endline": "1020"}}, "hunk_16": {"Ismethod": 1, "added_lines": "946,947,948,955,956,957,964,965,966,973,974,975", "deleted_lines": "948,956,964,972", "method_info": {"method_name": "TestMediaFile_IsRaw", "method_params": "T", "method_startline": "941", "method_endline": "978"}}, "hunk_17": {"Ismethod": 1, "added_lines": "1144,1145,1146,1160,1161,1162,1169,1170,1171", "deleted_lines": "1144,1145,1146,1155,1163,1174", "method_info": {"method_name": "TestMediaFile_IsPhoto", "method_params": "T", "method_startline": "1139", "method_endline": "1181"}}, "hunk_18": {"Ismethod": 1, "added_lines": "1429,1430,1431,1432,1433,1441,1442,1443,1444,1445", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_Orientation", "method_params": "T", "method_startline": "1424", "method_endline": "1449"}}, "hunk_19": {"Ismethod": 1, "added_lines": "1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_FileType", "method_params": "T", "method_startline": "1586", "method_endline": "1597"}}, "hunk_20": {"Ismethod": 1, "added_lines": "158,159,160,167,168,169", "deleted_lines": "154,161,171", "method_info": {"method_name": "TestMediaFile_CameraModel", "method_params": "T", "method_startline": "153", "method_endline": "172"}}, "hunk_21": {"Ismethod": 1, "added_lines": "356,357,358", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_CanonicalNameFromFileWithDirectory", "method_params": "T", "method_startline": "352", "method_endline": "360"}}, "hunk_22": {"Ismethod": 1, "added_lines": "138,139,140", "deleted_lines": "138", "method_info": {"method_name": "", "method_params": "", "method_startline": "134", "method_endline": "142"}}, "hunk_23": {"Ismethod": 1, "added_lines": "1363,1364,1365,1366,1367,1375,1376,1377,1378,1379", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_Height", "method_params": "T", "method_startline": "1358", "method_endline": "1383"}}, "hunk_24": {"Ismethod": 1, "added_lines": "138,139,140,147,148,149", "deleted_lines": "138,145", "method_info": {"method_name": "TestMediaFile_HasTimeAndPlace", "method_params": "T", "method_startline": "133", "method_endline": "152"}}, "hunk_25": {"Ismethod": 1, "added_lines": "367,368,369,375,376,377", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_EditedFilename", "method_params": "T", "method_startline": "362", "method_endline": "380"}}, "hunk_26": {"Ismethod": 1, "added_lines": "200,201,202,209,210,211", "deleted_lines": "195,205,212", "method_info": {"method_name": "TestMediaFile_LensModel", "method_params": "T", "method_startline": "195", "method_endline": "214"}}, "hunk_27": {"Ismethod": 1, "added_lines": "458,459,460", "deleted_lines": "412,443,447,464,475", "method_info": {"method_name": "TestMediaFile_RelatedFiles", "method_params": "T", "method_startline": "382", "method_endline": "484"}}, "hunk_28": {"Ismethod": 1, "added_lines": "1390,1391,1392,1393,1394,1402,1403,1404,1405,1406,1414,1415,1416,1417,1418", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_AspectRatio", "method_params": "T", "method_startline": "1385", "method_endline": "1422"}}, "hunk_29": {"Ismethod": 1, "added_lines": "1561,1562,1563,1564,1565,1569,1570,1571,1575,1576,1577", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_RenderDefaultThumbs", "method_params": "T", "method_startline": "1550", "method_endline": "1584"}}, "hunk_30": {"Ismethod": 1, "added_lines": "284,285,286,293,294,295", "deleted_lines": "280,289,298", "method_info": {"method_name": "TestMediaFile_Iso", "method_params": "T", "method_startline": "279", "method_endline": "298"}}, "hunk_31": {"Ismethod": 1, "added_lines": "1517,1518,1519,1520,1524,1525,1526,1527,1533,1534,1535,1536,1540,1541,1542,1543", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_Resample", "method_params": "T", "method_startline": "1505", "method_endline": "1548"}}, "hunk_32": {"Ismethod": 1, "added_lines": "1464,1465,1466,1467,1471,1472,1473,1479,1480,1481,1482,1486,1487,1492,1493,1494,1495,1499,1500", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_Thumbnail", "method_params": "T", "method_startline": "1451", "method_endline": "1503"}}, "hunk_33": {"Ismethod": 1, "added_lines": "985,986,987,994,995,996", "deleted_lines": "982,996", "method_info": {"method_name": "TestMediaFile_IsPng", "method_params": "T", "method_startline": "980", "method_endline": "999"}}, "hunk_34": {"Ismethod": 1, "added_lines": "1298,1299,1300,1301,1302,1304,1305,1311,1312,1313,1314,1315,1316,1317,1318,1324,1325,1326,1327,1328,1329,1330,1331", "deleted_lines": "1297,1303,1319,1320,1324,1328", "method_info": {"method_name": "TestMediaFile_decodeDimension", "method_params": "T", "method_startline": "1293", "method_endline": "1333"}}, "hunk_35": {"Ismethod": 1, "added_lines": "491,492,493,497,498,499", "deleted_lines": null, "method_info": {"method_name": "TestMediaFile_RelatedFiles_Ordering", "method_params": "T", "method_startline": "486", "method_endline": "510"}}, "hunk_36": {"Ismethod": 1, "added_lines": "263,264,265,272,273,274", "deleted_lines": "263,273", "method_info": {"method_name": "TestMediaFile_FNumber", "method_params": "T", "method_startline": "258", "method_endline": "277"}}, "hunk_37": {"Ismethod": 1, "added_lines": "907,908,909,916,917,918,925,926,927,934,935,936", "deleted_lines": "908,915,932", "method_info": {"method_name": "TestMediaFile_IsHEIF", "method_params": "T", "method_startline": "902", "method_endline": "939"}}, "hunk_38": {"Ismethod": 1, "added_lines": "639,640,641,648,649,650,657,658,659", "deleted_lines": "639,640,649", "method_info": {"method_name": "TestMediaFile_Basename", "method_params": "T", "method_startline": "634", "method_endline": "662"}}, "hunk_39": {"Ismethod": 1, "added_lines": "336,337,338,345,346,347", "deleted_lines": "331", "method_info": {"method_name": "TestMediaFileCanonicalNameFromFile", "method_params": "T", "method_startline": "331", "method_endline": "350"}}, "hunk_40": {"Ismethod": 1, "added_lines": "627,628,629", "deleted_lines": "625,626,632", "method_info": {"method_name": "TestMediaFile_Directory", "method_params": "T", "method_startline": "622", "method_endline": "632"}}, "hunk_41": {"Ismethod": 1, "added_lines": "1188,1189,1190", "deleted_lines": "1193,1201", "method_info": {"method_name": "TestMediaFile_IsVideo", "method_params": "T", "method_startline": "1183", "method_endline": "1204"}}, "hunk_42": {"Ismethod": 1, "added_lines": "242,243,244,251,252,253", "deleted_lines": "239,246,256", "method_info": {"method_name": "TestMediaFile_FocalLength", "method_params": "T", "method_startline": "237", "method_endline": "256"}}, "hunk_43": {"Ismethod": 1, "added_lines": "221,222,223,230,231,232", "deleted_lines": "222,229", "method_info": {"method_name": "TestMediaFile_LensMake", "method_params": "T", "method_startline": "216", "method_endline": "235"}}, "hunk_44": {"Ismethod": 1, "added_lines": "325,326,327", "deleted_lines": "323,324", "method_info": {"method_name": "TestMediaFileCanonicalName", "method_params": "T", "method_startline": "321", "method_endline": "329"}}}}}}}