{"BR": {"BR_id": "1034", "BR_author": "rich-junwang", "BRopenT": "2019-12-03T01:04:51Z", "BRcloseT": "2019-12-05T02:48:29Z", "BR_text": {"BRsummary": "Error when using fp16 trainer", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n I use fp16 trainer in fp16_utils.py to train model. I got the following error.\n <denchmark-link:https://github.com/eric-haibin-lin>@eric-haibin-lin</denchmark-link>\n \n <denchmark-h:h3>Error Message</denchmark-h>\n \n File \"/home/ec2-user/project/src/deep/utils/fp16_utils.py\", line 179, in step\n overflow = self._scaler.has_overflow(self.fp32_trainer._params)\n File \"/home/ec2-user/project/src/deep/utils/fp16_utils.py\", line 195, in has_overflow\n is_not_finite += mx.nd.contrib.isnan(grad).sum()\n File \"/apollo/env/project/lib/python3.6/site-packages/mxnet/ndarray/ndarray.py\", line 217, in iadd\n return op.broadcast_add(self, other, out=self)\n File \"\", line 56, in broadcast_add\n File \"/apollo/env/project/lib/python3.6/site-packages/mxnet/_ctypes/ndarray.py\", line 92, in _imperative_invoke\n ctypes.byref(out_stypes)))\n File \"/apollo/env/project/lib/python3.6/site-packages/mxnet/base.py\", line 253, in check_call\n raise MXNetError(py_str(_LIB.MXGetLastError()))\n mxnet.base.MXNetError: [22:57:10] /opt/brazil-pkg-cache/packages/DeepMXNet/DeepMXNet-1.5.x.1353.0/AL2012/generic-flavor/src/src/io/../operator/elemwise_op_common.h:135: Check failed: assign(&dattr, vec.at(i)): Incompatible attr in node  at 1-th input: expected float16, got float32\n \t"}, "comments": {}}, "commit": {"commit_id": "3ce9995329fb0d18787019df541d4f229d7c9ded", "commit_author": "Haibin Lin", "commitT": "2019-12-05 05:00:37+00:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "scripts\\bert\\fp16_utils.py", "file_new_name": "scripts\\bert\\fp16_utils.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "191,192", "deleted_lines": "191,192", "method_info": {"method_name": "has_overflow", "method_params": "self,params", "method_startline": "185", "method_endline": "197"}}}}}}}