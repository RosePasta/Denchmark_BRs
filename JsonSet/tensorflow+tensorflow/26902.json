{"BR": {"BR_id": "26902", "BR_author": "ppwwyyxx", "BRopenT": "2019-03-19T21:52:17Z", "BRcloseT": "2019-12-26T17:00:29Z", "BR_text": {"BRsummary": "tf_upgrade_v2 does not preserve file attributes and symbolic links", "BRdescription": "\n System information\n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow):n/a\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04):archlinux\n Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:n/a\n TensorFlow installed from (source or binary):binary\n TensorFlow version (use command below): tf2 preview nightly yesterday\n Python version:3.7\n Bazel version (if compiling from source):n/a\n GCC/Compiler version (if compiling from source):n/a\n CUDA/cuDNN version:n/a\n GPU model and memory:n/a\n \n \n \n tf_upgrade_v2 changes executable files to non-executable files. I expect executable files are still executable after the upgrade.\n \n \n tf_upgrade_v2 always changes symbolic links to regular files. However I expect:\n (1)For in-place upgrade, modify the file the link points to, but the symbolic link should be the same.\n (2) For non-in-place upgrade, if --intree and --outtree is used, symbolic links which point to files within the tree should become symbolic links pointing to the new file in the outtree. Symbolic links which point to external files should become a regular file.\n (3) For non-in-place single-file upgrade, the output should be a regular file.\n \n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ppwwyyxx", "commentT": "2019-07-17T23:17:32Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/ppwwyyxx>@ppwwyyxx</denchmark-link>\n ! Do you have a simple example where tf_upgrade_v2 changes a file to be non-executable?\n I just tried the following:\n <denchmark-code>touch test1/bar.sh\n chmod +x test1/bar.sh\n pip install tf-nightly-2.0-preview\n tf_upgrade_v2 --intree=test1/ --outtree=test2/ --copyotherfiles=True\n </denchmark-code>\n \n After these commands are run, test2/bar.sh does have executable permissions. Could it be instead that file ownership changed?\n Sorry for delay looking at this issue.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ppwwyyxx", "commentT": "2019-07-25T22:34:34Z", "comment_text": "\n \t\tI submitted a change to fix symbolic link behavior. However, the behavior is slightly different than you proposed. Specifically, I keep symlink unchanged if it points to external file (as opposed to converting it to regular file).\n I was thinking that someone who has code in a different directory might want to update it separately, while keeping the symlink.\n I will keep this issue open for the executable permission. Per my previous comment, I need some example to reproduce it.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "ppwwyyxx", "commentT": "2019-11-11T19:28:04Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ppwwyyxx>@ppwwyyxx</denchmark-link>\n  Can you check whether the issue resolved in the  or ? If this was resolved, please close the issue. Thanks!\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "ppwwyyxx", "commentT": "2019-12-26T12:32:06Z", "comment_text": "\n \t\tIt has been 44 days with no activity and the awaiting response label was assigned. Is this still an issue?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "ppwwyyxx", "commentT": "2019-12-26T17:00:29Z", "comment_text": "\n \t\tClosing due to no other updates\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "ppwwyyxx", "commentT": "2019-12-26T17:00:31Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/26902>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/26902>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "0fa0d44944abd86578fa076802f5a8a7490d5656", "commit_author": "Anna R", "commitT": "2019-07-24 18:11:15-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\tools\\compatibility\\ast_edits.py", "file_new_name": "tensorflow\\tools\\compatibility\\ast_edits.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1077,1078,1079", "deleted_lines": null, "method_info": {"method_name": "process_tree_inplace", "method_params": "self,root_directory", "method_startline": "1061", "method_endline": "1085"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tensorflow\\tools\\compatibility\\ast_edits_test.py", "file_new_name": "tensorflow\\tools\\compatibility\\ast_edits_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690", "deleted_lines": null, "method_info": {"method_name": "testUpgradeCopyWithSymlinkInDifferentDir", "method_params": "self", "method_startline": "670", "method_endline": "690"}}, "hunk_1": {"Ismethod": 1, "added_lines": "627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647", "deleted_lines": null, "method_info": {"method_name": "testUpgradeInPlaceWithSymlinkInDifferentDir", "method_params": "self", "method_startline": "627", "method_endline": "647"}}, "hunk_2": {"Ismethod": 1, "added_lines": "609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625", "deleted_lines": null, "method_info": {"method_name": "testUpgradeInplaceWithSymlink", "method_params": "self", "method_startline": "609", "method_endline": "625"}}, "hunk_3": {"Ismethod": 1, "added_lines": "649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668", "deleted_lines": null, "method_info": {"method_name": "testUpgradeCopyWithSymlink", "method_params": "self", "method_startline": "649", "method_endline": "668"}}}}}}}