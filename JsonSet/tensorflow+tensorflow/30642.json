{"BR": {"BR_id": "30642", "BR_author": "SeekerYb", "BRopenT": "2019-07-12T11:12:52Z", "BRcloseT": "2019-09-13T19:45:58Z", "BR_text": {"BRsummary": "\u2018scatter_nd_update\u2019 doesn't work with string", "BRdescription": "\n \n I Reproduced this issue in newest <denchmark-link:https://hub.docker.com/r/tensorflow/tensorflow>tensorflow official docker image</denchmark-link>\n .\n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow):no\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04):Ubuntu 18.04\n TensorFlow installed from (source or binary):binary\n TensorFlow version (use command below):1.14.0\n Python version:2.7.15+\n \n \n In my model, I need to maintain an extremely long 2-D variable tensor\uff0cwhich has several columns and many rows, and its dtype is string. In every training step, I need to update only several individual rows of that tensor. <denchmark-link:https://www.tensorflow.org/api_docs/python/tf/scatter_nd_update>tf.scatter_nd_update</denchmark-link>\n  meets my requirements perfectly,\n except that it doesn't work with string in fact. As a contrast,  <denchmark-link:https://www.tensorflow.org/api_docs/python/tf/scatter_nd>tf.scatter_nd</denchmark-link>\n  does work. Since the document doesn't mention that  can't be string, I think it may be a bug.\n Describe the expected behavior\n I hope tf.scatter_nd_update support string ref,and I really need this feature in my project. So if it can't be fixed quickly, any walk-around suggestions (include modify some source code) is also welcome.\n Code to reproduce the issue\n <denchmark-code>import tensorflow as tf\n ref = tf.Variable([\u2018qq\u2019,\u2019ww\u2019,\u2019ee\u2019,\u2019rr\u2019,\u2019\u2019,\u2019\u2019,\u2019\u2019,\u2019\u2019])\n indices = tf.constant([[4], [3], [1] ,[7]])\n updates = tf.constant(['aa', 'dd', 'cc', 'bb'])\n update = tf.scatter_nd_update(ref, indices, updates)\n with tf.Session() as sess:\n     sess.run(tf.initialize_all_variables())\n     print(sess.run(update))\n </denchmark-code>\n \n Other info / logs\n <denchmark-code>Traceback (most recent call last):\n   File \"<stdin>\", line 2, in <module>\n   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 950, in run\n     run_metadata_ptr)\n   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1173, in _run\n     feed_dict_tensor, options, run_metadata)\n   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1350, in _do_run\n     run_metadata)\n   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1370, in _do_call\n     raise type(e)(node_def, op, message)\n tensorflow.python.framework.errors_impl.InvalidArgumentError: No OpKernel was registered to support Op 'ScatterNdUpdate' used by node ScatterNdUpdate (defined at <stdin>:1) with these attrs: [_class=[\"loc:@Variable\"], use_locking=true, Tindices=DT_INT32, T=DT_STRING]\n Registered devices: [CPU, XLA_CPU]\n Registered kernels:\n   device='CPU'; T in [DT_BOOL]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_BOOL]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_COMPLEX128]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_COMPLEX128]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_COMPLEX64]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_COMPLEX64]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_DOUBLE]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_DOUBLE]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_FLOAT]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_FLOAT]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_BFLOAT16]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_BFLOAT16]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_HALF]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_HALF]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_INT8]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_INT8]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_UINT8]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_UINT8]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_INT16]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_INT16]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_UINT16]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_UINT16]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_INT32]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_INT32]; Tindices in [DT_INT32]\n   device='CPU'; T in [DT_INT64]; Tindices in [DT_INT64]\n   device='CPU'; T in [DT_INT64]; Tindices in [DT_INT32]\n \n \t [[ScatterNdUpdate]]\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "SeekerYb", "commentT": "2019-07-15T13:08:11Z", "comment_text": "\n \t\tCould reproduce the issue with TF version 1.14.Thanks\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "SeekerYb", "commentT": "2019-09-13T19:45:59Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=30642>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=30642>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "c3e32b03e187fc2854c34add42ee3d1fe1f17628", "commit_author": "Alexandre Passos", "commitT": "2019-09-13 12:45:40-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\core\\kernels\\scatter_nd_op.cc", "file_new_name": "tensorflow\\core\\kernels\\scatter_nd_op.cc", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "385", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\python\\kernel_tests\\scatter_nd_ops_test.py", "file_new_name": "tensorflow\\python\\kernel_tests\\scatter_nd_ops_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "171,172,173,174,175,176,177,178", "deleted_lines": null, "method_info": {"method_name": "testString", "method_params": "self", "method_startline": "171", "method_endline": "178"}}}}}}}