{"BR": {"BR_id": "32755", "BR_author": "MattConley", "BRopenT": "2019-09-24T02:09:01Z", "BRcloseT": "2019-10-04T04:39:19Z", "BR_text": {"BRsummary": "Bincount Op test \"test_negative\" fails with TF 2.0", "BRdescription": "\n System information\n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\n Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\n TensorFlow installed from (source or binary): Binary\n TensorFlow version (use command below): 2.0.0-rc1\n Python version: 3.6\n Bazel version (if compiling from source): N/A\n GCC/Compiler version (if compiling from source): N/A\n CUDA/cuDNN version: 10.0\n GPU model and memory: RTX 2080 Ti, 11G\n \n Describe the current behavior\n The test_negative test in tensorflow/python/kernel_tests/bincount_op_test.py fails, as the bincount call with negative values does not throw an InvalidArgumentError.\n This behavior might be the result of the op being called on the GPU, as only the CPU call is expected to throw the error, as per the comment here: <denchmark-link:https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/kernel_tests/bincount_op_test.py#L107>https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/kernel_tests/bincount_op_test.py#L107</denchmark-link>\n .\n Setting CUDA_VISIBLE_DEVICES to be empty forces the op to run on CPU and the test passes (the invalid argument error is successfully thrown), but passing use_gpu=False as an option to the session wrapper does not have this effect.\n Describe the expected behavior\n The test_negative test should pass, as the call to bincount with a negative input value is expected to throw an InvalidArgumentError.\n Code to reproduce the issue\n Run the python test tensorflow/python/kernel_tests/bincount_op_test.py.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "MattConley", "commentT": "2019-09-25T08:04:58Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/MattConley>@MattConley</denchmark-link>\n , Will it be possible to provide the sample standalone code to replicate the issue. Thanks!\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "MattConley", "commentT": "2019-09-25T20:56:32Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/gadagashwini>@gadagashwini</denchmark-link>\n  Unfortunately the minimal repro I have at the moment is the bincount_op_test itself, specifically  (<denchmark-link:https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/kernel_tests/bincount_op_test.py#L106-L110>https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/kernel_tests/bincount_op_test.py#L106-L110</denchmark-link>\n ).\n The issue might be with the test framework itself, as internal session wrappers are used even with TF 2.0.\n Also, setting CUDA_VISIBLE_DEVICES to be empty forces the op to run on CPU and the test passes (the invalid argument error is successfully thrown), but passing use_gpu=False as an option to the session wrapper does not have this effect.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "MattConley", "commentT": "2019-09-27T23:11:55Z", "comment_text": "\n \t\tI was able to reproduce the error reported in TF 2.0 nightly version '2.0.0-dev20190924'\n OP_REQUIRES failed at bincount_op.cc:111 : Invalid argument: Input arr must be non-negative!\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "MattConley", "commentT": "2019-10-02T21:04:49Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/reedwm>@reedwm</denchmark-link>\n  can you take a look at this?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "MattConley", "commentT": "2019-10-04T04:39:20Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/32755>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/32755>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "9b5f9aabd84b0d1db782286143c560792d711449", "commit_author": "Reed Wanderman-Milne", "commitT": "2019-10-03 21:39:01-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\kernel_tests\\BUILD", "file_new_name": "tensorflow\\python\\kernel_tests\\BUILD", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "170", "deleted_lines": "170"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\python\\kernel_tests\\bincount_op_test.py", "file_new_name": "tensorflow\\python\\kernel_tests\\bincount_op_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "109", "deleted_lines": "108", "method_info": {"method_name": "test_negative", "method_params": "self", "method_startline": "107", "method_endline": "111"}}}}}}}