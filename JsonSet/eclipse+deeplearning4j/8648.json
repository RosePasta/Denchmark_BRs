{"BR": {"BR_id": "8648", "BR_author": "AlexDBlack", "BRopenT": "2020-01-28T10:43:47Z", "BRcloseT": "2020-02-01T07:19:37Z", "BR_text": {"BRsummary": "SameDiff: NPE instead of missing placeholder exception in test case", "BRdescription": "\n <denchmark-code>        SameDiff sd = SameDiff.create();\n \n         int nOut = 4;\n         int minibatch = 10;\n         SDVariable predictions = sd.var(\"in\", DataType.DOUBLE, minibatch, nOut);\n         SDVariable labels = sd.var(\"labels\", DataType.DOUBLE, -1, nOut);\n \n         INDArray wpe = Nd4j.createFromArray(new double[]{0,0,1,1,2,2,3,3,4,4});\n         SDVariable  w = sd.var(\"weights\", Nd4j.create(new double[][]{\n                 {0,0,0,0}, {0,0,1,1}, {1,1,0,0}, {1,1,1,1}, {1,1,1,1},\n                 {2,2,2,2}, {2,2,2,2}, {2,2,2,2}, {2,2,2,2}, {2,2,2,2}}));\n \n         LossReduce reduction = LossReduce.MEAN_BY_NONZERO_WEIGHT_COUNT;\n \n         INDArray predictionsArr = Nd4j.randn(DataType.DOUBLE, minibatch, nOut);\n         INDArray labelsArr = Nd4j.randn(DataType.DOUBLE, minibatch, nOut);\n \n         INDArray expOut = Transforms.abs(predictionsArr.sub(labelsArr));\n         SDVariable   loss = sd.loss().absoluteDifference(\"loss\", labels, predictions, w, reduction);\n \n \n         //This does not seem to actually do anything.\n         TestCase tc = new TestCase(sd)\n                 .expectedOutput(\"loss\", expOut);\n         OpValidation.validate(tc);\n </denchmark-code>\n \n The labels placeholder isn't provided in the test case; we should get an exception saying there's a missing placeholder (and identify which one is missing by name), instead of getting a NPE.\n \t"}, "comments": {}}, "commit": {"commit_id": "0756e3fe7073686b513c19b4b6aa7fa8ed69c410", "commit_author": "Alex Black", "commitT": "2020-02-01 18:19:36+11:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\CapsnetGradientCheckTest.java", "file_new_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\CapsnetGradientCheckTest.java", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "46,47,48,49,50,51"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\OutputLayerGradientChecks.java", "file_new_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\OutputLayerGradientChecks.java", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "46,47,48,49"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\RnnGradientChecks.java", "file_new_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\RnnGradientChecks.java", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "50,51,52,53"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\UtilLayerGradientChecks.java", "file_new_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\UtilLayerGradientChecks.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "230,231,232", "deleted_lines": "236,237", "method_info": {"method_name": "UtilLayerGradientChecks::testFrozenWithBackprop", "method_params": "", "method_startline": "192", "method_endline": "238"}}, "hunk_1": {"Ismethod": 1, "added_lines": "179,180,181", "deleted_lines": "56,185,186,187", "method_info": {"method_name": "UtilLayerGradientChecks::testMaskLayer", "method_params": "", "method_startline": "56", "method_endline": "188"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\YoloGradientCheckTests.java", "file_new_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\java\\org\\deeplearning4j\\gradientcheck\\YoloGradientCheckTests.java", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "59,60,61,62,63"}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\resources\\logback-test.xml", "file_new_name": "deeplearning4j\\deeplearning4j-core\\src\\test\\resources\\logback-test.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "22,23", "deleted_lines": "22,23"}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-cuda\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-cuda\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "22,23", "deleted_lines": "22,23"}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-nearestneighbors-parent\\deeplearning4j-nearestneighbor-server\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-nearestneighbors-parent\\deeplearning4j-nearestneighbor-server\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "22,23", "deleted_lines": "22,23"}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-remote\\deeplearning4j-json-server\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-remote\\deeplearning4j-json-server\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-scaleout\\deeplearning4j-scaleout-parallelwrapper-parameter-server\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-scaleout\\deeplearning4j-scaleout-parallelwrapper-parameter-server\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-scaleout\\spark\\dl4j-spark-nlp-java8\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-scaleout\\spark\\dl4j-spark-nlp-java8\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-scaleout\\spark\\dl4j-spark-nlp\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-scaleout\\spark\\dl4j-spark-nlp\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-scaleout\\spark\\dl4j-spark-parameterserver\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-scaleout\\spark\\dl4j-spark-parameterserver\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_13": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-scaleout\\spark\\dl4j-spark\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-scaleout\\spark\\dl4j-spark\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_14": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-ui-parent\\deeplearning4j-ui-model\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-ui-parent\\deeplearning4j-ui-model\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_15": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-ui-parent\\deeplearning4j-ui-standalone\\src\\main\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-ui-parent\\deeplearning4j-ui-standalone\\src\\main\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_16": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-ui-parent\\deeplearning4j-ui\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-ui-parent\\deeplearning4j-ui\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_17": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\deeplearning4j-ui-parent\\deeplearning4j-vertx\\src\\test\\resources\\logback.xml", "file_new_name": "deeplearning4j\\deeplearning4j-ui-parent\\deeplearning4j-vertx\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_18": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "deeplearning4j\\dl4j-integration-tests\\src\\test\\resources\\logback-test.xml", "file_new_name": "deeplearning4j\\dl4j-integration-tests\\src\\test\\resources\\logback-test.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "22,23", "deleted_lines": "22,23"}}}, "file_19": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "nd4j\\nd4j-backends\\nd4j-api-parent\\nd4j-api\\src\\main\\java\\org\\nd4j\\autodiff\\samediff\\internal\\AbstractSession.java", "file_new_name": "nd4j\\nd4j-backends\\nd4j-api-parent\\nd4j-api\\src\\main\\java\\org\\nd4j\\autodiff\\samediff\\internal\\AbstractSession.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "299,300,301,304,305", "deleted_lines": "298", "method_info": {"method_name": "AbstractSession<T,O>::output", "method_params": "variables,placeholderValues,batch,requiredActivations,listeners,at", "method_startline": "130", "method_endline": "486"}}}}, "file_20": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "nd4j\\nd4j-backends\\nd4j-backend-impls\\nd4j-native\\src\\test\\resources\\logback.xml", "file_new_name": "nd4j\\nd4j-backends\\nd4j-backend-impls\\nd4j-native\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_21": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "nd4j\\nd4j-backends\\nd4j-tests\\src\\test\\java\\org\\nd4j\\autodiff\\samediff\\SameDiffTests.java", "file_new_name": "nd4j\\nd4j-backends\\nd4j-tests\\src\\test\\java\\org\\nd4j\\autodiff\\samediff\\SameDiffTests.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "3534,3535,3536,3537,3538,3539,3540,3541,3542,3543,3544,3545,3546,3547,3548,3549,3550,3551,3552,3553,3554", "deleted_lines": null, "method_info": {"method_name": "SameDiffTests::testMissingPlaceholderError", "method_params": "", "method_startline": "3534", "method_endline": "3554"}}}}, "file_22": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "nd4j\\nd4j-backends\\nd4j-tests\\src\\test\\java\\org\\nd4j\\linalg\\Nd4jTestsC.java", "file_new_name": "nd4j\\nd4j-backends\\nd4j-tests\\src\\test\\java\\org\\nd4j\\linalg\\Nd4jTestsC.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "6938,6940", "deleted_lines": "6938,6940", "method_info": {"method_name": "Nd4jTestsC::Nd4jTestsC::testTensorDot.testSomething_1", "method_params": "", "method_startline": "6933", "method_endline": "6956"}}, "hunk_1": {"Ismethod": 1, "added_lines": "6938,6940", "deleted_lines": "6938,6940", "method_info": {"method_name": "Nd4jTestsC::testTensorDot", "method_params": "", "method_startline": "2232", "method_endline": "8271"}}}}, "file_23": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "nd4j\\nd4j-backends\\nd4j-tests\\src\\test\\resources\\logback.xml", "file_new_name": "nd4j\\nd4j-backends\\nd4j-tests\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_24": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "nd4j\\nd4j-parameter-server-parent\\nd4j-parameter-server-client\\src\\test\\resources\\logback.xml", "file_new_name": "nd4j\\nd4j-parameter-server-parent\\nd4j-parameter-server-client\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_25": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "nd4j\\nd4j-parameter-server-parent\\nd4j-parameter-server-node\\src\\test\\resources\\logback.xml", "file_new_name": "nd4j\\nd4j-parameter-server-parent\\nd4j-parameter-server-node\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_26": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "nd4j\\nd4j-parameter-server-parent\\nd4j-parameter-server-status\\src\\test\\resources\\logback.xml", "file_new_name": "nd4j\\nd4j-parameter-server-parent\\nd4j-parameter-server-status\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_27": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "nd4j\\nd4j-parameter-server-parent\\nd4j-parameter-server\\src\\test\\resources\\logback.xml", "file_new_name": "nd4j\\nd4j-parameter-server-parent\\nd4j-parameter-server\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_28": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "nd4j\\nd4j-remote\\nd4j-json-server\\src\\test\\resources\\logback.xml", "file_new_name": "nd4j\\nd4j-remote\\nd4j-json-server\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}, "file_29": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "nd4j\\nd4j-serde\\nd4j-aeron\\src\\test\\resources\\logback.xml", "file_new_name": "nd4j\\nd4j-serde\\nd4j-aeron\\src\\test\\resources\\logback.xml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25", "deleted_lines": "24,25"}}}}}}