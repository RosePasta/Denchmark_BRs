{"BR": {"BR_id": "2305", "BR_author": "successar", "BRopenT": "2020-11-02T21:43:56Z", "BRcloseT": "2020-12-23T19:04:15Z", "BR_text": {"BRsummary": "Cache a function with an nested list comprehension", "BRdescription": "\n <denchmark-h:h1>Summary</denchmark-h>\n \n When trying to cache a function with an nested list comprehension, streamlit doesn't allow outer iterator value within inner iterator.\n <denchmark-h:h1>Steps to reproduce</denchmark-h>\n \n import streamlit as st\n \n @st.cache()\n def create_raw_data():\n     production=[[outer + inner for inner in range(3)] for outer in range(5)]\n     return production\n \n production = create_raw_data()\n st.write(production)\n <denchmark-h:h2>Expected behavior:</denchmark-h>\n \n Should print [[0, 1, 2], [1, 2, 3], ..., [4, 5, 6]]\n <denchmark-h:h2>Actual behavior:</denchmark-h>\n \n <denchmark-link:https://user-images.githubusercontent.com/1499824/97922262-2dd99c00-1d2a-11eb-9516-5dd2fe09e0b4.png></denchmark-link>\n \n <denchmark-h:h2>Is this a regression?</denchmark-h>\n \n No.\n <denchmark-h:h1>Debug info</denchmark-h>\n \n \n Streamlit version: (get it with 0.70.0)\n Python version: (get it with 3.7.7)\n Using Conda? PipEnv? PyEnv? Pex? Using conda env. Streamlit Installed with pip\n OS version: Ubuntu 18.04\n Browser version: Chrome\n \n <denchmark-h:h1>Additional information</denchmark-h>\n \n Same as <denchmark-link:https://github.com/streamlit/streamlit/issues/1801>#1801</denchmark-link>\n  but that issue was closed. The provided solution there doesn't work.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "successar", "commentT": "2020-11-05T18:19:51Z", "comment_text": "\n \t\tInteresting!  I repro'd your bug.  Thanks for the tidy code snippet.  I'll see how fast we can get to this one.\n \t\t"}}}, "commit": {"commit_id": "7f8b812134709e1163274b93223f7d76f96eb393", "commit_author": "bh-streamlit", "commitT": "2020-12-23 11:04:14-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 9, "file_old_name": "lib\\streamlit\\hashing.py", "file_new_name": "lib\\streamlit\\hashing.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "604", "deleted_lines": "549,600", "method_info": {"method_name": "_to_bytes", "method_params": "self,obj,context", "method_startline": "382", "method_endline": "653"}}, "hunk_1": {"Ismethod": 1, "added_lines": "722", "deleted_lines": null, "method_info": {"method_name": "get_referenced_objects", "method_params": "code,context", "method_startline": "688", "method_endline": "751"}}, "hunk_2": {"Ismethod": 1, "added_lines": "655,669,672", "deleted_lines": "665", "method_info": {"method_name": "_code_to_bytes", "method_params": "self,code,context,func", "method_startline": "655", "method_endline": "674"}}, "hunk_3": {"Ismethod": 1, "added_lines": "218,219,220,221,222,223,224,225,226,227", "deleted_lines": null, "method_info": {"method_name": "pop", "method_params": "self", "method_startline": "218", "method_endline": "227"}}, "hunk_4": {"Ismethod": 1, "added_lines": "205,206,207,208,209,210,211,212,213,215,216", "deleted_lines": null, "method_info": {"method_name": "_set", "method_params": "self,key,value", "method_startline": "205", "method_endline": "216"}}, "hunk_5": {"Ismethod": 1, "added_lines": "229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246", "deleted_lines": null, "method_info": {"method_name": "push", "method_params": "self,code,func", "method_startline": "229", "method_endline": "246"}}, "hunk_6": {"Ismethod": 1, "added_lines": "249,254", "deleted_lines": null, "method_info": {"method_name": "_get_context", "method_params": "func", "method_startline": "249", "method_endline": "254"}}, "hunk_7": {"Ismethod": 1, "added_lines": "200,201,202,203", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self", "method_startline": "200", "method_endline": "203"}}, "hunk_8": {"Ismethod": 1, "added_lines": "604", "deleted_lines": "600", "method_info": {"method_name": "_code_to_bytes", "method_params": "self,code,context", "method_startline": "600", "method_endline": "617"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "lib\\tests\\streamlit\\caching_test.py", "file_new_name": "lib\\tests\\streamlit\\caching_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "383,384,385,386,387,388,389,390", "deleted_lines": null, "method_info": {"method_name": "test_function_body_uses_nested_listcomps", "method_params": "self", "method_startline": "383", "method_endline": "390"}}, "hunk_1": {"Ismethod": 1, "added_lines": "385,386,387", "deleted_lines": null, "method_info": {"method_name": "test_function_body_uses_nested_listcomps.foo", "method_params": "arg", "method_startline": "385", "method_endline": "387"}}}}}}}