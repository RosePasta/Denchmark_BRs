{"BR": {"BR_id": "3221", "BR_author": "mfojtak", "BRopenT": "2019-02-02T09:41:58Z", "BRcloseT": "2019-02-10T13:57:32Z", "BR_text": {"BRsummary": "model load fails when textcat in pipeline", "BRdescription": "\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n Run <denchmark-link:https://github.com/explosion/spaCy/blob/develop/examples/training/train_textcat.py>https://github.com/explosion/spaCy/blob/develop/examples/training/train_textcat.py</denchmark-link>\n \n <denchmark-h:h2>Your Environment</denchmark-h>\n \n Using spacy-nightly (2.1.0a6)\n \n Operating System: Ubuntu 16.04\n Python Version Used: 3.7\n spaCy Version Used: 2.1.0a6\n \n The train_textcat example fails with:\n <denchmark-code>File \"example.py\", line 137, in <module>\n     plac.call(main)\n   File \"/opt/conda/lib/python3.7/site-packages/plac_core.py\", line 328, in call\n     cmd, result = parser.consume(arglist)\n   File \"/opt/conda/lib/python3.7/site-packages/plac_core.py\", line 207, in consume\n     return cmd, self.func(*(args + varargs + extraopts), **kwargs)\n   File \"example.py\", line 94, in main\n     nlp2 = spacy.load(output_dir)\n   File \"/opt/conda/lib/python3.7/site-packages/spacy/__init__.py\", line 22, in load\n     return util.load_model(name, **overrides)\n   File \"/opt/conda/lib/python3.7/site-packages/spacy/util.py\", line 121, in load_model\n     return load_model_from_path(name, **overrides)\n   File \"/opt/conda/lib/python3.7/site-packages/spacy/util.py\", line 159, in load_model_from_path\n     return nlp.from_disk(model_path)\n   File \"/opt/conda/lib/python3.7/site-packages/spacy/language.py\", line 767, in from_disk\n     util.from_disk(path, deserializers, exclude)\n   File \"/opt/conda/lib/python3.7/site-packages/spacy/util.py\", line 579, in from_disk\n     reader(path / key)\n   File \"/opt/conda/lib/python3.7/site-packages/spacy/language.py\", line 763, in <lambda>\n     deserializers[name] = lambda p, proc=proc: proc.from_disk(p, vocab=False)\n   File \"pipeline.pyx\", line 428, in spacy.pipeline.Pipe.from_disk\n   File \"/opt/conda/lib/python3.7/site-packages/spacy/util.py\", line 579, in from_disk\n     reader(path / key)\n   File \"pipeline.pyx\", line 420, in spacy.pipeline.Pipe.from_disk.load_model\n   File \"pipeline.pyx\", line 1148, in spacy.pipeline.TextCategorizer.Model\n TypeError: Model() takes exactly 2 positional arguments (1 given)\n </denchmark-code>\n \n This is caused by the change in textcat constructor which now has additional positional argument nr_class with no default value specified.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "mfojtak", "commentT": "2019-02-05T09:38:51Z", "comment_text": "\n \t\tAny idea when this is gonna be fixed?\n It is a showstopper for me and anybody who needs to do text categorization.\n Is there a temporary solution/hack?\n Related to <denchmark-link:https://github.com/explosion/spaCy/issues/3148>#3148</denchmark-link>\n  and <denchmark-link:https://github.com/explosion/spaCy/issues/3087>#3087</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "mfojtak", "commentT": "2019-02-05T11:32:47Z", "comment_text": "\n \t\tAh, I missed the extended discussion because it was buried in the textcat example thread. If somebody had submitted a PR for this small fix, I would have definitely merged that. Sorry! I can add the default argument now and we can ship it with the next nightly release.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "mfojtak", "commentT": "2019-02-06T07:36:14Z", "comment_text": "\n \t\tI have built from develop branch and can confirm that it is working now.\n This one can be closed.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "mfojtak", "commentT": "2019-03-12T14:12:40Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "5e16490d9d2cf3fc8c571d56bdbbd36dd11dd759", "commit_author": "Ines Montani", "commitT": "2019-02-05 12:33:47+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\pipeline.pyx", "file_new_name": "spacy\\pipeline.pyx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "1148", "deleted_lines": "1148"}}}}}}