{"BR": {"BR_id": "5048", "BR_author": "svlandeg", "BRopenT": "2020-02-21T20:53:25Z", "BRcloseT": "2020-03-02T10:49:29Z", "BR_text": {"BRsummary": "get_doc not storing POS properly", "BRdescription": "\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n <denchmark-code>\n     words = [\"This\", \"is\", \"a\", \"sentence\"]\n     pos_s = [\"DET\", \"VERB\", \"DET\", \"NOUN\"]\n     spaces = [\" \", \" \", \" \", \"\"]\n     deps_s = [\"dep\", \"adj\", \"nn\", \"atm\"]\n     tags_s = [\"DT\", \"VBZ\", \"DT\", \"NN\"]\n \n     nlp = English()\n     strings = nlp.vocab.strings\n \n     for w in words:\n         strings.add(w)\n     deps = [strings.add(d) for d in deps_s]\n     pos = [strings.add(p) for p in pos_s]\n     tags = [strings.add(t) for t in tags_s]\n \n     attrs = [POS, DEP, TAG]\n     array = numpy.array(list(zip(pos, deps, tags)), dtype=\"uint64\")\n \n     doc = Doc(nlp.vocab, words=words, spaces=spaces)\n     doc.from_array(attrs, array)\n     print(\"1\", [(token.text, token.pos_, token.tag_) for token in doc])\n \n     doc2 = get_doc(nlp.vocab, words=words, pos=pos_s, deps=deps_s, tags=tags_s)\n     print(\"2\", [(token.text, token.pos_, token.tag_) for token in doc2])\n </denchmark-code>\n \n output:\n <denchmark-code>1 [('This', 'DET', 'DT'), ('is', 'VERB', 'VBZ'), ('a', 'DET', 'DT'), ('sentence', 'NOUN', 'NN')]\n 2 [('This', 'DET', 'DT'), ('is', 'AUX', 'VBZ'), ('a', 'DET', 'DT'), ('sentence', 'NOUN', 'NN')]\n </denchmark-code>\n \n For the second token, the POS should be VERB, not AUX.\n Will be submitting a PR soon to fix this!\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "svlandeg", "commentT": "2020-04-02T14:49:11Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "c6b12ab02adcdfe760bc10e249924553cb826410", "commit_author": "Sofie Van Landeghem", "commitT": "2020-03-02 11:49:28+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\errors.py", "file_new_name": "spacy\\errors.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "110,111,112,547", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\pipeline\\pipes.pyx", "file_new_name": "spacy\\pipeline\\pipes.pyx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "370", "deleted_lines": "370"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "spacy\\tests\\doc\\test_doc_api.py", "file_new_name": "spacy\\tests\\doc\\test_doc_api.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "279,281", "deleted_lines": null, "method_info": {"method_name": "test_doc_from_array_sent_starts", "method_params": "en_vocab", "method_startline": "276", "method_endline": "308"}}, "hunk_1": {"Ismethod": 1, "added_lines": "153,154,155", "deleted_lines": "153,154,155,156", "method_info": {"method_name": "test_doc_api_runtime_error", "method_params": "en_tokenizer", "method_startline": "149", "method_endline": "172"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\doc\\test_token_api.py", "file_new_name": "spacy\\tests\\doc\\test_token_api.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "217", "deleted_lines": "217", "method_info": {"method_name": "test_token_api_conjuncts_simple", "method_params": "en_vocab", "method_startline": "214", "method_endline": "220"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\parser\\test_parse_navigate.py", "file_new_name": "spacy\\tests\\parser\\test_parse_navigate.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53", "deleted_lines": "37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53", "method_info": {"method_name": "heads", "method_params": "", "method_startline": "35", "method_endline": "53"}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\regression\\test_issue2001-2500.py", "file_new_name": "spacy\\tests\\regression\\test_issue2001-2500.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "51", "deleted_lines": "51", "method_info": {"method_name": "test_issue2203", "method_params": "en_vocab", "method_startline": "43", "method_endline": "60"}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\regression\\test_issue2501-3000.py", "file_new_name": "spacy\\tests\\regression\\test_issue2501-3000.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "127", "deleted_lines": "127", "method_info": {"method_name": "test_issue2772", "method_params": "en_vocab", "method_startline": "122", "method_endline": "130"}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\regression\\test_issue4590.py", "file_new_name": "spacy\\tests\\regression\\test_issue4590.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "30", "deleted_lines": "30", "method_info": {"method_name": "test_issue4590", "method_params": "en_vocab", "method_startline": "9", "method_endline": "38"}}}}, "file_8": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "spacy\\tests\\regression\\test_issue5048.py"}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "spacy\\tests\\test_displacy.py", "file_new_name": "spacy\\tests\\test_displacy.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "78", "deleted_lines": "78", "method_info": {"method_name": "test_displacy_rtl", "method_params": "", "method_startline": "70", "method_endline": "86"}}, "hunk_1": {"Ismethod": 1, "added_lines": "34,35,36,37", "deleted_lines": "34,35,36,37", "method_info": {"method_name": "test_displacy_parse_deps", "method_params": "en_vocab", "method_startline": "23", "method_endline": "43"}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "spacy\\tests\\util.py", "file_new_name": "spacy\\tests\\util.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "31,33,34,35,36,37,38,39,40,41,42,43,44,45,46,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73", "deleted_lines": "31,32,33,34,35,39,40,41,42,43,44,50,51,52", "method_info": {"method_name": "get_doc", "method_params": "vocab,words,pos,heads,deps,tags,ents,lemmas", "method_startline": "31", "method_endline": "79"}}, "hunk_1": {"Ismethod": 1, "added_lines": "31,33,34,35,36,37,38,39,40,41,42,43,44,45,46,50,51,52,53", "deleted_lines": "29,31,32,33,34,35,39,40,41,42,43,44,50,51,52", "method_info": {"method_name": "get_doc", "method_params": "vocab,words,pos,heads,deps,tags,ents", "method_startline": "29", "method_endline": "53"}}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\tokens\\doc.pyx", "file_new_name": "spacy\\tokens\\doc.pyx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "788,789,877", "deleted_lines": "875"}}}}}}