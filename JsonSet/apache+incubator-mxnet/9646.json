{"BR": {"BR_id": "9646", "BR_author": "lebeg", "BRopenT": "2018-01-31T14:53:22Z", "BRcloseT": "2018-03-01T13:22:07Z", "BR_text": {"BRsummary": "Android build broken", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n The shared memory implementation uses POSIX function calls that are not available on Android.\n <denchmark-h:h2>Environment info (Required)</denchmark-h>\n \n <denchmark-code>----------Python Info----------\n ('Version      :', '2.7.9')\n ('Compiler     :', 'GCC 4.9.2')\n ('Build        :', ('default', 'Jun 29 2016 13:08:31'))\n ('Arch         :', ('64bit', 'ELF'))\n ------------Pip Info-----------\n ('Version      :', '9.0.1')\n ('Directory    :', '/usr/local/lib/python2.7/dist-packages/pip')\n ----------MXNet Info-----------\n No MXNet installed.\n ----------System Info----------\n ('Platform     :', 'Linux-4.9.60-linuxkit-aufs-x86_64-with-debian-8.10')\n ('system       :', 'Linux')\n ('node         :', '440208ec43e4')\n ('release      :', '4.9.60-linuxkit-aufs')\n ('version      :', '#1 SMP Mon Nov 6 16:00:12 UTC 2017')\n ----------Hardware Info----------\n ('machine      :', 'x86_64')\n ('processor    :', '')\n Architecture:          x86_64\n CPU op-mode(s):        32-bit, 64-bit\n Byte Order:            Little Endian\n CPU(s):                2\n On-line CPU(s) list:   0,1\n Thread(s) per core:    1\n Core(s) per socket:    1\n Socket(s):             2\n Vendor ID:             GenuineIntel\n CPU family:            6\n Model:                 61\n Model name:            Intel(R) Core(TM) i7-5557U CPU @ 3.10GHz\n Stepping:              4\n CPU MHz:               3097.758\n BogoMIPS:              6302.63\n L1d cache:             32K\n L1i cache:             32K\n L2 cache:              256K\n L3 cache:              4096K\n ----------Network Test----------\n Setting timeout: 10\n Timing for MXNet: https://github.com/apache/incubator-mxnet, DNS: 0.0475 sec, LOAD: 1.0690 sec.\n Timing for PYPI: https://pypi.python.org/pypi/pip, DNS: 0.0490 sec, LOAD: 0.2531 sec.\n Timing for FashionMNIST: https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/dataset/fashion-mnist/train-labels-idx1-ubyte.gz, DNS: 0.0487 sec, LOAD: 0.8761 sec.\n Timing for Conda: https://repo.continuum.io/pkgs/free/, DNS: 0.0409 sec, LOAD: 0.1492 sec.\n Timing for Gluon Tutorial(en): http://gluon.mxnet.io, DNS: 0.0607 sec, LOAD: 0.1259 sec.\n Timing for Gluon Tutorial(cn): https://zh.gluon.ai, DNS: 0.0431 sec, LOAD: 0.8136 sec.\n </denchmark-code>\n \n <denchmark-h:h2>Build info (Required if built from source)</denchmark-h>\n \n aarch64-linux-android-clang++\n MXNet commit hash:\n <denchmark-link:https://github.com/apache/incubator-mxnet/commit/5e0a0b0bd54cdeb92321f958bf964ddc8aca94e9>5e0a0b0</denchmark-link>\n \n Build config:\n Building with docker containers:\n <denchmark-code>cd docker_multiarch\n python tool.py\n </denchmark-code>\n \n With using the Dockerfile.build.android.arm64 docker file:\n <denchmark-code># Build OpenBLAS\n # https://github.com/xianyi/OpenBLAS/wiki/How-to-build-OpenBLAS-for-Android\n RUN git clone https://github.com/xianyi/OpenBLAS.git && \\\n     cd OpenBLAS && \\\n     make -j$(nproc) TARGET=ARMV8 ARM_SOFTFP_ABI=1 HOSTCC=gcc NOFORTRAN=1 libs\n \n ENV OPENBLAS_ROOT /work/OpenBLAS\n ENV LIBRARY_PATH /work/OpenBLAS/lib/:/work/OpenBLAS/:$LIBRARY_PATH\n ENV CPLUS_INCLUDE_PATH /work/OpenBLAS/include/:/work/OpenBLAS/:$CPLUS_INCLUDE_PATH\n WORKDIR /work\n \n ENV CC=${CROSS_ROOT}/bin/${CROSS_TRIPLE}-clang\n ENV CXX=${CROSS_ROOT}/bin/${CROSS_TRIPLE}-clang++\n ENV BUILD_OPTS \"USE_BLAS=openblas USE_SSE=0 DMLC_LOG_STACK_TRACE=0 USE_OPENCV=0 USE_LAPACK=0\"\n \n # Build MXNet\n ADD mxnet mxnet\n ADD arm.crosscompile.android.mk /work/mxnet/make/config.mk\n RUN cd mxnet && \\\n     make -j$(nproc) $BUILD_OPTS\n </denchmark-code>\n \n <denchmark-h:h2>Error Message:</denchmark-h>\n \n <denchmark-code>/usr/aarch64-linux-android/bin/aarch64-linux-android-clang++ -std=c++11 -c -DMSHADOW_FORCE_STREAM -Wall -Wsign-compare -O3 -DNDEBUG=1 -I/work/mxnet/mshadow/ -I/work/mxnet/dmlc-core/include -fPIC -I/work/mxnet/nnvm/include -I/work/mxnet/dlpack/include -Iinclude -funroll-loops -Wno-unused-variable -Wno-unused-parameter -Wno-unknown-pragmas -Wno-unused-local-typedefs -DMSHADOW_USE_SSE=0 -DMSHADOW_USE_CUDA=0 -DMSHADOW_USE_CBLAS=1 -DMSHADOW_USE_MKL=0 -DMSHADOW_RABIT_PS=0 -DMSHADOW_DIST_PS=0 -DMSHADOW_USE_PASCAL=0 -DMXNET_USE_OPENCV=0 -fopenmp  -DMXNET_USE_NCCL=0 -DMXNET_USE_LIBJPEG_TURBO=0 -MMD -c src/storage/storage.cc -o build/src/storage/storage.o\n In file included from src/storage/storage.cc:30:\n src/storage/./cpu_shared_storage_manager.h:167:13: error: use of undeclared identifier 'shm_open'\n       fid = shm_open(filename.c_str(), O_EXCL|O_CREAT|O_RDWR, 0666);\n             ^\n src/storage/./cpu_shared_storage_manager.h:172:11: error: use of undeclared identifier 'shm_open'\n     fid = shm_open(filename.c_str(), O_RDWR, 0666);\n           ^\n src/storage/./cpu_shared_storage_manager.h:208:14: error: use of undeclared identifier 'shm_unlink'\n     CHECK_EQ(shm_unlink(filename.c_str()), 0)\n              ^\n 3 errors generated.\n Makefile:393: recipe for target 'build/src/storage/storage.o' failed\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "lebeg", "commentT": "2018-01-31T15:07:37Z", "comment_text": "\n \t\tCreated a <denchmark-link:https://discuss.mxnet.io/t/android-build-broken/580>discussion topic</denchmark-link>\n  on this\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "lebeg", "commentT": "2018-01-31T15:49:08Z", "comment_text": "\n \t\tPlease create a thread on the dev list.\n \n Am 31.01.2018 7:08 vorm. schrieb \"Anton Chernov\" <notifications@github.com>:\n <denchmark-link:#>\u2026</denchmark-link>\n \n \n  Created a discussion topic\n  <https://discuss.mxnet.io/t/android-build-broken/580> on this\n \n  \u2014\n  You are receiving this because you are subscribed to this thread.\n  Reply to this email directly, view it on GitHub\n  <#9646 (comment)>,\n  or mute the thread\n  <https://github.com/notifications/unsubscribe-auth/ARxB64WIUehSqysKEVWfqobcsw35ExnRks5tQIHPgaJpZM4R0GEg>\n  .\n \n \n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "lebeg", "commentT": "2018-02-01T07:10:03Z", "comment_text": "\n \t\trelated issues : <denchmark-link:https://github.com/apache/incubator-mxnet/issues/8917>#8917</denchmark-link>\n  <denchmark-link:https://github.com/apache/incubator-mxnet/issues/8707>#8707</denchmark-link>\n \n the commit that introduce the bug: <denchmark-link:https://github.com/apache/incubator-mxnet/issues/8917#issuecomment-348751625>#8917 (comment)</denchmark-link>\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "lebeg", "commentT": "2018-02-01T07:17:12Z", "comment_text": "\n \t\tThanks a lot <denchmark-link:https://github.com/edmBernard>@edmBernard</denchmark-link>\n  !\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "lebeg", "commentT": "2018-03-01T13:05:25Z", "comment_text": "\n \t\tThe android build is fixed.\n \t\t"}}}, "commit": {"commit_id": "baa277dd721c74b3ce5acd72d8d1ba55ceb4ded4", "commit_author": "Anton Chernov", "commitT": "2018-02-28 10:30:13-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\storage\\cpu_shared_storage_manager.h", "file_new_name": "src\\storage\\cpu_shared_storage_manager.h", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "23,233,234", "deleted_lines": "23,24,25,26,49,50"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "src\\storage\\storage.cc", "file_new_name": "src\\storage\\storage.cc", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "178,179,180,182", "deleted_lines": null, "method_info": {"method_name": "mxnet::StorageImpl::SharedIncrementRefCount", "method_params": "handle", "method_startline": "171", "method_endline": "183"}}, "hunk_1": {"Ismethod": 1, "added_lines": "54,55,56,57,58,59,60", "deleted_lines": "54", "method_info": {"method_name": "mxnet::StorageImpl::ActivateDevice", "method_params": "ctx", "method_startline": "51", "method_endline": "73"}}, "hunk_2": {"Ismethod": 1, "added_lines": "97,99", "deleted_lines": null, "method_info": {"method_name": "mxnet::StorageImpl::Alloc", "method_params": "handle", "method_startline": "85", "method_endline": "139"}}}}}}}