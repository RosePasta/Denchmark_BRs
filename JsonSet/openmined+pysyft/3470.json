{"BR": {"BR_id": "3470", "BR_author": "LaRiffle", "BRopenT": "2020-05-08T13:13:33Z", "BRcloseT": "2020-05-14T16:46:18Z", "BR_text": {"BRsummary": "Inplace send_ & get_ on LongTensor Bug", "BRdescription": "\n Describe the bug\n This fails\n t = torch.LongTensor([2])\n p = t.send_(alice) * 2\n p.get_()\n with\n <denchmark-code>s)\n     653 \n     654         if inplace:\n --> 655             self.set_(tensor)\n     656             if hasattr(tensor, \"child\"):\n     657                 self.child = tensor.child\n \n RuntimeError: Expected object of scalar type Float but got scalar type Long for argument #2 'source' in call to _th_set_\n </denchmark-code>\n \n The reason being that after the operation * 2 the wrapper changes of type from FloatTensor to LongTensor\n That's (partly) why BatchNorm is failing <denchmark-link:https://github.com/OpenMined/PySyft/issues/2498>#2498</denchmark-link>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "ea8e9c4d6ba2f5b1f5a3fd3fc7e1d383f7c87d52", "commit_author": "Th\u00e9o Ryffel", "commitT": "2020-05-14 18:46:17+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "syft\\frameworks\\torch\\hook\\hook.py", "file_new_name": "syft\\frameworks\\torch\\hook\\hook.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "217,218,219,220,221,222,223,224", "deleted_lines": "217,218,219,220,221", "method_info": {"method_name": "create_wrapper", "method_params": "cls,wrapper_type", "method_startline": "214", "method_endline": "224"}}, "hunk_1": {"Ismethod": 1, "added_lines": "656,657,658,673,674,675,687,688,689,704,705,706", "deleted_lines": "653,654,666,670,671,683,684,699,700", "method_info": {"method_name": "_hook_module", "method_params": "self", "method_startline": "572", "method_endline": "747"}}, "hunk_2": {"Ismethod": 1, "added_lines": "704,705,706", "deleted_lines": "699,700", "method_info": {"method_name": "_hook_module.module_float_precision_", "method_params": "nn_self", "method_startline": "697", "method_endline": "708"}}, "hunk_3": {"Ismethod": 1, "added_lines": "687,688,689", "deleted_lines": "683,684", "method_info": {"method_name": "_hook_module.module_fix_precision_", "method_params": "nn_self,args,kwargs", "method_startline": "682", "method_endline": "691"}}, "hunk_4": {"Ismethod": 1, "added_lines": "656,657,658", "deleted_lines": "654", "method_info": {"method_name": "_hook_module.module_get_", "method_params": "nn_self", "method_startline": "654", "method_endline": "663"}}, "hunk_5": {"Ismethod": 1, "added_lines": "673,674,675", "deleted_lines": "670,671", "method_info": {"method_name": "_hook_module.module_share_", "method_params": "nn_self,args,kwargs", "method_startline": "668", "method_endline": "677"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "syft\\frameworks\\torch\\tensors\\interpreters\\native.py", "file_new_name": "syft\\frameworks\\torch\\tensors\\interpreters\\native.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "275,276,277,278,279", "deleted_lines": null, "method_info": {"method_name": "get_class_attributes", "method_params": "self", "method_startline": "275", "method_endline": "279"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "568", "method_info": {"method_name": "create_pointer", "method_params": "self,BaseWorker,int", "method_startline": "564", "method_endline": "573"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "syft\\generic\\frameworks\\hook\\hook.py", "file_new_name": "syft\\generic\\frameworks\\hook\\hook.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "474,475,476,477,478", "deleted_lines": "472,473,474,475,476,479", "method_info": {"method_name": "_get_hooked_method.overloaded_native_method", "method_params": "self,args,kwargs", "method_startline": "400", "method_endline": "481"}}, "hunk_1": {"Ismethod": 1, "added_lines": "474,475,476,477,478", "deleted_lines": "472,473,474,475,476,479", "method_info": {"method_name": "_get_hooked_method", "method_params": "cls,tensor_type,method_name", "method_startline": "385", "method_endline": "483"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "syft\\generic\\pointers\\pointer_tensor.py", "file_new_name": "syft\\generic\\pointers\\pointer_tensor.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "183", "method_info": {"method_name": "create_pointer", "method_params": "tensor,AbstractWorker,None,int", "method_startline": "179", "method_endline": "187"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "test\\torch\\pointers\\test_pointer_tensor.py", "file_new_name": "test\\torch\\pointers\\test_pointer_tensor.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "580,581,582,583,584,585,586,587", "deleted_lines": null, "method_info": {"method_name": "test_inplace_ops_on_remote_long_tensor", "method_params": "workers", "method_startline": "580", "method_endline": "587"}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "test\\torch\\tensors\\test_native.py", "file_new_name": "test\\torch\\tensors\\test_native.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "173", "deleted_lines": null, "method_info": {"method_name": "test_complex_model.__init__", "method_params": "self", "method_startline": "168", "method_endline": "175"}}, "hunk_1": {"Ismethod": 1, "added_lines": "163,173,185,196,197,198,199,200,201,202,203", "deleted_lines": "163", "method_info": {"method_name": "test_complex_model", "method_params": "workers", "method_startline": "160", "method_endline": "203"}}, "hunk_2": {"Ismethod": 1, "added_lines": "185", "deleted_lines": null, "method_info": {"method_name": "test_complex_model.forward", "method_params": "self,x", "method_startline": "177", "method_endline": "188"}}}}}}}