{"BR": {"BR_id": "1632", "BR_author": "freewym", "BRopenT": "2020-01-19T21:44:08Z", "BRcloseT": "2020-01-21T00:34:41Z", "BR_text": {"BRsummary": "Training loss is mixed with valid loss", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n After the latest introduction of metrics, the training loss printed as log is different from before, which I suspect is because  its value is somewhat mixed with valid loss\n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n Steps to reproduce the behavior (always include the command you ran):\n You can reproduce it by observing the difference of training losses before/after setting --disable-validation\n <denchmark-h:h4>Code sample</denchmark-h>\n \n <denchmark-h:h3>Expected behavior</denchmark-h>\n \n <denchmark-h:h3>Environment</denchmark-h>\n \n \n fairseq Version (e.g., 1.0 or master): master\n PyTorch Version (e.g., 1.0): 1.1\n OS (e.g., Linux):\n How you installed fairseq (pip, source):\n Build command you used (if compiling from source):\n Python version:\n CUDA/cuDNN version:\n GPU models and configuration:\n Any other relevant information:\n \n <denchmark-h:h3>Additional context</denchmark-h>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "freewym", "commentT": "2020-01-20T05:01:24Z", "comment_text": "\n \t\tGood catch, this bug was actually introduced in <denchmark-link:https://github.com/pytorch/fairseq/commit/60fbf64f302a825eee77637a0b7de54fde38fb2c>60fbf64</denchmark-link>\n , with the switching of lines 166/167 in train.py. Will merge a fix soon.\n \t\t"}}}, "commit": {"commit_id": "9f961964aa943d6853899ffc04916232ea7bfdba", "commit_author": "Myle Ott", "commitT": "2020-01-20 16:34:33-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "fairseq\\metrics.py", "file_new_name": "fairseq\\metrics.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "37,40,42,43,44,49,65,66,77,92", "deleted_lines": "37,40,42,43,48,49,65,66,77,92", "method_info": {"method_name": "aggregate", "method_params": "None,bool", "method_startline": "37", "method_endline": "96"}}, "hunk_1": {"Ismethod": 1, "added_lines": "37,40,42,43,44,49,65,66,77,92", "deleted_lines": "37,40,42,43,48,49,65,66,77,92", "method_info": {"method_name": "aggregate", "method_params": "None,bool", "method_startline": "37", "method_endline": "96"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "fairseq_cli\\train.py", "file_new_name": "fairseq_cli\\train.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,190", "deleted_lines": "166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,190", "method_info": {"method_name": "train", "method_params": "args,trainer,task,epoch_itr", "method_startline": "145", "method_endline": "194"}}, "hunk_1": {"Ismethod": 1, "added_lines": "235,236,237", "deleted_lines": "235,236,237,238", "method_info": {"method_name": "validate", "method_params": "args,trainer,task,epoch_itr,subsets", "method_startline": "204", "method_endline": "246"}}}}, "file_2": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tests\\test_metrics.py"}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tests\\test_reproducibility.py", "file_new_name": "tests\\test_reproducibility.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "86,87,88,89,90,91,92", "deleted_lines": null, "method_info": {"method_name": "test_mid_epoch_reproducibility", "method_params": "self", "method_startline": "86", "method_endline": "92"}}, "hunk_1": {"Ismethod": 1, "added_lines": "20,21,22,23,24,25,26,27,43,50,59", "deleted_lines": "20,36,43,52", "method_info": {"method_name": "_test_reproducibility", "method_params": "self,name,extra_flags,delta", "method_startline": "20", "method_endline": "60"}}, "hunk_2": {"Ismethod": 1, "added_lines": "20,21,22,23,24,25,26", "deleted_lines": "20", "method_info": {"method_name": "_test_reproducibility", "method_params": "self,name,extra_flags,delta,resume_checkpoint,max_epoch", "method_startline": "20", "method_endline": "26"}}}}}}}