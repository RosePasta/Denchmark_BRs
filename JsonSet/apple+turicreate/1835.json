{"BR": {"BR_id": "1835", "BR_author": "znation", "BRopenT": "2019-05-05T21:58:48Z", "BRcloseT": "2019-05-07T04:02:31Z", "BR_text": {"BRsummary": "Process crash with wrong flexible_type::get&lt;&gt;", "BRdescription": "\n Repro steps:\n \n Use the C API to call a function that expects (i.e.) an SArray of dicts, and pass in an SArray of string.\n \n Expected:\n An exception is thrown from C++, goes through the C API mechanism of error handling, and the function populates the tc_error pointer and returns.\n Actual:\n In debug:\n The assert(false) is hit, and takes down the process immediately.\n In release:\n Weird and bad things happen because of an unsafe reinterpret_cast. Likely to crash in the immediate future after the assertion would've happened in debug.\n Discussed with <denchmark-link:https://github.com/hoytak>@hoytak</denchmark-link>\n , and we think the perf hit from potentially throwing on .get won't be too bad (and in the places where profiling says it's a perf hit, we should either plumb through an  separately, or refactor to avoid calling  in a tight loop).\n \t"}, "comments": {}}, "commit": {"commit_id": "c3963c203c7d01b9202c6d8366d57f2afdcb2c03", "commit_author": "Zach Nation", "commitT": "2019-05-06 21:02:30-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 22, "file_old_name": "src\\flexible_type\\flexible_type.hpp", "file_new_name": "src\\flexible_type\\flexible_type.hpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1612", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_dict>", "method_params": "", "method_startline": "1611", "method_endline": "1614"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1572", "deleted_lines": "1575", "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_nd_vec>", "method_params": "", "method_startline": "1571", "method_endline": "1575"}}, "hunk_2": {"Ismethod": 1, "added_lines": "1916", "deleted_lines": "1919", "method_info": {"method_name": "turi::flexible_type::apply_mutating_visitor", "method_params": "visitor", "method_startline": "1892", "method_endline": "1919"}}, "hunk_3": {"Ismethod": 1, "added_lines": "1556", "deleted_lines": "1559", "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_vec>", "method_params": "", "method_startline": "1555", "method_endline": "1559"}}, "hunk_4": {"Ismethod": 1, "added_lines": "1480", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_date_time>", "method_params": "", "method_startline": "1479", "method_endline": "1482"}}, "hunk_5": {"Ismethod": 1, "added_lines": "1596", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_list>", "method_params": "", "method_startline": "1595", "method_endline": "1598"}}, "hunk_6": {"Ismethod": 1, "added_lines": "1486", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_date_time>", "method_params": "", "method_startline": "1485", "method_endline": "1488"}}, "hunk_7": {"Ismethod": 1, "added_lines": "1991", "deleted_lines": "1994", "method_info": {"method_name": "turi::flexible_type::apply_mutating_visitor", "method_params": "visitor,other", "method_startline": "1954", "method_endline": "1994"}}, "hunk_8": {"Ismethod": 1, "added_lines": "1516", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_float>", "method_params": "", "method_startline": "1515", "method_endline": "1518"}}, "hunk_9": {"Ismethod": 1, "added_lines": "2033", "deleted_lines": "2036", "method_info": {"method_name": "turi::flexible_type::apply_visitor", "method_params": "visitor,other", "method_startline": "1998", "method_endline": "2036"}}, "hunk_10": {"Ismethod": 1, "added_lines": "1493", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_int>", "method_params": "", "method_startline": "1492", "method_endline": "1495"}}, "hunk_11": {"Ismethod": 1, "added_lines": "1588", "deleted_lines": "1591", "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_list>", "method_params": "", "method_startline": "1587", "method_endline": "1591"}}, "hunk_12": {"Ismethod": 1, "added_lines": "1523", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_float>", "method_params": "", "method_startline": "1522", "method_endline": "1525"}}, "hunk_13": {"Ismethod": 1, "added_lines": "1499", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_int>", "method_params": "", "method_startline": "1498", "method_endline": "1501"}}, "hunk_14": {"Ismethod": 1, "added_lines": "1548", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_string>", "method_params": "", "method_startline": "1547", "method_endline": "1550"}}, "hunk_15": {"Ismethod": 1, "added_lines": "1604", "deleted_lines": "1607", "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_dict>", "method_params": "", "method_startline": "1603", "method_endline": "1607"}}, "hunk_16": {"Ismethod": 1, "added_lines": "1627", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_image>", "method_params": "", "method_startline": "1626", "method_endline": "1629"}}, "hunk_17": {"Ismethod": 1, "added_lines": "1948", "deleted_lines": "1951", "method_info": {"method_name": "turi::flexible_type::apply_visitor", "method_params": "visitor", "method_startline": "1924", "method_endline": "1951"}}, "hunk_18": {"Ismethod": 1, "added_lines": "1564", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_vec>", "method_params": "", "method_startline": "1563", "method_endline": "1566"}}, "hunk_19": {"Ismethod": 1, "added_lines": "1580", "deleted_lines": null, "method_info": {"method_name": "turi::flexible_type::get<flex_nd_vec>", "method_params": "", "method_startline": "1579", "method_endline": "1582"}}, "hunk_20": {"Ismethod": 1, "added_lines": "1620", "deleted_lines": "1623", "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_image>", "method_params": "", "method_startline": "1619", "method_endline": "1623"}}, "hunk_21": {"Ismethod": 1, "added_lines": "1541", "deleted_lines": "1544", "method_info": {"method_name": "turi::flexible_type::mutable_get<flex_string>", "method_params": "", "method_startline": "1540", "method_endline": "1544"}}}}}}}