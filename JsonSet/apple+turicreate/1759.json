{"BR": {"BR_id": "1759", "BR_author": "guyinbar", "BRopenT": "2019-04-22T13:02:16Z", "BRcloseT": "2019-11-07T20:18:16Z", "BR_text": {"BRsummary": "Sketch.num_na() is broken for float", "BRdescription": "\n According to documentation, Sketch.num_na() should return the exact number of missing values (<denchmark-link:https://apple.github.io/turicreate/docs/api/generated/turicreate.Sketch.html#turicreate-sketch>https://apple.github.io/turicreate/docs/api/generated/turicreate.Sketch.html#turicreate-sketch</denchmark-link>\n ), however, when  is float,  it always returns 0.\n <denchmark-code>sf = tc.SFrame({'A':[1.0, 2.0] + [float('nan')]*100})\n print sf['A'].summary().num_na() \n print len(sf['A']) - len(sf['A'].dropna()) \n </denchmark-code>\n \n <denchmark-code>sf = tc.util.generate_random_sframe(10000, 'R', random_seed=11)\n print sf['X1-R'].dtype\n print sf['X1-R'].summary().num_na() \n print len(sf) - len(sf.dropna())\n print sum(sf['X1-R'].apply(lambda x : math.isnan(x)))\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "guyinbar", "commentT": "2019-04-24T20:55:30Z", "comment_text": "\n \t\tThe name of this should be changed.  A float('nan') is not a missing value; that would be a python None.   dropna() and num_na() are not consistent in that they handle NAN differently.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "guyinbar", "commentT": "2019-04-24T20:56:02Z", "comment_text": "\n \t\tLet's change num_na to be num_missing.\n \t\t"}}}, "commit": {"commit_id": "46ca01b6baace808b32c3b7f67bdba6ca494efde", "commit_author": "Toby Roseman", "commitT": "2019-11-07 12:18:15-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\python\\turicreate\\__init__.py", "file_new_name": "src\\python\\turicreate\\__init__.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "100,101"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "src\\python\\turicreate\\aggregate.py", "file_new_name": "src\\python\\turicreate\\aggregate.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "77", "deleted_lines": "77,87,88,89,90,91,92,93", "method_info": {"method_name": "COUNT", "method_params": "args", "method_startline": "77", "method_endline": "94"}}, "hunk_1": {"Ismethod": 1, "added_lines": "77", "deleted_lines": "77,87", "method_info": {"method_name": "COUNT", "method_params": "", "method_startline": "77", "method_endline": "87"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "src\\python\\turicreate\\data_structures\\sarray.py", "file_new_name": "src\\python\\turicreate\\data_structures\\sarray.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1625,1626,1627,1628,1629,1630,1631,1632,1633,1634,1635,1636,1637,1638,1639,1640,1641,1642,1643,1644,1645,1646,1647,1648,1649,1650,1651,1652", "method_info": {"method_name": "_count_ngrams", "method_params": "self,n,method,to_lower,ignore_space", "method_startline": "1615", "method_endline": "1652"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1354,1355,1356,1357,1358,1359,1360,1361,1362,1363,1364,1365", "method_info": {"method_name": "__materialize__", "method_params": "self", "method_startline": "1354", "method_endline": "1365"}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1559,1560,1561,1562,1563,1564,1565,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1611,1612,1613", "method_info": {"method_name": "_count_words", "method_params": "self,to_lower,delimiters", "method_startline": "1559", "method_endline": "1613"}}, "hunk_3": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1879,1881,1882,1905,1906,1907,1908,1909,1910,1960,1961,1962,1963,1964", "method_info": {"method_name": "apply", "method_params": "self,fn,dtype,skip_na,seed", "method_startline": "1879", "method_endline": "1982"}}, "hunk_4": {"Ismethod": 1, "added_lines": "1771,1844", "deleted_lines": null, "method_info": {"method_name": "apply", "method_params": "self,fn,dtype,skip_na", "method_startline": "1771", "method_endline": "1862"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "src\\python\\turicreate\\data_structures\\sframe.py", "file_new_name": "src\\python\\turicreate\\data_structures\\sframe.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "2450,2496", "deleted_lines": "2450,2473,2474,2475,2476,2477,2478,2502,2503,2504,2505,2506", "method_info": {"method_name": "apply", "method_params": "self,fn,dtype", "method_startline": "2450", "method_endline": "2511"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "3705,3706,3707,3708,3709,3710,3711,3712,3713,3714,3715,3716", "method_info": {"method_name": "__materialize__", "method_params": "self", "method_startline": "3705", "method_endline": "3716"}}, "hunk_2": {"Ismethod": 1, "added_lines": "2450,2496", "deleted_lines": "2450,2473,2474,2475,2476,2477,2478,2502,2503,2504,2505,2506", "method_info": {"method_name": "apply", "method_params": "self,fn,dtype,seed", "method_startline": "2450", "method_endline": "2521"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\data_structures\\sketch.py", "file_new_name": "src\\python\\turicreate\\data_structures\\sketch.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411", "method_info": {"method_name": "num_na", "method_params": "self", "method_startline": "394", "method_endline": "411"}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\test\\test_dbscan.py", "file_new_name": "src\\python\\turicreate\\test\\test_dbscan.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "185,196,216", "deleted_lines": "185,196,216,217", "method_info": {"method_name": "test_distances", "method_params": "self", "method_startline": "169", "method_endline": "257"}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "src\\python\\turicreate\\test\\test_distances.py", "file_new_name": "src\\python\\turicreate\\test\\test_distances.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "269,270,271,272,273,274", "method_info": {"method_name": "test_local_dot_product", "method_params": "self", "method_startline": "269", "method_endline": "274"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "358,359,360,361", "method_info": {"method_name": "dot_product", "method_params": "a,b", "method_startline": "358", "method_endline": "361"}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "49,50,51", "method_info": {"method_name": "test_dot_product", "method_params": "self", "method_startline": "49", "method_endline": "51"}}, "hunk_3": {"Ismethod": 1, "added_lines": "70", "deleted_lines": "74", "method_info": {"method_name": "test_edge_cases", "method_params": "self", "method_startline": "64", "method_endline": "80"}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\test\\test_image_classifier.py", "file_new_name": "src\\python\\turicreate\\test\\test_image_classifier.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "277,278,279,280,281", "method_info": {"method_name": "setUpClass", "method_params": "self", "method_startline": "277", "method_endline": "281"}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\test\\test_knn_classifier.py", "file_new_name": "src\\python\\turicreate\\test\\test_knn_classifier.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "142,154,176", "deleted_lines": "142,154,176,177", "method_info": {"method_name": "test_distances", "method_params": "self", "method_startline": "128", "method_endline": "223"}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "src\\python\\turicreate\\test\\test_nearest_neighbors.py", "file_new_name": "src\\python\\turicreate\\test\\test_nearest_neighbors.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "293", "method_info": {"method_name": "test_create_sparse_distances", "method_params": "self", "method_startline": "284", "method_endline": "368"}}, "hunk_1": {"Ismethod": 1, "added_lines": "204,205", "deleted_lines": "204,205,207", "method_info": {"method_name": "test_create_methods", "method_params": "self", "method_startline": "188", "method_endline": "226"}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "252", "method_info": {"method_name": "test_create_dense_distances", "method_params": "self", "method_startline": "241", "method_endline": "282"}}, "hunk_3": {"Ismethod": 1, "added_lines": "1574", "deleted_lines": null, "method_info": {"method_name": "test_query_distances", "method_params": "self", "method_startline": "1569", "method_endline": "1581"}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\test\\test_recommender.py", "file_new_name": "src\\python\\turicreate\\test\\test_recommender.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "868,869,870,871,872,873,874,875,876,877,878,879", "method_info": {"method_name": "test_rmse_report", "method_params": "self", "method_startline": "868", "method_endline": "879"}}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\test\\test_recsys_api.py", "file_new_name": "src\\python\\turicreate\\test\\test_recsys_api.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "116,117", "method_info": {"method_name": "_test_basic", "method_params": "self,m", "method_startline": "100", "method_endline": "117"}}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "src\\python\\turicreate\\test\\test_sarray.py", "file_new_name": "src\\python\\turicreate\\test\\test_sarray.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1456,1457,1458,1459,1460,1461,1462,1463,1464,1465,1466,1467,1468,1469", "method_info": {"method_name": "test_word_count2", "method_params": "self", "method_startline": "1456", "method_endline": "1469"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1471,1472,1473,1474,1475,1476,1477,1478,1479,1480,1481,1482,1483,1484,1485,1486,1487,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1515,1516,1517,1518,1519,1520,1521,1522,1523,1524,1525,1526,1527,1528,1529,1530,1531,1532,1533,1534,1535,1536,1537,1538,1539,1540,1541,1542,1543,1544,1545,1546,1547,1548,1549,1550,1551", "method_info": {"method_name": "test_ngram_count", "method_params": "self", "method_startline": "1471", "method_endline": "1551"}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1433,1434,1435,1436,1437,1438,1439,1440,1441,1442,1443,1444,1445,1446,1447,1448,1449,1450,1451,1452,1453,1454", "method_info": {"method_name": "test_word_count", "method_params": "self", "method_startline": "1433", "method_endline": "1454"}}}}, "file_13": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\toolkits\\classifier\\nearest_neighbor_classifier.py", "file_new_name": "src\\python\\turicreate\\toolkits\\classifier\\nearest_neighbor_classifier.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "157", "deleted_lines": "122,123,124,125,126,127,128,129,165,166", "method_info": {"method_name": "create", "method_params": "dataset,target,features,distance,verbose", "method_startline": "115", "method_endline": "305"}}}}, "file_14": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\python\\turicreate\\toolkits\\classifier\\random_forest_classifier.py", "file_new_name": "src\\python\\turicreate\\toolkits\\classifier\\random_forest_classifier.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "585,586,587,588,589,590,591"}}}, "file_15": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\python\\turicreate\\toolkits\\clustering\\dbscan.py", "file_new_name": "src\\python\\turicreate\\toolkits\\clustering\\dbscan.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "65", "deleted_lines": "65,66,171,172,177,178,179"}}}, "file_16": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\toolkits\\drawing_classifier\\drawing_classifier.py", "file_new_name": "src\\python\\turicreate\\toolkits\\drawing_classifier\\drawing_classifier.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "754", "deleted_lines": "714,715", "method_info": {"method_name": "evaluate", "method_params": "self,dataset,metric,batch_size,verbose", "method_startline": "656", "method_endline": "754"}}}}, "file_17": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\toolkits\\image_classifier\\image_classifier.py", "file_new_name": "src\\python\\turicreate\\toolkits\\image_classifier\\image_classifier.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "230,231,232,233,234,235,236", "method_info": {"method_name": "create", "method_params": "dataset,target,feature,model,l2_penalty,l1_penalty,solver,feature_rescaling,convergence_threshold,step_size,lbfgs_memory_level,max_iterations,class_weights,validation_set,verbose,seed,batch_size", "method_startline": "38", "method_endline": "312"}}}}, "file_18": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\python\\turicreate\\toolkits\\nearest_neighbors\\_nearest_neighbors.py", "file_new_name": "src\\python\\turicreate\\toolkits\\nearest_neighbors\\_nearest_neighbors.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "123,157,158,171,172,173,174,380,461", "deleted_lines": "82,83,84,85,86,87,88,89,131,132,166,179,180,181,182,303,304,305,306,307,308,365,366,367,368,369,395,400,481"}}}, "file_19": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\python\\turicreate\\toolkits\\recommender\\item_similarity_recommender.py", "file_new_name": "src\\python\\turicreate\\toolkits\\recommender\\item_similarity_recommender.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,228,229,230,231"}}}, "file_20": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\python\\turicreate\\toolkits\\recommender\\util.py", "file_new_name": "src\\python\\turicreate\\toolkits\\recommender\\util.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1455,1456,1457,1458,1459,1460,1461,1462,1463,1464,1465,1466,1467,1468,1469,1470,1471,1472", "method_info": {"method_name": "_training_stats", "method_params": "self", "method_startline": "1455", "method_endline": "1472"}}}}, "file_21": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "src\\toolkits\\nearest_neighbors\\distance_functions.hpp", "file_new_name": "src\\toolkits\\nearest_neighbors\\distance_functions.hpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "222,223,224,225", "method_info": {"method_name": "turi::nearest_neighbors::dot_product::distance", "method_params": "a,b", "method_startline": "222", "method_endline": "225"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "214,215,216,217,218,219,220", "method_info": {"method_name": "turi::nearest_neighbors::dot_product::distance", "method_params": "a,b", "method_startline": "214", "method_endline": "220"}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "488,489", "method_info": {"method_name": "turi::nearest_neighbors::distance_metric::make_dist_instance", "method_params": "dist_name", "method_startline": "473", "method_endline": "502"}}, "hunk_3": {"Ismethod": 1, "added_lines": null, "deleted_lines": "74,75,76,77,78,79,80,81,82,83", "method_info": {"method_name": "turi::nearest_neighbors::all_pairs_dot_product", "method_params": "A,B,dists", "method_startline": "74", "method_endline": "83"}}}}, "file_22": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\toolkits\\nearest_neighbors\\distances.hpp", "file_new_name": "src\\toolkits\\nearest_neighbors\\distances.hpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "184,185,186", "method_info": {"method_name": "turi::distances::dot_product", "method_params": "a,b", "method_startline": "184", "method_endline": "186"}}}}, "file_23": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "src\\toolkits\\nearest_neighbors\\nearest_neighbors.cpp", "file_new_name": "src\\toolkits\\nearest_neighbors\\nearest_neighbors.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "168,169,170,171", "method_info": {"method_name": "turi::nearest_neighbors::find_block_neighbors", "method_params": "R,Q,neighbors,dist_name,ref_offset,query_offset", "method_startline": "150", "method_endline": "189"}}, "hunk_1": {"Ismethod": 1, "added_lines": "213", "deleted_lines": "216,217,218,219,221", "method_info": {"method_name": "turi::nearest_neighbors::off_diag_block_similarity_graph", "method_params": "R,C,neighbors,dist_name,row_offset,col_offset", "method_startline": "193", "method_endline": "230"}}}}, "file_24": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "test\\unity\\toolkits\\nearest_neighbors.cxx", "file_new_name": "test\\unity\\toolkits\\nearest_neighbors.cxx", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "490,491,492", "method_info": {"method_name": "test_nn_consistency::test_lsh_dot_product_2", "method_params": "", "method_startline": "490", "method_endline": "492"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "774,775,776", "method_info": {"method_name": "BOOST_AUTO_TEST_CASE", "method_params": "test_lsh_dot_product_2", "method_startline": "774", "method_endline": "776"}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "486,487,488", "method_info": {"method_name": "test_nn_consistency::test_lsh_dot_product_1", "method_params": "", "method_startline": "486", "method_endline": "488"}}, "hunk_3": {"Ismethod": 1, "added_lines": null, "deleted_lines": "771,772,773", "method_info": {"method_name": "BOOST_AUTO_TEST_CASE", "method_params": "test_lsh_dot_product_1", "method_startline": "771", "method_endline": "773"}}}}}}}