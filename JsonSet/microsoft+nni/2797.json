{"BR": {"BR_id": "2797", "BR_author": "mystous", "BRopenT": "2020-08-17T23:58:21Z", "BRcloseT": "2020-08-31T03:07:09Z", "BR_text": {"BRsummary": "NAS Visualization doesn't work for only ENAS micro search space", "BRdescription": "\n Environment:\n \n NNI version: 1.7\n NNI mode (local|remote|pai): remote\n Client OS: Windows\n Server OS (for remote mode only): Ubuntu\n Python version: 3.7\n PyTorch/TensorFlow version: 1.4.0(PyTorch)\n Is conda/virtualenv/venv used?: native env\n Is running in Docker?: Yes\n \n NAS Visualization doesn't work for only ENAS micro search space.\n It works well for ENAS macro search space\n ~/nni/examples/nas/enas$ python3 search.py --search-for micro --visualization\n Files already downloaded and verified\n Files already downloaded and verified\n [08/17/2020, 11:53:18 PM] INFO (nni.nas.pytorch.trainer) Creating graph json, writing to logs/1597708397.9150221. Visualization enabled.\n Traceback (most recent call last):\n File \"search.py\", line 60, in \n trainer.enable_visualization()\n File \"/home/user/.local/lib/python3.7/site-packages/nni/nas/pytorch/trainer.py\", line 189, in enable_visualization\n json.dump(self.mutator.graph(sample), f)\n File \"/home/user/.local/lib/python3.7/site-packages/nni/nas/pytorch/mutator.py\", line 115, in graph\n graph_def, _ = build_graph(self.model, inputs, verbose=False)\n File \"/home/user/.local/lib/python3.7/site-packages/nni/_graph_utils.py\", line 23, in build_graph\n g = TorchProtoGraph(model, dummy_input, verbose)\n File \"/home/user/.local/lib/python3.7/site-packages/nni/_graph_utils.py\", line 82, in \n super().(model, dummy_input)\n File \"/home/user/.local/lib/python3.7/site-packages/nni/_graph_utils.py\", line 61, in \n self._trace(model, dummy_input)\n File \"/home/user/.local/lib/python3.7/site-packages/nni/_graph_utils.py\", line 68, in _trace\n self.trace = torch.jit.trace(model, dummy_input)\n File \"/home/user/.local/lib/python3.7/site-packages/torch/jit/.py\", line 882, in trace\n check_tolerance, _force_outplace, _module_class)\n File \"/home/user/.local/lib/python3.7/site-packages/torch/jit/.py\", line 1034, in trace_module\n module._c._create_method_from_trace(method_name, func, example_inputs, var_lookup_fn, _force_outplace)\n File \"/home/user/.local/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 530, in \n result = self._slow_forward(*input, **kwargs)\n File \"/home/user/.local/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 516, in _slow_forward\n result = self.forward(*input, **kwargs)\n File \"/home/user/nni/examples/nas/enas/micro.py\", line 179, in forward\n prev, cur = layer(prev, cur)\n File \"/home/user/.local/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 530, in \n result = self._slow_forward(*input, **kwargs)\n File \"/home/user/.local/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 516, in _slow_forward\n result = self.forward(*input, **kwargs)\n File \"/home/user/nni/examples/nas/enas/micro.py\", line 117, in forward\n node_out, mask = self.nodes<denchmark-link:prev_nodes_out>i</denchmark-link>\n \n File \"/home/user/.local/lib/python3.7/site-packages/nni/nas/pytorch/mutables.py\", line 116, in \n return super().(*args, **kwargs)\n File \"/home/user/.local/lib/python3.7/site-packages/nni/nas/pytorch/mutables.py\", line 55, in \n return super().(*args, **kwargs)\n File \"/home/user/.local/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 530, in \n result = self._slow_forward(*input, **kwargs)\n File \"/home/user/.local/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 516, in _slow_forward\n result = self.forward(*input, **kwargs)\n File \"/home/user/nni/examples/nas/enas/micro.py\", line 65, in forward\n return out_x + out_y, mask_x | mask_y\n RuntimeError: cbitor is only supported for integer type tensors at /pytorch/aten/src/TH/generic/THTensorMath.cpp:66\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "mystous", "commentT": "2020-08-31T03:07:09Z", "comment_text": "\n \t\tClose this as the problem has already been fixed.\n \t\t"}}}, "commit": {"commit_id": "b168b0161987e95f9571c6fdaaef448c03ac396c", "commit_author": "Yuge Zhang", "commitT": "2020-08-24 16:24:57+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "src\\sdk\\pynni\\nni\\nas\\pytorch\\mutator.py", "file_new_name": "src\\sdk\\pynni\\nni\\nas\\pytorch\\mutator.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "165", "deleted_lines": "165", "method_info": {"method_name": "on_forward_layer_choice", "method_params": "self,mutable,args,kwargs", "method_startline": "142", "method_endline": "174"}}, "hunk_1": {"Ismethod": 1, "added_lines": "195", "deleted_lines": "195", "method_info": {"method_name": "on_forward_input_choice", "method_params": "self,mutable,tensor_list", "method_startline": "176", "method_endline": "200"}}}}}}}