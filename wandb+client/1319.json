{"BR": {"BR_id": "1319", "BR_author": "jliu", "BRopenT": "2020-10-05T06:54:54Z", "BRcloseT": "2020-10-16T16:30:33Z", "BR_text": {"BRsummary": "bug with matplotlib subplots", "BRdescription": "\n The following example does not work with wandb:\n <denchmark-code>from matplotlib import pyplot as plt\n import wandb\n \n wandb.init(project='test')\n fig, ax = plt.subplots(2)\n ax[0].plot([1, 2, 3])\n wandb.log({'figure': wandb.Image(plt)}, step=0)\n \n </denchmark-code>\n \n and gives error message:\n Traceback (most recent call last):\n File \"wandb_broken_example.py\", line 9, in \n wandb.log({'figure': wandb.Image(plt)}, step=0)\n File \"/h/jyliu/miniconda3/envs/geom/lib/python3.8/site-packages/wandb/data_types.py\", line 887, in init\n util.ensure_matplotlib_figure(data).savefig(buf)\n File \"/h/jyliu/miniconda3/envs/geom/lib/python3.8/site-packages/wandb/util.py\", line 334, in ensure_matplotlib_figure\n raise ValueError(\n ValueError: You attempted to log an empty plot, pass a figure directly or ensure the global plot isn't closed.\n This is very similar to <denchmark-link:https://github.com/comet-ml/issue-tracking/issues/312>this Comet bug</denchmark-link>\n , where the usage of <denchmark-link:https://github.com/wandb/client/blob/master/wandb/util.py#L333>gca().has_data()</denchmark-link>\n  is causing problems.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "jliu", "commentT": "2020-10-05T06:54:56Z", "comment_text": "\n \t\tIssue-Label Bot is automatically applying the label bug to this issue, with a confidence of 0.99. Please mark this comment with \ud83d\udc4d or \ud83d\udc4e to give our bot feedback!\n Links: <denchmark-link:https://github.com/marketplace/issue-label-bot>app homepage</denchmark-link>\n , <denchmark-link:https://mlbot.net/data/wandb/client>dashboard</denchmark-link>\n  and <denchmark-link:https://github.com/hamelsmu/MLapp>code</denchmark-link>\n  for this bot.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "jliu", "commentT": "2020-10-05T09:42:07Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/jliu>@jliu</denchmark-link>\n , thank you for reporting this. We're looking into this.\n \t\t"}}}, "commit": {"commit_id": "695007b7f46682927909380c18ca7950abbe81ab", "commit_author": "Tim Sweeney", "commitT": "2020-10-16 09:30:32-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "requirements_dev.txt", "file_new_name": "requirements_dev.txt", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "26", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "tests\\test_data_types.py", "file_new_name": "tests\\test_data_types.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "244,245,246,247,248,249,250,251,252,253", "deleted_lines": null, "method_info": {"method_name": "test_matplotlib_image_with_multiple_axes", "method_params": "", "method_startline": "244", "method_endline": "253"}}, "hunk_1": {"Ismethod": 1, "added_lines": "255,256,257,258,259,260,261,262,263,264", "deleted_lines": null, "method_info": {"method_name": "test_matplotlib_plotly_with_multiple_axes", "method_params": "", "method_startline": "255", "method_endline": "264"}}, "hunk_2": {"Ismethod": 1, "added_lines": "307,308,309,310,311,312,313,314,315,316,317", "deleted_lines": null, "method_info": {"method_name": "test_make_plot_media_from_matplotlib_with_image", "method_params": "", "method_startline": "307", "method_endline": "317"}}, "hunk_3": {"Ismethod": 1, "added_lines": "266,267,268,269,270,271,272,273,274,275,276,277,278,279,280", "deleted_lines": null, "method_info": {"method_name": "test_plotly_from_matplotlib_with_image", "method_params": "", "method_startline": "266", "method_endline": "280"}}, "hunk_4": {"Ismethod": 1, "added_lines": "295,296,297,298,299,300,301,302,303,304,305", "deleted_lines": null, "method_info": {"method_name": "test_make_plot_media_from_matplotlib_without_image", "method_params": "", "method_startline": "295", "method_endline": "305"}}, "hunk_5": {"Ismethod": 1, "added_lines": "282,283,284,285,286,287,288,289,290,291,292,293", "deleted_lines": null, "method_info": {"method_name": "test_image_from_matplotlib_with_image", "method_params": "", "method_startline": "282", "method_endline": "293"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tests\\test_util.py", "file_new_name": "tests\\test_util.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256", "deleted_lines": null, "method_info": {"method_name": "test_matplotlib_contains_images", "method_params": "", "method_startline": "235", "method_endline": "256"}}, "hunk_1": {"Ismethod": 1, "added_lines": "258,259,260,261,262,263,264,265,266,267", "deleted_lines": null, "method_info": {"method_name": "test_matplotlib_to_plotly", "method_params": "", "method_startline": "258", "method_endline": "267"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\utils\\__init__.py", "file_new_name": "tests\\utils\\__init__.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "1,2,3,4,5,32,33,34", "deleted_lines": null}}}, "file_4": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tests\\utils\\dummy_data.py"}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "wandb\\data_types.py", "file_new_name": "wandb\\data_types.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1276,1278", "deleted_lines": "1276,1277,1279", "method_info": {"method_name": "make_plot_media", "method_params": "cls,val", "method_startline": "1274", "method_endline": "1279"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1283,1285,1286,1287,1288,1289,1290,1291,1292,1293,1294", "deleted_lines": "1281,1282,1283,1289,1290", "method_info": {"method_name": "__init__", "method_params": "self,val,kwargs", "method_startline": "1281", "method_endline": "1299"}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "wandb\\util.py", "file_new_name": "wandb\\util.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "345,346,347", "deleted_lines": null, "method_info": {"method_name": "matplotlib_contains_images", "method_params": "obj", "method_startline": "345", "method_endline": "347"}}, "hunk_1": {"Ismethod": 1, "added_lines": "339,340,341,342,343", "deleted_lines": "339", "method_info": {"method_name": "matplotlib_to_plotly", "method_params": "obj", "method_startline": "339", "method_endline": "343"}}, "hunk_2": {"Ismethod": 1, "added_lines": "339,340", "deleted_lines": "337,338,339", "method_info": {"method_name": "ensure_matplotlib_figure", "method_params": "obj", "method_startline": "299", "method_endline": "340"}}}}}}}