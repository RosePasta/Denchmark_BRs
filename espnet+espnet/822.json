{"BR": {"BR_id": "822", "BR_author": "kan-bayashi", "BRopenT": "2019-06-08T11:36:25Z", "BRcloseT": "2019-06-25T06:28:01Z", "BR_text": {"BRsummary": "Output dimension of Conv2dSubsampling", "BRdescription": "\n Conv2dSubsampling layer cause dimension mismatch when idim is multiple of 4.\n \n \n \n espnet/espnet/nets/pytorch_backend/transformer/subsampling.py\n \n \n         Lines 14 to 25\n       in\n       577baff\n \n \n \n \n \n \n  def __init__(self, idim, odim, dropout_rate): \n \n \n \n  super(Conv2dSubsampling, self).__init__() \n \n \n \n  self.conv = torch.nn.Sequential( \n \n \n \n  torch.nn.Conv2d(1, odim, 3, 2), \n \n \n \n  torch.nn.ReLU(), \n \n \n \n  torch.nn.Conv2d(odim, odim, 3, 2), \n \n \n \n  torch.nn.ReLU() \n \n \n \n      ) \n \n \n \n  self.out = torch.nn.Sequential( \n \n \n \n  torch.nn.Linear(odim * (idim // 4), odim), \n \n \n \n  PositionalEncoding(odim, dropout_rate) \n \n \n \n      ) \n \n \n \n \n \n [ins] In [8]: conv = torch.nn.Conv2d(1, 1, 3, 2)\n \n [ins] In [9]: input = torch.zeros((1, 1, 20, 20))\n \n [ins] In [10]: out1 = conv(input)\n \n [ins] In [11]: out1.shape\n Out[11]: torch.Size([1, 1, 9, 9])\n \n [ins] In [12]: out2 = conv(out1)\n \n [ins] In [13]: out2.shape\n Out[13]: torch.Size([1, 1, 4, 4])\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "kan-bayashi", "commentT": "2019-06-11T01:57:40Z", "comment_text": "\n \t\tlet me fix this in <denchmark-link:https://github.com/espnet/espnet/pull/774>#774</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "kan-bayashi", "commentT": "2019-06-11T11:21:36Z", "comment_text": "\n \t\tFixed in <denchmark-link:https://github.com/espnet/espnet/pull/774>#774</denchmark-link>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "kan-bayashi", "commentT": "2019-06-25T06:27:57Z", "comment_text": "\n \t\tFixed <denchmark-link:https://github.com/espnet/espnet/pull/774>#774</denchmark-link>\n  <denchmark-link:https://github.com/espnet/espnet/issues/822>#822</denchmark-link>\n  <denchmark-link:https://github.com/espnet/espnet/pull/921>#921</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "aca5f0812cd44813d6703e6a13a075ada6b99e81", "commit_author": "Fhrozen", "commitT": "2019-06-11 19:41:31+09:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "espnet\\nets\\pytorch_backend\\transformer\\subsampling.py", "file_new_name": "espnet\\nets\\pytorch_backend\\transformer\\subsampling.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": "23", "method_info": {"method_name": "__init__", "method_params": "self,idim,odim,dropout_rate", "method_startline": "14", "method_endline": "25"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "test\\test_e2e_transformer.py", "file_new_name": "test\\test_e2e_transformer.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "59,60,62,68", "deleted_lines": "60,66", "method_info": {"method_name": "prepare", "method_params": "backend", "method_startline": "49", "method_endline": "98"}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "135", "method_info": {"method_name": "test_transformer_synth", "method_params": "module", "method_startline": "112", "method_endline": "165"}}}}}}}