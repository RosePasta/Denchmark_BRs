{"BR": {"BR_id": "79", "BR_author": "lastzero", "BRopenT": "2018-12-11T06:46:53Z", "BRcloseT": "2019-05-26T19:40:22Z", "BR_text": {"BRsummary": "API tests show error on Travis CI but tests are green", "BRdescription": "\n See <denchmark-link:https://travis-ci.org/photoprism/photoprism/jobs/466362413#L631>https://travis-ci.org/photoprism/photoprism/jobs/466362413#L631</denchmark-link>\n \n <denchmark-code>=== RUN   TestGetPhotos\n --- PASS: TestGetPhotos (0.01s)\n === RUN   TestLikePhoto\n (Error 1292: Incorrect datetime value: '0000-00-00' for column 'taken_at' at row 1) \n [2018-12-11 06:35:04]  \n --- PASS: TestLikePhoto (0.00s)\n === RUN   TestDislikePhoto\n (Error 1292: Incorrect datetime value: '0000-00-00' for column 'taken_at' at row 1) \n [2018-12-11 06:35:04]  \n --- PASS: TestDislikePhoto (0.02s)\n PASS\n ok  \tgithub.com/photoprism/photoprism/internal/api\t0.365s\n </denchmark-code>\n \n Maybe models are not properly initialized? Check GORM docs and compare to other code.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "lastzero", "commentT": "2018-12-11T08:10:23Z", "comment_text": "\n \t\tMaybe it is not GORM related? I see that following change has been made\n to      const DataURL = \"<denchmark-link:https://dl.photoprism.org/fixtures/photos.zip>https://dl.photoprism.org/fixtures/photos.zip</denchmark-link>\n \"\n from const DataURL = \"<denchmark-link:https://www.dropbox.com/s/na9p9wwt98l7m5b/import.zip?dl=1>https://www.dropbox.com/s/na9p9wwt98l7m5b/import.zip?dl=1</denchmark-link>\n \"\n However, when we look at the download server, only demo.zip and test.zip are there.  In this case, no photo record will be created thus return NULL \uff08\u20180000-00-00\u2019\uff09\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "lastzero", "commentT": "2018-12-11T08:18:59Z", "comment_text": "\n \t\tTest fixtures are cached in /tmp (only the file hash is compared, not the original download URL). You can pull / merge again, I changed the file name a few times. Should exist, worked for me. We have our own download server now.\n I've seen the error before somewhere else, it was easy to fix... not quite sure what it was.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "lastzero", "commentT": "2019-04-26T02:27:19Z", "comment_text": "\n \t\tIn fact, tests failed whenever database was empty as there was not photo with ID 1. We need to create default test fixtures that are there from the start.\n \t\t"}}}, "commit": {"commit_id": "2e418d6e1e73d78c6708c13ee29736c52a80511d", "commit_author": "Michael Mayer", "commitT": "2019-04-26 04:25:00+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "internal\\api\\photos.go", "file_new_name": "internal\\api\\photos.go", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "64,65,66,67,68,69,70", "deleted_lines": "64", "method_info": {"method_name": "", "method_params": "", "method_startline": "55", "method_endline": "74"}}, "hunk_1": {"Ismethod": 1, "added_lines": "64,65,66,67,68,69,70", "deleted_lines": "64", "method_info": {"method_name": "LikePhoto", "method_params": "RouterGroup,Config", "method_startline": "54", "method_endline": "75"}}, "hunk_2": {"Ismethod": 1, "added_lines": "91,92,93,94,95,96,97", "deleted_lines": "85", "method_info": {"method_name": "DislikePhoto", "method_params": "RouterGroup,Config", "method_startline": "81", "method_endline": "102"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "internal\\api\\photos_test.go", "file_new_name": "internal\\api\\photos_test.go", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "27,28,29,30", "deleted_lines": "27", "method_info": {"method_name": "TestLikePhoto", "method_params": "T", "method_startline": "20", "method_endline": "31"}}, "hunk_1": {"Ismethod": 1, "added_lines": "40,41,42,43", "deleted_lines": "37", "method_info": {"method_name": "TestDislikePhoto", "method_params": "T", "method_startline": "33", "method_endline": "44"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "internal\\api\\thumbnails.go", "file_new_name": "internal\\api\\thumbnails.go", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "36,37,38,39,40,41,42", "deleted_lines": "36", "method_info": {"method_name": "GetThumbnail", "method_params": "RouterGroup,Config", "method_startline": "24", "method_endline": "76"}}, "hunk_1": {"Ismethod": 1, "added_lines": "36,37,38,39,40,41,42", "deleted_lines": "36", "method_info": {"method_name": "", "method_params": "", "method_startline": "25", "method_endline": "75"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "internal\\photoprism\\search.go", "file_new_name": "internal\\photoprism\\search.go", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "187,188,189,190,192", "deleted_lines": "187,188,190", "method_info": {"method_name": "FindFiles", "method_params": "int,int", "method_startline": "187", "method_endline": "193"}}, "hunk_1": {"Ismethod": 1, "added_lines": "205,206,207,208,209,210", "deleted_lines": "207,208,210", "method_info": {"method_name": "FindFileByHash", "method_params": "string", "method_startline": "205", "method_endline": "211"}}, "hunk_2": {"Ismethod": 1, "added_lines": "196,197,198,199,201", "deleted_lines": "197,201,202", "method_info": {"method_name": "FindFileByID", "method_params": "string", "method_startline": "196", "method_endline": "202"}}, "hunk_3": {"Ismethod": 1, "added_lines": "214,215,216,217,219", "deleted_lines": null, "method_info": {"method_name": "FindPhotoByID", "method_params": "uint64", "method_startline": "214", "method_endline": "220"}}}}}}}