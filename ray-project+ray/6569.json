{"BR": {"BR_id": "6569", "BR_author": "dschaehi", "BRopenT": "2019-12-21T09:22:36Z", "BRcloseT": "2019-12-25T07:15:33Z", "BR_text": {"BRsummary": "[tune] Ray Tune fails to parse typing hints of the function for experiment", "BRdescription": "\n <denchmark-h:h3>What is the problem?</denchmark-h>\n \n If the function for experiment has a <denchmark-link:https://docs.python.org/3/library/typing.html>typing hint</denchmark-link>\n  for its argument , then Ray Tune fails to parse the argument and assumes that there is a reporter signature. The cause of this problem is in this source code:\n \n \n Changing\n \n to\n \n might solve the problem.\n Ray version and other system information (Python version, TensorFlow version, OS):\n Ray: 0.8.0\n Python: 3.7.5\n OS: Ubuntu 18.04\n Does the problem occur on the latest wheels?\n I couldn't install the latest wheel. So I can't confirm it.\n <denchmark-h:h3>Reproduction</denchmark-h>\n \n The following is a modification of the first examples in the <denchmark-link:https://ray.readthedocs.io/en/latest/tune.html#quick-start>Ray Tune Documentation</denchmark-link>\n , where I added a typing hint   for the argument of function .\n <denchmark-code>from typing import Dict, Any\n \n import torch.optim as optim\n from ray import tune\n from ray.tune.examples.mnist_pytorch import get_data_loaders, ConvNet, train, test\n \n \n def train_mnist(config: Dict[str, Any]):\n     train_loader, test_loader = get_data_loaders()\n     model = ConvNet()\n     optimizer = optim.SGD(model.parameters(), lr=config[\"lr\"])\n     for i in range(10):\n         train(model, optimizer, train_loader)\n         acc = test(model, test_loader)\n         tune.track.log(mean_accuracy=acc)\n \n \n analysis = tune.run(train_mnist, config={\"lr\": tune.grid_search([0.001, 0.01, 0.1])})\n \n print(\"Best config: \", analysis.get_best_config(metric=\"mean_accuracy\"))\n \n # Get a dataframe for analyzing trial results.\n df = analysis.dataframe()\n </denchmark-code>\n \n When running the code you get this error message:\n TypeError: train_mnist() takes 1 positional argument but 2 were given\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "dschaehi", "commentT": "2019-12-21T14:21:06Z", "comment_text": "\n \t\tThanks for opening this PR! Opened <denchmark-link:https://github.com/ray-project/ray/pull/6571>#6571</denchmark-link>\n  to fix this.\n \t\t"}}}, "commit": {"commit_id": "aa7b861332c83c802037ee13f2207938e394e1a0", "commit_author": "Richard Liaw", "commitT": "2019-12-25 08:15:33+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docker\\tune_test\\Dockerfile", "file_new_name": "docker\\tune_test\\Dockerfile", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "9", "deleted_lines": "9"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\tune\\function_runner.py", "file_new_name": "python\\ray\\tune\\function_runner.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "252,253,254,255", "deleted_lines": "251", "method_info": {"method_name": "wrap_function", "method_params": "train_func", "method_startline": "248", "method_endline": "280"}}}}}}}