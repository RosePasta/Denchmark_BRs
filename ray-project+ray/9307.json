{"BR": {"BR_id": "9307", "BR_author": "deanwampler", "BRopenT": "2020-07-05T17:45:42Z", "BRcloseT": "2020-07-17T20:52:55Z", "BR_text": {"BRsummary": "[Tune] status tables during training aren't showing values for tunable, nested config parameters", "BRdescription": "\n <denchmark-h:h3>What is the problem?</denchmark-h>\n \n Ray 0.8.6. Python 3.7.7.\n Running this script (actually run with ipython):\n from ray import tune\n ray.init()\n tune.run(\n     \"PPO\",\n     stop={\"episode_reward_mean\": 400},\n     config={\n         \"env\": \"CartPole-v1\",\n         \"num_gpus\": 0,\n         \"num_workers\": 1,\n         # \"lr\": tune.grid_search([0.01, 0.001, 0.0001]),\n         \"model\": {\n             'fcnet_hiddens': [tune.grid_search([20, 40, 60, 80]), tune.grid_search([20, 40, 60, 80])]\n         },\n         \"eager\": False,\n     },\n )\n It appears that Tune easily drives the 16 different combinations for the two elements of fcnet_hidden (number of weights for two NN layers). All combinations easily reach the reward of 400, but some do so with lower iterations and/or elapsed times, which is what I want to determine.\n The bug is in the status table printed. It has two columns for the tuning parameters, model/fcnet_hiddens/0 and model/fcnet_hiddens/1, but they are empty. I can determine the actual values by looking at the experiment_tag, e.g.,  experiment_tag: 8_fcnet_hiddens_0=20,fcnet_hiddens_1=60\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "deanwampler", "commentT": "2020-07-14T02:17:24Z", "comment_text": "\n \t\tTaking a look at this this week. I can reproduce the issue locally.\n <denchmark-code>== Status ==\n Memory usage on this node: 10.5/16.0 GiB\n Using FIFO scheduling algorithm.\n Resources requested: 8/8 CPUs, 0/0 GPUs, 0.0/4.49 GiB heap, 0.0/1.51 GiB objects\n Number of trials: 16 (4 RUNNING, 12 TERMINATED)\n +-----------------------------+------------+--------------------+-------------------------+-------------------------+--------+------------------+--------+----------+\n | Trial name                  | status     | loc                | model/fcnet_hiddens/0   | model/fcnet_hiddens/1   |   iter |   total time (s) |     ts |   reward |\n |-----------------------------+------------+--------------------+-------------------------+-------------------------+--------+------------------+--------+----------|\n | PPO_CartPole-v1_e7acd_00000 | TERMINATED |                    |                         |                         |     18 |          220.755 |  72000 |   406.54 |\n | PPO_CartPole-v1_e7acd_00001 | TERMINATED |                    |                         |                         |     31 |          371.998 | 124000 |   403.33 |\n | PPO_CartPole-v1_e7acd_00002 | TERMINATED |                    |                         |                         |     18 |          220.732 |  72000 |   406.52 |\n | PPO_CartPole-v1_e7acd_00003 | TERMINATED |                    |                         |                         |     15 |          189.082 |  60000 |   409.03 |\n | PPO_CartPole-v1_e7acd_00004 | TERMINATED |                    |                         |                         |     19 |          233.262 |  76000 |   410.45 |\n | PPO_CartPole-v1_e7acd_00005 | TERMINATED |                    |                         |                         |     22 |          260.052 |  88000 |   412.14 |\n | PPO_CartPole-v1_e7acd_00006 | TERMINATED |                    |                         |                         |     30 |          354.216 | 120000 |   401.67 |\n | PPO_CartPole-v1_e7acd_00007 | TERMINATED |                    |                         |                         |     18 |          211.58  |  72000 |   403.37 |\n | PPO_CartPole-v1_e7acd_00008 | TERMINATED |                    |                         |                         |     19 |          222.288 |  76000 |   416.59 |\n | PPO_CartPole-v1_e7acd_00009 | TERMINATED |                    |                         |                         |     19 |          218.809 |  76000 |   406.62 |\n | PPO_CartPole-v1_e7acd_00010 | TERMINATED |                    |                         |                         |     16 |          531.601 |  64000 |   400.38 |\n | PPO_CartPole-v1_e7acd_00011 | TERMINATED |                    |                         |                         |     21 |         4509.18  |  84000 |   415.27 |\n | PPO_CartPole-v1_e7acd_00012 | RUNNING    | 192.168.2.66:49528 |                         |                         |     16 |         4449.35  |  64000 |   383.28 |\n | PPO_CartPole-v1_e7acd_00013 | RUNNING    | 192.168.2.66:49553 |                         |                         |     12 |         4406.25  |  48000 |   292.06 |\n | PPO_CartPole-v1_e7acd_00014 | RUNNING    | 192.168.2.66:49578 |                         |                         |      5 |         3502.22  |  20000 |   110.89 |\n | PPO_CartPole-v1_e7acd_00015 | RUNNING    |                    |                         |                         |        |                  |        |          |\n +-----------------------------+------------+--------------------+-------------------------+-------------------------+--------+------------------+--------+----------+\n </denchmark-code>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "deanwampler", "commentT": "2020-07-14T04:03:36Z", "comment_text": "\n \t\tthe trial config contains the model/fcnet_hiddens key e.g. {'env': 'CartPole-v1', 'num_gpus': 0, 'num_workers': 1, 'eager': False, 'model/fcnet_hiddens': [20, 20]} whereas trial.evaluated_params contains the flattened keys e.g. {'model/fcnet_hiddens/0': 20, 'model/fcnet_hiddens/1': 20} instead.\n progress_reporter uses trial.evaluated_params to generate the header and looks into trial.config for the config values\n \t\t"}}}, "commit": {"commit_id": "87630cf024cd00b79e6f13831150b59629252973", "commit_author": "krfricke", "commitT": "2020-07-17 13:52:54-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\tune\\progress_reporter.py", "file_new_name": "python\\ray\\tune\\progress_reporter.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "469,470,472,473", "deleted_lines": "469,470,472,473", "method_info": {"method_name": "_get_trial_info", "method_params": "trial,parameters,metrics", "method_startline": "459", "method_endline": "474"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\tune\\tests\\test_progress_reporter.py", "file_new_name": "python\\ray\\tune\\tests\\test_progress_reporter.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "249,250,251,252,253,254,255,259,260,261,262,269,271", "deleted_lines": "249,250,254,261,263", "method_info": {"method_name": "testProgressStr", "method_params": "self", "method_startline": "236", "method_endline": "289"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\tune\\utils\\__init__.py", "file_new_name": "python\\ray\\tune\\utils\\__init__.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "2,3,11", "deleted_lines": "2,3"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\tune\\utils\\util.py", "file_new_name": "python\\ray\\tune\\utils\\util.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237", "deleted_lines": null, "method_info": {"method_name": "unflattened_lookup", "method_params": "flat_key,lookup,delimiter,default", "method_startline": "219", "method_endline": "237"}}}}}}}