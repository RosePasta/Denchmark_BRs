{"BR": {"BR_id": "10433", "BR_author": "kfstorm", "BRopenT": "2020-08-31T03:42:04Z", "BRcloseT": "2020-09-11T11:05:30Z", "BR_text": {"BRsummary": "Allow users to specify the classpath of Java workers in driver options", "BRdescription": "\n There's an existing option named ray.job.resource-path, which allows users to specify the parent directory of a job resource directory. When a worker process is about to execute a task, it creates a class loader for this job from a child directory named by job ID from the parent directory. This approach is not usable since most likely users won't specify the job ID when starting a driver and the job ID is generated automatically.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "kfstorm", "commentT": "2020-08-31T03:42:21Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ray-project/ray/issues/7291>#7291</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "bbfbc98a4155cbe79e001efb8e7cd9821c0f7d97", "commit_author": "chaokunyang", "commitT": "2020-09-09 00:46:32+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "doc\\source\\cross-language.rst", "file_new_name": "doc\\source\\cross-language.rst", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,63,79,85,114,161,190,294", "deleted_lines": "44,60,66,95,142,171,275"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "doc\\source\\starting-ray.rst", "file_new_name": "doc\\source\\starting-ray.rst", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "138,139,191,192,193,194,195", "deleted_lines": "155,156,162"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\AbstractRayRuntime.java", "file_new_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\AbstractRayRuntime.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "72", "deleted_lines": "72", "method_info": {"method_name": "AbstractRayRuntime::AbstractRayRuntime", "method_params": "rayConfig", "method_startline": "69", "method_endline": "74"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\RayNativeRuntime.java", "file_new_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\RayNativeRuntime.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "160,161", "deleted_lines": "160", "method_info": {"method_name": "RayNativeRuntime::start", "method_params": "", "method_startline": "140", "method_endline": "181"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\config\\RayConfig.java", "file_new_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\config\\RayConfig.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "317", "deleted_lines": "314", "method_info": {"method_name": "RayConfig::render", "method_params": "", "method_startline": "308", "method_endline": "320"}}, "hunk_1": {"Ismethod": 1, "added_lines": "230,231,232,233,235", "deleted_lines": "228,229,230,232", "method_info": {"method_name": "RayConfig::RayConfig", "method_params": "config", "method_startline": "120", "method_endline": "256"}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\functionmanager\\FunctionManager.java", "file_new_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\functionmanager\\FunctionManager.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "70,71", "deleted_lines": null, "method_info": {"method_name": "FunctionManager::FunctionManager", "method_params": "codeSearchPath", "method_startline": "70", "method_endline": "72"}}, "hunk_1": {"Ismethod": 1, "added_lines": "70", "deleted_lines": "68,69", "method_info": {"method_name": "FunctionManager::FunctionManager", "method_params": "jobResourcePath", "method_startline": "68", "method_endline": "70"}}, "hunk_2": {"Ismethod": 1, "added_lines": "120,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148", "deleted_lines": "118,121,122,123,124,125,126,127,128,129,130,131,132,133,134", "method_info": {"method_name": "FunctionManager::createJobFunctionTable", "method_params": "jobId", "method_startline": "118", "method_endline": "152"}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\runner\\RunManager.java", "file_new_name": "java\\runtime\\src\\main\\java\\io\\ray\\runtime\\runner\\RunManager.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "360,361,362,363", "deleted_lines": "360", "method_info": {"method_name": "RunManager::buildWorkerCommand", "method_params": "", "method_startline": "343", "method_endline": "376"}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "java\\runtime\\src\\main\\resources\\ray.default.conf", "file_new_name": "java\\runtime\\src\\main\\resources\\ray.default.conf", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "25,26,27,28", "deleted_lines": "25,26,27,28"}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "java\\runtime\\src\\test\\java\\io\\ray\\runtime\\config\\RayConfigTest.java", "file_new_name": "java\\runtime\\src\\test\\java\\io\\ray\\runtime\\config\\RayConfigTest.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "15,18,19,22", "deleted_lines": "14,17,20", "method_info": {"method_name": "RayConfigTest::testCreateRayConfig", "method_params": "", "method_startline": "13", "method_endline": "24"}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "java\\runtime\\src\\test\\java\\io\\ray\\runtime\\functionmanager\\FunctionManagerTest.java", "file_new_name": "java\\runtime\\src\\test\\java\\io\\ray\\runtime\\functionmanager\\FunctionManagerTest.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "155,156,168,169,174,182,183", "deleted_lines": "154,155,156,168,169,174,182", "method_info": {"method_name": "FunctionManagerTest::testGetFunctionFromLocalResource", "method_params": "", "method_startline": "153", "method_endline": "186"}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "java\\test.sh", "file_new_name": "java\\test.sh", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "49,50,51,52,53,54,55,56,57,58", "deleted_lines": null}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "java\\test\\src\\main\\java\\io\\ray\\test\\BaseMultiLanguageTest.java", "file_new_name": "java\\test\\src\\main\\java\\io\\ray\\test\\BaseMultiLanguageTest.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "70,72,74,86,87,89", "deleted_lines": "69,71,72,74,86,87", "method_info": {"method_name": "BaseMultiLanguageTest::setUp", "method_params": "", "method_startline": "56", "method_endline": "101"}}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "java\\test\\src\\main\\java\\io\\ray\\test\\ClassLoaderTest.java", "file_new_name": "java\\test\\src\\main\\java\\io\\ray\\test\\ClassLoaderTest.java", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "37", "deleted_lines": "38", "method_info": {"method_name": "ClassLoaderTest::tearDown", "method_params": "", "method_startline": "36", "method_endline": "38"}}, "hunk_1": {"Ismethod": 1, "added_lines": "31,32", "deleted_lines": "32,33", "method_info": {"method_name": "ClassLoaderTest::setUp", "method_params": "", "method_startline": "29", "method_endline": "33"}}, "hunk_2": {"Ismethod": 1, "added_lines": "42,47,48,49,85,86,92", "deleted_lines": "43,44,49,50,86,87,93", "method_info": {"method_name": "ClassLoaderTest::testClassLoaderInMultiThreading", "method_params": "", "method_startline": "41", "method_endline": "130"}}}}, "file_13": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "python\\ray\\job_config.py", "file_new_name": "python\\ray\\job_config.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,worker_env,num_java_workers_per_process,jvm_options,code_search_path", "method_startline": "18", "method_endline": "23"}}, "hunk_1": {"Ismethod": 1, "added_lines": "44", "deleted_lines": null, "method_info": {"method_name": "serialize", "method_params": "self", "method_startline": "37", "method_endline": "45"}}}}, "file_14": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\node.py", "file_new_name": "python\\ray\\node.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "733,734", "deleted_lines": "733", "method_info": {"method_name": "start_raylet", "method_params": "self,use_valgrind,use_profiler", "method_startline": "691", "method_endline": "736"}}}}, "file_15": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "python\\ray\\parameter.py", "file_new_name": "python\\ray\\parameter.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "150", "deleted_lines": "150", "method_info": {"method_name": "__init__", "method_params": "self,redis_address,num_cpus,num_gpus,resources,memory,object_store_memory,redis_max_memory,redis_port,redis_shard_ports,object_manager_port,node_manager_port,gcs_server_port,node_ip_address,raylet_ip_address,min_worker_port,max_worker_port,object_ref_seed,driver_mode,redirect_worker_output,redirect_output,num_redis_shards,redis_max_clients,redis_password,plasma_directory,worker_path,huge_pages,include_dashboard,dashboard_host,dashboard_port,logging_level,logging_format,plasma_store_socket_name,raylet_socket_name,temp_dir,include_log_monitor,autoscaling_config,include_java,java_worker_options,load_code_from_local,start_initial_python_workers_for_first_job,_system_config,enable_object_reconstruction,metrics_agent_port,metrics_export_port,lru_evict,object_spilling_config", "method_startline": "104", "method_endline": "150"}}, "hunk_1": {"Ismethod": 1, "added_lines": "150,151", "deleted_lines": "150", "method_info": {"method_name": "__init__", "method_params": "self,redis_address,num_cpus,num_gpus,resources,memory,object_store_memory,redis_max_memory,redis_port,redis_shard_ports,object_manager_port,node_manager_port,gcs_server_port,node_ip_address,raylet_ip_address,min_worker_port,max_worker_port,object_ref_seed,driver_mode,redirect_worker_output,redirect_output,num_redis_shards,redis_max_clients,redis_password,plasma_directory,worker_path,huge_pages,include_dashboard,dashboard_host,dashboard_port,logging_level,logging_format,plasma_store_socket_name,raylet_socket_name,temp_dir,include_log_monitor,autoscaling_config,include_java,java_worker_options,load_code_from_local,start_initial_python_workers_for_first_job,_system_config,enable_object_reconstruction,metrics_agent_port,metrics_export_port,lru_evict,object_spilling_config,code_search_path", "method_startline": "104", "method_endline": "151"}}}}, "file_16": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "python\\ray\\scripts\\scripts.py", "file_new_name": "python\\ray\\scripts\\scripts.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "394,395,396", "method_info": {"method_name": "start", "method_params": "node_ip_address,redis_address,address,redis_port,port,num_redis_shards,redis_max_clients,redis_password,redis_shard_ports,object_manager_port,node_manager_port,gcs_server_port,min_worker_port,max_worker_port,memory,object_store_memory,redis_max_memory,num_cpus,num_gpus,resources,head,include_webui,webui_host,include_dashboard,dashboard_host,dashboard_port,block,plasma_directory,huge_pages,autoscaling_config,no_redirect_worker_output,no_redirect_output,plasma_store_socket_name,raylet_socket_name,temp_dir,include_java,java_worker_options,load_code_from_local,system_config,lru_evict,enable_object_reconstruction,metrics_export_port,log_style,log_color,verbose", "method_startline": "385", "method_endline": "396"}}, "hunk_1": {"Ismethod": 1, "added_lines": "401,402,403", "deleted_lines": "394,395,396", "method_info": {"method_name": "start", "method_params": "node_ip_address,redis_address,address,redis_port,port,num_redis_shards,redis_max_clients,redis_password,redis_shard_ports,object_manager_port,node_manager_port,gcs_server_port,min_worker_port,max_worker_port,memory,object_store_memory,redis_max_memory,num_cpus,num_gpus,resources,head,include_webui,webui_host,include_dashboard,dashboard_host,dashboard_port,block,plasma_directory,huge_pages,autoscaling_config,no_redirect_worker_output,no_redirect_output,plasma_store_socket_name,raylet_socket_name,temp_dir,include_java,java_worker_options,code_search_path,load_code_from_local,system_config,lru_evict,enable_object_reconstruction,metrics_export_port,log_style,log_color,verbose", "method_startline": "392", "method_endline": "403"}}}}, "file_17": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "python\\ray\\services.py", "file_new_name": "python\\ray\\services.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1498,1499,1500,1501", "deleted_lines": "1498,1499,1500,1501", "method_info": {"method_name": "build_java_worker_command", "method_params": "java_worker_options,redis_address,node_manager_port,plasma_store_name,raylet_name,redis_password,session_dir,code_search_path", "method_startline": "1498", "method_endline": "1501"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1279,1280", "deleted_lines": null, "method_info": {"method_name": "start_raylet", "method_params": "redis_address,node_ip_address,node_manager_port,raylet_name,plasma_store_name,worker_path,temp_dir,session_dir,resource_spec,min_worker_port,max_worker_port,object_manager_port,redis_password,metrics_agent_port,metrics_export_port,use_valgrind,use_profiler,stdout_file,stderr_file,config,include_java,java_worker_options,load_code_from_local,plasma_directory,huge_pages,fate_share,socket_to_use,head_node,start_initial_python_workers_for_first_job,object_spilling_config,code_search_path", "method_startline": "1250", "method_endline": "1280"}}, "hunk_2": {"Ismethod": 1, "added_lines": "1279,1280", "deleted_lines": "1285", "method_info": {"method_name": "start_raylet", "method_params": "redis_address,node_ip_address,node_manager_port,raylet_name,plasma_store_name,worker_path,temp_dir,session_dir,resource_spec,min_worker_port,max_worker_port,object_manager_port,redis_password,metrics_agent_port,metrics_export_port,use_valgrind,use_profiler,stdout_file,stderr_file,config,include_java,java_worker_options,load_code_from_local,plasma_directory,huge_pages,fate_share,socket_to_use,head_node,start_initial_python_workers_for_first_job,object_spilling_config", "method_startline": "1256", "method_endline": "1285"}}, "hunk_3": {"Ismethod": 1, "added_lines": "1498,1499,1500,1501", "deleted_lines": "1496,1497,1498,1499,1500,1501,1502,1503", "method_info": {"method_name": "build_java_worker_command", "method_params": "java_worker_options,redis_address,node_manager_port,plasma_store_name,raylet_name,redis_password,session_dir", "method_startline": "1496", "method_endline": "1503"}}}}, "file_18": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\worker.py", "file_new_name": "python\\ray\\worker.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "496", "deleted_lines": null, "method_info": {"method_name": "init", "method_params": "address,num_cpus,num_gpus,resources,object_store_memory,local_mode,ignore_reinit_error,include_dashboard,dashboard_host,dashboard_port,job_config,configure_logging,logging_level,logging_format,log_to_driver,_enable_object_reconstruction,_redis_max_memory,_node_ip_address,_driver_object_store_memory,_memory,_redis_password,_include_java,_java_worker_options,_code_search_path,_temp_dir,_load_code_from_local,_lru_evict,_metrics_export_port,_object_spilling_config,_system_config", "method_startline": "470", "method_endline": "502"}}}}, "file_19": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\workers\\default_worker.py", "file_new_name": "python\\ray\\workers\\default_worker.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "4,5,103,104,105,106,107,108,109,146,147,148,149,150,151,152", "deleted_lines": "101"}}}, "file_20": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\ray\\protobuf\\gcs.proto", "file_new_name": "src\\ray\\protobuf\\gcs.proto", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "324,325,326,327", "deleted_lines": null}}}, "file_21": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\ray\\raylet\\worker_pool.cc", "file_new_name": "src\\ray\\raylet\\worker_pool.cc", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253", "deleted_lines": null, "method_info": {"method_name": "ray::raylet::WorkerPool::StartWorkerProcess", "method_params": "language,worker_type,job_id,dynamic_options", "method_startline": "174", "method_endline": "339"}}}}}}}