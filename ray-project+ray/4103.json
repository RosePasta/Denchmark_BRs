{"BR": {"BR_id": "4103", "BR_author": "KarlJosef", "BRopenT": "2019-02-20T15:56:30Z", "BRcloseT": "2019-02-21T18:47:02Z", "BR_text": {"BRsummary": "[rllib] Question regarding twin-Q usage in DDPG", "BRdescription": "\n <denchmark-h:h3>System information</denchmark-h>\n \n \n OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Linux Ubuntu 16.04\n Ray installed from (source or binary): source\n Ray version: latest\n Python version: 3.6\n Exact command to reproduce:\n \n <denchmark-h:h3>Describe the problem</denchmark-h>\n \n When activating the twin_q functionality in DDPG the following loss specific operations are defined when creating the policy graph (see ActorCriticLoss):\n <denchmark-code>q_t_selected = tf.squeeze(q_t, axis=len(q_t.shape) - 1)\n if twin_q:  \n     twin_q_t_selected = tf.squeeze(q_t, axis=len(q_t.shape) - 1)  \n     q_tp1 = tf.minimum(q_tp1, twin_q_tp1)  \n </denchmark-code>\n \n In this case q_t_selected and twin_q_t_selected hold the same operation. Probably twin_q_t_selected need to be adjusted the following way:\n <denchmark-code>twin_q_t_selected = tf.squeeze(twin_q_t, axis=len(q_t.shape) - 1)  \n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "KarlJosef", "commentT": "2019-02-20T21:12:27Z", "comment_text": "\n \t\tYes, that looks like a bug. cc <denchmark-link:https://github.com/joneswong>@joneswong</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "KarlJosef", "commentT": "2019-02-21T02:48:55Z", "comment_text": "\n \t\tyes, we must optimize both of the two q-net. twin_q_t should be used here.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "KarlJosef", "commentT": "2019-02-21T05:36:41Z", "comment_text": "\n \t\tI invoked a pr for this bug: <denchmark-link:https://github.com/ray-project/ray/pull/4108>#4108</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "acbe0b4e5f6cff6ce8fe8496d2c225b808dba9b1", "commit_author": "Jones Wong", "commitT": "2019-02-21 10:47:01-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\rllib\\agents\\ddpg\\ddpg_policy_graph.py", "file_new_name": "python\\ray\\rllib\\agents\\ddpg\\ddpg_policy_graph.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "150", "deleted_lines": "150"}}}}}}