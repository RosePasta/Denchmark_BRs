{"BR": {"BR_id": "12678", "BR_author": "alexenos", "BRopenT": "2020-12-08T18:43:13Z", "BRcloseT": "2020-12-09T07:53:58Z", "BR_text": {"BRsummary": "[rllib] MultiAgentBatch object has no attribute 'total'", "BRdescription": "\n <denchmark-h:h3>What is the problem?</denchmark-h>\n \n When trying to train with an ExternalEnv MultiAgent environment through the PolicyServerInput/PolicyClient interface. The following error occurs:\n <denchmark-code>Traceback (most recent call last):\n   File \"/home/dgarner/.local/share/virtualenvs/ray_bug-QUDZwH1p/lib/python3.6/site-packages/ray/rllib/env/policy_client.py\", line 272, in run\n     \"server.\".format(samples.count, samples.total()))\n AttributeError: 'MultiAgentBatch' object has no attribute 'total'\n </denchmark-code>\n \n Ray version and other system information (Python version, TensorFlow version, OS):\n python==3.6.9\n ray==1.0.1.post1\n tensorflow==2.3.1\n OS: Ubuntu 18.04 LTS\n <denchmark-h:h3>Reproduction (REQUIRED)</denchmark-h>\n \n Based on the unity3d_[server|client].py example, the following scripts will reproduce the error. Run the server script with no arguments, and then the client script with no arguments in another terminal.\n <denchmark-code>python bug_server.py\n python bug_client.py\n </denchmark-code>\n \n \n  I have verified my script runs in a clean environment and reproduces the issue.\n  I have verified the issue also occurs with the latest wheels.\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "alexenos", "commentT": "2020-12-08T18:44:17Z", "comment_text": "\n \t\tHere are the scripts with a .txt extension\n <denchmark-link:https://github.com/ray-project/ray/files/5661172/bug_client.txt>bug_client.txt</denchmark-link>\n \n <denchmark-link:https://github.com/ray-project/ray/files/5661173/bug_server.txt>bug_server.txt</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "alexenos", "commentT": "2020-12-08T18:53:56Z", "comment_text": "\n \t\tLooks like it was using a deprecated method .total instead of .agent_steps(). Do you mind submitting a fix?\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "alexenos", "commentT": "2020-12-08T20:53:21Z", "comment_text": "\n \t\tI dont mind at all!\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "alexenos", "commentT": "2020-12-09T07:53:55Z", "comment_text": "\n \t\tThanks for raising this <denchmark-link:https://github.com/alexenos>@alexenos</denchmark-link>\n  ! This PR fixes the issue:\n <denchmark-link:https://github.com/ray-project/ray/pull/12704>#12704</denchmark-link>\n \n Closing this. Feel free to re-open should the fix not work for you.\n \t\t"}}}, "commit": {"commit_id": "f6241302a80f4df7a4cde5227e0692cc7508415c", "commit_author": "Sven Mika", "commitT": "2020-12-09 16:41:13+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "rllib\\env\\policy_client.py", "file_new_name": "rllib\\env\\policy_client.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "272,273", "deleted_lines": "272", "method_info": {"method_name": "run", "method_params": "self", "method_startline": "263", "method_endline": "284"}}}}}}}