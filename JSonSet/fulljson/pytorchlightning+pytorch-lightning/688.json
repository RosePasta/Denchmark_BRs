{"BR": {"BR_id": "688", "BR_author": "fgerzer", "BRopenT": "2020-01-15T15:42:14Z", "BRcloseT": "2020-01-20T19:51:45Z", "BR_text": {"BRsummary": "Checkpoint saving isn't atomic", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n Saving checkpoints happens non-atomically. In some cases, this causes an incomplete write of a checkpoint (for example when receiving a SIGKILL during writing), causing any subsequent loading to fail with\n RuntimeError: unexpected EOF, expected 8 more bytes. The file might be corrupted.\n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n This is difficult to reproduce, since it relies on timing outside of code. For me, it happens with fast-running models that run at ~1-4 seconds per epoch.\n <denchmark-h:h3>Expected behavior</denchmark-h>\n \n Checkpointing should be resistant to such issues, and instead simply continue as-is.\n \t"}, "comments": {}}, "commit": {"commit_id": "9aad69d85635a8a65e1f0ee995516c0f8183c0f3", "commit_author": "Frederik Diehl", "commitT": "2020-01-20 14:51:44-05:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "pytorch_lightning\\trainer\\training_io.py", "file_new_name": "pytorch_lightning\\trainer\\training_io.py", "file_complexity": {"file_NLOC": "305", "file_CCN": "69", "file_NToken": "1500"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275", "deleted_lines": "265,270", "method_info": {"method_name": "_atomic_save", "method_params": "self,checkpoint,filepath", "method_startline": "260", "method_endline": "275", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "34", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "435,440", "deleted_lines": "418,423", "method_info": {"method_name": "hpc_save", "method_params": "self,folderpath,logger", "method_startline": "413", "method_endline": "442", "method_complexity": {"method_NLOC": "17", "method_CCN": "4", "method_NToken": "118", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "282,287", "deleted_lines": null, "method_info": {"method_name": "save_checkpoint", "method_params": "self,filepath", "method_startline": "277", "method_endline": "287", "method_complexity": {"method_NLOC": "8", "method_CCN": "3", "method_NToken": "45", "method_nesting_level": "1"}}}}}}}}