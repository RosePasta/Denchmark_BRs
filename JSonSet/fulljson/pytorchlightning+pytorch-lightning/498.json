{"BR": {"BR_id": "498", "BR_author": "ChenghaoMou", "BRopenT": "2019-11-12T18:37:49Z", "BRcloseT": "2019-11-13T11:03:39Z", "BR_text": {"BRsummary": "Escaping % in add_default_args", "BRdescription": "\n Describe the bug\n In utilities/arg_parse.py, a percentage symbol is not escaped and would cause an error when printing help information.\n parser.add_argument('--overfit', default=-1, type=float,\n                         help='% of dataset to use with this option. float, or -1 for none')\n To Reproduce\n Steps to reproduce the behavior:\n <denchmark-code>import os\n import random\n import sys\n from pytorch_lightning.utilities.arg_parse import add_default_args\n from test_tube import HyperOptArgumentParser, Experiment\n \n if __name__ == \"__main__\":\n     root_dir = os.path.split(os.path.dirname(sys.modules['__main__'].__file__))[0]\n     parent_parser = HyperOptArgumentParser(strategy='random_search', add_help=True)\n     add_default_args(parent_parser, root_dir)\n     hyperparams = parent_parser.parse_args()\n </denchmark-code>\n \n Execute the file with --help\n <denchmark-code>python temp.py --help\n </denchmark-code>\n \n Throws an error:\n <denchmark-code>WARNING:root:This caffe2 python run does not have GPU support. Will run in CPU only mode.\n Traceback (most recent call last):\n   File \"/Users/chenghaomou/Code/ai2/temp.py\", line 11, in <module>\n     hyperparams = parent_parser.parse_args()\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/site-packages/test_tube/argparse_hopt.py\", line 238, in parse_args\n     results = self.__parse_args(args, namespace)\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/site-packages/test_tube/argparse_hopt.py\", line 157, in __parse_args\n     args, argv = self.parse_known_args(args, namespace)\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 1782, in parse_known_args\n     namespace, args = self._parse_known_args(args, namespace)\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 1988, in _parse_known_args\n     start_index = consume_optional(start_index)\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 1928, in consume_optional\n     take_action(action, args, option_string)\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 1856, in take_action\n     action(self, namespace, argument_values, option_string)\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 1038, in __call__\n     parser.print_help()\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 2475, in print_help\n     self._print_message(self.format_help(), file)\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 2459, in format_help\n     return formatter.format_help()\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 284, in format_help\n     help = self._root_section.format_help()\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 215, in format_help\n     item_help = join([func(*args) for func, args in self.items])\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 215, in <listcomp>\n     item_help = join([func(*args) for func, args in self.items])\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 215, in format_help\n     item_help = join([func(*args) for func, args in self.items])\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 215, in <listcomp>\n     item_help = join([func(*args) for func, args in self.items])\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 525, in _format_action\n     help_text = self._expand_help(action)\n   File \"/Users/chenghaomou/Anaconda/envs/Elisa/lib/python3.7/argparse.py\", line 615, in _expand_help\n     return self._get_help_string(action) % params\n TypeError: %o format: an integer is required, not dict\n </denchmark-code>\n \n Expected behavior\n Escape the percentage sign and help can be printed.\n Desktop (please complete the following information):\n \n OS: macOS 10.15\n Browser Chrome\n Version 78.0.3904.87\n \n Additional context\n Add any other context about the problem here.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ChenghaoMou", "commentT": "2019-11-13T07:00:39Z", "comment_text": "\n \t\tthe sample code has several bugs it really fails...\n \t\t"}}}, "commit": {"commit_id": "89f7a82157297f32ca12283c0badbc5b50bb5224", "commit_author": "Chenghao MOU", "commitT": "2019-11-13 06:03:38-05:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pytorch_lightning\\utilities\\arg_parse.py", "file_new_name": "pytorch_lightning\\utilities\\arg_parse.py", "file_complexity": {"file_NLOC": "70", "file_CCN": "3", "file_NToken": "733"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "84", "deleted_lines": "84", "method_info": {"method_name": "add_default_args", "method_params": "parser,root_dir,rand_seed,possible_model_names", "method_startline": "9", "method_endline": "98", "method_complexity": {"method_NLOC": "65", "method_CCN": "3", "method_NToken": "729", "method_nesting_level": "0"}}}}}}}}