{"BR": {"BR_id": "1422", "BR_author": "bobofzhang", "BRopenT": "2020-04-09T09:22:50Z", "BRcloseT": "2020-04-09T12:52:16Z", "BR_text": {"BRsummary": "Not auto add DistributedSampler for DDP training", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n in 0.72, even if we don't set sampler, pytorch_lightning will not add  DistributedSampler for us.\n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n the reason is in pytorch, if we don't set sampler,  pytorch will add a sampler for us.\n in pytorch's dataloader.py:\n <denchmark-code>         if sampler is None:  # give default samplers\n             if self._dataset_kind == _DatasetKind.Iterable:\n                 # See NOTE [ Custom Samplers and IterableDataset ]\n                 sampler = _InfiniteConstantSampler()\n             else:  # map-style\n                 if shuffle:\n                     sampler = RandomSampler(dataset)\n                 else:\n                     sampler = SequentialSampler(dataset)\n </denchmark-code>\n \n but in pytorch_lightning we check whether sampler is None to  decide to add sampler\n in  data_loading.py funciton auto_add_sampler:\n <denchmark-code>        no_sampler_added = dataloader.sampler is None\n </denchmark-code>\n \n because pytorch have default sampler for us, which is not None, pytorch_lighting will not automatically add sampler.\n \t"}, "comments": {}}, "commit": {"commit_id": "21a1972921809ea04ab1e4c657e326dfecd5e352", "commit_author": "William Falcon", "commitT": "2020-04-09 08:52:15-04:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pytorch_lightning\\trainer\\data_loading.py", "file_new_name": "pytorch_lightning\\trainer\\data_loading.py", "file_complexity": {"file_NLOC": "201", "file_CCN": "36", "file_NToken": "1051"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "91", "deleted_lines": "90,92", "method_info": {"method_name": "auto_add_sampler", "method_params": "self,DataLoader,bool", "method_startline": "83", "method_endline": "111", "method_complexity": {"method_NLOC": "20", "method_CCN": "9", "method_NToken": "140", "method_nesting_level": "1"}}}}}}}}