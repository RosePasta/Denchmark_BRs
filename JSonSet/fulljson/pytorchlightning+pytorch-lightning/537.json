{"BR": {"BR_id": "537", "BR_author": "VSJMilewski", "BRopenT": "2019-11-21T15:44:20Z", "BRcloseT": "2019-12-09T12:42:07Z", "BR_text": {"BRsummary": "Summary not working for model on GPU with multiple inputs", "BRdescription": "\n Describe the bug\n When you want a summary for a model that requires multiple input parameters for forward, then this doesn't work. You can set self.example_input_array to be a tuple and there is some code for passing this to the forward method. However, if the model is on cuda, it tries to pass to move this input directly to cuda without a check whether it is a tuple or list.\n the line with the error is here:\n <denchmark-link:https://github.com/williamFalcon/pytorch-lightning/blob/7324dd902b8d071f4889ab1274a4d4dc09de9a78/pytorch_lightning/root_module/memory.py#L53>pytorch-lightning/blob/master/pytorch_lightning/root_module/memory.py#L53</denchmark-link>\n \n example of how it should be checked:\n <denchmark-link:https://github.com/williamFalcon/pytorch-lightning/blob/7324dd902b8d071f4889ab1274a4d4dc09de9a78/pytorch_lightning/root_module/memory.py#L61>pytorch-lightning/blob/master/pytorch_lightning/root_module/memory.py#L61</denchmark-link>\n \n To Reproduce\n Steps to reproduce the behavior:\n \n create a model that requires multiple inputs in the forward method.\n set self.example_input_array to be a tuple\n run the model on GPU\n \n Expected behavior\n a list with all layers and the input and output shapes of these layers.\n \n <denchmark-link:https://user-images.githubusercontent.com/6348139/69352469-4bc70180-0c7d-11ea-88c6-8056ab531c80.png></denchmark-link>\n \n Desktop (please complete the following information):\n \n OS: Linux Mint 19.2\n Browser chrome\n Version 8.0.3904.97 (Official Build) (64-bit)\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "VSJMilewski", "commentT": "2019-11-25T11:26:29Z", "comment_text": "\n \t\t@victormilewski1994 good point. I guess we didn't specifically design the summarizer to take in multiple inputs. Would you be interested in submitting a PR?\n \t\t"}}}, "commit": {"commit_id": "d562172b4cd363b86f9d670120932cd333b03cf5", "commit_author": "VSJMilewski", "commitT": "2019-12-09 04:42:07-08:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pytorch_lightning\\core\\memory.py", "file_new_name": "pytorch_lightning\\core\\memory.py", "file_complexity": {"file_NLOC": "178", "file_CCN": "56", "file_NToken": "1256"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "53,54,55,56,57,58,59,62,63,64,65,66,67,72,77,89", "deleted_lines": "53,56,61,66,78", "method_info": {"method_name": "get_variable_sizes", "method_params": "self", "method_startline": "45", "method_endline": "100", "method_complexity": {"method_NLOC": "44", "method_CCN": "16", "method_NToken": "333", "method_nesting_level": "1"}}}}}}}}