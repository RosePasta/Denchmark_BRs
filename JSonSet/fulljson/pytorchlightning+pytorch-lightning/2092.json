{"BR": {"BR_id": "2092", "BR_author": "edenlightning", "BRopenT": "2020-06-05T20:33:09Z", "BRcloseT": "2020-06-08T21:55:26Z", "BR_text": {"BRsummary": "[ddp] New ddp implementation doesn't work in notebooks / using scripts", "BRdescription": "\n The using .spawn() to spin off subprocesses ddp in had a few problems:\n \n Everything needs to be picklable.\n It doesn\u2019t work well with num_workers on dataloaders because of spawn\n fit(model) trains the model in a subprocess, so the original model is not updated.\n Those are not limitations of lightning, but of pytorch and python.\n \n As a result, we removed .spawn and instead call the script under the hood.\n This approach solves all problems above, but it assumes you can call your model like\n python train.py ... and does not support other ways of calling the script.\n We should decide how to support DDP on Jupyter notebooks.\n \t"}, "comments": {}}, "commit": {"commit_id": "3260e59b2723a0f5d666c6779486717aa3a9373d", "commit_author": "William Falcon", "commitT": "2020-06-08 17:55:25-04:00", "commit_complexity": {"commit_NLOC": "0.3333333333333333", "commit_CCN": "0.3333333333333333", "commit_Nprams": "0.6666666666666666"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\source\\multi_gpu.rst", "file_new_name": "docs\\source\\multi_gpu.rst", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "203,204,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628", "deleted_lines": "203"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pytorch_lightning\\trainer\\data_loading.py", "file_new_name": "pytorch_lightning\\trainer\\data_loading.py", "file_complexity": {"file_NLOC": "241", "file_CCN": "61", "file_NToken": "1340"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "142", "deleted_lines": null, "method_info": {"method_name": "_get_distributed_sampler", "method_params": "self,dataloader", "method_startline": "134", "method_endline": "148", "method_complexity": {"method_NLOC": "15", "method_CCN": "3", "method_NToken": "130", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "pytorch_lightning\\trainer\\distrib_data_parallel.py", "file_new_name": "pytorch_lightning\\trainer\\distrib_data_parallel.py", "file_complexity": {"file_NLOC": "392", "file_CCN": "89", "file_NToken": "1818"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "398,406,407,408,461", "deleted_lines": "397,457", "method_info": {"method_name": "ddp_train", "method_params": "self,process_idx,model,is_master", "method_startline": "397", "method_endline": "468", "method_complexity": {"method_NLOC": "35", "method_CCN": "12", "method_NToken": "300", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "224", "deleted_lines": "224", "method_info": {"method_name": "set_distributed_mode", "method_params": "self,distributed_backend", "method_startline": "194", "method_endline": "256", "method_complexity": {"method_NLOC": "54", "method_CCN": "25", "method_NToken": "301", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "398,406,407,408,461", "deleted_lines": "457", "method_info": {"method_name": "ddp_train", "method_params": "self,process_idx,model,is_master,proc_offset", "method_startline": "398", "method_endline": "472", "method_complexity": {"method_NLOC": "36", "method_CCN": "13", "method_NToken": "315", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "381", "deleted_lines": null, "method_info": {"method_name": "spawn_ddp_children", "method_params": "self,model", "method_startline": "342", "method_endline": "396", "method_complexity": {"method_NLOC": "35", "method_CCN": "7", "method_NToken": "304", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "pytorch_lightning\\trainer\\trainer.py", "file_new_name": "pytorch_lightning\\trainer\\trainer.py", "file_complexity": {"file_NLOC": "923", "file_CCN": "90", "file_NToken": "3897"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "249,879,883,884,885,886,887,888", "deleted_lines": "249"}}}}}}