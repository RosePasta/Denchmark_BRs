{"BR": {"BR_id": "4188", "BR_author": "justusschock", "BRopenT": "2020-10-16T07:46:47Z", "BRcloseT": "2020-10-21T18:34:30Z", "BR_text": {"BRsummary": "To many backwards with LBFGS", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n When using LBFGS we have one backward step to much, because we call backward before the optimiser step (also for gradient accumulation), but the optimizer step get's a closure and therefore calls backward again.\n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n <denchmark-code>import torch\n import pytorch_lightning as ptl\n from pytorch_lightning import LightningModule\n from torch.utils.data import Dataset\n \n \n class RandomDictDataset(Dataset):\n     def __init__(self, size, length):\n         self.len = length\n         self.data = torch.randn(length, size)\n \n     def __getitem__(self, index):\n         a = self.data[index]\n         b = a + 2\n         return {\"a\": a, \"b\": b}\n \n     def __len__(self):\n         return self.len\n \n \n class RandomDictStringDataset(Dataset):\n     def __init__(self, size, length):\n         self.len = length\n         self.data = torch.randn(length, size)\n \n     def __getitem__(self, index):\n         return {\"id\": str(index), \"x\": self.data[index]}\n \n     def __len__(self):\n         return self.len\n \n \n class RandomDataset(Dataset):\n     def __init__(self, size, length):\n         self.len = length\n         self.data = torch.randn(length, size)\n \n     def __getitem__(self, index):\n         return self.data[index]\n \n     def __len__(self):\n         return self.len\n \n \n class BoringModel(LightningModule):\n     def __init__(self):\n         \"\"\"\n         Testing PL Module\n         Use as follows:\n         - subclass\n         - modify the behavior for what you want\n         class TestModel(BaseTestModel):\n             def training_step(...):\n                 # do your own thing\n         or:\n         model = BaseTestModel()\n         model.training_epoch_end = None\n         \"\"\"\n         super().__init__()\n         self.layer = torch.nn.Linear(32, 2)\n \n     def forward(self, x):\n         return self.layer(x)\n \n     def loss(self, batch, prediction):\n         # An arbitrary loss to have a loss that updates the model weights during `Trainer.fit` calls\n         return torch.nn.functional.cross_entropy(\n             prediction,\n             torch.ones(len(prediction), dtype=torch.long, device=prediction.device),\n         )\n \n     def training_step(self, batch, batch_idx):\n         output = self.layer(batch)\n         loss = self.loss(batch, output)\n         self.log(\"loss\", loss)\n         return loss\n \n     def validation_step(self, batch, batch_idx):\n         output = self.layer(batch)\n         loss = self.loss(batch, output)\n         self.log(\"loss\", loss)\n         return loss\n \n     def test_step(self, batch, batch_idx):\n         output = self.layer(batch)\n         loss = self.loss(batch, output)\n         return loss\n \n     def configure_optimizers(self):\n         optimizer = torch.optim.LBFGS(self.parameters())\n         return optimizer\n \n     def train_dataloader(self):\n         return torch.utils.data.DataLoader(RandomDataset(32, 64), batch_size=16)\n \n     def val_dataloader(self):\n         return torch.utils.data.DataLoader(RandomDataset(32, 64), batch_size=16)\n \n     def test_dataloader(self):\n         return torch.utils.data.DataLoader(RandomDataset(32, 64), batch_size=16)\n \n \n def main():\n     model = BoringModel()\n     trainer = ptl.Trainer(\n         distributed_backend=\"dp\",\n         gpus=1,\n     )\n     trainer.fit(model)\n \n \n if __name__ == \"__main__\":\n     main()```\n \n ### Environment\n \n Please copy and paste the output from our\n [environment collection script](https://raw.githubusercontent.com/PyTorchLightning/pytorch-lightning/master/tests/collect_env_details.py)\n (or fill out the checklist below manually).\n \n You can get the script and run it with:\n </denchmark-code>\n \n wget <denchmark-link:https://raw.githubusercontent.com/PyTorchLightning/pytorch-lightning/master/tests/collect_env_details.py>https://raw.githubusercontent.com/PyTorchLightning/pytorch-lightning/master/tests/collect_env_details.py</denchmark-link>\n \n <denchmark-h:h1>For security purposes, please check the contents of collect_env_details.py before running it.</denchmark-h>\n \n python collect_env_details.py\n <denchmark-code>\n * CUDA:\n         - GPU:\n                 - GeForce RTX 2080 Ti\n                 - GeForce RTX 2080 Ti\n         - available:         True\n         - version:           10.2\n * Packages:\n         - numpy:             1.19.2\n         - pyTorch_debug:     False\n         - pyTorch_version:   1.6.0\n         - pytorch-lightning: 20201015\n         - tqdm:              4.50.2\n * System:\n         - OS:                Linux\n         - architecture:\n                 - 64bit\n                 - ELF\n         - processor:         x86_64\n         - python:            3.8.5\n         - version:           #52~18.04.1-Ubuntu SMP PREEMPT Thu Sep 10 13:34:23 UTC 2020\n \n ### Additional context\n \n Probably we can fix this. by passing a closure to all optimisers (to be more consistent).\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "justusschock", "commentT": "2020-10-16T08:40:06Z", "comment_text": "\n \t\tcc <denchmark-link:https://github.com/awaelchli>@awaelchli</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "0ec410769744843726a140b7efabbeeb1c4e2929", "commit_author": "Justus Schock", "commitT": "2020-10-21 19:34:29+01:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.59375"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pytorch_lightning\\accelerators\\accelerator.py", "file_new_name": "pytorch_lightning\\accelerators\\accelerator.py", "file_complexity": {"file_NLOC": "167", "file_CCN": "41", "file_NToken": "1181"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "94,95", "deleted_lines": "94,95,96,97,98", "method_info": {"method_name": "backward", "method_params": "self,closure_loss,optimizer,opt_idx,args,kwargs", "method_startline": "87", "method_endline": "99", "method_complexity": {"method_NLOC": "10", "method_CCN": "2", "method_NToken": "86", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "pytorch_lightning\\core\\lightning.py", "file_new_name": "pytorch_lightning\\core\\lightning.py", "file_complexity": {"file_NLOC": "1235", "file_CCN": "109", "file_NToken": "2815"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1084,1103,1104", "deleted_lines": "1084,1085,1086,1087", "method_info": {"method_name": "backward", "method_params": "self,Tensor,Optimizer,int,args,kwargs", "method_startline": "1084", "method_endline": "1104", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "48", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "1132", "deleted_lines": "1134", "method_info": {"method_name": "optimizer_step", "method_params": "self,int,int,Optimizer,int,None,bool,bool,bool", "method_startline": "1128", "method_endline": "1137", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "47", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "1103,1104", "deleted_lines": "1087,1106", "method_info": {"method_name": "backward", "method_params": "self,Tensor,Optimizer,int", "method_startline": "1087", "method_endline": "1106", "method_complexity": {"method_NLOC": "20", "method_CCN": "1", "method_NToken": "25", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "1084", "deleted_lines": "1084,1085", "method_info": {"method_name": "manual_backward", "method_params": "self,Tensor,Optimizer,args,kwargs", "method_startline": "1061", "method_endline": "1085", "method_complexity": {"method_NLOC": "20", "method_CCN": "1", "method_NToken": "59", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "1132", "deleted_lines": "1134", "method_info": {"method_name": "optimizer_step", "method_params": "self,int,int,Optimizer,int,None,bool,bool,bool", "method_startline": "1126", "method_endline": "1135", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "47", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 31, "file_old_name": "pytorch_lightning\\trainer\\training_loop.py", "file_new_name": "pytorch_lightning\\trainer\\training_loop.py", "file_complexity": {"file_NLOC": "524", "file_CCN": "152", "file_NToken": "4040"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "185", "deleted_lines": "182", "method_info": {"method_name": "on_train_end", "method_params": "self", "method_startline": "172", "method_endline": "202", "method_complexity": {"method_NLOC": "17", "method_CCN": "5", "method_NToken": "125", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "50,51", "deleted_lines": null, "method_info": {"method_name": "on_trainer_init", "method_params": "self,max_epochs,min_epochs,max_steps,min_steps,num_sanity_val_steps,automatic_optimization", "method_startline": "50", "method_endline": "51", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "15", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "440,441,442", "deleted_lines": "440,441", "method_info": {"method_name": "_process_result", "method_params": "self,training_step_output,split_batch", "method_startline": "420", "method_endline": "447", "method_complexity": {"method_NLOC": "24", "method_CCN": "2", "method_NToken": "52", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "450,452,453,454", "deleted_lines": "449,451,452", "method_info": {"method_name": "optimizer_step", "method_params": "self,optimizer,opt_idx,batch_idx,train_step_and_backward_closure", "method_startline": "449", "method_endline": "454", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "41", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "830", "deleted_lines": "827", "method_info": {"method_name": "update_train_loop_lr_schedulers", "method_params": "self,monitor_metrics", "method_startline": "824", "method_endline": "830", "method_complexity": {"method_NLOC": "5", "method_CCN": "3", "method_NToken": "66", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "463,469", "deleted_lines": "467", "method_info": {"method_name": "track_and_norm_grad", "method_params": "self,optimizer", "method_startline": "463", "method_endline": "469", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "29", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "878,879", "deleted_lines": "878", "method_info": {"method_name": "save_loggers_on_train_batch_end", "method_params": "self", "method_startline": "875", "method_endline": "882", "method_complexity": {"method_NLOC": "7", "method_CCN": "6", "method_NToken": "64", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "641,646,650,651,652,653,673,674,675,676,677,678,679,680,681,682,683,684,685,687,688,689,690,692,694,696,697,698,699,700,701,702,703,704,706,707,709,710,712,713,714,716,717,718,719,720,721,723,724,732,733,734,735,736,754", "deleted_lines": "642,647,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,686,687,689,690,692,693,694,696,697,698,700,701,703,704,706,707,708,709,710,711,712,713,714,716,717,718,719,721,722,730,731,732,733,751", "method_info": {"method_name": "run_training_batch", "method_params": "self,batch,batch_idx,dataloader_idx", "method_startline": "620", "method_endline": "756", "method_complexity": {"method_NLOC": "69", "method_CCN": "20", "method_NToken": "535", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "395,396,397,402", "deleted_lines": "395,396,397,402", "method_info": {"method_name": "_process_training_step_output_1_0", "method_params": "self,training_step_output,split_batch", "method_startline": "387", "method_endline": "418", "method_complexity": {"method_NLOC": "18", "method_CCN": "3", "method_NToken": "117", "method_nesting_level": "1"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "758,759", "deleted_lines": null, "method_info": {"method_name": "_process_closure_result", "method_params": "self,list,list,list,int", "method_startline": "758", "method_endline": "759", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "19", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "96", "deleted_lines": "93", "method_info": {"method_name": "setup_fit", "method_params": "self,model,train_dataloader,val_dataloaders,datamodule", "method_startline": "91", "method_endline": "103", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "65", "method_nesting_level": "1"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "814,821", "deleted_lines": "817", "method_info": {"method_name": "backward", "method_params": "self,result,optimizer,opt_idx,args,kwargs", "method_startline": "813", "method_endline": "822", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "85", "method_nesting_level": "1"}}}, "hunk_12": {"Ismethod": 1, "added_lines": "301,303,306,309", "deleted_lines": "300,302,305,308,309", "method_info": {"method_name": "training_step", "method_params": "self,split_batch,batch_idx,opt_idx,hiddens", "method_startline": "297", "method_endline": "341", "method_complexity": {"method_NLOC": "31", "method_CCN": "4", "method_NToken": "190", "method_nesting_level": "1"}}}, "hunk_13": {"Ismethod": 1, "added_lines": "249,250", "deleted_lines": "248,249", "method_info": {"method_name": "on_train_batch_end", "method_params": "self,epoch_output,epoch_end_outputs,batch,batch_idx,dataloader_idx", "method_startline": "244", "method_endline": "250", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "47", "method_nesting_level": "1"}}}, "hunk_14": {"Ismethod": 1, "added_lines": "209", "deleted_lines": "206", "method_info": {"method_name": "check_checkpoint_callback", "method_params": "self,should_save,is_last", "method_startline": "204", "method_endline": "211", "method_complexity": {"method_NLOC": "7", "method_CCN": "8", "method_NToken": "77", "method_nesting_level": "1"}}}, "hunk_15": {"Ismethod": 1, "added_lines": "554,604,611", "deleted_lines": "552,602,603,604,605,612", "method_info": {"method_name": "run_training_epoch", "method_params": "self", "method_startline": "522", "method_endline": "618", "method_complexity": {"method_NLOC": "41", "method_CCN": "10", "method_NToken": "317", "method_nesting_level": "1"}}}, "hunk_16": {"Ismethod": 1, "added_lines": "85,89", "deleted_lines": "82,86", "method_info": {"method_name": "on_train_start", "method_params": "self", "method_startline": "80", "method_endline": "89", "method_complexity": {"method_NLOC": "5", "method_CCN": "3", "method_NToken": "47", "method_nesting_level": "1"}}}, "hunk_17": {"Ismethod": 1, "added_lines": "850", "deleted_lines": "845,846", "method_info": {"method_name": "should_check_val_fx", "method_params": "self,batch_idx,is_last_batch", "method_startline": "844", "method_endline": "853", "method_complexity": {"method_NLOC": "8", "method_CCN": "6", "method_NToken": "86", "method_nesting_level": "1"}}}, "hunk_18": {"Ismethod": 1, "added_lines": "50,51,52", "deleted_lines": "49,68", "method_info": {"method_name": "on_trainer_init", "method_params": "self,max_epochs,min_epochs,max_steps,min_steps,num_sanity_val_steps,automatic_optimization", "method_startline": "49", "method_endline": "70", "method_complexity": {"method_NLOC": "19", "method_CCN": "2", "method_NToken": "140", "method_nesting_level": "1"}}}, "hunk_19": {"Ismethod": 1, "added_lines": "793,796,801,807,808,809,810", "deleted_lines": "787,788,797,800,801", "method_info": {"method_name": "training_step_and_backward", "method_params": "self,split_batch,batch_idx,opt_idx,optimizer,hiddens", "method_startline": "787", "method_endline": "811", "method_complexity": {"method_NLOC": "13", "method_CCN": "4", "method_NToken": "114", "method_nesting_level": "1"}}}, "hunk_20": {"Ismethod": 1, "added_lines": "363", "deleted_lines": "363", "method_info": {"method_name": "_process_training_step_output", "method_params": "self,training_step_output,split_batch", "method_startline": "343", "method_endline": "385", "method_complexity": {"method_NLOC": "24", "method_CCN": "7", "method_NToken": "163", "method_nesting_level": "1"}}}, "hunk_21": {"Ismethod": 1, "added_lines": "518", "deleted_lines": "516", "method_info": {"method_name": "tbptt_split_batch", "method_params": "self,batch", "method_startline": "514", "method_endline": "520", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "59", "method_nesting_level": "1"}}}, "hunk_22": {"Ismethod": 1, "added_lines": "901,902,904,905,911", "deleted_lines": null, "method_info": {"method_name": "process_train_step_outputs", "method_params": "self,all_train_step_outputs,early_stopping_accumulator,checkpoint_accumulator", "method_startline": "884", "method_endline": "914", "method_complexity": {"method_NLOC": "14", "method_CCN": "10", "method_NToken": "117", "method_nesting_level": "1"}}}, "hunk_23": {"Ismethod": 1, "added_lines": "860,865", "deleted_lines": "868,869,871,872", "method_info": {"method_name": "build_train_args", "method_params": "self,batch,batch_idx,opt_idx,hiddens", "method_startline": "855", "method_endline": "873", "method_complexity": {"method_NLOC": "14", "method_CCN": "4", "method_NToken": "88", "method_nesting_level": "1"}}}, "hunk_24": {"Ismethod": 1, "added_lines": "463", "deleted_lines": "461,467", "method_info": {"method_name": "on_before_backward", "method_params": "self,batch_idx,optimizer", "method_startline": "461", "method_endline": "467", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_25": {"Ismethod": 1, "added_lines": "47,48", "deleted_lines": "38", "method_info": {"method_name": "__init__", "method_params": "self,trainer", "method_startline": "38", "method_endline": "48", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "64", "method_nesting_level": "1"}}}, "hunk_26": {"Ismethod": 1, "added_lines": "292", "deleted_lines": "291", "method_info": {"method_name": "on_after_backward", "method_params": "self,training_step_output,batch_idx,untouched_loss", "method_startline": "283", "method_endline": "295", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "64", "method_nesting_level": "1"}}}, "hunk_27": {"Ismethod": 1, "added_lines": "696,697,698,699,700,701,702,703,704", "deleted_lines": "696,697,698,700,701,703,704", "method_info": {"method_name": "run_training_batch.train_step_and_backward_closure", "method_params": "", "method_startline": "696", "method_endline": "704", "method_complexity": {"method_NLOC": "9", "method_CCN": "2", "method_NToken": "34", "method_nesting_level": "6"}}}, "hunk_28": {"Ismethod": 1, "added_lines": "833,834", "deleted_lines": "832", "method_info": {"method_name": "run_on_epoch_end_hook", "method_params": "self,epoch_output", "method_startline": "832", "method_endline": "834", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "25", "method_nesting_level": "1"}}}, "hunk_29": {"Ismethod": 1, "added_lines": "140,150,169", "deleted_lines": "137,147,166", "method_info": {"method_name": "setup_training", "method_params": "self,LightningModule", "method_startline": "105", "method_endline": "170", "method_complexity": {"method_NLOC": "29", "method_CCN": "12", "method_NToken": "296", "method_nesting_level": "1"}}}, "hunk_30": {"Ismethod": 1, "added_lines": "234,241,242", "deleted_lines": "231,232,233,240,241", "method_info": {"method_name": "on_train_epoch_start", "method_params": "self,epoch", "method_startline": "213", "method_endline": "242", "method_complexity": {"method_NLOC": "15", "method_CCN": "3", "method_NToken": "120", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\base\\deterministic_model.py", "file_new_name": "tests\\base\\deterministic_model.py", "file_complexity": {"file_NLOC": "334", "file_CCN": "60", "file_NToken": "3387"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "495", "deleted_lines": "495", "method_info": {"method_name": "backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "488", "method_endline": "495", "method_complexity": {"method_NLOC": "7", "method_CCN": "3", "method_NToken": "51", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 8, "file_old_name": "tests\\trainer\\data_flow\\test_eval_loop_flow_1_0.py", "file_new_name": "tests\\trainer\\data_flow\\test_eval_loop_flow_1_0.py", "file_complexity": {"file_NLOC": "165", "file_CCN": "28", "file_NToken": "957"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "47", "deleted_lines": "46", "method_info": {"method_name": "test__eval_step__flow", "method_params": "tmpdir", "method_startline": "25", "method_endline": "66", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "90", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "97", "deleted_lines": "96", "method_info": {"method_name": "test__eval_step__eval_step_end__flow.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "96", "method_endline": "97", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "154", "deleted_lines": "153", "method_info": {"method_name": "test__eval_step__epoch_end__flow.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "153", "method_endline": "154", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "154", "deleted_lines": "153", "method_info": {"method_name": "test__eval_step__epoch_end__flow", "method_params": "tmpdir", "method_startline": "118", "method_endline": "174", "method_complexity": {"method_NLOC": "22", "method_CCN": "1", "method_NToken": "99", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "219", "deleted_lines": "218", "method_info": {"method_name": "test__validation_step__step_end__epoch_end__flow", "method_params": "tmpdir", "method_startline": "177", "method_endline": "238", "method_complexity": {"method_NLOC": "22", "method_CCN": "1", "method_NToken": "95", "method_nesting_level": "0"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "219", "deleted_lines": "218", "method_info": {"method_name": "test__validation_step__step_end__epoch_end__flow.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "218", "method_endline": "219", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "47", "deleted_lines": "46", "method_info": {"method_name": "test__eval_step__flow.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "46", "method_endline": "47", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "97", "deleted_lines": "96", "method_info": {"method_name": "test__eval_step__eval_step_end__flow", "method_params": "tmpdir", "method_startline": "69", "method_endline": "115", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "86", "method_nesting_level": "0"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 8, "file_old_name": "tests\\trainer\\data_flow\\test_train_loop_flow_dict_1_0.py", "file_new_name": "tests\\trainer\\data_flow\\test_train_loop_flow_dict_1_0.py", "file_complexity": {"file_NLOC": "131", "file_CCN": "18", "file_NToken": "834"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "182", "deleted_lines": "181", "method_info": {"method_name": "test__training_step__step_end__epoch_end__flow_dict", "method_params": "tmpdir", "method_startline": "149", "method_endline": "200", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "85", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "128", "deleted_lines": "127", "method_info": {"method_name": "test__training_step__epoch_end__flow_dict.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "127", "method_endline": "128", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "38", "deleted_lines": "37", "method_info": {"method_name": "test__training_step__flow_dict.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "37", "method_endline": "38", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "128", "deleted_lines": "127", "method_info": {"method_name": "test__training_step__epoch_end__flow_dict", "method_params": "tmpdir", "method_startline": "101", "method_endline": "146", "method_complexity": {"method_NLOC": "20", "method_CCN": "1", "method_NToken": "84", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "182", "deleted_lines": "181", "method_info": {"method_name": "test__training_step__step_end__epoch_end__flow_dict.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "181", "method_endline": "182", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "38", "deleted_lines": "37", "method_info": {"method_name": "test__training_step__flow_dict", "method_params": "tmpdir", "method_startline": "24", "method_endline": "56", "method_complexity": {"method_NLOC": "19", "method_CCN": "1", "method_NToken": "83", "method_nesting_level": "0"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "80", "deleted_lines": "79", "method_info": {"method_name": "test__training_step__tr_step_end__flow_dict", "method_params": "tmpdir", "method_startline": "59", "method_endline": "98", "method_complexity": {"method_NLOC": "20", "method_CCN": "1", "method_NToken": "84", "method_nesting_level": "0"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "80", "deleted_lines": "79", "method_info": {"method_name": "test__training_step__tr_step_end__flow_dict.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "79", "method_endline": "80", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 8, "file_old_name": "tests\\trainer\\data_flow\\test_train_loop_flow_scalar_1_0.py", "file_new_name": "tests\\trainer\\data_flow\\test_train_loop_flow_scalar_1_0.py", "file_complexity": {"file_NLOC": "151", "file_CCN": "21", "file_NToken": "871"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "40", "deleted_lines": "39", "method_info": {"method_name": "test__training_step__flow_scalar.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "39", "method_endline": "40", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "40", "deleted_lines": "39", "method_info": {"method_name": "test__training_step__flow_scalar", "method_params": "tmpdir", "method_startline": "26", "method_endline": "58", "method_complexity": {"method_NLOC": "19", "method_CCN": "1", "method_NToken": "83", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "184", "deleted_lines": "183", "method_info": {"method_name": "test__training_step__step_end__epoch_end__flow_scalar.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "183", "method_endline": "184", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "82", "deleted_lines": "81", "method_info": {"method_name": "test__training_step__tr_step_end__flow_scalar", "method_params": "tmpdir", "method_startline": "61", "method_endline": "100", "method_complexity": {"method_NLOC": "20", "method_CCN": "1", "method_NToken": "84", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "184", "deleted_lines": "183", "method_info": {"method_name": "test__training_step__step_end__epoch_end__flow_scalar", "method_params": "tmpdir", "method_startline": "151", "method_endline": "202", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "85", "method_nesting_level": "0"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "130", "deleted_lines": "129", "method_info": {"method_name": "test__training_step__epoch_end__flow_scalar.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "129", "method_endline": "130", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "82", "deleted_lines": "81", "method_info": {"method_name": "test__training_step__tr_step_end__flow_scalar.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "81", "method_endline": "82", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "130", "deleted_lines": "129", "method_info": {"method_name": "test__training_step__epoch_end__flow_scalar", "method_params": "tmpdir", "method_startline": "103", "method_endline": "148", "method_complexity": {"method_NLOC": "20", "method_CCN": "1", "method_NToken": "84", "method_nesting_level": "0"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tests\\trainer\\legacy_deprecate_flow_log_tests\\test_eval_loop_dict_return.py", "file_new_name": "tests\\trainer\\legacy_deprecate_flow_log_tests\\test_eval_loop_dict_return.py", "file_complexity": {"file_NLOC": "204", "file_CCN": "14", "file_NToken": "1243"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "26,27,28,29,30", "deleted_lines": "25", "method_info": {"method_name": "test_validation_step_no_return", "method_params": "tmpdir", "method_startline": "22", "method_endline": "52", "method_complexity": {"method_NLOC": "20", "method_CCN": "1", "method_NToken": "106", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "28,29", "deleted_lines": null, "method_info": {"method_name": "test_validation_step_no_return.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "28", "method_endline": "29", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tests\\trainer\\logging\\test_eval_loop_logging_1_0.py", "file_new_name": "tests\\trainer\\logging\\test_eval_loop_logging_1_0.py", "file_complexity": {"file_NLOC": "249", "file_CCN": "25", "file_NToken": "1657"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "121", "deleted_lines": "120", "method_info": {"method_name": "test__validation_step__step_end__epoch_end__log.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "120", "method_endline": "121", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "50", "deleted_lines": "49", "method_info": {"method_name": "test__validation_step__log", "method_params": "tmpdir", "method_startline": "27", "method_endline": "84", "method_complexity": {"method_NLOC": "33", "method_CCN": "1", "method_NToken": "147", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "50", "deleted_lines": "49", "method_info": {"method_name": "test__validation_step__log.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "49", "method_endline": "50", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "121", "deleted_lines": "120", "method_info": {"method_name": "test__validation_step__step_end__epoch_end__log", "method_params": "tmpdir", "method_startline": "87", "method_endline": "162", "method_complexity": {"method_NLOC": "42", "method_CCN": "1", "method_NToken": "184", "method_nesting_level": "0"}}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tests\\trainer\\logging\\test_train_loop_logging_1_0.py", "file_new_name": "tests\\trainer\\logging\\test_train_loop_logging_1_0.py", "file_complexity": {"file_NLOC": "346", "file_CCN": "38", "file_NToken": "2579"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "72", "deleted_lines": "71", "method_info": {"method_name": "test__training_step__log", "method_params": "tmpdir", "method_startline": "28", "method_endline": "121", "method_complexity": {"method_NLOC": "46", "method_CCN": "1", "method_NToken": "212", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "72", "deleted_lines": "71", "method_info": {"method_name": "test__training_step__log.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "71", "method_endline": "72", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "145", "deleted_lines": "144", "method_info": {"method_name": "test__training_step__epoch_end__log", "method_params": "tmpdir", "method_startline": "124", "method_endline": "183", "method_complexity": {"method_NLOC": "36", "method_CCN": "1", "method_NToken": "194", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "145", "deleted_lines": "144", "method_info": {"method_name": "test__training_step__epoch_end__log.backward", "method_params": "self,loss,optimizer,optimizer_idx", "method_startline": "144", "method_endline": "145", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "2"}}}}}, "file_10": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tests\\trainer\\optimization\\test_backward_calls.py", "file_complexity": {"file_NLOC": "32", "file_CCN": "3", "file_NToken": "218"}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 38, "file_old_name": "tests\\trainer\\test_trainer.py", "file_new_name": "tests\\trainer\\test_trainer.py", "file_complexity": {"file_NLOC": "1008", "file_CCN": "99", "file_NToken": "6776"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1114,1115,1116,1117", "deleted_lines": "1114", "method_info": {"method_name": "test_trainer_subclassing.__init__", "method_params": "self,custom_arg,args,custom_kwarg,kwargs", "method_startline": "1114", "method_endline": "1117", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "39", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "761,763,764,772,774,775", "deleted_lines": "740,742,743,744,745,753,755,756,757,758,762,770", "method_info": {"method_name": "test_disabled_validation", "method_params": "tmpdir", "method_startline": "729", "method_endline": "775", "method_complexity": {"method_NLOC": "30", "method_CCN": "1", "method_NToken": "164", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "886,887,888,889,890,891,892,893,894,895,896,897,898,899,900", "deleted_lines": "878,893,894,895,896,897,898", "method_info": {"method_name": "test_gradient_clipping", "method_params": "tmpdir", "method_startline": "872", "method_endline": "904", "method_complexity": {"method_NLOC": "13", "method_CCN": "1", "method_NToken": "65", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "368,374,377", "deleted_lines": "366,369", "method_info": {"method_name": "test_loading_yaml", "method_params": "tmpdir", "method_startline": "361", "method_endline": "377", "method_complexity": {"method_NLOC": "11", "method_CCN": "2", "method_NToken": "101", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "925,926,927,928,929,930,931,932,933,934,935,936,937,938,939", "deleted_lines": "909,926,930,931,932,933,934,935,936,937,938,939,940,941,942", "method_info": {"method_name": "test_gradient_clipping_fp16", "method_params": "tmpdir", "method_startline": "909", "method_endline": "942", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "73", "method_nesting_level": "0"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "193,194,212,226,227,229,230,231,232,233,234,235,236,237,238", "deleted_lines": "206,221,222,223,273,274,275,276,277,278,279,280,281,282", "method_info": {"method_name": "test_gradient_accumulation_scheduling", "method_params": "tmpdir,schedule,expected", "method_startline": "190", "method_endline": "282", "method_complexity": {"method_NLOC": "57", "method_CCN": "12", "method_NToken": "493", "method_nesting_level": "0"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "506,540,542,556,560,567,570", "deleted_lines": "525,527,541,545,552,555", "method_info": {"method_name": "test_resume_from_checkpoint_epoch_restored", "method_params": "monkeypatch,tmpdir,tmpdir_server,url_ckpt", "method_startline": "503", "method_endline": "571", "method_complexity": {"method_NLOC": "32", "method_CCN": "4", "method_NToken": "233", "method_nesting_level": "0"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "894,895,896,897", "deleted_lines": "894,895,896,897", "method_info": {"method_name": "test_gradient_clipping_fp16._optimizer_step", "method_params": "args,kwargs", "method_startline": "894", "method_endline": "897", "method_complexity": {"method_NLOC": "4", "method_CCN": "2", "method_NToken": "75", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "786", "deleted_lines": "784", "method_info": {"method_name": "test_nan_loss_detection.training_step", "method_params": "self,batch,batch_idx,optimizer_idx", "method_startline": "782", "method_endline": "789", "method_complexity": {"method_NLOC": "8", "method_CCN": "3", "method_NToken": "64", "method_nesting_level": "2"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "1013", "deleted_lines": "1007,1010,1018,1019,1020", "method_info": {"method_name": "test_num_sanity_val_steps", "method_params": "tmpdir,limit_val_batches", "method_startline": "995", "method_endline": "1020", "method_complexity": {"method_NLOC": "20", "method_CCN": "2", "method_NToken": "116", "method_nesting_level": "0"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "391,393,394", "deleted_lines": "383,384,385,386,387,388,390,391,392,393,394", "method_info": {"method_name": "test_dp_output_reduce", "method_params": "", "method_startline": "380", "method_endline": "394", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "102", "method_nesting_level": "0"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "229,230,231,232,233,234,235,236,237", "deleted_lines": null, "method_info": {"method_name": "test_gradient_accumulation_scheduling._optimizer_step", "method_params": "epoch,batch_idx,optimizer,optimizer_idx,second_order_closure,on_tpu,using_native_amp,using_lbfgs", "method_startline": "229", "method_endline": "237", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "26", "method_nesting_level": "1"}}}, "hunk_12": {"Ismethod": 1, "added_lines": "1307,1308", "deleted_lines": null, "method_info": {"method_name": "test_trainer_subclassing.__init__", "method_params": "self,kwargs", "method_startline": "1306", "method_endline": "1309", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "41", "method_nesting_level": "2"}}}, "hunk_13": {"Ismethod": 1, "added_lines": "46,62,65,70,74,75,76,77,78,79", "deleted_lines": "43,47,63,66,71,75,76,84", "method_info": {"method_name": "test_no_val_module", "method_params": "monkeypatch,tmpdir,tmpdir_server,url_ckpt", "method_startline": "43", "method_endline": "84", "method_complexity": {"method_NLOC": "28", "method_CCN": "2", "method_NToken": "166", "method_nesting_level": "0"}}}, "hunk_14": {"Ismethod": 1, "added_lines": "1291,1296,1300,1307,1308,1311,1314,1319", "deleted_lines": null, "method_info": {"method_name": "test_trainer_subclassing", "method_params": "", "method_startline": "1286", "method_endline": "1319", "method_complexity": {"method_NLOC": "19", "method_CCN": "1", "method_NToken": "120", "method_nesting_level": "0"}}}, "hunk_15": {"Ismethod": 1, "added_lines": "1046,1049", "deleted_lines": "1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054", "method_info": {"method_name": "test_num_sanity_val_steps_neg_one", "method_params": "tmpdir,limit_val_batches", "method_startline": "1032", "method_endline": "1054", "method_complexity": {"method_NLOC": "17", "method_CCN": "1", "method_NToken": "108", "method_nesting_level": "0"}}}, "hunk_16": {"Ismethod": 1, "added_lines": "1291", "deleted_lines": null, "method_info": {"method_name": "test_trainer_subclassing.__init__", "method_params": "self,custom_arg,args,custom_kwarg,kwargs", "method_startline": "1291", "method_endline": "1294", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "39", "method_nesting_level": "2"}}}, "hunk_17": {"Ismethod": 1, "added_lines": "786,800", "deleted_lines": "784,793", "method_info": {"method_name": "test_nan_loss_detection", "method_params": "tmpdir", "method_startline": "778", "method_endline": "805", "method_complexity": {"method_NLOC": "15", "method_CCN": "2", "method_NToken": "91", "method_nesting_level": "0"}}}, "hunk_18": {"Ismethod": 1, "added_lines": "1357,1360,1361,1364,1365", "deleted_lines": null, "method_info": {"method_name": "test_trainer_setup_call", "method_params": "tmpdir", "method_startline": "1343", "method_endline": "1365", "method_complexity": {"method_NLOC": "13", "method_CCN": "1", "method_NToken": "89", "method_nesting_level": "0"}}}, "hunk_19": {"Ismethod": 1, "added_lines": "956", "deleted_lines": "945,952,953,954,955,956,957", "method_info": {"method_name": "test_gpu_choice", "method_params": "tmpdir", "method_startline": "945", "method_endline": "957", "method_complexity": {"method_NLOC": "10", "method_CCN": "2", "method_NToken": "75", "method_nesting_level": "0"}}}, "hunk_20": {"Ismethod": 1, "added_lines": "91,108,111,116,117,118,119,120,121", "deleted_lines": "88,105,108,113,114,122,126", "method_info": {"method_name": "test_no_val_end_module", "method_params": "monkeypatch,tmpdir,tmpdir_server,url_ckpt", "method_startline": "88", "method_endline": "126", "method_complexity": {"method_NLOC": "26", "method_CCN": "2", "method_NToken": "143", "method_nesting_level": "0"}}}, "hunk_21": {"Ismethod": 1, "added_lines": "457,458,464,469,475,476,482,486,487,490", "deleted_lines": "460,461,467,471,472,475,487,491", "method_info": {"method_name": "test_model_checkpoint_only_weights", "method_params": "tmpdir", "method_startline": "455", "method_endline": "491", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "165", "method_nesting_level": "0"}}}, "hunk_22": {"Ismethod": 1, "added_lines": "888,889,890,891,892,893,894,895,896,897,898", "deleted_lines": "893,894,895,896,897,898", "method_info": {"method_name": "test_gradient_clipping.training_step_and_backward", "method_params": "split_batch,batch_idx,opt_idx,optimizer,hiddens", "method_startline": "888", "method_endline": "898", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "100", "method_nesting_level": "1"}}}, "hunk_23": {"Ismethod": 1, "added_lines": "426", "deleted_lines": "426", "method_info": {"method_name": "test_model_checkpoint_options.mock_save_function", "method_params": "filepath,args", "method_startline": "425", "method_endline": "426", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}, "hunk_24": {"Ismethod": 1, "added_lines": "611", "deleted_lines": "596,616", "method_info": {"method_name": "test_trainer_max_steps_and_epochs", "method_params": "tmpdir", "method_startline": "589", "method_endline": "621", "method_complexity": {"method_NLOC": "20", "method_CCN": "1", "method_NToken": "128", "method_nesting_level": "0"}}}, "hunk_25": {"Ismethod": 1, "added_lines": "631,638,646,647,648,651,659,660,661", "deleted_lines": "631,632,635,643,644", "method_info": {"method_name": "test_trainer_min_steps_and_epochs", "method_params": "tmpdir", "method_startline": "624", "method_endline": "661", "method_complexity": {"method_NLOC": "23", "method_CCN": "3", "method_NToken": "164", "method_nesting_level": "0"}}}, "hunk_26": {"Ismethod": 1, "added_lines": "133,155,160,161,162,163,164,165", "deleted_lines": "148,153,154,155,183,184,185,186,187,188", "method_info": {"method_name": "test_strict_model_load", "method_params": "monkeypatch,tmpdir,tmpdir_server,url_ckpt", "method_startline": "130", "method_endline": "189", "method_complexity": {"method_NLOC": "42", "method_CCN": "4", "method_NToken": "202", "method_nesting_level": "0"}}}, "hunk_27": {"Ismethod": 1, "added_lines": "315", "deleted_lines": "321", "method_info": {"method_name": "test_gradient_accumulation_scheduling_last_batch.on_train_batch_end", "method_params": "self,outputs,batch,batch_idx,dataloader_idx", "method_startline": "314", "method_endline": "321", "method_complexity": {"method_NLOC": "6", "method_CCN": "5", "method_NToken": "81", "method_nesting_level": "2"}}}, "hunk_28": {"Ismethod": 1, "added_lines": "824", "deleted_lines": "809", "method_info": {"method_name": "test_nan_params_detection", "method_params": "tmpdir", "method_startline": "808", "method_endline": "830", "method_complexity": {"method_NLOC": "15", "method_CCN": "2", "method_NToken": "107", "method_nesting_level": "0"}}}, "hunk_29": {"Ismethod": 1, "added_lines": null, "deleted_lines": "865,866,867,868", "method_info": {"method_name": "test_gradient_clipping._optimizer_step", "method_params": "args,kwargs", "method_startline": "865", "method_endline": "868", "method_complexity": {"method_NLOC": "4", "method_CCN": "2", "method_NToken": "75", "method_nesting_level": "1"}}}, "hunk_30": {"Ismethod": 1, "added_lines": "698,701,704,718,720,721,722,723,724", "deleted_lines": "701,703", "method_info": {"method_name": "test_test_checkpoint_path", "method_params": "tmpdir,ckpt_path,save_top_k", "method_startline": "690", "method_endline": "726", "method_complexity": {"method_NLOC": "32", "method_CCN": "5", "method_NToken": "195", "method_nesting_level": "0"}}}, "hunk_31": {"Ismethod": 1, "added_lines": "315,329", "deleted_lines": "307,321", "method_info": {"method_name": "test_gradient_accumulation_scheduling_last_batch", "method_params": "tmpdir,accumulate_grad_batches,limit_train_batches", "method_startline": "304", "method_endline": "332", "method_complexity": {"method_NLOC": "13", "method_CCN": "1", "method_NToken": "54", "method_nesting_level": "0"}}}, "hunk_32": {"Ismethod": 1, "added_lines": "426,431,432,433,441,446,447,448", "deleted_lines": "426,431,432,433,442,443,449", "method_info": {"method_name": "test_model_checkpoint_options", "method_params": "tmpdir,save_top_k,save_last,file_prefix,expected_files", "method_startline": "422", "method_endline": "452", "method_complexity": {"method_NLOC": "19", "method_CCN": "3", "method_NToken": "150", "method_nesting_level": "0"}}}, "hunk_33": {"Ismethod": 1, "added_lines": null, "deleted_lines": "221,222,223", "method_info": {"method_name": "test_gradient_accumulation_scheduling._optimizer_step", "method_params": "epoch,batch_idx,optimizer,optimizer_idx,second_order_closure,on_tpu,using_native_amp,using_lbfgs", "method_startline": "221", "method_endline": "223", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "1"}}}, "hunk_34": {"Ismethod": 1, "added_lines": "927,928,929,930,931,932,933,934,935,936,937", "deleted_lines": "930,931,932,933,934,935,936,937", "method_info": {"method_name": "test_gradient_clipping_fp16.training_step_and_backward", "method_params": "split_batch,batch_idx,opt_idx,optimizer,hiddens", "method_startline": "927", "method_endline": "937", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "100", "method_nesting_level": "1"}}}, "hunk_35": {"Ismethod": 1, "added_lines": "212,226,227,229,230,231,232,233,234,235,236,237,238,288,289,290", "deleted_lines": "206,221,222,223,273,274,275,276,277,278,279,280,281,282,286", "method_info": {"method_name": "test_gradient_accumulation_scheduling", "method_params": "tmpdir,schedule,expected", "method_startline": "196", "method_endline": "290", "method_complexity": {"method_NLOC": "57", "method_CCN": "12", "method_NToken": "497", "method_nesting_level": "0"}}}, "hunk_36": {"Ismethod": 1, "added_lines": "978", "deleted_lines": "977", "method_info": {"method_name": "test_tpu_choice", "method_params": "tmpdir,tpu_cores,expected_tpu_id,error_expected", "method_startline": "976", "method_endline": "982", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "65", "method_nesting_level": "0"}}}, "hunk_37": {"Ismethod": 1, "added_lines": "343,353", "deleted_lines": "335,345", "method_info": {"method_name": "test_loading_meta_tags", "method_params": "tmpdir", "method_startline": "335", "method_endline": "358", "method_complexity": {"method_NLOC": "14", "method_CCN": "1", "method_NToken": "118", "method_nesting_level": "0"}}}}}}}}