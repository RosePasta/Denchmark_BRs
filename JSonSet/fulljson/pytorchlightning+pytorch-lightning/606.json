{"BR": {"BR_id": "606", "BR_author": "awaelchli", "BRopenT": "2019-12-08T00:30:41Z", "BRcloseT": "2019-12-09T18:32:50Z", "BR_text": {"BRsummary": "Early Stopping kicks in at min_epochs + 2 instead of min_epochs", "BRdescription": "\n <denchmark-h:h3>Describe the bug</denchmark-h>\n \n I was working on a fix for <denchmark-link:https://github.com/PyTorchLightning/pytorch-lightning/issues/524>#524</denchmark-link>\n  and found that early stopping starts to kick in at epoch 3 despite min_epochs = 1.\n <denchmark-h:h4>To Reproduce</denchmark-h>\n \n run basic_examples/gpu_template.py and log the callback calls every epoch.\n <denchmark-h:h4>Expected behavior</denchmark-h>\n \n When setting min_epochs=n (counting from 1), we should evaluate early stopping at the end of epoch n.\n <denchmark-h:h4>Proposed fix:</denchmark-h>\n \n I propose to change <denchmark-link:https://github.com/williamFalcon/pytorch-lightning/blob/58cc6e13b9999161a526b83063c983750e6553b1/pytorch_lightning/trainer/training_loop.py#L322>this</denchmark-link>\n  line in the training loop:\n \n to\n \n \n \n Why the \"-1\"? The epoch variable in the training loop starts at 0, but the Trainer argument min_epochs starts counting at 1.\n \n \n Why the \">=\"? The early stop check is done at the end of each epoch, hence the epoch counter will be = to min_epochs after min_epochs have passed.\n \n \n Desktop (please complete the following information):\n \n OS: Linux\n Version: master\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "awaelchli", "commentT": "2019-12-09T12:49:31Z", "comment_text": "\n \t\tsubmit the PR for this?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "awaelchli", "commentT": "2019-12-09T13:20:42Z", "comment_text": "\n \t\tyep. was waiting for an approval.\n \t\t"}}}, "commit": {"commit_id": "e2ee4ddbdb75a91132394208fabc8c62ca39f3e9", "commit_author": "Adrian W\u00e4lchli", "commitT": "2019-12-09 10:32:49-08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pytorch_lightning\\trainer\\training_loop.py", "file_new_name": "pytorch_lightning\\trainer\\training_loop.py", "file_complexity": {"file_NLOC": "414", "file_CCN": "79", "file_NToken": "1694"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "345", "deleted_lines": "342", "method_info": {"method_name": "train", "method_params": "self", "method_startline": "282", "method_endline": "360", "method_complexity": {"method_NLOC": "49", "method_CCN": "19", "method_NToken": "369", "method_nesting_level": "1"}}}}}}}}