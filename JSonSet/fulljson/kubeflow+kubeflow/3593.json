{"BR": {"BR_id": "3593", "BR_author": "jlewi", "BRopenT": "2019-07-02T01:40:24Z", "BRcloseT": "2020-01-20T00:13:39Z", "BR_text": {"BRsummary": "gcp.go should assert error is of type kfError before accessing its fields", "BRdescription": "\n We have lots of code like this\n \n \n \n kubeflow/bootstrap/pkg/kfapp/gcp/gcp.go\n \n \n          Line 832\n       in\n       bb4d1d9\n \n \n \n \n \n \n  return &kfapis.KfError{ \n \n \n \n \n \n <denchmark-code>return  &kfapis.KfError{\n \t\t\tCode: secretsErr.(*kfapis.KfError).Code,\n \t\t\tMessage: fmt.Sprintf(\"gcp apply could not create secrets Error %v\",\n \t\t\t\tsecretsErr.(*kfapis.KfError).Message),\n \t\t}\n </denchmark-code>\n \n This is unsafe because this will segfault if the error fails the assertion.\n We should be more defensive.\n In a forthcoming PR I will add a method like\n <denchmark-code>func NewKfErrorWithMessage(e error, msg string) error {\n \tkErr, ok := e.(*KfError)\n \n \tif !ok {\n \t\tlog.Infof(\"Error is not a KfError; %v\", e)\n \n \t\treturn &KfError{\n \t\t\tCode:    int(UNKNOWN),\n \t\t\tMessage: msg + \"; \" +  e.Error(),\n \t\t}\n \t}\n \treturn &KfError{\n \t\tCode:    kErr.Code,\n \t\tMessage: msg + \"; \" + kErr.Message,\n \t}\n }\n </denchmark-code>\n \n which can be used to replace the existing code.\n Filing this issue to track actually updating the code.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "jlewi", "commentT": "2019-07-02T01:40:25Z", "comment_text": "\n \t\tIssue Label Bot is not confident enough to auto-label this issue. See <denchmark-link:https://mlbot.net/data/kubeflow/kubeflow>dashboard</denchmark-link>\n  for more details.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "jlewi", "commentT": "2019-09-30T02:14:11Z", "comment_text": "\n \t\tThis issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "jlewi", "commentT": "2020-01-12T23:55:11Z", "comment_text": "\n \t\tThis issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n \t\t"}}}, "commit": {"commit_id": "56fafa45e96c7933eecf09d8174e993d778f41ec", "commit_author": "Jeremy Lewi", "commitT": "2019-07-02 13:04:30-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "bootstrap\\pkg\\utils\\logging.go", "file_complexity": {"file_NLOC": "17", "file_CCN": "3", "file_NToken": "78"}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "bootstrap\\v2\\pkg\\apis\\kferrors.go", "file_new_name": "bootstrap\\v2\\pkg\\apis\\kferrors.go", "file_complexity": {"file_NLOC": "34", "file_CCN": "3", "file_NToken": "156"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64", "deleted_lines": null, "method_info": {"method_name": "NewKfErrorWithMessage", "method_params": "error,string", "method_startline": "49", "method_endline": "64", "method_complexity": {"method_NLOC": "14", "method_CCN": "2", "method_NToken": "80", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "bootstrap\\v2\\pkg\\utils\\logging.go", "file_complexity": {"file_NLOC": "17", "file_CCN": "3", "file_NToken": "78"}}}}}