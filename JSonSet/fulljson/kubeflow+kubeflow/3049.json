{"BR": {"BR_id": "3049", "BR_author": "lluunn", "BRopenT": "2019-04-18T19:37:18Z", "BRcloseT": "2019-04-19T23:27:55Z", "BR_text": {"BRsummary": "kfctl install istio fails with GOOGLE_APPLICATION_CREDENTIALS", "BRdescription": "\n Just like what we do in <denchmark-link:https://github.com/kubeflow/kubeflow/blob/master/testing/kfctl/kfctl_go_test.py>test</denchmark-link>\n :\n \n use GOOGLE_APPLICATIOB_CREDENTIALS to point to a service account\n gcloud activate that\n set email to that service account\n \n Installing istio failed to create clusterrole.\n However, there is already a binding for service account and cluster admin.\n Maybe it's because when installing istio we get another identity / wrong way getting credential?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "lluunn", "commentT": "2019-04-18T19:37:20Z", "comment_text": "\n \t\tIssue-Label Bot is automatically applying the label kind/bug to this issue, with a confidence of 0.94. Please mark this comment with \ud83d\udc4d or \ud83d\udc4e to give our bot feedback!\n Links: <denchmark-link:https://github.com/marketplace/issue-label-bot>app homepage</denchmark-link>\n , <denchmark-link:https://mlbot.net/data/kubeflow/kubeflow>dashboard</denchmark-link>\n  and <denchmark-link:https://github.com/hamelsmu/MLapp>code</denchmark-link>\n  for this bot.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "lluunn", "commentT": "2019-04-18T22:38:12Z", "comment_text": "\n \t\tFrom the audit log, the user trying to create clusterrole is: 108944523862763815402\n not the service account\n Not sure how it gets 108944523862763815402...\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "lluunn", "commentT": "2019-04-18T22:40:26Z", "comment_text": "\n \t\t<denchmark-link:https://user-images.githubusercontent.com/32310205/56395626-2efeb300-61f0-11e9-9784-ab759bfe0d40.png></denchmark-link>\n \n The user who updating the admin binding is the same.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "lluunn", "commentT": "2019-04-18T22:50:23Z", "comment_text": "\n \t\t<denchmark-link:https://user-images.githubusercontent.com/32310205/56395922-7174bf80-61f1-11e9-82e5-6d5b2b16703f.png></denchmark-link>\n \n The ksonnet apply has the correct identity: admin-sa@kai-test2...\n Which is different from 1089... used by creating admin binding and scretes and istio.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "lluunn", "commentT": "2019-04-18T22:52:38Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/kubeflow/kubeflow/blob/master/bootstrap/pkg/kfapp/gcp/gcp.go#L667-L682>https://github.com/kubeflow/kubeflow/blob/master/bootstrap/pkg/kfapp/gcp/gcp.go#L667-L682</denchmark-link>\n \n So using this way, we get identity 108944523862763815402\n \t\t"}}}, "commit": {"commit_id": "0c410b78953f306dc58a2f024cb5fa89487d98dd", "commit_author": "Lun-Kai Hsu", "commitT": "2019-04-19 16:27:54-07:00", "commit_complexity": {"commit_NLOC": "0.375", "commit_CCN": "0.0", "commit_Nprams": "0.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "bootstrap\\pkg\\kfapp\\gcp\\gcp.go", "file_new_name": "bootstrap\\pkg\\kfapp\\gcp\\gcp.go", "file_complexity": {"file_NLOC": "1453", "file_CCN": "32", "file_NToken": "10116"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,684,685,688,689", "deleted_lines": "667,668,669,670,671,672,673,675,676,677,678,679,680,681,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "prow_config.yaml", "file_new_name": "prow_config.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64", "deleted_lines": null}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "testing\\kfctl\\conftest.py", "file_new_name": "testing\\kfctl\\conftest.py", "file_complexity": {"file_NLOC": "46", "file_CCN": "9", "file_NToken": "270"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "24,25,26", "deleted_lines": null, "method_info": {"method_name": "pytest_addoption", "method_params": "parser", "method_startline": "3", "method_endline": "26", "method_complexity": {"method_NLOC": "19", "method_CCN": "1", "method_NToken": "113", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "48,49,50,51", "deleted_lines": null, "method_info": {"method_name": "use_basic_auth", "method_params": "request", "method_startline": "45", "method_endline": "51", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "34", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "54,55,56", "deleted_lines": null, "method_info": {"method_name": "use_istio", "method_params": "request", "method_startline": "54", "method_endline": "60", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "34", "method_nesting_level": "0"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "testing\\kfctl\\kf_is_ready_test.py", "file_new_name": "testing\\kfctl\\kf_is_ready_test.py", "file_complexity": {"file_NLOC": "58", "file_CCN": "7", "file_NToken": "269"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "14,50,59,65,66,67,68,69", "deleted_lines": "14,28,29,60,69", "method_info": {"method_name": "test_kf_is_ready", "method_params": "namespace,use_basic_auth", "method_startline": "14", "method_endline": "69", "method_complexity": {"method_NLOC": "35", "method_CCN": "5", "method_NToken": "160", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "14,50,59,65,66,67,68,69,73", "deleted_lines": "14,28,29,60,69", "method_info": {"method_name": "test_kf_is_ready", "method_params": "namespace,use_basic_auth,use_istio", "method_startline": "14", "method_endline": "73", "method_complexity": {"method_NLOC": "40", "method_CCN": "7", "method_NToken": "196", "method_nesting_level": "0"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "testing\\kfctl\\kfctl_go_test.py", "file_new_name": "testing\\kfctl\\kfctl_go_test.py", "file_complexity": {"file_NLOC": "79", "file_CCN": "10", "file_NToken": "570"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "30,76,77,78", "deleted_lines": "30", "method_info": {"method_name": "test_build_kfctl_go", "method_params": "app_path,project,use_basic_auth,use_istio", "method_startline": "30", "method_endline": "112", "method_complexity": {"method_NLOC": "48", "method_CCN": "7", "method_NToken": "392", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "30,76,77,78", "deleted_lines": "30", "method_info": {"method_name": "test_build_kfctl_go", "method_params": "app_path,project,use_basic_auth", "method_startline": "30", "method_endline": "109", "method_complexity": {"method_NLOC": "46", "method_CCN": "6", "method_NToken": "381", "method_nesting_level": "0"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "testing\\workflows\\components\\kfctl_go_test.jsonnet", "file_new_name": "testing\\workflows\\components\\kfctl_go_test.jsonnet", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "184,188,189,190,191,227,250", "deleted_lines": "184"}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "testing\\workflows\\components\\params.libsonnet", "file_new_name": "testing\\workflows\\components\\params.libsonnet", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "43", "deleted_lines": null}}}}}}