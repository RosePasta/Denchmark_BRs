{"BR": {"BR_id": "3945", "BR_author": "crauterb", "BRopenT": "2019-08-19T12:21:47Z", "BRcloseT": "2019-12-03T22:37:28Z", "BR_text": {"BRsummary": "Istio-Gateway for created Notebook Servers is not configurable", "BRdescription": "\n /kind bug\n What steps did you take and what happened:\n I deployed v0.6.1. of Kubeflow in an existing Kubernetes Cluster with an existing Istio-Setup.\n After adapting all virtual-service definitions, I got stuck on deploying new notebooks: I was not able to configure the created virtual service for the created notebook server.\n The default version that is deployed is:\n apiVersion: networking.istio.io/v1alpha3\n kind: VirtualService\n metadata:\n   name: notebook-kubeflow-my-jupyter\n spec:\n   gateways:\n   - kubeflow/kubeflow-gateway\n   hosts:\n   - '*'\n   http:\n   - match:\n     - uri:\n         prefix: /notebook/kubeflow/my-jupyter\n     rewrite:\n       uri: /notebook/kubeflow/my-jupyter\n     route:\n     - destination:\n         host: my-jupyter.kubeflow.svc.cluster.local\n         port:\n           number: 80\n     timeout: 300s\n ... and if I am not mistaken, this is hard-coded in the <denchmark-link:https://github.com/kubeflow/kubeflow/blob/master/components/notebook-controller/pkg/controller/notebook/notebook_controller.go#L431>notebook-controller.go</denchmark-link>\n \n What did you expect to happen:\n I expected to be able to configure the gateway using a .yaml file or environment variable.\n Anything else you would like to add:\n I generated the  configuration using <denchmark-link:https://www.kubeflow.org/docs/started/k8s/kfctl-existing-arrikto/>this documentation</denchmark-link>\n .\n Environment:\n \n Kubeflow version: : v.0.6.1\n kfctl version: : v0.6.1-rc.2-1-g3a37cbc6\n Kubernetes platform: on-premise Kubernetes cluster\n Kubernetes client version: (use kubectl version): v1.15.2\n Kubernetes server version: (use kubectl version): v1.11.3\n OS: Ubuntu\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "crauterb", "commentT": "2019-08-19T12:21:49Z", "comment_text": "\n \t\tIssue-Label Bot is automatically applying the label kind/bug to this issue, with a confidence of 0.88. Please mark this comment with \ud83d\udc4d or \ud83d\udc4e to give our bot feedback!\n Links: <denchmark-link:https://github.com/marketplace/issue-label-bot>app homepage</denchmark-link>\n , <denchmark-link:https://mlbot.net/data/kubeflow/kubeflow>dashboard</denchmark-link>\n  and <denchmark-link:https://github.com/hamelsmu/MLapp>code</denchmark-link>\n  for this bot.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "crauterb", "commentT": "2019-08-19T15:33:51Z", "comment_text": "\n \t\tSeems like a limitation of the notebook controller.\n Possible solution:\n \n Add option in notebook controller to define the Istio Gateway.\n Expose that option as a parameter in kubeflow/manifests.\n Set that parameter to your desired value in the KfDef config file.\n \n applications:\n - name: notebook-controller\n   kustomizeConfig:\n     overlays:\n     - istio\n     - application\n     parameters:\n     - name: istio-gateway\n       value: mygateway\n     repoRef:\n       name: manifests\n       path: jupyter/notebook-controller\n /cc <denchmark-link:https://github.com/kunmingg>@kunmingg</denchmark-link>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "crauterb", "commentT": "2019-08-28T18:36:15Z", "comment_text": "\n \t\t/area istio\n /priority p2\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "crauterb", "commentT": "2019-08-28T21:17:13Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/crauterb>@crauterb</denchmark-link>\n  and <denchmark-link:https://github.com/yanniszark>@yanniszark</denchmark-link>\n !\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "crauterb", "commentT": "2019-11-26T22:00:30Z", "comment_text": "\n \t\tThis issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "crauterb", "commentT": "2020-11-23T22:42:31Z", "comment_text": "\n \t\tHow does one configure the ? The Issue <denchmark-link:https://github.com/kubeflow/manifests/pull/499>kubeflow/manifests#499</denchmark-link>\n   only provides the gateway configuration. It defaults to  and I would like to change that.\n \t\t"}}}, "commit": {"commit_id": "df467130c026aa671cb97ad31f06212577f203e6", "commit_author": "Jeremie Vallee", "commitT": "2019-10-14 12:06:59-07:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "components\\notebook-controller\\controllers\\notebook_controller.go", "file_new_name": "components\\notebook-controller\\controllers\\notebook_controller.go", "file_complexity": {"file_NLOC": "394", "file_CCN": "67", "file_NToken": "2628"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "355,356,357,358,359,360", "deleted_lines": "355", "method_info": {"method_name": "generateVirtualService", "method_params": "Notebook", "method_startline": "339", "method_endline": "396", "method_complexity": {"method_NLOC": "52", "method_CCN": "5", "method_NToken": "368", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "components\\notebook-controller\\go.sum", "file_new_name": "components\\notebook-controller\\go.sum", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "642", "deleted_lines": null}}}}}}