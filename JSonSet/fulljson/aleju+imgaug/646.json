{"BR": {"BR_id": "646", "BR_author": "WillNichols726", "BRopenT": "2020-03-26T14:50:12Z", "BRcloseT": "2020-04-13T15:09:11Z", "BR_text": {"BRsummary": "Array broadcast error in Change Color Temperatures", "BRdescription": "\n Getting the following broadcast error when trying to use the Change color temperature augmenter\n Calling code:\n <denchmark-code>self.augmenter = iaa.SomeOf((0,2), [\n                 iaa.AdditiveGaussianNoise(scale=0.3*255, per_channel=True),\n                 iaa.Cutout(nb_iterations=(1,8), size=0.1, fill_mode='gaussian', fill_per_channel=True),\n                 iaa.GaussianBlur(sigma=(0, 0.2)),\n                 iaa.MultiplyAndAddToBrightness(mul=(0.5, 1.5), add=(-30, 30)),\n                 iaa.ChangeColorTemperature((1100, 10000)),\n                 iaa.GammaContrast((0.5, 2.0)),\n                 iaa.Clouds()\n             ],\n             random_order=True            \n             )\n \n #images is a numpy array (N, 96, 96, 3)\n images = self.augmenter.augment_images(images=images)\n </denchmark-code>\n \n Exception Stack:\n <denchmark-code>File \"C:\\Users\\Will.Nichols\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\imgaug\\augmenters\\meta.py\", line 825, in augment_images\n     hooks=hooks\n   File \"C:\\Users\\Will.Nichols\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\imgaug\\augmenters\\meta.py\", line 645, in augment_batch_\n     hooks=hooks)\n   File \"C:\\Users\\Will.Nichols\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\imgaug\\augmenters\\meta.py\", line 3406, in _augment_batch_\n     hooks=hooks\n   File \"C:\\Users\\Will.Nichols\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\imgaug\\augmenters\\meta.py\", line 645, in augment_batch_\n     hooks=hooks)\n   File \"C:\\Users\\Will.Nichols\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\imgaug\\augmenters\\color.py\", line 3093, in _augment_batch_\n     batch.images, kelvins, from_colorspaces=self.from_colorspace)\n   File \"C:\\Users\\Will.Nichols\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\imgaug\\augmenters\\color.py\", line 926, in change_color_temperatures_\n     rgb_multipliers = table.transform_kelvins_to_rgb_multipliers(kelvins)\n   File \"C:\\Users\\Will.Nichols\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\imgaug\\augmenters\\color.py\", line 451, in transform_kelvins_to_rgb_multipliers\n     * (multipliers_ceiled - multipliers_floored)\n ValueError: operands could not be broadcast together with shapes (4,) (4,3)\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "WillNichols726", "commentT": "2020-03-26T17:13:45Z", "comment_text": "\n \t\tWas able to patch my code by making the following code change. Was unable to create pull request.\n current:\n imgaug/augmenters/color.py: Line 450\n             + interpolation_factors\n patched:\n imgaug/augmenters/color.py: Line 450\n             + interpolation_factors[:,None]\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "WillNichols726", "commentT": "2020-04-13T15:09:11Z", "comment_text": "\n \t\tThanks for reporting this issue. The tests all ran with 1 or 3 images (leading to broadcastable arrays in the mentioned line) and thus did not catch this error. It is now fixed in master.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "WillNichols726", "commentT": "2020-12-14T13:47:39Z", "comment_text": "\n \t\tHello, it seems that this fix hasn't been released to PyPi yet. Are there any plans for new release please?\n \t\t"}}}, "commit": {"commit_id": "cf05cd46907945b7b6545040fca197766557626f", "commit_author": "Alexander Jung", "commitT": "2020-04-13 17:05:41+02:00", "commit_complexity": {"commit_NLOC": "0.4838709677419355", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "changelogs\\master\\fixed\\20200412_fix_change_color_temperature.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "imgaug\\augmenters\\color.py", "file_new_name": "imgaug\\augmenters\\color.py", "file_complexity": {"file_NLOC": "3172", "file_CCN": "152", "file_NToken": "11956"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "450", "deleted_lines": "450", "method_info": {"method_name": "transform_kelvins_to_rgb_multipliers", "method_params": "self,kelvins", "method_startline": "416", "method_endline": "454", "method_complexity": {"method_NLOC": "16", "method_CCN": "1", "method_NToken": "112", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "test\\augmenters\\test_color.py", "file_new_name": "test\\augmenters\\test_color.py", "file_complexity": {"file_NLOC": "2241", "file_CCN": "304", "file_NToken": "21395"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "259,260,261,263", "deleted_lines": "259,261", "method_info": {"method_name": "test_several_images_as_list", "method_params": "self", "method_startline": "259", "method_endline": "275", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "167", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "279,280,281,282,283,284,285,286,287,288,289,290,291", "deleted_lines": "277", "method_info": {"method_name": "test_several_images_as_array", "method_params": "self", "method_startline": "277", "method_endline": "291", "method_complexity": {"method_NLOC": "13", "method_CCN": "1", "method_NToken": "141", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "300,301,302", "deleted_lines": null, "method_info": {"method_name": "test_three_images_as_array", "method_params": "self", "method_startline": "300", "method_endline": "316", "method_complexity": {"method_NLOC": "13", "method_CCN": "1", "method_NToken": "141", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "259,260,261,263", "deleted_lines": "259,261,277", "method_info": {"method_name": "test_three_images_as_list", "method_params": "self", "method_startline": "259", "method_endline": "277", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "167", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336", "deleted_lines": null, "method_info": {"method_name": "test_four_images_as_array", "method_params": "self", "method_startline": "318", "method_endline": "336", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "158", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298", "deleted_lines": null, "method_info": {"method_name": "test_four_images_as_list", "method_params": "self", "method_startline": "279", "method_endline": "298", "method_complexity": {"method_NLOC": "16", "method_CCN": "1", "method_NToken": "184", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "test\\augmenters\\test_mixed_files.py", "file_new_name": "test\\augmenters\\test_mixed_files.py", "file_complexity": {"file_NLOC": "405", "file_CCN": "28", "file_NToken": "5414"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "33", "deleted_lines": "33", "method_info": {"method_name": "test_determinism", "method_params": "", "method_startline": "27", "method_endline": "131", "method_complexity": {"method_NLOC": "91", "method_CCN": "3", "method_NToken": "1205", "method_nesting_level": "0"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "test\\test_multicore.py", "file_new_name": "test\\test_multicore.py", "file_complexity": {"file_NLOC": "687", "file_CCN": "107", "file_NToken": "5637"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "357,369,388,389,390", "deleted_lines": "357,369,388,389,390"}}}}}}