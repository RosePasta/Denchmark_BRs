{"BR": {"BR_id": "582", "BR_author": "avitalsh", "BRopenT": "2019-06-23T12:33:39Z", "BRcloseT": "2019-06-25T20:59:22Z", "BR_text": {"BRsummary": "dilation_rate not implemented error in keras conv2D", "BRdescription": "\n Hi,\n I was trying to use the new tf.keras to tfe.keras conversion (PR <denchmark-link:https://github.com/tf-encrypted/tf-encrypted/pull/571>#571</denchmark-link>\n  ) using the following code -\n <denchmark-code>model = tf.keras.Sequential()\n model.add(tf.keras.layers.Conv2D(filters=16, kernel_size=(3,3), use_bias=False))\n \n model.compile('adam', 'categorical_crossentropy', metrics=['accuracy'])\n \n config = tfe.LocalConfig()\n tfe.set_config(config)\n tfe.set_protocol(tfe.protocol.SecureNN())\n \n tf.reset_default_graph()\n \n with tfe.protocol.SecureNN():\n     tfe_model = tfe.keras.models.clone_model(model)\n </denchmark-code>\n \n tf.keras.layers.Conv2D has a default dilation_rate value (1,1). While building the tfe.keras model we reach this if statement:\n \n \n \n tf-encrypted/tf_encrypted/keras/layers/convolutional.py\n \n \n         Lines 122 to 125\n       in\n       0c4aa9b\n \n \n \n \n \n \n  if dilation_rate: \n \n \n \n  raise NotImplementedError( \n \n \n \n  arg_not_impl_msg.format(\"dilation_rate\", \"Conv2d\"), \n \n \n \n    ) \n \n \n \n \n \n Which makes us crush with the following error -\n NotImplementedError: dilation_rate argument is not implemented for layer Conv2d\n I tried setting dilation_rate  to None as a quick workaround but it raised a value error because dilation_rate should be:\n \n an integer or tuple/list of 2 integers\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "avitalsh", "commentT": "2019-06-24T19:03:23Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/avitalsh>@avitalsh</denchmark-link>\n , thank you very much for raising this issue. I see the problem. I will fix it today.\n \t\t"}}}, "commit": {"commit_id": "57e421b2ca0ac79f05f6b0b6ac13df3ffc47359a", "commit_author": "Yann Dupis", "commitT": "2019-06-25 13:59:21-07:00", "commit_complexity": {"commit_NLOC": "0.23529411764705882", "commit_CCN": "1.0", "commit_Nprams": "0.9411764705882353"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tf_encrypted\\keras\\engine\\base_layer.py", "file_new_name": "tf_encrypted\\keras\\engine\\base_layer.py", "file_complexity": {"file_NLOC": "85", "file_CCN": "18", "file_NToken": "433"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "123,124,125,126", "deleted_lines": "118,119,120,121", "method_info": {"method_name": "set_weights", "method_params": "self,weights,sess", "method_startline": "111", "method_endline": "126", "method_complexity": {"method_NLOC": "8", "method_CCN": "3", "method_NToken": "85", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tf_encrypted\\keras\\layers\\convolutional.py", "file_new_name": "tf_encrypted\\keras\\layers\\convolutional.py", "file_complexity": {"file_NLOC": "167", "file_CCN": "14", "file_NToken": "772"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "147,148,149", "deleted_lines": "132,133,134,135,136,137,138,139,140,141,142,143,144,145,146", "method_info": {"method_name": "build", "method_params": "self,input_shape", "method_startline": "132", "method_endline": "155", "method_complexity": {"method_NLOC": "19", "method_CCN": "4", "method_NToken": "127", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "88", "deleted_lines": "88", "method_info": {"method_name": "__init__", "method_params": "self,filters,kernel_size,strides,1", "method_startline": "82", "method_endline": "98", "method_complexity": {"method_NLOC": "17", "method_CCN": "1", "method_NToken": "72", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tf_encrypted\\keras\\layers\\dense.py", "file_new_name": "tf_encrypted\\keras\\layers\\dense.py", "file_complexity": {"file_NLOC": "88", "file_CCN": "8", "file_NToken": "362"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "7,64,65,66,67,68,69,70,71", "deleted_lines": "7,8,9,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85"}}}, "file_3": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tf_encrypted\\keras\\layers\\layers_utils.py", "file_complexity": {"file_NLOC": "28", "file_CCN": "4", "file_NToken": "137"}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tf_encrypted\\keras\\layers\\normalization.py", "file_new_name": "tf_encrypted\\keras\\layers\\normalization.py", "file_complexity": {"file_NLOC": "177", "file_CCN": "12", "file_NToken": "609"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "101", "deleted_lines": "100", "method_info": {"method_name": "__init__", "method_params": "self,axis,momentum,epsilon,center,scale,beta_initializer,gamma_initializer,moving_mean_initializer,moving_variance_initializer,beta_regularizer,gamma_regularizer,beta_constraint,gamma_constraint,renorm,renorm_clipping,renorm_momentum,fused,trainable,virtual_batch_size,adjustment,name,kwargs", "method_startline": "84", "method_endline": "106", "method_complexity": {"method_NLOC": "23", "method_CCN": "1", "method_NToken": "98", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tf_encrypted\\keras\\layers\\relu.py", "file_new_name": "tf_encrypted\\keras\\layers\\relu.py", "file_complexity": {"file_NLOC": "33", "file_CCN": "4", "file_NToken": "127"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "29,30,31,32", "deleted_lines": "29,30,31,32", "method_info": {"method_name": "__init__", "method_params": "self,max_value,negative_slope,threshold,kwargs", "method_startline": "26", "method_endline": "32", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "56", "method_nesting_level": "1"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tf_encrypted\\keras\\models\\sequential_test.py", "file_new_name": "tf_encrypted\\keras\\models\\sequential_test.py", "file_complexity": {"file_NLOC": "102", "file_CCN": "7", "file_NToken": "960"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123", "deleted_lines": null, "method_info": {"method_name": "test_conv_model", "method_params": "self", "method_startline": "91", "method_endline": "123", "method_complexity": {"method_NLOC": "26", "method_CCN": "1", "method_NToken": "282", "method_nesting_level": "1"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tf_encrypted\\keras\\testing_utils.py", "file_new_name": "tf_encrypted\\keras\\testing_utils.py", "file_complexity": {"file_NLOC": "48", "file_CCN": "8", "file_NToken": "390"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "71", "deleted_lines": null}}}}}}