{"BR": {"BR_id": "7193", "BR_author": "AlexDBlack", "BRopenT": "2019-02-19T05:27:51Z", "BRcloseT": "2019-02-20T08:50:05Z", "BR_text": {"BRsummary": "DL4J: Transfer NPE on no weight init for legacy format nets", "BRdescription": "\n I'm pretty sure this is just an issue in the JSON backward compatibility handling since the weight initialization was moved to a class.\n <denchmark-code>        ComputationGraph cg = (ComputationGraph) ResNet50.builder().build().initPretrained();\n \n         cg = new TransferLearning.GraphBuilder(cg)\n                 .addLayer(\"out\", new LossLayer.Builder().lossFunction(LossFunctions.LossFunction.MCXENT).activation(Activation.IDENTITY).build(), \"fc1000\")\n                 .setInputTypes(InputType.convolutional(224, 224, 3))\n                 .setOutputs(\"out\")\n                 .build();\n </denchmark-code>\n \n <denchmark-code>Exception in thread \"main\" java.lang.NullPointerException\n \tat org.deeplearning4j.nn.params.ConvolutionParamInitializer.createWeightMatrix(ConvolutionParamInitializer.java:189)\n \tat org.deeplearning4j.nn.params.ConvolutionParamInitializer.init(ConvolutionParamInitializer.java:118)\n \tat org.deeplearning4j.nn.conf.layers.ConvolutionLayer.instantiate(ConvolutionLayer.java:171)\n \tat org.deeplearning4j.nn.conf.graph.LayerVertex.instantiate(LayerVertex.java:106)\n \tat org.deeplearning4j.nn.graph.ComputationGraph.init(ComputationGraph.java:553)\n \tat org.deeplearning4j.nn.graph.ComputationGraph.init(ComputationGraph.java:435)\n \tat org.deeplearning4j.nn.transferlearning.TransferLearning$GraphBuilder.build(TransferLearning.java:967)\n \tat org.deeplearning4j.mkldnn.SimpleResnet50.main(SimpleResnet50.java:28)\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "AlexDBlack", "commentT": "2019-03-22T09:03:46Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "8c0b0d5f62758fd89232b07441e88bd2441d09ff", "commit_author": "Alex Black", "commitT": "2019-02-20 19:50:04+11:00", "commit_complexity": {"commit_NLOC": "0.6212765957446809", "commit_CCN": "0.8340425531914893", "commit_Nprams": "0.8936170212765957"}, "changed_files": {"file_0": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\TestUtils.java", "file_complexity": {"file_NLOC": "182", "file_CCN": "41", "file_NToken": "1430"}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\computationgraph\\TestComputationGraphSpace.java", "file_new_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\computationgraph\\TestComputationGraphSpace.java", "file_complexity": {"file_NLOC": "120", "file_CCN": "13", "file_NToken": "1273"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "142", "deleted_lines": "141", "method_info": {"method_name": "TestComputationGraphSpace::testBasic2", "method_params": "", "method_startline": "84", "method_endline": "164", "method_complexity": {"method_NLOC": "63", "method_CCN": "12", "method_NToken": "632", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\computationgraph\\TestGraphLocalExecution.java", "file_new_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\computationgraph\\TestGraphLocalExecution.java", "file_complexity": {"file_NLOC": "293", "file_CCN": "24", "file_NToken": "2794"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "94,95,96", "deleted_lines": null, "method_info": {"method_name": "TestGraphLocalExecution::before", "method_params": "", "method_startline": "94", "method_endline": "96", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\multilayernetwork\\TestDL4JLocalExecution.java", "file_new_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\multilayernetwork\\TestDL4JLocalExecution.java", "file_complexity": {"file_NLOC": "292", "file_CCN": "27", "file_NToken": "2635"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "83,84,85", "deleted_lines": null, "method_info": {"method_name": "TestDL4JLocalExecution::before", "method_params": "", "method_startline": "83", "method_endline": "85", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\multilayernetwork\\TestLayerSpace.java", "file_new_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\multilayernetwork\\TestLayerSpace.java", "file_complexity": {"file_NLOC": "225", "file_CCN": "37", "file_NToken": "2440"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "100", "deleted_lines": "99", "method_info": {"method_name": "TestLayerSpace::testBasic2", "method_params": "", "method_startline": "64", "method_endline": "109", "method_complexity": {"method_NLOC": "34", "method_CCN": "7", "method_NToken": "366", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\multilayernetwork\\TestMultiLayerSpace.java", "file_new_name": "arbiter\\arbiter-deeplearning4j\\src\\test\\java\\org\\deeplearning4j\\arbiter\\multilayernetwork\\TestMultiLayerSpace.java", "file_complexity": {"file_NLOC": "545", "file_CCN": "49", "file_NToken": "6158"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "267", "deleted_lines": "259", "method_info": {"method_name": "TestMultiLayerSpace::testBasic2", "method_params": "", "method_startline": "204", "method_endline": "297", "method_complexity": {"method_NLOC": "72", "method_CCN": "15", "method_NToken": "751", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "94,95,96", "deleted_lines": null, "method_info": {"method_name": "TestMultiLayerSpace::before", "method_params": "", "method_startline": "94", "method_endline": "96", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\conf\\serde\\BaseNetConfigDeserializer.java", "file_new_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\conf\\serde\\BaseNetConfigDeserializer.java", "file_complexity": {"file_NLOC": "199", "file_CCN": "56", "file_NToken": "1608"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242", "deleted_lines": null, "method_info": {"method_name": "BaseNetConfigDeserializer<T>::handleWeightInitBackwardCompatibility", "method_params": "baseLayer,on", "method_startline": "222", "method_endline": "242", "method_complexity": {"method_NLOC": "19", "method_CCN": "7", "method_NToken": "151", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "97,98,99,100,101,102,103,104", "deleted_lines": null, "method_info": {"method_name": "BaseNetConfigDeserializer<T>::requiresWeightInitFromLegacy", "method_params": "layers", "method_startline": "97", "method_endline": "104", "method_complexity": {"method_NLOC": "8", "method_CCN": "4", "method_NToken": "45", "method_nesting_level": "1"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\conf\\serde\\ComputationGraphConfigurationDeserializer.java", "file_new_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\conf\\serde\\ComputationGraphConfigurationDeserializer.java", "file_complexity": {"file_NLOC": "122", "file_CCN": "34", "file_NToken": "1203"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "76,77,81,104,122,123,124,125,141,142,143,144,145,146,147,148", "deleted_lines": "79,134", "method_info": {"method_name": "ComputationGraphConfigurationDeserializer::deserialize", "method_params": "jp,ctxt", "method_startline": "54", "method_endline": "168", "method_complexity": {"method_NLOC": "90", "method_CCN": "33", "method_NToken": "890", "method_nesting_level": "1"}}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\conf\\serde\\MultiLayerConfigurationDeserializer.java", "file_new_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\conf\\serde\\MultiLayerConfigurationDeserializer.java", "file_complexity": {"file_NLOC": "111", "file_CCN": "30", "file_NToken": "1020"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "61,63,127,128,129,130,131,132,133,134,135,136", "deleted_lines": "62", "method_info": {"method_name": "MultiLayerConfigurationDeserializer::deserialize", "method_params": "jp,ctxt", "method_startline": "48", "method_endline": "159", "method_complexity": {"method_NLOC": "84", "method_CCN": "29", "method_NToken": "739", "method_nesting_level": "1"}}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\layers\\objdetect\\Yolo2OutputLayer.java", "file_new_name": "deeplearning4j\\deeplearning4j-nn\\src\\main\\java\\org\\deeplearning4j\\nn\\layers\\objdetect\\Yolo2OutputLayer.java", "file_complexity": {"file_NLOC": "374", "file_CCN": "32", "file_NToken": "5170"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "174", "deleted_lines": "174", "method_info": {"method_name": "Yolo2OutputLayer::computeBackpropGradientAndScore", "method_params": "workspaceMgr,scoreOnly,computeScoreForExamples", "method_startline": "108", "method_endline": "384", "method_complexity": {"method_NLOC": "148", "method_CCN": "7", "method_NToken": "2542", "method_nesting_level": "1"}}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-zoo\\src\\main\\java\\org\\deeplearning4j\\zoo\\model\\AlexNet.java", "file_new_name": "deeplearning4j\\deeplearning4j-zoo\\src\\main\\java\\org\\deeplearning4j\\zoo\\model\\AlexNet.java", "file_complexity": {"file_NLOC": "149", "file_CCN": "8", "file_NToken": "1272"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "155,161,169", "deleted_lines": "155,161,169", "method_info": {"method_name": "AlexNet::conf", "method_params": "", "method_startline": "84", "method_endline": "178", "method_complexity": {"method_NLOC": "91", "method_CCN": "1", "method_NToken": "817", "method_nesting_level": "1"}}}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-zoo\\src\\main\\java\\org\\deeplearning4j\\zoo\\model\\NASNet.java", "file_new_name": "deeplearning4j\\deeplearning4j-zoo\\src\\main\\java\\org\\deeplearning4j\\zoo\\model\\NASNet.java", "file_complexity": {"file_NLOC": "148", "file_CCN": "20", "file_NToken": "1438"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "132", "method_info": {"method_name": "NASNet::graphBuilder", "method_params": "", "method_startline": "121", "method_endline": "204", "method_complexity": {"method_NLOC": "67", "method_CCN": "9", "method_NToken": "754", "method_nesting_level": "1"}}}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-zoo\\src\\main\\java\\org\\deeplearning4j\\zoo\\model\\ResNet50.java", "file_new_name": "deeplearning4j\\deeplearning4j-zoo\\src\\main\\java\\org\\deeplearning4j\\zoo\\model\\ResNet50.java", "file_complexity": {"file_NLOC": "192", "file_CCN": "13", "file_NToken": "2290"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "185", "method_info": {"method_name": "ResNet50::graphBuilder", "method_params": "", "method_startline": "178", "method_endline": "241", "method_complexity": {"method_NLOC": "53", "method_CCN": "1", "method_NToken": "900", "method_nesting_level": "1"}}}}}, "file_13": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-zoo\\src\\main\\java\\org\\deeplearning4j\\zoo\\model\\UNet.java", "file_new_name": "deeplearning4j\\deeplearning4j-zoo\\src\\main\\java\\org\\deeplearning4j\\zoo\\model\\UNet.java", "file_complexity": {"file_NLOC": "176", "file_CCN": "10", "file_NToken": "2206"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "109", "method_info": {"method_name": "UNet::graphBuilder", "method_params": "", "method_startline": "103", "method_endline": "228", "method_complexity": {"method_NLOC": "108", "method_CCN": "1", "method_NToken": "1667", "method_nesting_level": "1"}}}}}, "file_14": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "deeplearning4j\\deeplearning4j-zoo\\src\\test\\java\\org\\deeplearning4j\\zoo\\TestInstantiation.java", "file_new_name": "deeplearning4j\\deeplearning4j-zoo\\src\\test\\java\\org\\deeplearning4j\\zoo\\TestInstantiation.java", "file_complexity": {"file_NLOC": "236", "file_CCN": "14", "file_NToken": "2814"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "353,354,355,356,357,358,359,360,361,362,363,364", "deleted_lines": null, "method_info": {"method_name": "TestInstantiation::testTransferLearning", "method_params": "", "method_startline": "353", "method_endline": "364", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "94", "method_nesting_level": "1"}}}}}, "file_15": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "nd4j\\nd4j-backends\\nd4j-api-parent\\nd4j-api\\src\\main\\java\\org\\nd4j\\linalg\\dataset\\api\\preprocessor\\VGG16ImagePreProcessor.java", "file_new_name": "nd4j\\nd4j-backends\\nd4j-api-parent\\nd4j-api\\src\\main\\java\\org\\nd4j\\linalg\\dataset\\api\\preprocessor\\VGG16ImagePreProcessor.java", "file_complexity": {"file_NLOC": "96", "file_CCN": "22", "file_NToken": "598"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "117,118", "deleted_lines": null, "method_info": {"method_name": "VGG16ImagePreProcessor::revertFeatures", "method_params": "features", "method_startline": "116", "method_endline": "119", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "40", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "72,73", "deleted_lines": null, "method_info": {"method_name": "VGG16ImagePreProcessor::preProcess", "method_params": "features", "method_startline": "71", "method_endline": "74", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "40", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "148,149,150,151,152,153,154,155,156,157,158,159", "deleted_lines": null, "method_info": {"method_name": "VGG16ImagePreProcessor::getMeanFor", "method_params": "features", "method_startline": "148", "method_endline": "159", "method_complexity": {"method_NLOC": "12", "method_CCN": "4", "method_NToken": "50", "method_nesting_level": "1"}}}}}}}}