{"BR": {"BR_id": "365", "BR_author": "guillaumekln", "BRopenT": "2019-03-05T10:51:02Z", "BRcloseT": "2019-03-05T11:33:33Z", "BR_text": {"BRsummary": "Failed to restore checkpoint during evaluation when using DenseBridge", "BRdescription": "\n As it seems there still is an issue, after writing 1st checkpoint OpenNMT fails:\n <denchmark-code>INFO:tensorflow:Starting evaluation at 2019-03-04T18:24:11Z\n INFO:tensorflow:Graph was finalized.\n 2019-03-04 20:24:11.831808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\n 2019-03-04 20:24:11.831888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\n 2019-03-04 20:24:11.831898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0\n 2019-03-04 20:24:11.831906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N\n 2019-03-04 20:24:11.832092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15190 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0002:01:00.0, compute capability: 6.0)\n WARNING:tensorflow:From /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\n Instructions for updating:\n Use standard file APIs to check for files with this prefix.\n INFO:tensorflow:Restoring parameters from /projects/aigine/35/tf/m-1088-3-5-5-s/model.ckpt-4000\n 2019-03-04 20:24:12.044384: W tensorflow/core/framework/op_kernel.cc:1401] OP_REQUIRES failed at save_restore_v2_ops.cc:184 : Not found: Key seq2seq/decoder/dense/bias_2 not found in checkpoint\n \n WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.\n For more information, please see:\n   * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md\n   * https://github.com/tensorflow/addons\n If you depend on functionality not listed there, please file an issue.\n \n Traceback (most recent call last):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\n     return fn(*args)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\n     options, feed_dict, fetch_list, target_list, run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\n     run_metadata)\n tensorflow.python.framework.errors_impl.NotFoundError: Key seq2seq/decoder/dense/bias_2 not found in checkpoint\n          [[{{node save/RestoreV2}}]]\n          [[{{node save/RestoreV2}}]]\n \n During handling of the above exception, another exception occurred:\n \n Traceback (most recent call last):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1276, in restore\n     {self.saver_def.filename_tensor_name: save_path})\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 929, in run\n     run_metadata_ptr)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\n     feed_dict_tensor, options, run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\n     run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\n     raise type(e)(node_def, op, message)\n tensorflow.python.framework.errors_impl.NotFoundError: Key seq2seq/decoder/dense/bias_2 not found in checkpoint\n          [[node save/RestoreV2 (defined at /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py:1537) ]]\n          [[node save/RestoreV2 (defined at /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py:1537) ]]\n \n Caused by op 'save/RestoreV2', defined at:\n   File \"opennmt/bin/main.py\", line 201, in <module>\n     main()\n   File \"opennmt/bin/main.py\", line 172, in main\n     runner.train_and_evaluate(checkpoint_path=args.checkpoint_path)\n   File \"/home/ari/tf/onmt-120/OpenNMT-tf/opennmt/runner.py\", line 293, in train_and_evaluate\n     result = tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 471, in train_and_evaluate\n     return executor.run()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 611, in run\n     return self.run_local()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 712, in run_local\n     saving_listeners=saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 358, in train\n     loss = self._train_model(input_fn, hooks, saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1124, in _train_model\n     return self._train_model_default(input_fn, hooks, saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1158, in _train_model_default\n     saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1407, in _train_with_estimator_spec\n     _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 676, in run\n     run_metadata=run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1171, in run\n     run_metadata=run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1255, in run\n     return self._sess.run(*args, **kwargs)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1335, in run\n     run_metadata=run_metadata))\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/basic_session_run_hooks.py\", line 582, in after_run\n     if self._save(run_context.session, global_step):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/basic_session_run_hooks.py\", line 607, in _save\n     if l.after_save(session, step):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 517, in after_save\n     self._evaluate(global_step_value)  # updates self.eval_result\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 537, in _evaluate\n     self._evaluator.evaluate_and_export())\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 913, in evaluate_and_export\n     hooks=self._eval_spec.hooks)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 469, in evaluate\n     name=name)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 511, in _actual_eval\n     return _evaluate()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 500, in _evaluate\n     output_dir=self.eval_dir(name))\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1537, in _evaluate_run\n     config=self._session_config)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/evaluation.py\", line 271, in _evaluate_once\n     session_creator=session_creator, hooks=hooks) as session:\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 934, in __init__\n     stop_grace_period_secs=stop_grace_period_secs)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 648, in __init__\n     self._sess = _RecoverableSession(self._coordinated_creator)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1122, in __init__\n     _WrappedSession.__init__(self, self._create_session())\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1127, in _create_session\n     return self._sess_creator.create_session()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 805, in create_session\n     self.tf_sess = self._session_creator.create_session()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 562, in create_session\n     self._scaffold.finalize()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 217, in finalize\n     self._saver = training_saver._get_saver_or_default()  # pylint: disable=protected-access\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 604, in _get_saver_or_default\n     saver = Saver(sharded=True, allow_empty=True)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 832, in __init__\n     self.build()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 844, in build\n     self._build(self._filename, build_save=True, build_restore=True)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 881, in _build\n     build_save=build_save, build_restore=build_restore)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 507, in _build_internal\n     restore_sequentially, reshape)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 385, in _AddShardedRestoreOps\n     name=\"restore_shard\"))\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 332, in _AddRestoreOps\n     restore_sequentially)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 580, in bulk_restore\n     return io_ops.restore_v2(filename_tensor, names, slices, dtypes)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1572, in restore_v2\n     name=name)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\n     op_def=op_def)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\n     return func(*args, **kwargs)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\n     op_def=op_def)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1801, in __init__\n     self._traceback = tf_stack.extract_stack()\n \n NotFoundError (see above for traceback): Key seq2seq/decoder/dense/bias_2 not found in checkpoint\n          [[node save/RestoreV2 (defined at /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py:1537) ]]\n          [[node save/RestoreV2 (defined at /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py:1537) ]]\n \n \n During handling of the above exception, another exception occurred:\n \n Traceback (most recent call last):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1286, in restore\n     names_to_keys = object_graph_key_mapping(save_path)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1591, in object_graph_key_mapping\n     checkpointable.OBJECT_GRAPH_PROTO_KEY)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 370, in get_tensor\n     status)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 528, in __exit__\n     c_api.TF_GetCode(self.status.status))\n tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint\n \n During handling of the above exception, another exception occurred:\n \n Traceback (most recent call last):\n   File \"opennmt/bin/main.py\", line 201, in <module>\n     main()\n   File \"opennmt/bin/main.py\", line 172, in main\n     runner.train_and_evaluate(checkpoint_path=args.checkpoint_path)\n   File \"/home/ari/tf/onmt-120/OpenNMT-tf/opennmt/runner.py\", line 293, in train_and_evaluate\n     result = tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 471, in train_and_evaluate\n     return executor.run()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 611, in run\n     return self.run_local()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 712, in run_local\n     saving_listeners=saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 358, in train\n     loss = self._train_model(input_fn, hooks, saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1124, in _train_model\n     return self._train_model_default(input_fn, hooks, saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1158, in _train_model_default\n     saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1407, in _train_with_estimator_spec\n     _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 676, in run\n     run_metadata=run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1171, in run\n     run_metadata=run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1270, in run\n     raise six.reraise(*original_exc_info)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/six.py\", line 693, in reraise\n     raise value\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1255, in run\n     return self._sess.run(*args, **kwargs)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1335, in run\n     run_metadata=run_metadata))\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/basic_session_run_hooks.py\", line 582, in after_run\n     if self._save(run_context.session, global_step):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/basic_session_run_hooks.py\", line 607, in _save\n     if l.after_save(session, step):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 517, in after_save\n     self._evaluate(global_step_value)  # updates self.eval_result\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 537, in _evaluate\n     self._evaluator.evaluate_and_export())\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 913, in evaluate_and_export\n     hooks=self._eval_spec.hooks)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 469, in evaluate\n     name=name)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 511, in _actual_eval\n     return _evaluate()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 500, in _evaluate\n     output_dir=self.eval_dir(name))\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1537, in _evaluate_run\n     config=self._session_config)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/evaluation.py\", line 271, in _evaluate_once\n     session_creator=session_creator, hooks=hooks) as session:\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 934, in __init__\n     stop_grace_period_secs=stop_grace_period_secs)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 648, in __init__\n     self._sess = _RecoverableSession(self._coordinated_creator)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1122, in __init__\n     _WrappedSession.__init__(self, self._create_session())\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1127, in _create_session\n     return self._sess_creator.create_session()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 805, in create_session\n     self.tf_sess = self._session_creator.create_session()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 571, in create_session\n     init_fn=self._scaffold.init_fn)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 281, in prepare_session\n     config=config)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 195, in _restore_checkpoint\n     saver.restore(sess, checkpoint_filename_with_path)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1292, in restore\n     err, \"a Variable name or other graph key that is missing\")\n tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:\n \n Key seq2seq/decoder/dense/bias_2 not found in checkpoint\n          [[node save/RestoreV2 (defined at /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py:1537) ]]\n          [[node save/RestoreV2 (defined at /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py:1537) ]]\n \n Caused by op 'save/RestoreV2', defined at:\n   File \"opennmt/bin/main.py\", line 201, in <module>\n     main()\n   File \"opennmt/bin/main.py\", line 172, in main\n     runner.train_and_evaluate(checkpoint_path=args.checkpoint_path)\n   File \"/home/ari/tf/onmt-120/OpenNMT-tf/opennmt/runner.py\", line 293, in train_and_evaluate\n     result = tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 471, in train_and_evaluate\n     return executor.run()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 611, in run\n     return self.run_local()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 712, in run_local\n     saving_listeners=saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 358, in train\n     loss = self._train_model(input_fn, hooks, saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1124, in _train_model\n     return self._train_model_default(input_fn, hooks, saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1158, in _train_model_default\n     saving_listeners)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1407, in _train_with_estimator_spec\n     _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 676, in run\n     run_metadata=run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1171, in run\n     run_metadata=run_metadata)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1255, in run\n     return self._sess.run(*args, **kwargs)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1335, in run\n     run_metadata=run_metadata))\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/basic_session_run_hooks.py\", line 582, in after_run\n     if self._save(run_context.session, global_step):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/basic_session_run_hooks.py\", line 607, in _save\n     if l.after_save(session, step):\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 517, in after_save\n     self._evaluate(global_step_value)  # updates self.eval_result\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 537, in _evaluate\n     self._evaluator.evaluate_and_export())\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/training.py\", line 913, in evaluate_and_export\n     hooks=self._eval_spec.hooks)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 469, in evaluate\n     name=name)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 511, in _actual_eval\n     return _evaluate()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 500, in _evaluate\n     output_dir=self.eval_dir(name))\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1537, in _evaluate_run\n     config=self._session_config)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/evaluation.py\", line 271, in _evaluate_once\n     session_creator=session_creator, hooks=hooks) as session:\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 934, in __init__\n     stop_grace_period_secs=stop_grace_period_secs)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 648, in __init__\n     self._sess = _RecoverableSession(self._coordinated_creator)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1122, in __init__\n     _WrappedSession.__init__(self, self._create_session())\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1127, in _create_session\n     return self._sess_creator.create_session()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 805, in create_session\n     self.tf_sess = self._session_creator.create_session()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 562, in create_session\n     self._scaffold.finalize()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 217, in finalize\n     self._saver = training_saver._get_saver_or_default()  # pylint: disable=protected-access\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 604, in _get_saver_or_default\n     saver = Saver(sharded=True, allow_empty=True)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 832, in __init__\n     self.build()\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 844, in build\n     self._build(self._filename, build_save=True, build_restore=True)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 881, in _build\n     build_save=build_save, build_restore=build_restore)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 507, in _build_internal\n     restore_sequentially, reshape)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 385, in _AddShardedRestoreOps\n     name=\"restore_shard\"))\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 332, in _AddRestoreOps\n     restore_sequentially)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 580, in bulk_restore\n     return io_ops.restore_v2(filename_tensor, names, slices, dtypes)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1572, in restore_v2\n     name=name)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\n     op_def=op_def)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\n     return func(*args, **kwargs)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\n     op_def=op_def)\n   File \"/home/ari/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1801, in __init__\n     self._traceback = tf_stack.extract_stack()\n \n NotFoundError (see above for traceback): Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:\n \n Key seq2seq/decoder/dense/bias_2 not found in checkpoint\n          [[node save/RestoreV2 (defined at /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py:1537) ]]\n          [[node save/RestoreV2 (defined at /home/ari/anaconda3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py:1537) ]]\n \n \n </denchmark-code>\n \n Originally posted by @Dagamies in #359 (comment)\n \t"}, "comments": {}}, "commit": {"commit_id": "ea72cb39ede791a356419b7231658d48f4bbd8eb", "commit_author": "Guillaume Klein", "commitT": "2019-03-05 12:33:32+01:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.2222222222222222"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "19,20", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "opennmt\\layers\\bridge.py", "file_new_name": "opennmt\\layers\\bridge.py", "file_complexity": {"file_NLOC": "62", "file_CCN": "14", "file_NToken": "472"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "52,53,54,55,56", "deleted_lines": "52,53", "method_info": {"method_name": "__call__", "method_params": "self,encoder_state,decoder_zero_state", "method_startline": "41", "method_endline": "57", "method_complexity": {"method_NLOC": "7", "method_CCN": "3", "method_NToken": "71", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "opennmt\\layers\\position.py", "file_new_name": "opennmt\\layers\\position.py", "file_complexity": {"file_NLOC": "99", "file_CCN": "17", "file_NToken": "836"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "66,67,68,70,71,72", "deleted_lines": "66,68", "method_info": {"method_name": "__call__", "method_params": "self,inputs,sequence_length,position", "method_startline": "53", "method_endline": "74", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "81", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "opennmt\\utils\\compat.py", "file_new_name": "opennmt\\utils\\compat.py", "file_complexity": {"file_NLOC": "47", "file_CCN": "16", "file_NToken": "304"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "56,57,58", "deleted_lines": null, "method_info": {"method_name": "reuse", "method_params": "", "method_startline": "56", "method_endline": "58", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "16", "method_nesting_level": "0"}}}}}}}}