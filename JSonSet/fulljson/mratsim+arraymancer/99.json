{"BR": {"BR_id": "99", "BR_author": "edubart", "BRopenT": "2017-10-08T16:02:04Z", "BRcloseT": "2017-10-11T00:13:37Z", "BR_text": {"BRsummary": "Display crashes with openmp for large tensors", "BRdescription": "\n Display uses x => $x, this will allocate a string inside openmp thread, which is not supported by nim, to trigger this must display a tensor with more elements than OMP_FOR_THRESHOLD, (currently 1000).\n     buffer = buffer.concat(\n               sep.repeat(t0.shape[1]).toTensor().reshape(t.shape[1],1),\n               t0.map(x => $x).reshape(t.shape[1], t.shape[2]),\n               axis = 1\n               )\n Also we need to make OMP_FOR_THRESHOLD = 1 in nimble test_openmp to catch these bugs, and maybe also force number of openmp threads to be at least 2, to really test all openmp operations, just do that that and many tests related with string allocation will crash on openmp test.\n As note that openmp test needs an additional\n   switch(\"stackTrace\",\"off\")\n becase some tests are still using closures and stacktrace also allocates in openmp threads.\n \t"}, "comments": {}}, "commit": {"commit_id": "73344468f1c38bb5b5eb950d4482e5492f110026", "commit_author": "Mamy Ratsimbazafy", "commitT": "2017-10-11 02:13:27+02:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\tensor\\higher_order.nim", "file_new_name": "src\\tensor\\higher_order.nim", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "88,104,105,110,111,112,113,114,115,116,117,118,119,120,121,122,167,168,169,189,190,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211", "deleted_lines": "88,104,105,106,107,156"}}}}}}