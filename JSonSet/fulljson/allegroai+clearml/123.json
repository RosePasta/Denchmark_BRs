{"BR": {"BR_id": "123", "BR_author": "iakremnev", "BRopenT": "2020-04-13T10:30:30Z", "BRcloseT": "2020-04-14T17:43:55Z", "BR_text": {"BRsummary": "Async model checkpoint upload fails when the file is renamed", "BRdescription": "\n <denchmark-h:h3>Bug</denchmark-h>\n \n While using TrainsLogger in Pytorch-Lightning, the latter saves model checkpoint via _atomic_save function, which renames the file right after calling torch.save. Consequently, train's hook on torch.save tries to asynchronously upload .ckpt.part file and fails.\n The original issue on Pytorch-Lightning Github: <denchmark-link:https://github.com/PyTorchLightning/pytorch-lightning/issues/1466>PyTorchLightning/pytorch-lightning#1466</denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "iakremnev", "commentT": "2020-04-13T10:34:17Z", "comment_text": "\n \t\t<denchmark-link:https://allegroai-trains.slack.com/archives/CTK20V944/p1586771229061800>https://allegroai-trains.slack.com/archives/CTK20V944/p1586771229061800</denchmark-link>\n \n \n I think the best solution is for Trains to create a copy of the file and upload it in the background. That said the name will still end with .part\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "iakremnev", "commentT": "2020-04-13T12:46:20Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/iakremnev>@iakremnev</denchmark-link>\n  ,\n Seems like any renaming or deleting a stored model file before the async upload is completed will cause this error. What we will do is create a temp copy of the model file, upload it and then delete the temp file when upload is completed.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "iakremnev", "commentT": "2020-04-14T14:51:07Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/iakremnev>@iakremnev</denchmark-link>\n ,\n Please see if the latest RC fixes the problem:\n pip install trains==0.14.2rc0\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "iakremnev", "commentT": "2020-04-14T17:43:55Z", "comment_text": "\n \t\tYes, the issue is solved! Thanks for the quick fix \u2764\ufe0f\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "iakremnev", "commentT": "2020-07-12T08:06:02Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/bmartinn>@bmartinn</denchmark-link>\n  Is this really fixed? I'm facing the same issue. I use and   through  of  as follow:\n logger = TrainsLogger(auto_connect_frameworks=True)\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "iakremnev", "commentT": "2020-07-12T21:57:16Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/S-aiueo32>@S-aiueo32</denchmark-link>\n  what exactly are you experiencing?\n Yes the issue was fixed, but recently they moved the  to  and I lost track.\n \t\t"}}}, "commit": {"commit_id": "4bb17ca42081aaf27fabcd21c6a42e32313fb80e", "commit_author": "allegroai", "commitT": "2020-04-13 19:03:15+03:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "0.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "trains\\binding\\frameworks\\__init__.py", "file_new_name": "trains\\binding\\frameworks\\__init__.py", "file_complexity": {"file_NLOC": "165", "file_CCN": "56", "file_NToken": "1069"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "207,208,209,210,211,212,213,214,215,216,217", "deleted_lines": "203", "method_info": {"method_name": "create_output_model", "method_params": "model,saved_path,framework,task,singlefile,model_name", "method_startline": "134", "method_endline": "225", "method_complexity": {"method_NLOC": "69", "method_CCN": "24", "method_NToken": "513", "method_nesting_level": "1"}}}}}}}}