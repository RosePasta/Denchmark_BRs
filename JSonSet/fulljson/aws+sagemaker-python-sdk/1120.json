{"BR": {"BR_id": "1120", "BR_author": "svpino", "BRopenT": "2019-11-12T15:30:17Z", "BRcloseT": "2019-12-10T02:58:12Z", "BR_text": {"BRsummary": "Deploy method doesn't work if \"tags\" attribute is supplied", "BRdescription": "\n Please fill out the form below.\n <denchmark-h:h3>System Information</denchmark-h>\n \n \n sagemaker lib version 1.43.4.post1\n Using object detection sample notebook.\n \n <denchmark-h:h3>Describe the problem</denchmark-h>\n \n When supplying the tags attribute to the deploy function of a model, an error is displayed.\n Here is the relevant code:\n <denchmark-code>object_detector = od_model.deploy(\n     initial_instance_count = 1, \n     instance_type = 'ml.m4.xlarge'\n     tags = [{\n         \"TagName\": \"TagValue\"\n     }])\n </denchmark-code>\n \n Error message:\n <denchmark-code>---------------------------------------------------------------------------\n TypeError                                 Traceback (most recent call last)\n <ipython-input-63-da1a1683e6f2> in <module>()\n       3     instance_type = 'ml.m4.xlarge',\n       4     tags = [{\n ----> 5         \"TagName\": \"TagValue\"\n       6     }])\n       7 \n \n ~/anaconda3/envs/mxnet_p36/lib/python3.6/site-packages/sagemaker/estimator.py in deploy(self, initial_instance_count, instance_type, accelerator_type, endpoint_name, use_compiled_model, update_endpoint, wait, model_name, kms_key, **kwargs)\n     549         else:\n     550             kwargs[\"model_kms_key\"] = self.output_kms_key\n --> 551             model = self.create_model(**kwargs)\n     552         model.name = model_name\n     553         return model.deploy(\n \n ~/anaconda3/envs/mxnet_p36/lib/python3.6/site-packages/sagemaker/estimator.py in create_model(self, role, image, predictor_cls, serializer, deserializer, content_type, accept, vpc_config_override, **kwargs)\n    1176             predictor_cls=predictor_cls,\n    1177             enable_network_isolation=self.enable_network_isolation(),\n -> 1178             **kwargs\n    1179         )\n    1180 \n \n TypeError: __init__() got an unexpected keyword argument 'tags'\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "svpino", "commentT": "2019-12-04T18:39:51Z", "comment_text": "\n \t\tHello <denchmark-link:https://github.com/svpino>@svpino</denchmark-link>\n ,\n Apologies for the late response.\n Thank you for bringing this issue up to us.\n I will first attempt to reproduce the error that you are seeing and will report ASAP.\n Example notebook the user is referencing: <denchmark-link:https://github.com/awslabs/amazon-sagemaker-examples/blob/master/introduction_to_amazon_algorithms/object_detection_pascalvoc_coco/object_detection_image_json_format.ipynb>https://github.com/awslabs/amazon-sagemaker-examples/blob/master/introduction_to_amazon_algorithms/object_detection_pascalvoc_coco/object_detection_image_json_format.ipynb</denchmark-link>\n \n Thank you!\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "svpino", "commentT": "2019-12-04T23:25:27Z", "comment_text": "\n \t\tI was able to reproduce the issue. Seems like the issue is that tags is being supported in the deploy method through kwargs, which will run into problems depending on the implementation of the create_model function. To mitigate this, I will add a keyword argument for tags, which is similar to the deploy method for our Model class.\n PR with the fix: <denchmark-link:https://github.com/aws/sagemaker-python-sdk/pull/1146>#1146</denchmark-link>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "svpino", "commentT": "2019-12-10T02:58:12Z", "comment_text": "\n \t\tThe change has been released. Please reopen if there are any other issues! Thanks!\n \t\t"}}}, "commit": {"commit_id": "ee2c34589d57ad8cf552d998bc2118e401a7f11a", "commit_author": "Dan", "commitT": "2019-12-04 17:52:49-08:00", "commit_complexity": {"commit_NLOC": "0.029411764705882353", "commit_CCN": "1.0", "commit_Nprams": "0.9705882352941176"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\sagemaker\\estimator.py", "file_new_name": "src\\sagemaker\\estimator.py", "file_complexity": {"file_NLOC": "903", "file_CCN": "145", "file_NToken": "4945"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "609", "deleted_lines": null, "method_info": {"method_name": "deploy", "method_params": "self,initial_instance_count,instance_type,accelerator_type,endpoint_name,use_compiled_model,update_endpoint,wait,model_name,kms_key,data_capture_config,tags,kwargs", "method_startline": "597", "method_endline": "610", "method_complexity": {"method_NLOC": "14", "method_CCN": "1", "method_NToken": "46", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tests\\unit\\test_estimator.py", "file_new_name": "tests\\unit\\test_estimator.py", "file_complexity": {"file_NLOC": "2000", "file_CCN": "105", "file_NToken": "10477"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1705", "deleted_lines": "1705", "method_info": {"method_name": "test_fit_deploy_keep_tags", "method_params": "sagemaker_session", "method_startline": "1705", "method_endline": "1747", "method_complexity": {"method_NLOC": "38", "method_CCN": "1", "method_NToken": "152", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "1750,1751,1752,1753,1754,1755,1756,1757,1758,1759,1760,1761,1762,1763,1764,1765,1766,1767,1768,1769,1770,1771,1772,1773,1774,1775,1776,1777,1778,1779,1780,1781,1782,1783,1784,1785,1786,1787", "deleted_lines": null, "method_info": {"method_name": "test_fit_deploy_tags", "method_params": "sagemaker_session", "method_startline": "1750", "method_endline": "1787", "method_complexity": {"method_NLOC": "33", "method_CCN": "1", "method_NToken": "151", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "1705", "deleted_lines": "1705", "method_info": {"method_name": "test_fit_deploy_tags_in_estimator", "method_params": "sagemaker_session", "method_startline": "1705", "method_endline": "1747", "method_complexity": {"method_NLOC": "38", "method_CCN": "1", "method_NToken": "152", "method_nesting_level": "0"}}}}}}}}