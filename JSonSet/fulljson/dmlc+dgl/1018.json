{"BR": {"BR_id": "1018", "BR_author": "modesitt-sesco", "BRopenT": "2019-11-19T21:22:42Z", "BRcloseT": "2019-11-20T07:14:41Z", "BR_text": {"BRsummary": "[Bug] dgl.to_homo fails on given example in pytorch 1.3.1", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n <denchmark-h:h2>To Reproduce</denchmark-h>\n \n Simply run the to_homo example\n <denchmark-code>import dgl \n \n follows_g = dgl.graph([(0, 1), (1, 2)], 'user', 'follows')\n devs_g = dgl.bipartite([(0, 0), (1, 1)], 'developer', 'develops', 'game')\n hetero_g = dgl.hetero_from_relations([follows_g, devs_g])\n homo_g = dgl.to_homo(hetero_g)\n </denchmark-code>\n \n and it fails with\n <denchmark-code>Traceback (most recent call last):\n   File \"<stdin>\", line 1, in <module>\n   File \"/Users/dmodesitt/Dev/playground/virt/venv/lib/python3.7/site-packages/dgl/convert.py\", line 598, in to_homo\n     retg = graph((F.cat(srcs, 0), F.cat(dsts, 0)), card=total_num_nodes)\n   File \"/Users/dmodesitt/Dev/playground/virt/venv/lib/python3.7/site-packages/dgl/convert.py\", line 111, in graph\n     return create_from_edges(u, v, ntype, etype, ntype, urange, vrange)\n   File \"/Users/dmodesitt/Dev/playground/virt/venv/lib/python3.7/site-packages/dgl/convert.py\", line 646, in create_from_edges\n     u = utils.toindex(u)\n   File \"/Users/dmodesitt/Dev/playground/virt/venv/lib/python3.7/site-packages/dgl/utils.py\", line 242, in toindex\n     return data if isinstance(data, Index) else Index(data)\n   File \"/Users/dmodesitt/Dev/playground/virt/venv/lib/python3.7/site-packages/dgl/utils.py\", line 15, in __init__\n     self._initialize_data(data)\n   File \"/Users/dmodesitt/Dev/playground/virt/venv/lib/python3.7/site-packages/dgl/utils.py\", line 22, in _initialize_data\n     self._dispatch(data)\n   File \"/Users/dmodesitt/Dev/playground/virt/venv/lib/python3.7/site-packages/dgl/utils.py\", line 47, in _dispatch\n     raise DGLError('Index data must be an int64 vector, but got: %s' % str(data))\n dgl._ffi.base.DGLError: Index data must be an int64 vector, but got: tensor([0., 1., 3., 4.])\n </denchmark-code>\n \n <denchmark-h:h2>Expected Behavior</denchmark-h>\n \n This is not expected to crash it is a given <denchmark-link:https://docs.dgl.ai/generated/dgl.to_homo.html#dgl.to_homo>example</denchmark-link>\n \n <denchmark-h:h2>Environment</denchmark-h>\n \n \n DGL Version (e.g., 1.0):\n dgl==0.4.1\n Backend Library & Version (e.g., PyTorch 0.4.1, MXNet/Gluon 1.3):\n pytorch==1.3.1\n OS (e.g., Linux):\n macos\n How you installed DGL (conda, pip, source):\n pip\n Python version: 3.7.4\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "modesitt-sesco", "commentT": "2019-11-20T06:33:22Z", "comment_text": "\n \t\tVerified the report. This seems to be related to the latest PyTorch version as our CI tests with PyTorch 1.1 can be successfully passed.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "modesitt-sesco", "commentT": "2019-11-20T07:16:07Z", "comment_text": "\n \t\tThis should now be fixed in <denchmark-link:https://github.com/dmlc/dgl/pull/1019>#1019</denchmark-link>\n  . You can install from source to get the latest version.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "modesitt-sesco", "commentT": "2020-02-15T03:21:40Z", "comment_text": "\n \t\t\n This should now be fixed in #1019 . You can install from source to get the latest version.\n \n Hi,\n Thanks for your efforts. But I don't have root priviledge for the servers I am working on. So I cannot use 'sudo' to install from source...\n Could you please provide me with any advice for getting around with this issue?\n Thank you very much!\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "modesitt-sesco", "commentT": "2020-02-15T05:57:48Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lzzhaha>@lzzhaha</denchmark-link>\n  Can you install new packages with pip or Conda? If so, you can install DGL v0.4.2 to address the issue.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "modesitt-sesco", "commentT": "2020-02-16T00:33:48Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/mufeili>@mufeili</denchmark-link>\n  Yes the problem is indeed solved in DGL v0.4.2 with pip installation.\n Thank you so much!\n \t\t"}}}, "commit": {"commit_id": "f1542b9dfa74c503269881135252f6517ae46260", "commit_author": "Mufei Li", "commitT": "2019-11-20 15:14:40+08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\dgl\\convert.py", "file_new_name": "python\\dgl\\convert.py", "file_complexity": {"file_NLOC": "368", "file_CCN": "80", "file_NToken": "3491"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "593,594", "deleted_lines": "593,594", "method_info": {"method_name": "to_homo", "method_params": "G", "method_startline": "535", "method_endline": "612", "method_complexity": {"method_NLOC": "35", "method_CCN": "6", "method_NToken": "394", "method_nesting_level": "0"}}}}}}}}