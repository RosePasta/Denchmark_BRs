{"BR": {"BR_id": "2098", "BR_author": "mufeili", "BRopenT": "2020-08-23T20:53:31Z", "BRcloseT": "2020-08-29T08:34:50Z", "BR_text": {"BRsummary": "[Bug] Context Issue for bfs_edges_generator on GPU Graphs", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n Got\n \n Check failed: csr.indptr->ctx.device_type == source->ctx.device_type (2 vs. 1) : Graph and source should in the same device context\n \n even when both the graph and the source are on the same GPU.\n <denchmark-h:h2>To Reproduce</denchmark-h>\n \n import dgl\n import torch\n \n device = 'cuda:0'\n g = dgl.graph(([1, 2], [3, 4]), device=device)\n root_ids = torch.tensor([1, 2]).to(device)\n for _ in dgl.bfs_edges_generator(g, root_ids):\n     pass\n <denchmark-h:h2>Environment</denchmark-h>\n \n \n DGL Version (e.g., 1.0): 0.5.0\n Backend Library & Version (e.g., PyTorch 0.4.1, MXNet/Gluon 1.3): PyTorch 1.5.1\n OS (e.g., Linux): ubuntu\n How you installed DGL (conda, pip, source): pip\n Python version: 3.6.10\n CUDA/cuDNN version (if applicable): 10.2\n GPU models and configuration (e.g. V100): Tesla T4\n Any other relevant information:\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "mufeili", "commentT": "2020-08-24T06:45:14Z", "comment_text": "\n \t\tWhat if you don't move root_ids to gpu?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "mufeili", "commentT": "2020-08-25T08:46:56Z", "comment_text": "\n \t\t\n What if you don't move root_ids to gpu?\n \n It raises the same error.\n \t\t"}}}, "commit": {"commit_id": "642bdbaf04796ac9ee10ccd9ca23886e7307a0aa", "commit_author": "Mufei Li", "commitT": "2020-08-29 16:34:31+08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "python\\dgl\\traversal.py", "file_new_name": "python\\dgl\\traversal.py", "file_complexity": {"file_NLOC": "84", "file_CCN": "5", "file_NToken": "789"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "92,93", "deleted_lines": "91", "method_info": {"method_name": "bfs_edges_generator", "method_params": "graph,source,reverse", "method_startline": "57", "method_endline": "100", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "137", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "47,48", "deleted_lines": "47", "method_info": {"method_name": "bfs_nodes_generator", "method_params": "graph,source,reverse", "method_startline": "13", "method_endline": "55", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "137", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "134,135", "deleted_lines": "132", "method_info": {"method_name": "topological_nodes_generator", "method_params": "graph,reverse", "method_startline": "102", "method_endline": "140", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "112", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "183,184", "deleted_lines": "180", "method_info": {"method_name": "dfs_edges_generator", "method_params": "graph,source,reverse", "method_startline": "142", "method_endline": "190", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "134", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\compute\\test_traversal.py", "file_new_name": "tests\\compute\\test_traversal.py", "file_complexity": {"file_NLOC": "106", "file_CCN": "26", "file_NToken": "1008"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "21,63,91"}}}}}}