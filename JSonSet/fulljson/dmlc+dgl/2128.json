{"BR": {"BR_id": "2128", "BR_author": "chwan-rice", "BRopenT": "2020-08-30T05:07:54Z", "BRcloseT": "2020-09-13T04:06:43Z", "BR_text": {"BRsummary": "cannot request out_edges() for empty node sets on cuda", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n I'm using the latest DGL version. The following code throws a DGLError: Check failed: dim != 0 (0 vs. 0) :\n import dgl\n import torch\n \n g = dgl.DGLGraph(([0, 1], [1, 2])).to('cuda:0')\n idx = torch.LongTensor([]).to('cuda:0')\n g.out_edges(idx)\n However, if the graph runs on CPU, the code works well. I'm not sure whether this is a bug.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "chwan-rice", "commentT": "2020-08-31T05:45:36Z", "comment_text": "\n \t\tEmpty tensor should not be allowed in out_edges function. Do you have any expected behavior here?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "chwan-rice", "commentT": "2020-08-31T06:18:09Z", "comment_text": "\n \t\tActually, I just feel it's strange that out_edges has different behavior on CPU and GPU. It would be better if it returns an empty edge set.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "chwan-rice", "commentT": "2020-09-03T16:44:42Z", "comment_text": "\n \t\tA similar problem is found in out_degrees\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "chwan-rice", "commentT": "2020-09-13T04:06:43Z", "comment_text": "\n \t\tShould be fixed in master.  Will go into 0.5.2 release.\n \t\t"}}}, "commit": {"commit_id": "7d8522a29f3ea07d921fb54e4f4b723fc108ac6d", "commit_author": "Quan (Andy) Gan", "commitT": "2020-09-11 18:23:44+08:00", "commit_complexity": {"commit_NLOC": "0.06896551724137931", "commit_CCN": "0.2413793103448276", "commit_Nprams": "0.9310344827586207"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\dgl\\backend\\mxnet\\tensor.py", "file_new_name": "python\\dgl\\backend\\mxnet\\tensor.py", "file_complexity": {"file_NLOC": "451", "file_CCN": "140", "file_NToken": "4032"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "144,145", "deleted_lines": null, "method_info": {"method_name": "sum", "method_params": "input,dim,keepdims", "method_startline": "143", "method_endline": "146", "method_complexity": {"method_NLOC": "4", "method_CCN": "2", "method_NToken": "56", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\dgl\\heterograph.py", "file_new_name": "python\\dgl\\heterograph.py", "file_complexity": {"file_NLOC": "1918", "file_CCN": "414", "file_NToken": "11043"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "5337,5338,5339", "method_info": {"method_name": "create_formats_", "method_params": "self", "method_startline": "5299", "method_endline": "5340", "method_complexity": {"method_NLOC": "41", "method_CCN": "2", "method_NToken": "26", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\array\\cpu\\array_cumsum.cc", "file_new_name": "src\\array\\cpu\\array_cumsum.cc", "file_complexity": {"file_NLOC": "33", "file_CCN": "6", "file_NToken": "297"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "17", "deleted_lines": "17", "method_info": {"method_name": "dgl::aten::impl::CumSum", "method_params": "array,prepend_zero", "method_startline": "14", "method_endline": "35", "method_complexity": {"method_NLOC": "22", "method_CCN": "6", "method_NToken": "241", "method_nesting_level": "3"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\array\\cuda\\array_cumsum.cu", "file_new_name": "src\\array\\cuda\\array_cumsum.cu", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "20,21", "deleted_lines": "20"}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\compute\\test_heterograph.py", "file_new_name": "tests\\compute\\test_heterograph.py", "file_complexity": {"file_NLOC": "2048", "file_CCN": "153", "file_NToken": "29162"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400", "deleted_lines": null, "method_info": {"method_name": "test_empty_query", "method_params": "idtype", "method_startline": "369", "method_endline": "400", "method_complexity": {"method_NLOC": "29", "method_CCN": "1", "method_NToken": "405", "method_nesting_level": "0"}}}}}}}}