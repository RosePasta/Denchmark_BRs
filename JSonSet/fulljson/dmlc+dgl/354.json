{"BR": {"BR_id": "354", "BR_author": "mufeili", "BRopenT": "2019-01-11T17:00:33Z", "BRcloseT": "2019-01-12T13:37:32Z", "BR_text": {"BRsummary": "[Bug in Example] Multi-head features not properly handled", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n <denchmark-h:h2>To Reproduce</denchmark-h>\n \n Steps to reproduce the behavior:\n \n python examples/pytorch/gat/train.py --dataset cora --residual\n \n <denchmark-h:h2>Expected behavior</denchmark-h>\n \n <denchmark-code>/Users/MufeiLi/Desktop/research/projects/dgl/python/dgl/base.py:17: UserWarning: Initializer is not set. Use zero initializer instead. To suppress this warning, use `set_initializer` to explicitly specify which initializer to use.\n   warnings.warn(msg)\n Traceback (most recent call last):\n   File \"/Applications/PyCharm.app/Contents/helpers/pydev/pydevd.py\", line 1664, in <module>\n     main()\n   File \"/Applications/PyCharm.app/Contents/helpers/pydev/pydevd.py\", line 1658, in main\n     globals = debugger.run(setup['file'], None, None, is_module)\n   File \"/Applications/PyCharm.app/Contents/helpers/pydev/pydevd.py\", line 1068, in run\n     pydev_imports.execfile(file, globals, locals)  # execute the script\n   File \"/Applications/PyCharm.app/Contents/helpers/pydev/_pydev_imps/_pydev_execfile.py\", line 18, in execfile\n     exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\n   File \"/Users/MufeiLi/Desktop/research/projects/dgl/examples/pytorch/gat/train.py\", line 275, in <module>\n     main(args)\n   File \"/Users/MufeiLi/Desktop/research/projects/dgl/examples/pytorch/gat/train.py\", line 216, in main\n     logits = model(features)\n   File \"/Users/MufeiLi/miniconda3/envs/dgl/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 489, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/Users/MufeiLi/Desktop/research/projects/dgl/examples/pytorch/gat/train.py\", line 135, in forward\n     logits = self.gat_layers[-1](h).sum(1)\n   File \"/Users/MufeiLi/miniconda3/envs/dgl/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 489, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/Users/MufeiLi/Desktop/research/projects/dgl/examples/pytorch/gat/train.py\", line 84, in forward\n     ret = self.residual_fc(h) + ret\n RuntimeError: The size of tensor a (56) must match the size of tensor b (7) at non-singleton dimension 2\n </denchmark-code>\n \n <denchmark-h:h2>Environment</denchmark-h>\n \n \n DGL Version (e.g., 1.0): 0.1.3\n Backend Library & Version (e.g., PyTorch 0.4.1, MXNet/Gluon 1.3): PyTorch 1.0.0\n OS (e.g., Linux): Mac\n How you installed DGL (conda, pip, source): source\n Build command you used (if compiling from source): by setting the environment variables\n Python version:\n CUDA/cuDNN version (if applicable):\n GPU models and configuration (e.g. V100):\n Any other relevant information:\n \n <denchmark-h:h2>Proposed Fix</denchmark-h>\n \n Comparing to <denchmark-link:https://github.com/PetarV-/GAT/blob/master/utils/layers.py>the official TensorFlow implementation</denchmark-link>\n , I think there are two differences:\n \n L56, dgl should be self.residual_fc = nn.Linear(in_dim, out_dim, bias=False) according to L30, official\n An additional aggregation across heads (concatenation and sum) as in L15, L23, L29, official is missing, which should be placed around L133, L135, PyTorch.\n \n \t"}, "comments": {}}, "commit": {"commit_id": "ddc2faa547da03e0b791648677ed06ce1daf3e0d", "commit_author": "Minjie Wang", "commitT": "2019-01-12 08:37:01-05:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "0.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "examples\\mxnet\\gcn\\README.md", "file_new_name": "examples\\mxnet\\gcn\\README.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "7,8,9,10,11,12,13,14,58,61,64,69,72,75,80,83,86", "deleted_lines": "50,53,56,61,64,67,72,75,78"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "examples\\pytorch\\gat\\train.py", "file_new_name": "examples\\pytorch\\gat\\train.py", "file_complexity": {"file_NLOC": "236", "file_CCN": "20", "file_NToken": "1788"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "63,66,67,68,69,75,76,80,83,84,86,87", "deleted_lines": "63,66,67,68,69,75,76,80,83,84,86", "method_info": {"method_name": "forward", "method_params": "self,inputs", "method_startline": "61", "method_endline": "88", "method_complexity": {"method_NLOC": "22", "method_CCN": "5", "method_NToken": "269", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "191,197", "deleted_lines": "195", "method_info": {"method_name": "main", "method_params": "args", "method_startline": "152", "method_endline": "242", "method_complexity": {"method_NLOC": "74", "method_CCN": "7", "method_NToken": "512", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "105", "deleted_lines": "104", "method_info": {"method_name": "__init__", "method_params": "self,g,num_layers,in_dim,num_hidden,num_classes,num_heads,activation,feat_drop,attn_drop,alpha,residual", "method_startline": "98", "method_endline": "109", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "105", "deleted_lines": "104", "method_info": {"method_name": "__init__", "method_params": "self,g,num_layers,in_dim,num_hidden,num_classes,heads,activation,feat_drop,attn_drop,alpha,residual", "method_startline": "99", "method_endline": "110", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "examples\\pytorch\\gcn\\README.md", "file_new_name": "examples\\pytorch\\gcn\\README.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "8,9,10,11,12,13,14,15,18", "deleted_lines": "10"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\dgl\\graph_index.py", "file_new_name": "python\\dgl\\graph_index.py", "file_complexity": {"file_NLOC": "351", "file_CCN": "83", "file_NToken": "2869"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "628,629", "method_info": {"method_name": "incidence_matrix", "method_params": "self,typestr,ctx", "method_startline": "558", "method_endline": "634", "method_complexity": {"method_NLOC": "38", "method_CCN": "5", "method_NToken": "471", "method_nesting_level": "1"}}}}}}}}