{"BR": {"BR_id": "3994", "BR_author": "annxingyuan", "BRopenT": "2020-09-30T20:07:04Z", "BRcloseT": "2020-10-08T03:31:52Z", "BR_text": {"BRsummary": "[webgl] CPU forwarding should work for unmodularized kernels.", "BRdescription": "\n Describe the current behavior\n On master, CPU forwarding will fail in WebGL for ops that are unmodularized in WebGL but modularized in CPU.\n Describe the expected behavior\n CPU forwarding should work.\n Standalone code to reproduce the issue\n <denchmark-code>const x = tf.softmax([1, 2, 3, 4]);\n </denchmark-code>\n \n The above code fails on the WebGL backend.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "annxingyuan", "commentT": "2020-10-01T22:45:53Z", "comment_text": "\n \t\tHi Ann,\n Quick update: I identified several ops that need to be fixed (e.g. ceil, floor, exp, etc). Once those are fixed, the ops that use them (e.g. softmax) should also be fixed too. I also saw that your PR <denchmark-link:https://github.com/tensorflow/tfjs/pull/3956>#3956</denchmark-link>\n  fixed a couple of ops as well:) Thanks!\n To reduce conflicts, I will wait for your PR to be submitted before sending out my fix. Please take your time!\n Thanks Ann!\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "annxingyuan", "commentT": "2020-10-02T16:02:07Z", "comment_text": "\n \t\tSounds good <denchmark-link:https://github.com/jinjingforever>@jinjingforever</denchmark-link>\n  - thank you for taking this on!\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "annxingyuan", "commentT": "2020-10-08T03:31:53Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tfjs/issues/3994>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tfjs/issues/3994>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "8c3836ba5da25c92162590f3120544b1de4aad2a", "commit_author": "Jing Jin", "commitT": "2020-10-07 20:31:51-07:00", "commit_complexity": {"commit_NLOC": "0.8406374501992032", "commit_CCN": "1.0", "commit_Nprams": "0.9840637450199203"}, "changed_files": {"file_0": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "e2e\\integration_tests\\cpu_forwarding_test.ts", "file_complexity": {"file_NLOC": "198", "file_CCN": "27", "file_NToken": "2322"}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Abs.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Abs.ts", "file_complexity": {"file_NLOC": "38", "file_CCN": "5", "file_NToken": "330"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "34,37", "deleted_lines": "31", "method_info": {"method_name": "absKernelFunc", "method_params": "", "method_startline": "31", "method_endline": "53", "method_complexity": {"method_NLOC": "23", "method_CCN": "3", "method_NToken": "202", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "22,23,24,25,26,27,28", "deleted_lines": "26", "method_info": {"method_name": "simpleAbsImpl", "method_params": "TypedArray", "method_startline": "22", "method_endline": "28", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "56", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Add.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Add.ts", "file_complexity": {"file_NLOC": "14", "file_CCN": "2", "file_NToken": "114"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": "23", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "23", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "4", "method_nesting_level": "0"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Ceil.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Ceil.ts", "file_complexity": {"file_NLOC": "10", "file_CCN": "1", "file_NToken": "73"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "23", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "7", "method_nesting_level": "0"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Div.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Div.ts", "file_complexity": {"file_NLOC": "11", "file_CCN": "1", "file_NToken": "75"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "24", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "24", "method_endline": "24", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "4", "method_nesting_level": "0"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Exp.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Exp.ts", "file_complexity": {"file_NLOC": "10", "file_CCN": "1", "file_NToken": "73"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "23", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "7", "method_nesting_level": "0"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Expm1.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Expm1.ts", "file_complexity": {"file_NLOC": "10", "file_CCN": "1", "file_NToken": "73"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "23", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "7", "method_nesting_level": "0"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Floor.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Floor.ts", "file_complexity": {"file_NLOC": "10", "file_CCN": "1", "file_NToken": "73"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "23", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "7", "method_nesting_level": "0"}}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Log.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Log.ts", "file_complexity": {"file_NLOC": "10", "file_CCN": "1", "file_NToken": "73"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "23", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "7", "method_nesting_level": "0"}}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Multiply.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Multiply.ts", "file_complexity": {"file_NLOC": "19", "file_CCN": "2", "file_NToken": "122"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": "23", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "23", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "4", "method_nesting_level": "0"}}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\NotEqual.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\NotEqual.ts", "file_complexity": {"file_NLOC": "12", "file_CCN": "2", "file_NToken": "83"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "24", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "24", "method_endline": "24", "method_complexity": {"method_NLOC": "1", "method_CCN": "2", "method_NToken": "10", "method_nesting_level": "0"}}}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Rsqrt.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Rsqrt.ts", "file_complexity": {"file_NLOC": "10", "file_CCN": "1", "file_NToken": "75"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23", "deleted_lines": "23", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "23", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "9", "method_nesting_level": "0"}}}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Slice.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Slice.ts", "file_complexity": {"file_NLOC": "42", "file_CCN": "5", "file_NToken": "423"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "60", "deleted_lines": "47,48,49,50,51,52,53,54,55,56,57,58,59", "method_info": {"method_name": "slice", "method_params": "SliceInputs,MathBackendCPU", "method_startline": "47", "method_endline": "62", "method_complexity": {"method_NLOC": "13", "method_CCN": "1", "method_NToken": "143", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45", "deleted_lines": "32,33,34,38,40,41,42,43,44,45", "method_info": {"method_name": "sliceImpl", "method_params": "TypedArray,DataType", "method_startline": "23", "method_endline": "45", "method_complexity": {"method_NLOC": "21", "method_CCN": "3", "method_NToken": "202", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "40", "deleted_lines": "40", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "40", "method_endline": "40", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "7", "method_nesting_level": "0"}}}}}, "file_13": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\SquaredDifference.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\SquaredDifference.ts", "file_complexity": {"file_NLOC": "14", "file_CCN": "1", "file_NToken": "84"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23,26", "deleted_lines": "25", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "23", "method_endline": "26", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "14", "method_nesting_level": "0"}}}}}, "file_14": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Sub.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Sub.ts", "file_complexity": {"file_NLOC": "15", "file_CCN": "2", "file_NToken": "114"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "24", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "24", "method_endline": "24", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "4", "method_nesting_level": "0"}}}}}, "file_15": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tfjs-backend-cpu\\src\\shared.ts", "file_new_name": "tfjs-backend-cpu\\src\\shared.ts", "file_complexity": {"file_NLOC": "14", "file_CCN": "0", "file_NToken": "98"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "19,20,21,22,23,24,25,27,28,29,30", "deleted_lines": null}}}, "file_16": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tfjs-backend-cpu\\src\\utils\\kernel_utils.ts", "file_new_name": "tfjs-backend-cpu\\src\\utils\\kernel_utils.ts", "file_complexity": {"file_NLOC": "115", "file_CCN": "15", "file_NToken": "1146"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "53,54", "deleted_lines": "53,54", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "42", "method_endline": "57", "method_complexity": {"method_NLOC": "11", "method_CCN": "2", "method_NToken": "115", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "39,40,41,53,54,91,92,115,116", "deleted_lines": "39,40,41,53,54,91,92,93,116,117", "method_info": {"method_name": "binaryKernelFunc", "method_params": "string,SimpleBinaryKernelImpl,ComplexBinaryKernelImpl,DataType", "method_startline": "38", "method_endline": "121", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "51", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "39,40,41,53,54,91,92,115,116", "deleted_lines": "39,40,41,53,54,91,92,93,116,117", "method_info": {"method_name": "binaryKernelFunc", "method_params": "string,SimpleBinaryOperation,ComplexBinaryOperation,DataType", "method_startline": "38", "method_endline": "122", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "51", "method_nesting_level": "0"}}}}}, "file_17": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tfjs-backend-cpu\\src\\utils\\unary_impl.ts", "file_complexity": {"file_NLOC": "13", "file_CCN": "3", "file_NToken": "94"}}, "file_18": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-cpu\\src\\utils\\unary_types.ts", "file_new_name": "tfjs-backend-cpu\\src\\utils\\unary_types.ts", "file_complexity": {"file_NLOC": "4", "file_CCN": "2", "file_NToken": "47"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "22", "deleted_lines": null, "method_info": {"method_name": "SimpleUnaryImpl", "method_params": "", "method_startline": "22", "method_endline": "22", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "2", "method_nesting_level": "0"}}}}}, "file_19": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tfjs-backend-cpu\\src\\utils\\unary_utils.ts", "file_new_name": "tfjs-backend-cpu\\src\\utils\\unary_utils.ts", "file_complexity": {"file_NLOC": "38", "file_CCN": "11", "file_NToken": "349"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "65,66,67,68,69,70,71,72,73,74,75,76,77", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "65", "method_endline": "77", "method_complexity": {"method_NLOC": "12", "method_CCN": "4", "method_NToken": "102", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78", "deleted_lines": null, "method_info": {"method_name": "unaryKernelFuncFromImpl", "method_params": "string,SimpleUnaryImpl,DataType", "method_startline": "63", "method_endline": "78", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "30", "method_nesting_level": "0"}}}}}, "file_20": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tfjs-backend-webgl\\scripts\\test-ci.sh", "file_new_name": "tfjs-backend-webgl\\scripts\\test-ci.sh", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24", "deleted_lines": null}}}, "file_21": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-backend-webgl\\src\\backend_webgl.ts", "file_new_name": "tfjs-backend-webgl\\src\\backend_webgl.ts", "file_complexity": {"file_NLOC": "2394", "file_CCN": "69", "file_NToken": "16035"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "2791", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "2791", "method_endline": "2791", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "2", "method_nesting_level": "0"}}}}}, "file_22": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tfjs-backend-webgl\\src\\kernel_utils\\shared.ts", "file_new_name": "tfjs-backend-webgl\\src\\kernel_utils\\shared.ts", "file_complexity": {"file_NLOC": "33", "file_CCN": "0", "file_NToken": "101"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24,25,26,27,28,29,30,32,33,34,35,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55", "deleted_lines": "29"}}}, "file_23": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tfjs-backend-webgl\\src\\setup_test.ts", "file_new_name": "tfjs-backend-webgl\\src\\setup_test.ts", "file_complexity": {"file_NLOC": "25", "file_CCN": "4", "file_NToken": "146"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "18", "deleted_lines": null}}}}}}