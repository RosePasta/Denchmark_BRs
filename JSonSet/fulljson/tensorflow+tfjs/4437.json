{"BR": {"BR_id": "4437", "BR_author": "ghafran", "BRopenT": "2020-12-22T01:35:29Z", "BRcloseT": "2020-12-29T02:22:10Z", "BR_text": {"BRsummary": "AutoML Object Detection: Argument 'x' passed to 'unstack' must be numeric tensor, but got string tensor", "BRdescription": "\n With the latest version of AutoML object detection on edge, we are getting this error using the out-of-box object detection model.\n <denchmark-code>tfjs:17 Uncaught (in promise) Error: Argument 'x' passed to 'unstack' must be numeric tensor, but got string tensor\n     at Qg (tfjs:17)\n     at $g (tfjs:17)\n     at unstack_ (tfjs:17)\n     at unstack__op (tfjs:17)\n     at tfjs:17\n     at tfjs:17\n     at e.t.scopedRun (tfjs:17)\n     at e.t.tidy (tfjs:17)\n     at lx (tfjs:17)\n     at e.<anonymous> (tfjs:17)\n </denchmark-code>\n \n Model here: <denchmark-link:https://github.com/tensorflow/tfjs/files/5727267/model.zip>model.zip</denchmark-link>\n \n Below is the html code:\n <denchmark-code><script src=\"https://unpkg.com/@tensorflow/tfjs\"></script>\n <script src=\"https://unpkg.com/@tensorflow/tfjs-automl\"></script>\n <img id=\"img\" src=\"test/test.jpg\">\n <script>\n     async function run() {\n         const model = await tf.automl.loadObjectDetection('/model/model.json');\n         const img = document.getElementById('img');\n         const options = { score: 0.5, iou: 0.5, topk: 20 };\n         console.log(model.dictionary);\n         const predictions = await model.detect(img, options);\n         console.log(predictions);\n         // Show the resulting object on the page.\n         const pre = document.createElement('pre');\n         pre.textContent = JSON.stringify(predictions, null, 2);\n         document.body.append(pre);\n     }\n     run();\n </script>\n </denchmark-code>\n \n Library Versions\n <denchmark-code>\"@tensorflow/tfjs\": \"^2.8.1\",\n \"@tensorflow/tfjs-automl\": \"^1.0.0\",\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ghafran", "commentT": "2020-12-22T17:38:50Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/tafsiri>@tafsiri</denchmark-link>\n  <denchmark-link:https://github.com/lina128>@lina128</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ghafran", "commentT": "2020-12-22T22:46:51Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/ghafran>@ghafran</denchmark-link>\n , I've submitted a PR to fix this. It will be released next week in 2.8.2. For context, the reason this error shows up  in the latest library is that, we started supporting hashtables in models. In this particular model, the hashtable is the label dictionary with string values, so we also need to add string support to underlying ops.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "ghafran", "commentT": "2020-12-23T02:08:19Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lina128>@lina128</denchmark-link>\n  Thanks for the update. Looking forward to the fix. Would be good to automate the QA for automl to ensure models work with latest tensorflowjs. Happy to help with that.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "ghafran", "commentT": "2020-12-29T02:22:12Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tfjs/issues/4437>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tfjs/issues/4437>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "6894adb02d1af6b4be90d21c7ccae10009437d38", "commit_author": "Na Li", "commitT": "2020-12-28 18:22:10-08:00", "commit_complexity": {"commit_NLOC": "0.6901408450704225", "commit_CCN": "0.9577464788732394", "commit_Nprams": "0.7746478873239436"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tfjs-backend-cpu\\src\\kernels\\Concat.ts", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Concat.ts", "file_complexity": {"file_NLOC": "62", "file_CCN": "13", "file_NToken": "686"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "82,83,84,85,89,90,91", "deleted_lines": "84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "82", "method_endline": "102", "method_complexity": {"method_NLOC": "14", "method_CCN": "1", "method_NToken": "115", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "83,84", "deleted_lines": "84", "method_info": {"method_name": "backend.data.get", "method_params": "dataId", "method_startline": "83", "method_endline": "84", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "16", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "82,83,84,85,89,90,91", "deleted_lines": "84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115", "method_info": {"method_name": "concat", "method_params": "ConcatInputs,MathBackendCPU", "method_startline": "28", "method_endline": "126", "method_complexity": {"method_NLOC": "48", "method_CCN": "5", "method_NToken": "470", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tfjs-backend-cpu\\src\\kernels\\Concat_impl.ts", "file_complexity": {"file_NLOC": "30", "file_CCN": "8", "file_NToken": "261"}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tfjs-backend-cpu\\src\\shared.ts", "file_new_name": "tfjs-backend-cpu\\src\\shared.ts", "file_complexity": {"file_NLOC": "31", "file_CCN": "0", "file_NToken": "221"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "23", "deleted_lines": null}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tfjs-backend-wasm\\src\\kernel_utils\\shared.ts", "file_new_name": "tfjs-backend-wasm\\src\\kernel_utils\\shared.ts", "file_complexity": {"file_NLOC": "4", "file_CCN": "0", "file_NToken": "36"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "21,22,27", "deleted_lines": "25"}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tfjs-backend-wasm\\src\\kernels\\Concat.ts", "file_new_name": "tfjs-backend-wasm\\src\\kernels\\Concat.ts", "file_complexity": {"file_NLOC": "68", "file_CCN": "12", "file_NToken": "666"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "31", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "31", "method_endline": "31", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "4", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "23,31,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66", "deleted_lines": "29", "method_info": {"method_name": "concat", "method_params": "ConcatInputs,BackendWasm", "method_startline": "23", "method_endline": "66", "method_complexity": {"method_NLOC": "32", "method_CCN": "5", "method_NToken": "319", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "63,64", "deleted_lines": null, "method_info": {"method_name": "backend.readSync", "method_params": "dataId", "method_startline": "63", "method_endline": "64", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "14", "method_nesting_level": "0"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tfjs-backend-webgl\\src\\kernel_utils\\shared.ts", "file_new_name": "tfjs-backend-webgl\\src\\kernel_utils\\shared.ts", "file_complexity": {"file_NLOC": "67", "file_CCN": "0", "file_NToken": "217"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "35,67", "deleted_lines": null}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tfjs-backend-webgl\\src\\kernels\\Concat_impl.ts", "file_new_name": "tfjs-backend-webgl\\src\\kernels\\Concat_impl.ts", "file_complexity": {"file_NLOC": "74", "file_CCN": "17", "file_NToken": "749"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,95,96,97,98,99,100,101,102,103,104,105,106", "deleted_lines": "83,84,85,87,88,89,90,91,92", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "59", "method_endline": "106", "method_complexity": {"method_NLOC": "35", "method_CCN": "4", "method_NToken": "329", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "60,61", "deleted_lines": null, "method_info": {"method_name": "backend.texData.get", "method_params": "dataId", "method_startline": "60", "method_endline": "61", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "16", "method_nesting_level": "0"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tfjs-core\\src\\gradients.ts", "file_new_name": "tfjs-core\\src\\gradients.ts", "file_complexity": {"file_NLOC": "169", "file_CCN": "53", "file_NToken": "1303"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "65", "deleted_lines": "65", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "63", "method_endline": "79", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "51", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "65", "deleted_lines": "65", "method_info": {"method_name": "grad", "method_params": "", "method_startline": "60", "method_endline": "80", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "38", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "121,122", "deleted_lines": "121", "method_info": {"method_name": "grads", "method_params": "", "method_startline": "112", "method_endline": "137", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "45", "method_nesting_level": "0"}}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\clone.ts", "file_new_name": "tfjs-core\\src\\ops\\clone.ts", "file_complexity": {"file_NLOC": "13", "file_CCN": "1", "file_NToken": "122"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "42", "deleted_lines": "42", "method_info": {"method_name": ">", "method_params": "TensorLike", "method_startline": "41", "method_endline": "48", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "53", "method_nesting_level": "0"}}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\concat.ts", "file_new_name": "tfjs-core\\src\\ops\\concat.ts", "file_complexity": {"file_NLOC": "31", "file_CCN": "6", "file_NToken": "258"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "72,73", "deleted_lines": "72", "method_info": {"method_name": ">", "method_params": "axis", "method_startline": "69", "method_endline": "93", "method_complexity": {"method_NLOC": "15", "method_CCN": "3", "method_NToken": "130", "method_nesting_level": "0"}}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\concat_test.ts", "file_new_name": "tfjs-core\\src\\ops\\concat_test.ts", "file_complexity": {"file_NLOC": "480", "file_CCN": "68", "file_NToken": "6727"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "306,307,308,309,310,311,312,313,314,315", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "264", "method_endline": "578", "method_complexity": {"method_NLOC": "28", "method_CCN": "1", "method_NToken": "282", "method_nesting_level": "0"}}}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\expand_dims.ts", "file_new_name": "tfjs-core\\src\\ops\\expand_dims.ts", "file_complexity": {"file_NLOC": "18", "file_CCN": "2", "file_NToken": "177"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "46", "deleted_lines": "46,47", "method_info": {"method_name": ">", "method_params": "TensorLike,axis", "method_startline": "45", "method_endline": "55", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "91", "method_nesting_level": "0"}}}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\reshape.ts", "file_new_name": "tfjs-core\\src\\ops\\reshape.ts", "file_complexity": {"file_NLOC": "17", "file_CCN": "1", "file_NToken": "161"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "56", "deleted_lines": "56", "method_info": {"method_name": ">", "method_params": "TensorLike", "method_startline": "54", "method_endline": "62", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "79", "method_nesting_level": "0"}}}}}, "file_13": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\slice.ts", "file_new_name": "tfjs-core\\src\\ops\\slice.ts", "file_complexity": {"file_NLOC": "20", "file_CCN": "2", "file_NToken": "192"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "64", "deleted_lines": "64", "method_info": {"method_name": ">", "method_params": "TensorLike", "method_startline": "62", "method_endline": "75", "method_complexity": {"method_NLOC": "11", "method_CCN": "2", "method_NToken": "105", "method_nesting_level": "0"}}}}}, "file_14": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\stack.ts", "file_new_name": "tfjs-core\\src\\ops\\stack.ts", "file_complexity": {"file_NLOC": "25", "file_CCN": "4", "file_NToken": "205"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "46,47", "deleted_lines": "46", "method_info": {"method_name": ">", "method_params": "axis", "method_startline": "44", "method_endline": "62", "method_complexity": {"method_NLOC": "15", "method_CCN": "2", "method_NToken": "118", "method_nesting_level": "0"}}}}}, "file_15": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\stack_test.ts", "file_new_name": "tfjs-core\\src\\ops\\stack_test.ts", "file_complexity": {"file_NLOC": "101", "file_CCN": "20", "file_NToken": "1264"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "117,118,119,120,121,122,123,124", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "117", "method_endline": "124", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "86", "method_nesting_level": "0"}}}}}, "file_16": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\tile.ts", "file_new_name": "tfjs-core\\src\\ops\\tile.ts", "file_complexity": {"file_NLOC": "22", "file_CCN": "2", "file_NToken": "205"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "55", "deleted_lines": "55,56", "method_info": {"method_name": ">", "method_params": "TensorLike", "method_startline": "54", "method_endline": "67", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "106", "method_nesting_level": "0"}}}}}, "file_17": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\unique.ts", "file_new_name": "tfjs-core\\src\\ops\\unique.ts", "file_complexity": {"file_NLOC": "21", "file_CCN": "2", "file_NToken": "202"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "80", "deleted_lines": "80,81", "method_info": {"method_name": ">", "method_params": "TensorLike,axis", "method_startline": "78", "method_endline": "89", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "114", "method_nesting_level": "0"}}}}}, "file_18": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\unstack.ts", "file_new_name": "tfjs-core\\src\\ops\\unstack.ts", "file_complexity": {"file_NLOC": "21", "file_CCN": "3", "file_NToken": "216"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "44", "deleted_lines": "44", "method_info": {"method_name": "unstack_", "method_params": "TensorLike,axis", "method_startline": "43", "method_endline": "48", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "91", "method_nesting_level": "0"}}}}}, "file_19": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\ops\\unstack_test.ts", "file_new_name": "tfjs-core\\src\\ops\\unstack_test.ts", "file_complexity": {"file_NLOC": "236", "file_CCN": "31", "file_NToken": "3770"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "221,222,223,224,225,226,227,228,229,230,231,232", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "221", "method_endline": "232", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "159", "method_nesting_level": "0"}}}}}, "file_20": {"file_change_type": "MODIFY", "file_Nmethod": 7, "file_old_name": "tfjs-core\\src\\tensor_util_env.ts", "file_new_name": "tfjs-core\\src\\tensor_util_env.ts", "file_complexity": {"file_NLOC": "108", "file_CCN": "41", "file_NToken": "953"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "126,134,135", "deleted_lines": "131,132", "method_info": {"method_name": ">", "method_params": "string,string", "method_startline": "124", "method_endline": "136", "method_complexity": {"method_NLOC": "13", "method_CCN": "2", "method_NToken": "113", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "73,74,75,78,79,80", "deleted_lines": "73,74,75", "method_info": {"method_name": "assertDtype", "method_params": "DataType,string,string", "method_startline": "72", "method_endline": "87", "method_complexity": {"method_NLOC": "16", "method_CCN": "7", "method_NToken": "106", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "73,74,75,78,79,80", "deleted_lines": "73,74,75", "method_info": {"method_name": "assertDtype", "method_params": "DataType,string,string", "method_startline": "72", "method_endline": "84", "method_complexity": {"method_NLOC": "13", "method_CCN": "6", "method_NToken": "82", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "135", "deleted_lines": null, "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "135", "method_endline": "135", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "1", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "126", "deleted_lines": "123,131,132", "method_info": {"method_name": ">", "method_params": "string,string", "method_startline": "121", "method_endline": "133", "method_complexity": {"method_NLOC": "12", "method_CCN": "2", "method_NToken": "91", "method_nesting_level": "0"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "91", "deleted_lines": "88", "method_info": {"method_name": ">", "method_params": "TensorLike,string,string", "method_startline": "86", "method_endline": "119", "method_complexity": {"method_NLOC": "31", "method_CCN": "14", "method_NToken": "277", "method_nesting_level": "0"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "91", "deleted_lines": null, "method_info": {"method_name": ">", "method_params": "TensorLike,string,string", "method_startline": "89", "method_endline": "122", "method_complexity": {"method_NLOC": "31", "method_CCN": "14", "method_NToken": "279", "method_nesting_level": "0"}}}}}, "file_21": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-core\\src\\tensor_util_test.ts", "file_new_name": "tfjs-core\\src\\tensor_util_test.ts", "file_complexity": {"file_NLOC": "176", "file_CCN": "41", "file_NToken": "1754"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "178", "deleted_lines": "178", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "177", "method_endline": "181", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "41", "method_nesting_level": "0"}}}}}}}}