{"BR": {"BR_id": "1690", "BR_author": "nskool", "BRopenT": "2020-01-25T06:49:06Z", "BRcloseT": "2020-01-28T17:07:23Z", "BR_text": {"BRsummary": "horovodrun convenience script does not account for 'OpenRTE' in the output of mpirun --version", "BRdescription": "\n Environment:\n \n Framework: (TensorFlow, PyTorch)\n Framework version: 1.14.0\n Horovod version: 0.16.4\n MPI version: 3.1.4/4.0.1\n CUDA version: 10.1\n NCCL version: 2.4.8\n Python version: 3.6\n OS and version: Ubuntu, Docker\n GCC version:5.4.0\n \n Checklist:\n \n Did you search issues to find if somebody asked this question before?\n Yes, hasn't been specifically asked\n Did you check if you question is answered in the troubleshooting guide?\n \n Bug report:\n \n horovodrun outputs the following, when using with Open MPI 4.0.1.\n \n <denchmark-code>horovodrun -np 1 -H localhost:1 python pytorch_mnist.py\n Open MPI not found in output of mpirun --version.\n Traceback (most recent call last):\n   File \"/opt/conda/bin/horovodrun\", line 21, in <module>\n     run.run()\n   File \"/opt/conda/lib/python3.6/site-packages/horovod/run/run.py\", line 448, in run\n     'horovodrun convenience script currently only supports '\n Exception: horovodrun convenience script currently only supports Open MPI.\n \n Choose one of:\n 1. Install Open MPI 4.0.0+ and re-install Horovod (use --no-cache-dir pip option).\n 2. Run distributed training script using the standard way provided by your MPI distribution (usually mpirun, srun, or jsrun).\n root@3da487b92c3d:/horovod/examples# mpirun --version\n mpirun.real (OpenRTE) 4.0.1\n \n Report bugs to http://www.open-mpi.org/community/help/\n </denchmark-code>\n \n \n When Open MPI is installed as follows:\n \n <denchmark-code>RUN wget https://www.open-mpi.org/software/ompi/v4.0/downloads/openmpi-$OPEN_MPI_VERSION.tar.gz \\\n  && gunzip -c openmpi-$OPEN_MPI_VERSION.tar.gz | tar xf - \\\n  && cd openmpi-$OPEN_MPI_VERSION \\\n  && ./configure --prefix=/home/.openmpi \\\n  && make all install \\\n  && cd .. \\\n  && rm openmpi-$OPEN_MPI_VERSION.tar.gz \\\n  && rm -rf openmpi-$OPEN_MPI_VERSION\n </denchmark-code>\n \n \n The horovodrun check expects 'OpenMPI' to be present in the output of mpirun --version. [link]. However, when installed as above, OpenMPI has the following in output:\n \n <denchmark-code>root@3b5149353790:/horovod/examples# mpirun --version\n mpirun.real (OpenRTE) 4.0.1\n \n Report bugs to http://www.open-mpi.org/community/help/\n </denchmark-code>\n \n \n Either openmpi was installed incorrectly (in which case, can horovod documentation clarify how to install it correctly?), or the horovodrun convenience script does not account for presence of 'OpenRTE' in the mpirun --version.\n \n I'm unable to understand when is 'OpenRTE' visible in mpirun --version, and it isn't? I saw the option --enable-orterun-prefix-by-default, but I'm not using it to build open-mpi.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "nskool", "commentT": "2020-01-25T17:09:59Z", "comment_text": "\n \t\tI am also facing similar issue. It requires a feature support to add OpenRTE flags in  file. Please use  command directly instead of  for now until this feature is supported.  By following this <denchmark-link:https://www.open-mpi.org/faq/?category=building#easy-build>link</denchmark-link>\n  for building/installing OpenMPI , you will be able to run horovodrun command.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "nskool", "commentT": "2020-01-28T00:49:07Z", "comment_text": "\n \t\tHey <denchmark-link:https://github.com/nskool>@nskool</denchmark-link>\n  <denchmark-link:https://github.com/karan6181>@karan6181</denchmark-link>\n  please try <denchmark-link:https://github.com/horovod/horovod/pull/1693>#1693</denchmark-link>\n  and let me know if it solves your issue.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "nskool", "commentT": "2020-01-28T05:04:58Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/tgaddair>@tgaddair</denchmark-link>\n  Yes working for me. Thanks for the quick fix!\n \t\t"}}}, "commit": {"commit_id": "33035d2c23d47510b7ad9eac0e9ad6a2d03b3322", "commit_author": "Travis Addair", "commitT": "2020-01-28 09:07:22-08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "horovod\\run\\mpi_run.py", "file_new_name": "horovod\\run\\mpi_run.py", "file_complexity": {"file_NLOC": "93", "file_CCN": "23", "file_NToken": "537"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "52", "deleted_lines": "52", "method_info": {"method_name": "_get_mpi_implementation_flags", "method_params": "", "method_startline": "38", "method_endline": "64", "method_complexity": {"method_NLOC": "26", "method_CCN": "8", "method_NToken": "136", "method_nesting_level": "0"}}}}}}}}