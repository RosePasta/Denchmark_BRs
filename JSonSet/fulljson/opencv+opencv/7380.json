{"BR": {"BR_id": "7380", "BR_author": "kesinger", "BRopenT": "2016-09-30T22:08:37Z", "BRcloseT": "2016-10-20T12:56:27Z", "BR_text": {"BRsummary": "Valgrind warning in icvGetPropertyCAM_V4L", "BRdescription": "\n \n OpenCV => recent-ish top-of-master, last commit 473dba1\n Operating System / Platform => Linux (Ubuntu 16.04)\n Compiler => gcc 5.4.0\n \n <denchmark-h:h5>Detailed description</denchmark-h>\n \n When running an opencv app under valgrind,  I get a warning about uninitialized bytes in ioctl:\n <denchmark-code>==16431== Syscall param ioctl(VKI_V4L2_G_FMT).fmt.pix.priv points to uninitialised byte(s)\n ==16431==    at 0x7BF4687: ioctl (syscall-template.S:84)\n ==16431==    by 0x5F85F32: cv::icvGetPropertyCAM_V4L(cv::CvCaptureCAM_V4L const*, int) [clone .constprop.12] (in ...)\n </denchmark-code>\n \n the code looks like:\n <denchmark-code>      v4l2_format form; // line 1582\n       form.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;\n       if (-1 == ioctl (capture->deviceHandle, VIDIOC_G_FMT, &form)) {\n </denchmark-code>\n \n One way to silence the warning is to explicitly clear out form:\n <denchmark-code>      v4l2_format form;\n       memset(&form, 0, sizeof(v4l2_format));\n       form.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;\n       if (-1 == ioctl (capture->deviceHandle, VIDIOC_G_FMT, &form)) {\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "kesinger", "commentT": "2016-10-18T09:19:40Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/kesinger>@kesinger</denchmark-link>\n  , could you please create pull request with the fix?\n \t\t"}}}, "commit": {"commit_id": "bd505531493ecd9114c21111035812195291f9fd", "commit_author": "Jake Kesinger", "commitT": "2016-10-18 14:18:35-04:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "modules\\videoio\\src\\cap_v4l.cpp", "file_new_name": "modules\\videoio\\src\\cap_v4l.cpp", "file_complexity": {"file_NLOC": "1190", "file_CCN": "260", "file_NToken": "7905"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1616", "deleted_lines": null, "method_info": {"method_name": "cv::icvGetPropertyCAM_V4L", "method_params": "capture,property_id", "method_startline": "1612", "method_endline": "1715", "method_complexity": {"method_NLOC": "86", "method_CCN": "23", "method_NToken": "469", "method_nesting_level": "1"}}}}}}}}