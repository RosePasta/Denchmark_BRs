{"BR": {"BR_id": "2475", "BR_author": "leckie-chn", "BRopenT": "2020-05-22T08:44:30Z", "BRcloseT": "2020-06-05T09:04:48Z", "BR_text": {"BRsummary": "nodejs OOM when `make build`", "BRdescription": "\n \n \n environment: WSL on windows 10 Enterprise (18363.836)\n \n \n error log:\n \n \n \u279c  make build\n # Building NNI Manager \n cd src/nni_manager && PATH=/home/niyan/.local/bin:${PATH} /tmp/niyan/nni-yarn/bin/yarn && PATH=/home/niyan/.local/bin:${PATH} /tmp/niyan/nni-yarn/bin/yarn build\n yarn install v1.12.1\n [1/5] Validating package.json...\n [2/5] Resolving packages...\n [3/5] Fetching packages...\n info fsevents@2.1.2: The platform \"linux\" is incompatible with this module.\n info \"fsevents@2.1.2\" is an optional dependency and failed compatibility check. Excluding it from installation.\n [4/5] Linking dependencies...\n warning \" > express-joi-validator@2.0.0\" has unmet peer dependency \"joi@6.x.x\".\n [5/5] Building fresh packages...\n Done in 130.84s.\n yarn run v1.12.1\n $ tsc\n Done in 6.28s.\n cp -rf src/nni_manager/config src/nni_manager/dist/\n # Building WebUI \n cd src/webui && PATH=/home/niyan/.local/bin:${PATH} /tmp/niyan/nni-yarn/bin/yarn && PATH=/home/niyan/.local/bin:${PATH} /tmp/niyan/nni-yarn/bin/yarn build\n yarn install v1.12.1\n [1/4] Resolving packages...\n [2/4] Fetching packages...\n info fsevents@1.2.11: The platform \"linux\" is incompatible with this module.\n info \"fsevents@1.2.11\" is an optional dependency and failed compatibility check. Excluding it from installation.\n [3/4] Linking dependencies...\n warning \" > echarts-for-react@2.0.15-beta.1\" has unmet peer dependency \"prop-types@^15.5.7\".\n warning \" > eslint-config-react-app@4.0.1\" has incorrect peer dependency \"@typescript-eslint/eslint-plugin@1.x\".\n warning \" > eslint-config-react-app@4.0.1\" has incorrect peer dependency \"@typescript-eslint/parser@1.x\".\n [4/4] Building fresh packages...\n Done in 360.61s.\n yarn run v1.12.1\n $ node scripts/build.js\n Creating an optimized production build...\n <--- Last few GCs --->\n [334:0x26a26a0]   112915 ms: Mark-sweep 1367.9 (1424.6) -> 1365.6 (1421.7) MB, 638.3 / 0.0 ms  (average mu = 0.137, current mu = 0.053) allocation failure GC in old space requested\n [334:0x26a26a0]   113293 ms: Mark-sweep 1367.5 (1423.6) -> 1366.2 (1422.3) MB, 373.2 / 0.0 ms  (average mu = 0.088, current mu = 0.011) allocation failure GC in old space requested\n \n <--- JS stacktrace --->\n ==== JS stack trace =========================================\n     0: ExitFrame [pc: 0x36d039e5be1d]\n Security context: 0x0828e079e6e1 <JSObject>\n     1: /* anonymous */ [0x37198687fb21] [/mnt/c/Users/yann/Desktop/code/nni/src/webui/node_modules/source-map/lib/source-node.js:~174] [pc=0x36d039e7e99c](this=0x1ca62a237481 <SourceNode map = 0x2eec412fe011>,chunk=0x01620905ffe1 <SourceNode map = 0x2eec412fe011>)\n     2: arguments adaptor frame: 3->1\n     3: SourceNode_add [0x1f5a928ca0d1] [/mnt/c/Users/yann/...\n FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory\n  1: 0x8daaa0 node::Abort() [/tmp/niyan/nni-node-linux-x64/bin/node]\n  2: 0x8daaec  [/tmp/niyan/nni-node-linux-x64/bin/node]\n  3: 0xad73ce v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, bool) [/tmp/niyan/nni-node-linux-x64/bin/node]\n  4: 0xad7604 v8::internal::V8::FatalProcessOutOfMemory(v8::internal::Isolate*, char const*, bool) [/tmp/niyan/nni-node-linux-x64/bin/node]\n  5: 0xec4c32  [/tmp/niyan/nni-node-linux-x64/bin/node]\n  6: 0xec4d38 v8::internal::Heap::CheckIneffectiveMarkCompact(unsigned long, double) [/tmp/niyan/nni-node-linux-x64/bin/node]\n  7: 0xed0e12 v8::internal::Heap::PerformGarbageCollection(v8::internal::GarbageCollector, v8::GCCallbackFlags) [/tmp/niyan/nni-node-linux-x64/bin/node]\n  8: 0xed1744 v8::internal::Heap::CollectGarbage(v8::internal::AllocationSpace, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags) [/tmp/niyan/nni-node-linux-x64/bin/node]\n  9: 0xed43b1 v8::internal::Heap::AllocateRawWithRetryOrFail(int, v8::internal::AllocationSpace, v8::internal::AllocationAlignment) [/tmp/niyan/nni-node-linux-x64/bin/node]\n 10: 0xe9d4a6 v8::internal::Factory::AllocateRawArray(int, v8::internal::PretenureFlag) [/tmp/niyan/nni-node-linux-x64/bin/node]\n 11: 0xe9dd2a v8::internal::Factory::NewFixedArrayWithFiller(v8::internal::Heap::RootListIndex, int, v8::internal::Object*, v8::internal::PretenureFlag) [/tmp/niyan/nni-node-linux-x64/bin/node]\n 12: 0xe9e2e7 v8::internal::Factory::NewUninitializedFixedArray(int, v8::internal::PretenureFlag) [/tmp/niyan/nni-node-linux-x64/bin/node]\n 13: 0xe5166f  [/tmp/niyan/nni-node-linux-x64/bin/node]\n 14: 0x10f738d v8::internal::Runtime_GrowArrayElements(int, v8::internal::Object**, v8::internal::Isolate*) [/tmp/niyan/nni-node-linux-x64/bin/node]\n 15: 0x36d039e5be1d\n Aborted (core dumped)\n error Command failed with exit code 134.\n info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\n Makefile:69: recipe for target 'build' failed\n make: *** [build] Error 1\n solution: <denchmark-link:https://stackoverflow.com/questions/38558989/node-js-heap-out-of-memory/57621731#57621731>stackoverflow - Node.js heap out of memory</denchmark-link>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "4897ac265da4e4fd746bd9ab2c8b71084ee1d5a2", "commit_author": "liuzhe-lz", "commitT": "2020-06-05 17:04:47+08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\webui\\package.json", "file_new_name": "src\\webui\\package.json", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "80,81,82", "deleted_lines": "80,81,82"}}}}}}