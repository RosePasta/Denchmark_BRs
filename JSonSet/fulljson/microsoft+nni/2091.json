{"BR": {"BR_id": "2091", "BR_author": "marsggbo", "BRopenT": "2020-02-23T11:51:53Z", "BRcloseT": "2020-02-29T03:58:50Z", "BR_text": {"BRsummary": "ENAS bug IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)", "BRdescription": "\n In ENAS example, when lstm_num_layers=1, the code can run successfully. However, when I set lstm_num_layers=2, then it raises the following error: IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "marsggbo", "commentT": "2020-02-23T12:43:11Z", "comment_text": "\n \t\tI solve this problem by modifying the output shape in the forward function, as below:\n class StackedLSTMCell(nn.Module):\n     def __init__(self, layers, size, bias):\n         super().__init__()\n         self.lstm_num_layers = layers\n         self.lstm_modules = nn.ModuleList([nn.LSTMCell(size, size, bias=bias)\n                                            for _ in range(self.lstm_num_layers)])\n \n     def forward(self, inputs, hidden):\n         prev_c, prev_h = hidden\n         next_c, next_h = [], []\n         for i, m in enumerate(self.lstm_modules):\n             curr_c, curr_h = m(inputs, (prev_c[i], prev_h[i]))\n             next_c.append(curr_c)\n             next_h.append(curr_h)\n             inputs = curr_h[-1].view(1,-1) # here\n         return next_c, next_h\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "marsggbo", "commentT": "2020-02-24T02:43:41Z", "comment_text": "\n \t\tGreat! Since you've solved the problem, would you like to submit a pull request? Thanks.\n \t\t"}}}, "commit": {"commit_id": "03cea2b4e1ac2d2c9f7269b1d79be3b5dac42d13", "commit_author": "marsggbo", "commitT": "2020-02-29 11:58:49+08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\sdk\\pynni\\nni\\nas\\pytorch\\enas\\mutator.py", "file_new_name": "src\\sdk\\pynni\\nni\\nas\\pytorch\\enas\\mutator.py", "file_complexity": {"file_NLOC": "170", "file_CCN": "32", "file_NToken": "1555"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "26,27,28", "deleted_lines": "26", "method_info": {"method_name": "forward", "method_params": "self,inputs,hidden", "method_startline": "19", "method_endline": "29", "method_complexity": {"method_NLOC": "9", "method_CCN": "2", "method_NToken": "86", "method_nesting_level": "1"}}}}}}}}