{"BR": {"BR_id": "1717", "BR_author": "myungjoo", "BRopenT": "2019-10-01T10:49:31Z", "BRcloseT": "2019-10-02T06:46:01Z", "BR_text": {"BRsummary": "[UnitTest FAIL] Parallel CAPI issue not fixed.", "BRdescription": "\n We definitely need to re-enable unit-test in aarch64/Tizen builds.\n <denchmark-code>$ gbs build -A aarch64 --define \"unit_test 1\"\n ...\n [  164s] [       OK ] nnstreamer_capi_singleshot.benchmark_time (1464 ms)\n [  164s] [ RUN      ] nnstreamer_capi_singleshot.invoke_03\n [  164s] [       OK ] nnstreamer_capi_singleshot.invoke_03 (63 ms)\n [  164s] [ RUN      ] nnstreamer_capi_singleshot.failure_01_n\n [  164s] [       OK ] nnstreamer_capi_singleshot.failure_01_n (87 ms)\n [  164s] [ RUN      ] nnstreamer_capi_singleshot.invoke_timeout\n [  168s] [       OK ] nnstreamer_capi_singleshot.invoke_timeout (3910 ms)\n [  168s] [ RUN      ] nnstreamer_capi_singleshot.parallel_runs\n [  171s] ../tests/tizen_capi/unittest_tizen_capi.cpp:1947: Failure\n [  171s]       Expected: status\n [  171s]       Which is: -1073741823\n [  171s] To be equal to: ML_ERROR_NONE\n [  171s]       Which is: 0\n [  171s] ../tests/tizen_capi/unittest_tizen_capi.cpp:1948: Failure\n [  171s] Value of: output != NULL\n [  171s]   Actual: false\n [  171s] Expected: true\n [  171s] ../tests/tizen_capi/unittest_tizen_capi.cpp:1947: Failure\n [  171s]       Expected: status\n [  171s]       Which is: -1073741823\n [  171s] To be equal to: ML_ERROR_NONE\n [  171s]       Which is: 0\n ...\n [  284s] [  FAILED  ] nnstreamer_capi_singleshot.parallel_runs (116530 ms)\n [  284s] [ RUN      ] nnstreamer_capi_singleshot.close_while_running\n [  286s] [       OK ] nnstreamer_capi_singleshot.close_while_running (1349 ms)\n [  286s] [----------] 8 tests from nnstreamer_capi_singleshot (126154 ms total)\n [  286s] \n [  286s] [----------] Global test environment tear-down\n [  286s] [==========] 31 tests from 8 test cases ran. (133220 ms total)\n [  286s] [  PASSED  ] 30 tests.\n [  286s] [  FAILED  ] 1 test, listed below:\n [  286s] [  FAILED  ] nnstreamer_capi_singleshot.parallel_runs\n [  286s] \n [  286s]  1 FAILED TEST\n [  286s] error: Bad exit status from /var/tmp/rpm-tmp.gMCjmT (%build)\n \n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "myungjoo", "commentT": "2019-10-01T10:49:32Z", "comment_text": "\n \t\t : Thank you for posting issue <denchmark-link:https://github.com/nnstreamer/nnstreamer/issues/1717>#1717</denchmark-link>\n . The person in charge will reply soon.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "myungjoo", "commentT": "2019-10-02T01:59:57Z", "comment_text": "\n \t\tThis fail on the aarch64 is not from the nnstreamer single API implementations. This is due to the slow tensorflow-lite.\n <denchmark-code>$ gbs build -A aarch64 --define \"unit_test 1\"\n ...\n [  119s] [ RUN      ] nnstreamer_capi_singleshot.benchmark_time\n [  121s] ** (-0:23218): WARNING **: Time to open single = 7792.000000 us\n [  121s] ** (-0:23218): WARNING **: Time to invoke single = 1395038.000000 us\n [  121s] ** (-0:23218): WARNING **: Time to close single = 54969.000000 us\n [  121s] [       OK ] nnstreamer_capi_singleshot.benchmark_time (1534 ms)\n ...\n </denchmark-code>\n \n <denchmark-code>$ gbs build -A x86_64 --define \"unit_test 1\"\n ...\n [  129s] [ RUN      ] nnstreamer_capi_singleshot.benchmark_time\n [  129s] ** (unittest_tizen_capi:32383): WARNING **: Time to open single = 718.000000 us\n [  129s] ** (unittest_tizen_capi:32383): WARNING **: Time to invoke single = 55428.000000 us\n [  129s] ** (unittest_tizen_capi:32383): WARNING **: Time to close single = 51088.000000 us\n [  129s] [       OK ] nnstreamer_capi_singleshot.benchmark_time (169 ms)\n ...\n </denchmark-code>\n \n nnstreamer_capi_singleshot.benchmark_time runs a NN model once and times it. The time consumed by aarch64 test case does not fit in the timeout values set, causing the error of TIZEN_ERROR_TIMED_OUT or -1073741823.\n I will check the tensorflow-lite build script in tizen.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "myungjoo", "commentT": "2019-10-02T02:03:25Z", "comment_text": "\n \t\tI will try <denchmark-link:https://github.com/nnsuite/ubuntuport-tensorflow/pull/4>nnsuite/ubuntuport-tensorflow#4</denchmark-link>\n  and <denchmark-link:https://github.com/nnsuite/ubuntuport-tensorflow/pull/5>nnsuite/ubuntuport-tensorflow#5</denchmark-link>\n  in the tizen build script, they might help.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "myungjoo", "commentT": "2019-10-02T03:24:57Z", "comment_text": "\n \t\t\n This is due to the slow tensorflow-lite.\n \n The API and the test cases should be robust against high latency of neural networks.\n \t\t"}}}, "commit": {"commit_id": "4e113182d7f41ea6a23bea4249c0b9dd98b009e0", "commit_author": "Parichay Kapoor", "commitT": "2019-10-02 15:17:38+09:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.9090909090909091", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 9, "file_old_name": "tests\\tizen_capi\\unittest_tizen_capi.cpp", "file_new_name": "tests\\tizen_capi\\unittest_tizen_capi.cpp", "file_complexity": {"file_NLOC": "1481", "file_CCN": "95", "file_NToken": "10524"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1512,1513,1514", "deleted_lines": null, "method_info": {"method_name": "TEST", "method_params": "nnstreamer_capi_singleshot,benchmark_time", "method_startline": "1448", "method_endline": "1538", "method_complexity": {"method_NLOC": "72", "method_CCN": "4", "method_NToken": "517", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "1917,1960,1961,1962,1963,1964,1965,1967", "deleted_lines": "1942,1943,1944,1945,1947,1948", "method_info": {"method_name": "single_shot_loop_test", "method_params": "arg", "method_startline": "1910", "method_endline": "1981", "method_complexity": {"method_NLOC": "58", "method_CCN": "14", "method_NToken": "360", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "2142", "deleted_lines": "2123", "method_info": {"method_name": "TEST", "method_params": "nnstreamer_capi_singleshot,close_while_running", "method_startline": "2122", "method_endline": "2162", "method_complexity": {"method_NLOC": "26", "method_CCN": "3", "method_NToken": "163", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "1764,1765,1766", "deleted_lines": null, "method_info": {"method_name": "TEST", "method_params": "nnstreamer_capi_singleshot,invoke_04", "method_startline": "1645", "method_endline": "1802", "method_complexity": {"method_NLOC": "122", "method_CCN": "5", "method_NToken": "948", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "1354,1355,1356", "deleted_lines": null, "method_info": {"method_name": "TEST", "method_params": "nnstreamer_capi_singleshot,invoke_01", "method_startline": "1254", "method_endline": "1371", "method_complexity": {"method_NLOC": "90", "method_CCN": "3", "method_NToken": "692", "method_nesting_level": "0"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "2088,2097,2098", "deleted_lines": "2069,2078,2079", "method_info": {"method_name": "TEST", "method_params": "nnstreamer_capi_singleshot,parallel_runs", "method_startline": "2067", "method_endline": "2115", "method_complexity": {"method_NLOC": "34", "method_CCN": "6", "method_NToken": "261", "method_nesting_level": "0"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "2043,2044,2046", "deleted_lines": "2024,2025,2027", "method_info": {"method_name": "TEST", "method_params": "nnstreamer_capi_singleshot,invoke_timeout", "method_startline": "1987", "method_endline": "2060", "method_complexity": {"method_NLOC": "50", "method_CCN": "4", "method_NToken": "339", "method_nesting_level": "0"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "1610,1611,1612", "deleted_lines": null, "method_info": {"method_name": "TEST", "method_params": "nnstreamer_capi_singleshot,invoke_03", "method_startline": "1545", "method_endline": "1638", "method_complexity": {"method_NLOC": "69", "method_CCN": "5", "method_NToken": "545", "method_nesting_level": "0"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "1427,1428,1429", "deleted_lines": null, "method_info": {"method_name": "TEST", "method_params": "nnstreamer_capi_singleshot,invoke_02", "method_startline": "1377", "method_endline": "1442", "method_complexity": {"method_NLOC": "50", "method_CCN": "3", "method_NToken": "338", "method_nesting_level": "0"}}}}}}}}