{"BR": {"BR_id": "497", "BR_author": "thllwg", "BRopenT": "2020-08-14T09:06:14Z", "BRcloseT": "2020-08-14T10:55:41Z", "BR_text": {"BRsummary": "Model evaluation fails when using external embeddings", "BRdescription": "\n I'm currently trying to train a network with the current dev branch, using LibriTTS 360+100 with external embeddings. Training fails at the end of the first epoch, when the evaluation is conducted.\n <denchmark-code>--> TRAIN PERFORMACE -- EPOCH TIME: 1426.36 sec -- GLOBAL_STEP: 1855\n   | > avg_decoder_loss: 1.14756\n   | > avg_postnet_loss: 1.27054\n   | > avg_stopnet_loss: 0.30356\n   | > avg_decoder_coarse_loss: 1.10275\n   | > avg_decoder_ddc_loss: 0.00487\n   | > avg_ga_loss: 0.04375\n   | > avg_loss: 3.56949\n   | > avg_align_error: 0.93601\n   | > avg_loader_time: 0.00657\n   | > avg_step_time: 0.76924\n \n > EVALUATION\n \n ! Run is removed from /home/dobby/models/multi/LibriTTS/libritts_360_100-gst-ddc-bn-embeddings-August-14-2020_06+31AM-8b4eb25\n Traceback (most recent call last):\n File \"mozilla_voice_tts/bin/train_tts.py\", line 714, in <module>\n  main(args)\n File \"mozilla_voice_tts/bin/train_tts.py\", line 627, in main\n  eval_avg_loss_dict = evaluate(model, criterion, ap, global_step, epoch)\n File \"/home/dobby/thllwgTTS_try/thllwgtts/lib/python3.6/site-packages/torch-1.6.0-py3.6-linux-x86_64.egg/torch/autograd/grad_mode.py\", line 15, in decorate_context\n  return func(*args, **kwargs)\n File \"mozilla_voice_tts/bin/train_tts.py\", line 342, in evaluate\n  text_input, text_lengths, mel_input, speaker_ids=speaker_ids, speaker_embeddings=speaker_embeddings)\n File \"/home/dobby/thllwgTTS_try/thllwgtts/lib/python3.6/site-packages/torch-1.6.0-py3.6-linux-x86_64.egg/torch/nn/modules/module.py\", line 722, in _call_impl\n  result = self.forward(*input, **kwargs)\n File \"/home/dobby/thllwgTTS_try/TTS/mozilla_voice_tts/tts/models/tacotron2.py\", line 112, in forward\n  speaker_embeddings = torch.unsqueeze(speaker_embeddings, 1)\n TypeError: unsqueeze(): argument 'input' (position 1) must be Tensor, not NoneType\n </denchmark-code>\n \n The reason is that the speaker_mapping passed to evaluate in train_tts.py.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "thllwg", "commentT": "2020-08-14T10:08:40Z", "comment_text": "\n \t\tinteresting actually we run a sample training in tests, but it passes the testing.\n \t\t"}}}, "commit": {"commit_id": "c90fce8d8c98fc58d9ab329a2ca95bc2539d4061", "commit_author": "thllwg", "commitT": "2020-08-14 11:11:04+02:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "mozilla_voice_tts\\bin\\train_tts.py", "file_new_name": "mozilla_voice_tts\\bin\\train_tts.py", "file_complexity": {"file_NLOC": "577", "file_CCN": "84", "file_NToken": "4310"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "627", "deleted_lines": "627", "method_info": {"method_name": "main", "method_params": "args", "method_startline": "480", "method_endline": "633", "method_complexity": {"method_NLOC": "122", "method_CCN": "36", "method_NToken": "928", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "103", "deleted_lines": "103", "method_info": {"method_name": "format_data", "method_params": "data,speaker_mapping", "method_startline": "86", "method_endline": "135", "method_complexity": {"method_NLOC": "41", "method_CCN": "12", "method_NToken": "330", "method_nesting_level": "0"}}}}}}}}