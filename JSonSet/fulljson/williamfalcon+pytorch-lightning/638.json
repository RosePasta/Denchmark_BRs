{"BR": {"BR_id": "638", "BR_author": "kwanUm", "BRopenT": "2019-12-19T12:52:41Z", "BRcloseT": "2020-04-07T10:30:47Z", "BR_text": {"BRsummary": "Pytorch lightning spawns processes after each epoch of training, causing training script to crash unexpectedly", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n When running my training script with PTL, I noticed that after the script is running process spawning is happening at the end of every epoch, which reloads the script. This unintended behavior often causes the training to crash if I'm in the middle of changing the code, and essentially locks the script running from any edits to it.\n A possible fix for this is to create the Data Loader object only once <denchmark-link:https://fburl.com/1x51d9ul>here</denchmark-link>\n .\n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n Train with PTL using DDP and num_workers > 1, and place a breakpoint at the top of the main file of your project.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "kwanUm", "commentT": "2020-01-21T02:35:16Z", "comment_text": "\n \t\tThat link seems to be FB-internal, so I can't see what you're linking to, but you may be able to solve your problem by defining the dataloader as an attribute, then simply returning the existing dataloader in the val_dataloader method.\n Early versions of Lightning actually cached the dataloader so that it didn't get re-created every epoch, but there are some use cases that need to create a new DL every time. This way, you have the flexibility to cache it yourself.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "kwanUm", "commentT": "2020-01-21T06:50:30Z", "comment_text": "\n \t\tThanks for your reply Nic, I'll go ahead and try that!\n <denchmark-link:#>\u2026</denchmark-link>\n \n \n On Tue, Jan 21, 2020 at 4:35 AM Nic Eggert ***@***.***> wrote:\n  That link seems to be FB-internal, so I can't see what you're linking to,\n  but you may be able to solve your problem by defining the dataloader as an\n  attribute, then simply returning the existing dataloader in the\n  val_dataloader method.\n \n  Early versions of Lightning actually cached the dataloader so that it\n  didn't get re-created every epoch, but there are some use cases that need\n  to create a new DL every time. This way, you have the flexibility to cache\n  it yourself.\n \n  \u2014\n  You are receiving this because you authored the thread.\n  Reply to this email directly, view it on GitHub\n  <#638?email_source=notifications&email_token=AB5EBDELPYKS3JKJX6U4VG3Q6ZNOJA5CNFSM4J5FOHPKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEJOJLCA#issuecomment-576492936>,\n  or unsubscribe\n  <https://github.com/notifications/unsubscribe-auth/AB5EBDAKGCFLHKW3J6ID2K3Q6ZNOJANCNFSM4J5FOHPA>\n  .\n \n \n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "kwanUm", "commentT": "2020-01-21T12:34:54Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/tullie>@tullie</denchmark-link>\n  want to look at this?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "kwanUm", "commentT": "2020-01-21T12:44:20Z", "comment_text": "\n \t\tYep. Will take a look this week\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "kwanUm", "commentT": "2020-01-31T02:37:46Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/kwanUm>@kwanUm</denchmark-link>\n  i've been unable to reproduce the problem.\n I'm wondering if you're not tagging your test_dataloader with @data_loader. This will ensure that the dataloader is only constructed once like you suggested. See \n \n \n pytorch-lightning/pytorch_lightning/core/decorators.py\n \n \n          Line 5\n       in\n       06242c2\n \n \n \n \n \n \n  def data_loader(fn): \n \n \n \n \n \n If that doesn't help, can you please send me some more code of your setup so I can try and reproduce?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "kwanUm", "commentT": "2020-02-01T21:16:21Z", "comment_text": "\n \t\tThanks for trying to check this <denchmark-link:https://github.com/tullie>@tullie</denchmark-link>\n .\n I haven't defined a test_dataloader method in my PTL Trainer - only overriden train_dataloader().\n I'm sorry for not being able to share the code for you to reproduce it yourself, but here's my train_dataloader code (it's annotated correctly):\n <denchmark-code>@pl.data_loader\n def train_dataloader(self):\n     train_dataset = GANTrainingDataset(...)\n     if self.distributed_backend == \"ddp\":\n         data_sampler = torch.utils.data.distributed.DistributedSampler(train_dataset,\n                                                                        num_replicas=self.num_of_gpus_running,\n                                                                        rank=self.logger.rank)\n     else:\n         data_sampler = torch.utils.data.RandomSampler(train_dataset)\n     return DataLoader(\n         train_dataset,\n         batch_size=self.batch_size,\n         sampler=data_sampler,\n         num_workers=self.num_workers,\n         drop_last=True,\n         pin_memory=True,\n     )\n </denchmark-code>\n \n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "kwanUm", "commentT": "2020-02-03T22:04:15Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/kwanUm>@kwanUm</denchmark-link>\n  thanks - I was able to reproduce the problem.\n My understanding is that you want DataLoader worker processes to be reused after each epoch. There's an issue and suggested work around for that in the pytorch repo here: <denchmark-link:https://github.com/pytorch/pytorch/issues/15849#issuecomment-573921048>pytorch/pytorch#15849 (comment)</denchmark-link>\n \n Another suggestion, and what I do, is copy the code base to a separate folder before running distributed training. This ensures any local changes you make won't affect the run.\n Let me know if this helps!\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "kwanUm", "commentT": "2020-04-03T22:22:33Z", "comment_text": "\n \t\tThis issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "kwanUm", "commentT": "2020-04-07T08:07:25Z", "comment_text": "\n \t\tCopying the code to another location for each run did the trick for me. Thanks!\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "kwanUm", "commentT": "2020-04-07T10:30:47Z", "comment_text": "\n \t\tawesome!\n \t\t"}}}, "commit": {"commit_id": "3c2fd560aa4d31b4f48ee225b83361deec53d9c7", "commit_author": "Adrian W\u00e4lchli", "commitT": "2020-03-12 12:47:23-04:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "0.8604651162790697", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "11", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "pytorch_lightning\\core\\grads.py", "file_new_name": "pytorch_lightning\\core\\grads.py", "file_complexity": {"file_NLOC": "23", "file_CCN": "4", "file_NToken": "175"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "11", "deleted_lines": "10", "method_info": {"method_name": "grad_norm", "method_params": "self,norm_type", "method_startline": "10", "method_endline": "29", "method_complexity": {"method_NLOC": "17", "method_CCN": "4", "method_NToken": "148", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "11", "deleted_lines": null, "method_info": {"method_name": "grad_norm", "method_params": "self,float", "method_startline": "11", "method_endline": "30", "method_complexity": {"method_NLOC": "17", "method_CCN": "4", "method_NToken": "157", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 14, "file_old_name": "pytorch_lightning\\core\\hooks.py", "file_new_name": "pytorch_lightning\\core\\hooks.py", "file_complexity": {"file_NLOC": "110", "file_CCN": "14", "file_NToken": "209"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "66", "deleted_lines": null, "method_info": {"method_name": "on_epoch_end", "method_params": "self", "method_startline": "66", "method_endline": "67", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "119,126", "method_info": {"method_name": "backward", "method_params": "self,trainer,loss,optimizer,optimizer_idx", "method_startline": "119", "method_endline": "150", "method_complexity": {"method_NLOC": "7", "method_CCN": "3", "method_NToken": "51", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "78,90", "deleted_lines": "80", "method_info": {"method_name": "on_before_zero_grad", "method_params": "self,Optimizer", "method_startline": "78", "method_endline": "91", "method_complexity": {"method_NLOC": "14", "method_CCN": "1", "method_NToken": "12", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "94,95", "deleted_lines": "97,98,99,100,102", "method_info": {"method_name": "on_after_backward", "method_params": "self", "method_startline": "94", "method_endline": "111", "method_complexity": {"method_NLOC": "18", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "90,94", "deleted_lines": "80,92,93", "method_info": {"method_name": "on_before_zero_grad", "method_params": "self,optimizer", "method_startline": "80", "method_endline": "94", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "40", "deleted_lines": "41", "method_info": {"method_name": "on_train_start", "method_params": "self", "method_startline": "40", "method_endline": "42", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "70", "deleted_lines": null, "method_info": {"method_name": "on_pre_performance_check", "method_params": "self", "method_startline": "70", "method_endline": "71", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "51", "deleted_lines": "52", "method_info": {"method_name": "on_batch_start", "method_params": "self,Any", "method_startline": "51", "method_endline": "55", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "12", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "62", "deleted_lines": null, "method_info": {"method_name": "on_epoch_start", "method_params": "self", "method_startline": "62", "method_endline": "63", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_9": {"Ismethod": 1, "added_lines": null, "deleted_lines": "52,56", "method_info": {"method_name": "on_batch_start", "method_params": "self,batch", "method_startline": "52", "method_endline": "57", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "74", "deleted_lines": null, "method_info": {"method_name": "on_post_performance_check", "method_params": "self", "method_startline": "74", "method_endline": "75", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "45", "deleted_lines": "45,48", "method_info": {"method_name": "on_train_end", "method_params": "self", "method_startline": "45", "method_endline": "48", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_12": {"Ismethod": 1, "added_lines": "58", "deleted_lines": null, "method_info": {"method_name": "on_batch_end", "method_params": "self", "method_startline": "58", "method_endline": "59", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_13": {"Ismethod": 1, "added_lines": "113", "deleted_lines": "119,126", "method_info": {"method_name": "backward", "method_params": "self,trainer,Tensor,Optimizer,int", "method_startline": "113", "method_endline": "143", "method_complexity": {"method_NLOC": "29", "method_CCN": "3", "method_NToken": "59", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 37, "file_old_name": "pytorch_lightning\\core\\lightning.py", "file_new_name": "pytorch_lightning\\core\\lightning.py", "file_complexity": {"file_NLOC": "1407", "file_CCN": "56", "file_NToken": "1740"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "668,669,670", "deleted_lines": null, "method_info": {"method_name": "test_epoch_end", "method_params": "self,str,str", "method_startline": "668", "method_endline": "670", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "31", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "76", "deleted_lines": null, "method_info": {"method_name": "print", "method_params": "self,args,kwargs", "method_startline": "76", "method_endline": "92", "method_complexity": {"method_NLOC": "17", "method_CCN": "2", "method_NToken": "32", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "901,902", "deleted_lines": null, "method_info": {"method_name": "configure_optimizers", "method_params": "self", "method_startline": "901", "method_endline": "902", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "30", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "446,447,448", "deleted_lines": null, "method_info": {"method_name": "validation_epoch_end", "method_params": "self,str,str", "method_startline": "446", "method_endline": "448", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "31", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "1481,1488", "deleted_lines": null, "method_info": {"method_name": "on_save_checkpoint", "method_params": "self,str", "method_startline": "1481", "method_endline": "1501", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "971,972,973,974,975,976,977", "deleted_lines": null, "method_info": {"method_name": "optimizer_step", "method_params": "self,int,int,Optimizer,int,None", "method_startline": "971", "method_endline": "977", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "29", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "971,972,973,974,975,976,977,978,986,987,988,989,990", "deleted_lines": "945,953,954,955,956,957", "method_info": {"method_name": "optimizer_step", "method_params": "self,epoch,batch_idx,optimizer,optimizer_idx,second_order_closure", "method_startline": "945", "method_endline": "1014", "method_complexity": {"method_NLOC": "68", "method_CCN": "4", "method_NToken": "64", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "864,865,866,867,868,869,870", "deleted_lines": "846,852,853,854,855", "method_info": {"method_name": "configure_apex", "method_params": "self,amp,model,optimizers,amp_level", "method_startline": "846", "method_endline": "875", "method_complexity": {"method_NLOC": "29", "method_CCN": "1", "method_NToken": "36", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "1049,1057,1058", "deleted_lines": "1078,1102,1104", "method_info": {"method_name": "tbptt_split_batch", "method_params": "self,Tensor,int", "method_startline": "1049", "method_endline": "1109", "method_complexity": {"method_NLOC": "57", "method_CCN": "9", "method_NToken": "188", "method_nesting_level": "1"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "446,447,448,449", "deleted_lines": "438", "method_info": {"method_name": "validation_epoch_end", "method_params": "self,list", "method_startline": "438", "method_endline": "510", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "10", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "1225,1243", "deleted_lines": "1260", "method_info": {"method_name": "val_dataloader", "method_params": "self", "method_startline": "1225", "method_endline": "1289", "method_complexity": {"method_NLOC": "65", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "1"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "668,669,670,671,686", "deleted_lines": "657,672", "method_info": {"method_name": "test_epoch_end", "method_params": "self,outputs", "method_startline": "657", "method_endline": "729", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_12": {"Ismethod": 1, "added_lines": "786,794,795", "deleted_lines": "846,852,853,854,855", "method_info": {"method_name": "init_ddp_connection", "method_params": "self,int,int", "method_startline": "786", "method_endline": "862", "method_complexity": {"method_NLOC": "66", "method_CCN": "4", "method_NToken": "129", "method_nesting_level": "1"}}}, "hunk_13": {"Ismethod": 1, "added_lines": "1503", "deleted_lines": null, "method_info": {"method_name": "get_tqdm_dict", "method_params": "self", "method_startline": "1503", "method_endline": "1520", "method_complexity": {"method_NLOC": "15", "method_CCN": "4", "method_NToken": "90", "method_nesting_level": "1"}}}, "hunk_14": {"Ismethod": 1, "added_lines": "1427", "deleted_lines": null, "method_info": {"method_name": "summarize", "method_params": "self,str", "method_startline": "1427", "method_endline": "1429", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "33", "method_nesting_level": "1"}}}, "hunk_15": {"Ismethod": 1, "added_lines": "143,144", "deleted_lines": null, "method_info": {"method_name": "training_step", "method_params": "self,args,kwargs", "method_startline": "143", "method_endline": "144", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "31", "method_nesting_level": "1"}}}, "hunk_16": {"Ismethod": 1, "added_lines": "786,794,795", "deleted_lines": "768,776,777", "method_info": {"method_name": "init_ddp_connection", "method_params": "self,proc_rank,world_size", "method_startline": "768", "method_endline": "844", "method_complexity": {"method_NLOC": "66", "method_CCN": "4", "method_NToken": "123", "method_nesting_level": "1"}}}, "hunk_17": {"Ismethod": 1, "added_lines": "1431", "deleted_lines": "1432,1438", "method_info": {"method_name": "freeze", "method_params": "self", "method_startline": "1431", "method_endline": "1445", "method_complexity": {"method_NLOC": "14", "method_CCN": "2", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_18": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1398", "method_info": {"method_name": "summarize", "method_params": "self,mode", "method_startline": "1398", "method_endline": "1400", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "29", "method_nesting_level": "1"}}}, "hunk_19": {"Ismethod": 1, "added_lines": "745,746,747,748", "deleted_lines": null, "method_info": {"method_name": "configure_ddp", "method_params": "self", "method_startline": "745", "method_endline": "748", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "14", "method_nesting_level": "1"}}}, "hunk_20": {"Ismethod": 1, "added_lines": "1461,1467", "deleted_lines": "1452,1459", "method_info": {"method_name": "on_save_checkpoint", "method_params": "self,checkpoint", "method_startline": "1452", "method_endline": "1472", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "9", "method_nesting_level": "1"}}}, "hunk_21": {"Ismethod": 1, "added_lines": "1136", "deleted_lines": "1139,1152", "method_info": {"method_name": "train_dataloader", "method_params": "self", "method_startline": "1136", "method_endline": "1170", "method_complexity": {"method_NLOC": "35", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_22": {"Ismethod": 1, "added_lines": "294", "deleted_lines": "374", "method_info": {"method_name": "validation_step", "method_params": "self,args,kwargs", "method_startline": "294", "method_endline": "380", "method_complexity": {"method_NLOC": "87", "method_CCN": "1", "method_NToken": "20", "method_nesting_level": "1"}}}, "hunk_23": {"Ismethod": 1, "added_lines": "1049,1057,1058", "deleted_lines": "1016,1024,1025", "method_info": {"method_name": "tbptt_split_batch", "method_params": "self,batch,split_size", "method_startline": "1016", "method_endline": "1076", "method_complexity": {"method_NLOC": "57", "method_CCN": "9", "method_NToken": "182", "method_nesting_level": "1"}}}, "hunk_24": {"Ismethod": 1, "added_lines": "1111", "deleted_lines": null, "method_info": {"method_name": "prepare_data", "method_params": "self", "method_startline": "1111", "method_endline": "1134", "method_complexity": {"method_NLOC": "24", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_25": {"Ismethod": 1, "added_lines": "1393", "deleted_lines": "1364", "method_info": {"method_name": "_load_model_state", "method_params": "cls,checkpoint", "method_startline": "1364", "method_endline": "1396", "method_complexity": {"method_NLOC": "27", "method_CCN": "6", "method_NToken": "130", "method_nesting_level": "1"}}}, "hunk_26": {"Ismethod": 1, "added_lines": "231,232", "deleted_lines": null, "method_info": {"method_name": "training_step_end", "method_params": "self,args,kwargs", "method_startline": "231", "method_endline": "232", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "26", "method_nesting_level": "1"}}}, "hunk_27": {"Ismethod": 1, "added_lines": "1393", "deleted_lines": "1398,1402,1418", "method_info": {"method_name": "_load_model_state", "method_params": "cls,str", "method_startline": "1393", "method_endline": "1425", "method_complexity": {"method_NLOC": "27", "method_CCN": "6", "method_NToken": "139", "method_nesting_level": "1"}}}, "hunk_28": {"Ismethod": 1, "added_lines": "1447", "deleted_lines": "1432,1438", "method_info": {"method_name": "on_load_checkpoint", "method_params": "self,checkpoint", "method_startline": "1432", "method_endline": "1450", "method_complexity": {"method_NLOC": "19", "method_CCN": "1", "method_NToken": "9", "method_nesting_level": "1"}}}, "hunk_29": {"Ismethod": 1, "added_lines": "1183,1202", "deleted_lines": "1193,1195,1213", "method_info": {"method_name": "test_dataloader", "method_params": "self", "method_startline": "1183", "method_endline": "1223", "method_complexity": {"method_NLOC": "41", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "1"}}}, "hunk_30": {"Ismethod": 1, "added_lines": "382", "deleted_lines": "438", "method_info": {"method_name": "validation_step_end", "method_params": "self,args,kwargs", "method_startline": "382", "method_endline": "438", "method_complexity": {"method_NLOC": "57", "method_CCN": "1", "method_NToken": "19", "method_nesting_level": "1"}}}, "hunk_31": {"Ismethod": 1, "added_lines": "1461,1467", "deleted_lines": "1474", "method_info": {"method_name": "on_load_checkpoint", "method_params": "self,str", "method_startline": "1461", "method_endline": "1479", "method_complexity": {"method_NLOC": "19", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}, "hunk_32": {"Ismethod": 1, "added_lines": "745,746,747,748,749,759,760", "deleted_lines": "731,741,742", "method_info": {"method_name": "configure_ddp", "method_params": "self,model,device_ids", "method_startline": "731", "method_endline": "766", "method_complexity": {"method_NLOC": "36", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "1"}}}, "hunk_33": {"Ismethod": 1, "added_lines": "864,865,866,867,868,869", "deleted_lines": null, "method_info": {"method_name": "configure_apex", "method_params": "self,object,str", "method_startline": "864", "method_endline": "869", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "1"}}}, "hunk_34": {"Ismethod": 1, "added_lines": "523", "deleted_lines": "593", "method_info": {"method_name": "test_step", "method_params": "self,args,kwargs", "method_startline": "523", "method_endline": "602", "method_complexity": {"method_NLOC": "80", "method_CCN": "1", "method_NToken": "20", "method_nesting_level": "1"}}}, "hunk_35": {"Ismethod": 1, "added_lines": "1447", "deleted_lines": "1452,1459", "method_info": {"method_name": "unfreeze", "method_params": "self", "method_startline": "1447", "method_endline": "1459", "method_complexity": {"method_NLOC": "12", "method_CCN": "2", "method_NToken": "27", "method_nesting_level": "1"}}}, "hunk_36": {"Ismethod": 1, "added_lines": "604", "deleted_lines": "657", "method_info": {"method_name": "test_step_end", "method_params": "self,args,kwargs", "method_startline": "604", "method_endline": "660", "method_complexity": {"method_NLOC": "57", "method_CCN": "1", "method_NToken": "19", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 17, "file_old_name": "pytorch_lightning\\core\\memory.py", "file_new_name": "pytorch_lightning\\core\\memory.py", "file_complexity": {"file_NLOC": "239", "file_CCN": "66", "file_NToken": "1609"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "21,22", "deleted_lines": "17,18,19,20", "method_info": {"method_name": "__init__", "method_params": "self,model,mode", "method_startline": "17", "method_endline": "26", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "39", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "103,104", "deleted_lines": "115", "method_info": {"method_name": "get_layer_names", "method_params": "self", "method_startline": "103", "method_endline": "115", "method_complexity": {"method_NLOC": "11", "method_CCN": "3", "method_NToken": "78", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "276", "deleted_lines": "276", "method_info": {"method_name": "get_human_readable_count", "method_params": "number", "method_startline": "276", "method_endline": "300", "method_complexity": {"method_NLOC": "10", "method_CCN": "2", "method_NToken": "98", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "276", "deleted_lines": "276", "method_info": {"method_name": "get_human_readable_count", "method_params": "int", "method_startline": "276", "method_endline": "300", "method_complexity": {"method_NLOC": "25", "method_CCN": "2", "method_NToken": "102", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "47,48", "deleted_lines": "101", "method_info": {"method_name": "get_variable_sizes", "method_params": "self", "method_startline": "47", "method_endline": "101", "method_complexity": {"method_NLOC": "44", "method_CCN": "16", "method_NToken": "334", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "21,22", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,str", "method_startline": "21", "method_endline": "28", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "43", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "36", "deleted_lines": "45", "method_info": {"method_name": "named_modules", "method_params": "self", "method_startline": "36", "method_endline": "45", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "68", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "117,118", "deleted_lines": "126", "method_info": {"method_name": "get_parameter_sizes", "method_params": "self", "method_startline": "117", "method_endline": "126", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "65", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "128,129", "deleted_lines": "136", "method_info": {"method_name": "get_parameter_nums", "method_params": "self", "method_startline": "128", "method_endline": "136", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "46", "method_nesting_level": "1"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "163,164,168", "deleted_lines": "163,167", "method_info": {"method_name": "_format_summary_table", "method_params": "cols", "method_startline": "163", "method_endline": "205", "method_complexity": {"method_NLOC": "34", "method_CCN": "11", "method_NToken": "331", "method_nesting_level": "0"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "153", "deleted_lines": null, "method_info": {"method_name": "summarize", "method_params": "self", "method_startline": "153", "method_endline": "160", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "42", "method_nesting_level": "1"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "253,256,257,258", "deleted_lines": "254,255,256,257,258", "method_info": {"method_name": "get_gpu_memory_map", "method_params": "", "method_startline": "253", "method_endline": "273", "method_complexity": {"method_NLOC": "19", "method_CCN": "3", "method_NToken": "87", "method_nesting_level": "0"}}}, "hunk_12": {"Ismethod": 1, "added_lines": "208", "deleted_lines": null, "method_info": {"method_name": "print_mem_stack", "method_params": "", "method_startline": "208", "method_endline": "214", "method_complexity": {"method_NLOC": "7", "method_CCN": "6", "method_NToken": "62", "method_nesting_level": "0"}}}, "hunk_13": {"Ismethod": 1, "added_lines": "138,139,143", "deleted_lines": "141,150", "method_info": {"method_name": "make_summary", "method_params": "self", "method_startline": "138", "method_endline": "151", "method_complexity": {"method_NLOC": "13", "method_CCN": "2", "method_NToken": "86", "method_nesting_level": "1"}}}, "hunk_14": {"Ismethod": 1, "added_lines": "234,235,236,237,238,239", "deleted_lines": "233,234,235,236,237", "method_info": {"method_name": "get_memory_profile", "method_params": "mode", "method_startline": "233", "method_endline": "248", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "73", "method_nesting_level": "0"}}}, "hunk_15": {"Ismethod": 1, "added_lines": "234,235,236,237,238,239", "deleted_lines": "234,235,236,237", "method_info": {"method_name": "get_memory_profile", "method_params": "str", "method_startline": "234", "method_endline": "250", "method_complexity": {"method_NLOC": "14", "method_CCN": "2", "method_NToken": "92", "method_nesting_level": "0"}}}, "hunk_16": {"Ismethod": 1, "added_lines": "217", "deleted_lines": null, "method_info": {"method_name": "count_mem_items", "method_params": "", "method_startline": "217", "method_endline": "231", "method_complexity": {"method_NLOC": "14", "method_CCN": "7", "method_NToken": "84", "method_nesting_level": "0"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 12, "file_old_name": "pytorch_lightning\\core\\saving.py", "file_new_name": "pytorch_lightning\\core\\saving.py", "file_complexity": {"file_NLOC": "48", "file_CCN": "13", "file_NToken": "262"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "18", "deleted_lines": null, "method_info": {"method_name": "on_save_checkpoint", "method_params": "self,str", "method_startline": "18", "method_endline": "22", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "39", "method_info": {"method_name": "load_hparams_from_tags_csv", "method_params": "tags_csv", "method_startline": "39", "method_endline": "48", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "85", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "18", "deleted_lines": "17", "method_info": {"method_name": "on_save_checkpoint", "method_params": "self,checkpoint", "method_startline": "17", "method_endline": "21", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "50", "deleted_lines": "51", "method_info": {"method_name": "convert", "method_params": "str", "method_startline": "50", "method_endline": "64", "method_complexity": {"method_NLOC": "13", "method_CCN": "6", "method_NToken": "75", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "27", "deleted_lines": "26,29", "method_info": {"method_name": "on_hpc_save", "method_params": "self,checkpoint", "method_startline": "26", "method_endline": "30", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "27", "deleted_lines": "29", "method_info": {"method_name": "on_hpc_save", "method_params": "self,str", "method_startline": "27", "method_endline": "30", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "32", "deleted_lines": "32,35", "method_info": {"method_name": "on_hpc_load", "method_params": "self,checkpoint", "method_startline": "32", "method_endline": "36", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "10", "deleted_lines": "9", "method_info": {"method_name": "on_load_checkpoint", "method_params": "self,checkpoint", "method_startline": "9", "method_endline": "15", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": null, "deleted_lines": "51", "method_info": {"method_name": "convert", "method_params": "val", "method_startline": "51", "method_endline": "65", "method_complexity": {"method_NLOC": "13", "method_CCN": "6", "method_NToken": "62", "method_nesting_level": "0"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "32", "deleted_lines": "32,35", "method_info": {"method_name": "on_hpc_load", "method_params": "self,str", "method_startline": "32", "method_endline": "35", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "10", "deleted_lines": null, "method_info": {"method_name": "on_load_checkpoint", "method_params": "self,str", "method_startline": "10", "method_endline": "16", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "1"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "38", "deleted_lines": "39", "method_info": {"method_name": "load_hparams_from_tags_csv", "method_params": "str", "method_startline": "38", "method_endline": "47", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "87", "method_nesting_level": "0"}}}}}}}}