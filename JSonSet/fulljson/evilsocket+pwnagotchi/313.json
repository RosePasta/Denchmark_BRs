{"BR": {"BR_id": "313", "BR_author": "wy4h5evs4eve4s", "BRopenT": "2019-10-16T21:42:32Z", "BRcloseT": "2019-10-17T11:42:12Z", "BR_text": {"BRsummary": "[BUG] _reboot() doesn't work", "BRdescription": "\n Describe the bug\n The _reboot(self) method of the agent calls:\n <denchmark-code>        os.system(\"/usr/bin/sync\")\n         os.system(\"/usr/sbin/shutdown -r now\")\n </denchmark-code>\n \n On my pwnagotchi 1.0.0RC4 these binaries do not exist, but I have /bin/sync and /sbin/shutdown instead.\n As a result, automatic reboot after N epochs of inactivity just doesn't work.\n To Reproduce\n Steps to reproduce the behavior:\n \n Install 1.0.0RC4 on a RPi0\n Leave it running untile the nexmon blindness bug kicks in\n The log will eventually say:\n \n <denchmark-code>[CRITICAL] 10 epochs without visible access points -> rebooting \n [WARNING] writing recovery data to /root/.pwnagotchi-recovery \n [WARNING] rebooting the system ...\n </denchmark-code>\n \n \n Nothing happens\n \n Expected behavior\n I'd expect the proper commands to get called and the board to reboot.\n Environment (please complete the following information):\n \n Pwnagotchi version: 1.0.0RC4\n OS version: pwnagotchi release image v1.0.0RC4\n Type of hardware: RPi0\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "wy4h5evs4eve4s", "commentT": "2019-10-17T08:59:55Z", "comment_text": "\n \t\tI suggest to add a function like this:\n \n \n \n pwnagotchi/pwnagotchi/__init__.py\n \n \n          Line 60\n       in\n       e15d0f3\n \n \n \n \n \n \n  def shutdown(): \n \n \n \n \n \n in the main init file\n \t\t"}}}, "commit": {"commit_id": "79688305fd69af7ed5694b72e34f8ff9264e4206", "commit_author": "Simone Margaritelli", "commitT": "2019-10-17 13:42:05+02:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pwnagotchi\\__init__.py", "file_new_name": "pwnagotchi\\__init__.py", "file_complexity": {"file_NLOC": "55", "file_CCN": "14", "file_NToken": "379"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "70,71,72,73", "deleted_lines": null, "method_info": {"method_name": "reboot", "method_params": "", "method_startline": "70", "method_endline": "73", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pwnagotchi\\agent.py", "file_new_name": "pwnagotchi\\agent.py", "file_complexity": {"file_NLOC": "402", "file_CCN": "130", "file_NToken": "3264"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "484", "deleted_lines": "484", "method_info": {"method_name": "_reboot", "method_params": "self", "method_startline": "481", "method_endline": "484", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "20", "method_nesting_level": "1"}}}}}}}}