{"BR": {"BR_id": "643", "BR_author": "miotislucifugis", "BRopenT": "2019-11-22T00:57:34Z", "BRcloseT": "2019-11-23T10:30:29Z", "BR_text": {"BRsummary": "webcfg is adding single quotes [BUG]", "BRdescription": "\n Describe the bug\n Everytime I save on webcfg, single quotes are added around the gpio pin number definitions under the gpio_button plugin- thus breaking their functionality.   It only seems to be happening with the gpio entries; no other entries in my config seem to be getting this treatment.  I can manually delete the quotes the old fashioned way and it will work again... until I use webcfg to make any changes.  It seems to do it with any change/save, I wasnt doing anything to gpio_button.   i was configuring GPS settings.\n before:\n    gpio_buttons: enabled: true gpios: 20: sudo touch /root/.pwnagotchi-auto && sudo systemctl restart pwnagotchi 21: shutdown -h now\n After saving with webcfg:\n    gpio_buttons: enabled: true gpios: '20': sudo touch /root/.pwnagotchi-auto && sudo systemctl restart pwnagotchi '21': shutdown -h now\n Ive deleted the whole entry and copied/pasted it from default.yml with the same results, so im fairly certain it is not formatting/spacing  errors in my config.yml.\n To Reproduce\n Steps to reproduce the behavior:\n \n Used nano to delete quotes around gpio pin #s in config.yml\n Reboot and test- GPIO buttons work.\n Change a setting in webcfg( any setting), save, reboot\n test again.  GPIO buttons do not work.\n Use Nano to check config.yml\n Quotes have been added around pin #s.   delete them, save, reboot\n test again.  GPIOs now work.\n 8 repeat....\n \n Expected behavior\n Webcfg should not be adding quotes around the gpio pin numbers the pwnagotchi boots and works fine without them.\n Screenshots\n If applicable, add screenshots to help explain your problem.\n Environment (please complete the following information):\n \n Pwnagotchi version 1.3.0\n waveshare v2\n -ups-lite\n macos using firefox for the web browser\n \n Also see <denchmark-link:url>https://github.com/evilsocket/pwnagotchi/issues/631</denchmark-link>\n   which i opened and closed yesterday because i thought it was user error.   Apparently not, as I can repeated get it to \"break\" again with a webcfg save .\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "miotislucifugis", "commentT": "2019-11-22T11:27:00Z", "comment_text": "\n \t\thi, looks like an bug in the gpio plugin.\n can you test this:\n add a line after <denchmark-link:https://github.com/evilsocket/pwnagotchi/blob/master/pwnagotchi/plugins/default/gpio_buttons.py#L34>https://github.com/evilsocket/pwnagotchi/blob/master/pwnagotchi/plugins/default/gpio_buttons.py#L34</denchmark-link>\n \n <denchmark-code>old:\n         for gpio, command in gpios.items():\n             self.ports[gpio] = command\n \n new:\n         for gpio, command in gpios.items():\n             gpio = int(gpio)\n             self.ports[gpio] = command\n </denchmark-code>\n \n and test it with quoted gpio numbers?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "miotislucifugis", "commentT": "2019-11-22T21:05:31Z", "comment_text": "\n \t\tAdding that line does the trick!  Everything works perfectly even with single quotes.  Thanks\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "miotislucifugis", "commentT": "2019-11-23T01:10:17Z", "comment_text": "\n \t\tthanks for testing!\n \t\t"}}}, "commit": {"commit_id": "83f741bbb0713bbb541dc4390bd08c9b5069d772", "commit_author": "xenDE", "commitT": "2019-11-23 02:05:01+01:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pwnagotchi\\plugins\\default\\gpio_buttons.py", "file_new_name": "pwnagotchi\\plugins\\default\\gpio_buttons.py", "file_complexity": {"file_NLOC": "29", "file_CCN": "4", "file_NToken": "216"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "35", "deleted_lines": null, "method_info": {"method_name": "on_loaded", "method_params": "self", "method_startline": "25", "method_endline": "39", "method_complexity": {"method_NLOC": "10", "method_CCN": "2", "method_NToken": "96", "method_nesting_level": "1"}}}}}}}}