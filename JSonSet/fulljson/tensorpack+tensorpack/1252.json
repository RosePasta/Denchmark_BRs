{"BR": {"BR_id": "1252", "BR_author": "elmirador", "BRopenT": "2019-07-03T14:38:47Z", "BRcloseT": "2019-07-03T16:18:59Z", "BR_text": {"BRsummary": "Nested argscopes behave weird", "BRdescription": "\n I'm using tensorpack 0.9.4. It seems like argscope behaves weird when nested.\n <denchmark-code>from tensorpack.tfutils import argscope, get_arg_scope\n from tensorpack.models import BatchNorm\n \n with argscope(BatchNorm, data_format='NCHW', epsilon=1e-5):\n     print (get_arg_scope())\n     with argscope(BatchNorm, training=False, epsilon=1e-3):\n         print (get_arg_scope())\n     print (get_arg_scope())\n </denchmark-code>\n \n Result:\n <denchmark-code>defaultdict(<class 'dict'>, {'BatchNorm': {'data_format': 'NCHW', 'epsilon': 1e-05}})\n defaultdict(<class 'dict'>, {'BatchNorm': {'data_format': 'NCHW', 'epsilon': 0.001, 'training': False}})\n defaultdict(<class 'dict'>, {'BatchNorm': {'data_format': 'NCHW', 'epsilon': 0.001, 'training': False}})\n </denchmark-code>\n \n The third output should be the same as the first.\n I believe the reason is here: <denchmark-link:https://github.com/tensorpack/tensorpack/blob/master/tensorpack/tfutils/argscope.py#L52>https://github.com/tensorpack/tensorpack/blob/master/tensorpack/tfutils/argscope.py#L52</denchmark-link>\n \n It should be deepcopy instead of copy.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "elmirador", "commentT": "2019-07-03T16:03:39Z", "comment_text": "\n \t\tThanks a lot for finding this!\n \t\t"}}}, "commit": {"commit_id": "bf6402add61cebad61e251229610755357fb0a2b", "commit_author": "Yuxin Wu", "commitT": "2019-07-03 09:18:41-07:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\tutorial\\philosophy\\dataflow.md", "file_new_name": "docs\\tutorial\\philosophy\\dataflow.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "164", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorpack\\tfutils\\argscope.py", "file_new_name": "tensorpack\\tfutils\\argscope.py", "file_complexity": {"file_NLOC": "58", "file_CCN": "18", "file_NToken": "396"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "52,53", "deleted_lines": "52", "method_info": {"method_name": "argscope", "method_params": "layers,kwargs", "method_startline": "22", "method_endline": "58", "method_complexity": {"method_NLOC": "11", "method_CCN": "4", "method_NToken": "83", "method_nesting_level": "0"}}}}}}}}