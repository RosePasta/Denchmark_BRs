{"BR": {"BR_id": "383", "BR_author": "gatordevin", "BRopenT": "2020-11-27T04:58:56Z", "BRcloseT": "2021-01-22T23:00:16Z", "BR_text": {"BRsummary": "Possible NDArray Splicing Bug", "BRdescription": "\n Hey all. I may have encountered an issue with NDIndex splicing of NDArrays when using splice increments.\n Exception in thread \"main\" ai.djl.engine.EngineException: MXNet engine call failed: MXNetError: Check failed: src.Size() == dst->Size() (3 vs. 2) : Cannot reshape array of size 3 into shape [1,2]\n <denchmark-code>NDManager manager = NDManager.newBaseManager();\n NDArray targetBox = manager.ones(new Shape(1, 5));\n targetBox.set(new NDIndex(\":, 0::2\"), array -> array.mul(-1).add(1));\n </denchmark-code>\n \n Code to reproduce the error is shown above. If one of the lines is changed to the following it works as expected with no issues. Splicing could be running too far off the array so the size is different but I am not sure.\n targetBox.set(new NDIndex(\":, 1::2\"), array -> array.mul(-1).add(1));\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "gatordevin", "commentT": "2020-12-01T22:08:25Z", "comment_text": "\n \t\tCan you provide the corresponding numpy behavior if you would like to do something similar? <denchmark-link:https://github.com/zachgk>@zachgk</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "gatordevin", "commentT": "2020-12-03T18:04:17Z", "comment_text": "\n \t\tI can't find similar numpy function that do the same thing. The closest one is\n <denchmark-code>a = np.ones((1,5))\n a[:,0::2] *= -1\n a[:,0::2] += 1\n </denchmark-code>\n \n The error is from \n . <denchmark-link:https://github.com/zachgk>@zachgk</denchmark-link>\n  Could you take a look at set method?\n \t\t"}}}, "commit": {"commit_id": "4ccf3206975a2bf253fa436a8608b12481904bf5", "commit_author": "Zach Kimberg", "commitT": "2021-01-22 15:00:15-08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "api\\src\\main\\java\\ai\\djl\\ndarray\\index\\full\\NDIndexFullSlice.java", "file_new_name": "api\\src\\main\\java\\ai\\djl\\ndarray\\index\\full\\NDIndexFullSlice.java", "file_complexity": {"file_NLOC": "160", "file_CCN": "30", "file_NToken": "1265"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "160", "deleted_lines": "160", "method_info": {"method_name": "NDIndexFullSlice::addSliceInfo", "method_params": "ie,i,target,min,max,step,toSqueeze,shape,squeezedShape", "method_startline": "135", "method_endline": "165", "method_complexity": {"method_NLOC": "31", "method_CCN": "7", "method_NToken": "332", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "integration\\src\\main\\java\\ai\\djl\\integration\\tests\\ndarray\\NDIndexTest.java", "file_new_name": "integration\\src\\main\\java\\ai\\djl\\integration\\tests\\ndarray\\NDIndexTest.java", "file_complexity": {"file_NLOC": "146", "file_CCN": "10", "file_NToken": "1746"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "176,177,178,179,180,181,182,183", "deleted_lines": null, "method_info": {"method_name": "NDIndexTest::testSetByFunctionIncrements", "method_params": "", "method_startline": "176", "method_endline": "183", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "97", "method_nesting_level": "1"}}}}}}}}