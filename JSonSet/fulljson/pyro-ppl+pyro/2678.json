{"BR": {"BR_id": "2678", "BR_author": "sky660099", "BRopenT": "2020-10-21T08:44:50Z", "BRcloseT": "2020-10-22T21:04:47Z", "BR_text": {"BRsummary": "Elbo.compute_marginals throws an error for basic model", "BRdescription": "\n As <denchmark-link:https://github.com/bart>@bart</denchmark-link>\n  mentioned in this forum question :\n <denchmark-link:https://forum.pyro.ai/t/elbo-compute-marginals-throws-an-error-for-basic-model/2245>https://forum.pyro.ai/t/elbo-compute-marginals-throws-an-error-for-basic-model/2245</denchmark-link>\n \n When observed variables has no enumerated ancestors, this error of compute_marginals will arise:\n \"ValueError: Number of einsum subscripts must be equal to the number of operands.\"\n Now this error can be fixed by adding a dummy upstream discrete node, but a formal fix is needed.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "sky660099", "commentT": "2020-10-22T13:58:17Z", "comment_text": "\n \t\tcopying the minimum working example from the forum:\n \n @config_enumerate()\n def model(a=None, b=None):\n     a = sample(\"a\", dist.Bernoulli(0.75), obs=a)\n     p = 1-0.25*a\n     b = sample(\"b\", dist.Bernoulli(p), obs=b)\n \n elbo = pyro.infer.TraceEnum_ELBO()\n \n # This works.\n elbo.compute_marginals(model, guide, b=tt(1.))\n \n # These fail.\n elbo.compute_marginals(model, guide, a=tt(1.))\n elbo.compute_marginals(model, guide)\n \n \t\t"}}}, "commit": {"commit_id": "c8eece3397871258f664943a78d4fec8753c51ef", "commit_author": "Fritz Obermeyer", "commitT": "2020-10-22 14:04:46-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pyro\\infer\\traceenum_elbo.py", "file_new_name": "pyro\\infer\\traceenum_elbo.py", "file_complexity": {"file_NLOC": "365", "file_CCN": "118", "file_NToken": "2873"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "136,137,138,139,140,141,142", "deleted_lines": "136,137,138,139,140,141,142,143", "method_info": {"method_name": "_compute_model_factors", "method_params": "model_trace,guide_trace", "method_startline": "87", "method_endline": "143", "method_complexity": {"method_NLOC": "47", "method_CCN": "17", "method_NToken": "464", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tests\\infer\\test_enum.py", "file_new_name": "tests\\infer\\test_enum.py", "file_complexity": {"file_NLOC": "2720", "file_CCN": "393", "file_NToken": "31677"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "3078,3079,3080,3081,3082,3083,3084,3085,3086,3087,3088,3089,3090", "deleted_lines": null, "method_info": {"method_name": "test_marginals_2678", "method_params": "observed", "method_startline": "3078", "method_endline": "3090", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "47", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "3081,3082,3083", "deleted_lines": null, "method_info": {"method_name": "test_marginals_2678.model", "method_params": "a,b", "method_startline": "3081", "method_endline": "3083", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "55", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "3085,3086", "deleted_lines": null, "method_info": {"method_name": "test_marginals_2678.guide", "method_params": "a,b", "method_startline": "3085", "method_endline": "3086", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "12", "method_nesting_level": "1"}}}}}}}}