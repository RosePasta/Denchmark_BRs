{"BR": {"BR_id": "862", "BR_author": "tobyclh", "BRopenT": "2018-03-07T23:08:34Z", "BRcloseT": "2018-03-15T17:55:10Z", "BR_text": {"BRsummary": "Broadcasting issue with Gaussian Process", "BRdescription": "\n I was trying to fit some 2D data with Gaussian Process.\n During the training at multivariate normal, calculating log prob fails as broadcast doesn't work.\n adding unsqueeze followed by expand_as and diag seems to fix the issue.\n Code to reproduced\n #%%\n import torch\n import pyro\n from pyro.contrib.gp.kernels import RBF\n from pyro.contrib.gp.models import GPRegression\n import pyro.distributions as dist\n from pyro.infer import SVI\n from pyro.optim import Adam\n from pyro.util import ng_ones, ng_zeros\n \n pyro.set_rng_seed(0)\n \n N = [20, 500]\n X = dist.Uniform(ng_zeros(N), ng_ones(N)*5).sample()\n y = 0.5 * torch.sin(3*X) + dist.Normal(ng_zeros(N), ng_ones(N)*0.5).sample()\n \n kernel = RBF(input_dim=500, variance=torch.Tensor([10]), lengthscale=torch.Tensor([10]))\n gpr = GPRegression(X, y, kernel, noise=torch.Tensor([1]))\n \n \n optim = Adam({\"lr\": 0.001})\n svi = SVI(gpr.model, gpr.guide, optim, loss=\"ELBO\")\n losses = []\n num_steps = 1000\n for i in range(num_steps):\n     losses.append(svi.step())\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "tobyclh", "commentT": "2018-03-08T00:20:36Z", "comment_text": "\n \t\tHi, what version of Pyro and PyTorch are you using?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "tobyclh", "commentT": "2018-03-08T00:47:30Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/tobyclh>@tobyclh</denchmark-link>\n  Right now, GP does not support multidimensional output yet. I intend to implement it this weekend (<denchmark-link:https://github.com/pyro-ppl/pyro/issues/832>#832</denchmark-link>\n ) but it seems that you already solve this problem. Would you mind making a pull request for it? :)\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "tobyclh", "commentT": "2018-03-08T22:15:19Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/eb8680>@eb8680</denchmark-link>\n \n master, dev branch of pytorch and pyro!\n <denchmark-link:https://github.com/fehiepsi>@fehiepsi</denchmark-link>\n \n I made a PR and tested it but I can't seems to get the pyro test system working so it would be nice if you can let me know whether it passes those tests (those tests fails even on dev branch for some reason)\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "tobyclh", "commentT": "2018-11-12T18:10:22Z", "comment_text": "\n \t\tfrom pyro.util import ng_ones, ng_zeros\n ImportError: cannot import name 'ng_ones'\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "tobyclh", "commentT": "2018-11-12T18:32:30Z", "comment_text": "\n \t\t@SINDHUKUMARIP this code snippet is now outdated and  and  no longer exist in Pyro 0.2.1.  Please see the GP tutorial instead for up-to-date examples of GP usage: <denchmark-link:http://pyro.ai/examples/gp.html>http://pyro.ai/examples/gp.html</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "e8a72c9ff7e1128693da907a502007bf5ee364cf", "commit_author": "Du Phan", "commitT": "2018-03-15 10:55:09-07:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "0.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "Makefile", "file_new_name": "Makefile", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "8", "deleted_lines": "8"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "pyro\\contrib\\gp\\models\\gpr.py", "file_new_name": "pyro\\contrib\\gp\\models\\gpr.py", "file_complexity": {"file_NLOC": "82", "file_CCN": "10", "file_NToken": "570"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "30", "deleted_lines": "30,31,33", "method_info": {"method_name": "__init__", "method_params": "self,X,y,kernel,noise", "method_startline": "28", "method_endline": "36", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "75", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "44,45,46,47,48,49", "deleted_lines": "46,47,48", "method_info": {"method_name": "model", "method_params": "self", "method_startline": "38", "method_endline": "49", "method_complexity": {"method_NLOC": "9", "method_CCN": "2", "method_NToken": "124", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "60,61,62,63,64,77,81,82,84,86", "deleted_lines": "59,60,61,74,78,80,82", "method_info": {"method_name": "forward", "method_params": "self,Xnew,full_cov,noiseless", "method_startline": "59", "method_endline": "105", "method_complexity": {"method_NLOC": "38", "method_CCN": "5", "method_NToken": "289", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "pyro\\contrib\\gp\\models\\model.py", "file_new_name": "pyro\\contrib\\gp\\models\\model.py", "file_complexity": {"file_NLOC": "46", "file_CCN": "15", "file_NToken": "301"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "16,17,18,19,20,21,22,23,24,25,26,27,28,29", "deleted_lines": null, "method_info": {"method_name": "set_data", "method_params": "self,X,y", "method_startline": "16", "method_endline": "29", "method_complexity": {"method_NLOC": "8", "method_CCN": "4", "method_NToken": "80", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59", "deleted_lines": null, "method_info": {"method_name": "optimize", "method_params": "self,optimizer", "method_startline": "43", "method_endline": "59", "method_complexity": {"method_NLOC": "17", "method_CCN": "3", "method_NToken": "74", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "pyro\\contrib\\gp\\models\\sgpr.py", "file_new_name": "pyro\\contrib\\gp\\models\\sgpr.py", "file_complexity": {"file_NLOC": "130", "file_CCN": "16", "file_NToken": "942"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "68,74,86,87,88,92,93", "deleted_lines": "63,72,78,90", "method_info": {"method_name": "model", "method_params": "self", "method_startline": "61", "method_endline": "93", "method_complexity": {"method_NLOC": "22", "method_CCN": "5", "method_NToken": "250", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "105,106,107,108,109,121,134,142,150,151,152,153,154", "deleted_lines": "106,107,108,120,133,141,146,150", "method_info": {"method_name": "forward", "method_params": "self,Xnew,full_cov,noiseless", "method_startline": "104", "method_endline": "171", "method_complexity": {"method_NLOC": "51", "method_CCN": "6", "method_NToken": "457", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "42,59", "deleted_lines": "42,43,45,46,48", "method_info": {"method_name": "__init__", "method_params": "self,X,y,kernel,Xu,noise,approx,jitter", "method_startline": "40", "method_endline": "59", "method_complexity": {"method_NLOC": "17", "method_CCN": "4", "method_NToken": "143", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "pyro\\contrib\\gp\\models\\svgp.py", "file_new_name": "pyro\\contrib\\gp\\models\\svgp.py", "file_complexity": {"file_NLOC": "80", "file_CCN": "9", "file_NToken": "767"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "104,105,106,107,111,112,120", "deleted_lines": "106", "method_info": {"method_name": "forward", "method_params": "self,Xnew,full_cov", "method_startline": "101", "method_endline": "120", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "42,46,47,48,49,51,52,56,57,59,60,62,63,64,70,71", "deleted_lines": "35,44,48,50,54,56,57,59,65,66", "method_info": {"method_name": "model", "method_params": "self", "method_startline": "35", "method_endline": "71", "method_complexity": {"method_NLOC": "26", "method_CCN": "4", "method_NToken": "342", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "33,35", "method_info": {"method_name": "__init__", "method_params": "self,X,y,kernel,Xu,likelihood,jitter", "method_startline": "31", "method_endline": "35", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "60", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "81,82,83,84,85,86,88,94,95,96,97,98", "deleted_lines": "76,78,84,85,91,92,96,97,98", "method_info": {"method_name": "guide", "method_params": "self", "method_startline": "73", "method_endline": "99", "method_complexity": {"method_NLOC": "21", "method_CCN": "3", "method_NToken": "260", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "pyro\\contrib\\gp\\models\\vgp.py", "file_new_name": "pyro\\contrib\\gp\\models\\vgp.py", "file_complexity": {"file_NLOC": "80", "file_CCN": "9", "file_NToken": "795"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "105,109,110,112,113,114", "deleted_lines": "95,96,102,103,107,109,110,111", "method_info": {"method_name": "_predict_f", "method_params": "self,Xnew,X,kernel,mf,Lf,full_cov", "method_startline": "93", "method_endline": "132", "method_complexity": {"method_NLOC": "23", "method_CCN": "3", "method_NToken": "284", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "28", "deleted_lines": "28,29", "method_info": {"method_name": "__init__", "method_params": "self,X,y,kernel,likelihood,jitter", "method_startline": "26", "method_endline": "32", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "63", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "75,76,77,78,82,83,91", "deleted_lines": "72,76,77,78,86", "method_info": {"method_name": "forward", "method_params": "self,Xnew,full_cov", "method_startline": "72", "method_endline": "91", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "40,41,42,43,45,46,47", "deleted_lines": "34,43,44,46,47", "method_info": {"method_name": "model", "method_params": "self", "method_startline": "34", "method_endline": "47", "method_complexity": {"method_NLOC": "10", "method_CCN": "2", "method_NToken": "129", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "56,57,59,65,66,67,68,69", "deleted_lines": "56,58,64,65", "method_info": {"method_name": "guide", "method_params": "self", "method_startline": "49", "method_endline": "70", "method_complexity": {"method_NLOC": "16", "method_CCN": "2", "method_NToken": "207", "method_nesting_level": "1"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "pyro\\distributions\\sparse_multivariate_normal.py", "file_new_name": "pyro\\distributions\\sparse_multivariate_normal.py", "file_complexity": {"file_NLOC": "93", "file_CCN": "16", "file_NToken": "721"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "108,109,110", "deleted_lines": null, "method_info": {"method_name": "_compute_logdet_and_mahalanobis", "method_params": "self,D,W,y,trace_term", "method_startline": "90", "method_endline": "121", "method_complexity": {"method_NLOC": "21", "method_CCN": "4", "method_NToken": "221", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "40,45,46,47", "deleted_lines": "40,45,46", "method_info": {"method_name": "__init__", "method_params": "self,loc,D_term,W_term,trace_term", "method_startline": "39", "method_endline": "55", "method_complexity": {"method_NLOC": "15", "method_CCN": "7", "method_NToken": "163", "method_nesting_level": "1"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pyro\\infer\\svi.py", "file_new_name": "pyro\\infer\\svi.py", "file_complexity": {"file_NLOC": "62", "file_CCN": "6", "file_NToken": "360"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "72", "deleted_lines": "72", "method_info": {"method_name": "__call__", "method_params": "self,args,kwargs", "method_startline": "69", "method_endline": "76", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "1"}}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\contrib\\gp\\test_kernels.py", "file_new_name": "tests\\contrib\\gp\\test_kernels.py", "file_complexity": {"file_NLOC": "112", "file_CCN": "8", "file_NToken": "1129"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "13", "deleted_lines": "13"}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "tests\\contrib\\gp\\test_models.py", "file_new_name": "tests\\contrib\\gp\\test_models.py", "file_complexity": {"file_NLOC": "82", "file_CCN": "8", "file_NToken": "656"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89", "deleted_lines": "63,64,65,66,67,68,69,70,71,72,73,74,75", "method_info": {"method_name": "test_model_forward", "method_params": "model_class,X,y,kernel,likelihood", "method_startline": "63", "method_endline": "89", "method_complexity": {"method_NLOC": "22", "method_CCN": "5", "method_NToken": "236", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "93,94,95,96,97,98,99", "deleted_lines": null, "method_info": {"method_name": "test_inference", "method_params": "model_class,X,y,kernel,likelihood", "method_startline": "93", "method_endline": "99", "method_complexity": {"method_NLOC": "6", "method_CCN": "3", "method_NToken": "58", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50", "deleted_lines": "31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50", "method_info": {"method_name": "test_forward_sgpr", "method_params": "", "method_startline": "31", "method_endline": "50", "method_complexity": {"method_NLOC": "16", "method_CCN": "1", "method_NToken": "185", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "10,11,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28", "deleted_lines": "10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28", "method_info": {"method_name": "test_forward_gpr", "method_params": "", "method_startline": "10", "method_endline": "28", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "178", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75", "deleted_lines": "53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75", "method_info": {"method_name": "test_forward_sgpr_vs_gpr", "method_params": "", "method_startline": "53", "method_endline": "75", "method_complexity": {"method_NLOC": "19", "method_CCN": "1", "method_NToken": "243", "method_nesting_level": "0"}}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tutorial\\source\\gp.ipynb", "file_new_name": "tutorial\\source\\gp.ipynb", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "79,85,86,87,91,92,97,136,138,162,163,173,175,215,224,226,245,247,271,275,276,277,278,279,287,305,307,327,329,349,351,391,393,423,425,450,452,484,485,486,487,488,495,516,518,575,587,588,589,590,591,597,599,608,641,643", "deleted_lines": "79,85,86,90,91,92,93,98,137,139,163,164,174,176,216,225,227,246,248,272,273,274,275,276,280,288,307,328,349,389,391,421,423,448,450,480,481,482,483,486,493,514,516,573,574,575,576,577,589,595,597,606,639,641"}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tutorial\\source\\vae.ipynb", "file_new_name": "tutorial\\source\\vae.ipynb", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "190", "deleted_lines": "190,191,192"}}}}}}