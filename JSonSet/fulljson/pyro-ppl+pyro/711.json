{"BR": {"BR_id": "711", "BR_author": "neerajprad", "BRopenT": "2018-01-26T03:46:17Z", "BRcloseT": "2018-02-23T20:01:46Z", "BR_text": {"BRsummary": "DMM example returns NAN on Pyro dev", "BRdescription": "\n While refactoring to move to PyTorch distributions, I noticed that the dmm.py example has been throwing warnings after one epoch when it starts encountering NANs at multiple sites.\n This is on the current  branch with Pytorch . <denchmark-link:https://github.com/martinjankowiak>@martinjankowiak</denchmark-link>\n  - Could you help take a look at what's happening?\n \n /Users/npradhan/miniconda2/envs/pytorch/bin/python /Users/npradhan/workspace/pyro_dev/pyro/examples/dmm/dmm.py\n Namespace(annealing_epochs=1000, beta1=0.96, beta2=0.999, checkpoint_freq=0, clip_norm=20.0, cuda=False, iaf_dim=100, learning_rate=0.0004, load_model='', load_opt='', log='dmm.log', lr_decay=0.99996, mini_batch_size=20, minimum_annealing_factor=0.1, num_epochs=5000, num_iafs=0, rnn_dropout_rate=0.1, save_model='', save_opt='', weight_decay=0.6)\n N_train_data: 229     avg. training seq. length: 60.29    N_mini_batches: 12\n [training epoch 0000]  61.6189 \t\t\t\t(dt = 16.419 sec)\n /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_70'\n   warnings.warn(\"Encountered NAN log_pdf at site '{}'\".format(name))\n /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_71'\n   warnings.warn(\"Encountered NAN log_pdf at site '{}'\".format(name))\n /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_73'\n   warnings.warn(\"Encountered NAN log_pdf at site '{}'\".format(name))\n /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_74'\n   warnings.warn(\"Encountered NAN log_pdf at site '{}'\".format(name))\n /Users/npradhan/workspace/pyro_dev/pyro/pyro/poutine/trace.py:13: UserWarning: Encountered NAN log_pdf at site 'z_75'\n \n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "neerajprad", "commentT": "2018-02-22T15:15:44Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/neerajprad>@neerajprad</denchmark-link>\n  Could you please check again if this is still an issue? The script runs well to me. I use Pytorch commit . FYI I got NaN at log_pdf many times due to parameters of some distributions get wrong values (for example: sigma < 0 for normal distribution). Maybe there are some bugs at distributions at the time you faced this problem.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "neerajprad", "commentT": "2018-02-23T20:01:46Z", "comment_text": "\n \t\tClosing as resolved, we can reopen if it happens again\n \t\t"}}}, "commit": {"commit_id": "8db897244589e95e2cc6917d4613267a077cdb6c", "commit_author": "Neeraj Pradhan", "commitT": "2018-01-31 17:31:30-08:00", "commit_complexity": {"commit_NLOC": "0.5", "commit_CCN": "0.5", "commit_Nprams": "0.5"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "pyro\\distributions\\transformed_distribution.py", "file_new_name": "pyro\\distributions\\transformed_distribution.py", "file_complexity": {"file_NLOC": "160", "file_CCN": "27", "file_NToken": "938"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "58,59", "deleted_lines": "58", "method_info": {"method_name": "shape", "method_params": "self,args,kwargs", "method_startline": "58", "method_endline": "59", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "61", "deleted_lines": null, "method_info": {"method_name": "batch_shape", "method_params": "self,args,kwargs", "method_startline": "61", "method_endline": "62", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "24", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "58,59", "deleted_lines": "58", "method_info": {"method_name": "batch_shape", "method_params": "self,x,args,kwargs", "method_startline": "58", "method_endline": "59", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "248", "deleted_lines": "245", "method_info": {"method_name": "batch_log_det_jacobian", "method_params": "self,y,args,kwargs", "method_startline": "236", "method_endline": "248", "method_complexity": {"method_NLOC": "10", "method_CCN": "3", "method_NToken": "71", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\test_examples.py", "file_new_name": "tests\\test_examples.py", "file_complexity": {"file_NLOC": "49", "file_CCN": "15", "file_NToken": "377"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "33,34,39,40", "deleted_lines": null, "method_info": {"method_name": "discover_examples", "method_params": "", "method_startline": "15", "method_endline": "44", "method_complexity": {"method_NLOC": "27", "method_CCN": "11", "method_NToken": "191", "method_nesting_level": "0"}}}}}}}}