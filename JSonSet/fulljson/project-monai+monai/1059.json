{"BR": {"BR_id": "1059", "BR_author": "wyli", "BRopenT": "2020-09-23T16:01:04Z", "BRcloseT": "2020-09-24T09:14:14Z", "BR_text": {"BRsummary": "RandHistogramShift dtype inconsistency", "BRdescription": "\n Describe the bug\n RandHistogramShift transform doesn't preserve the float32 precision\n To Reproduce\n import numpy as np\n from monai.transforms import RandHistogramShift\n \n inputs = np.zeros((2, 2), dtype=np.float32)\n result = RandHistogramShift(num_control_points=(5, 20), prob=1.0)(inputs)\n print(inputs.dtype)  # float32\n print(result.dtype)  # float64\n Expected behavior\n result type should be float32 if the input's is\n Environment (please complete the following information):\n MONAI version: 0.3.0rc3+0.g3f4e064.dirty\n Python version: 3.6.10 |Anaconda, Inc.| (default, Mar 25 2020, 18:53:43)  [GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)]\n Numpy version: 1.19.2\n Pytorch version: 1.6.0\n --\n Thanks for reporting the issue <denchmark-link:https://github.com/Can-Zhao>@Can-Zhao</denchmark-link>\n !\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "wyli", "commentT": "2020-09-23T16:04:10Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/wyli>@wyli</denchmark-link>\n  ,\n Thanks for your finding.\n I can update it to keep the same behavior with other float64/float32 transforms.\n Thanks.\n \t\t"}}}, "commit": {"commit_id": "722b825847e411ad337d886cbd7e195644fe0653", "commit_author": "Nic Ma", "commitT": "2020-09-24 10:14:12+01:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "monai\\transforms\\intensity\\array.py", "file_new_name": "monai\\transforms\\intensity\\array.py", "file_complexity": {"file_NLOC": "599", "file_CCN": "74", "file_NToken": "3634"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "701", "deleted_lines": "701", "method_info": {"method_name": "__call__", "method_params": "self,ndarray", "method_startline": "694", "method_endline": "701", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "87", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "monai\\transforms\\intensity\\dictionary.py", "file_new_name": "monai\\transforms\\intensity\\dictionary.py", "file_complexity": {"file_NLOC": "573", "file_CCN": "71", "file_NToken": "3707"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "649,650", "deleted_lines": "649", "method_info": {"method_name": "__call__", "method_params": "self,Hashable", "method_startline": "640", "method_endline": "651", "method_complexity": {"method_NLOC": "12", "method_CCN": "3", "method_NToken": "131", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\test_rand_histogram_shift.py", "file_new_name": "tests\\test_rand_histogram_shift.py", "file_complexity": {"file_NLOC": "30", "file_CCN": "1", "file_NToken": "360"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "27,32", "deleted_lines": "27,32"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\test_rand_histogram_shiftd.py", "file_new_name": "tests\\test_rand_histogram_shiftd.py", "file_complexity": {"file_NLOC": "43", "file_CCN": "3", "file_NToken": "552"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "27,37", "deleted_lines": "27,37"}}}}}}