{"BR": {"BR_id": "356", "BR_author": "murraycutforth", "BRopenT": "2020-05-07T09:55:28Z", "BRcloseT": "2020-05-07T16:15:59Z", "BR_text": {"BRsummary": "RandGaussianNoise changes the type of the input to np.float64", "BRdescription": "\n First, thanks for creating a great library!\n Describe the bug\n Applying the RandGaussianNoise tranform to a np.float32 array changes the dtype to np.float64. This causes a crash down the line since pytorch expects np.float32 inputs.\n Expected behavior\n The transformed image's dtype does not change\n \n <denchmark-link:https://user-images.githubusercontent.com/11088372/81280218-1017cc80-9050-11ea-87a6-7494da4288aa.png></denchmark-link>\n \n Environment (please complete the following information):\n \n OS: Centos 7\n Python version: 3.6\n MONAI version: 0.1.0\n \n This could be an easy fix, by changing\n return img + self._noise if self._do_transform else img \n to\n return img + self._noise.astype(img.dtype) if self._do_transform else img .\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "murraycutforth", "commentT": "2020-05-07T09:59:50Z", "comment_text": "\n \t\tI forgot to add, it's trivial to work around this by adding a CastToType transform in the transformation pipeline.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "murraycutforth", "commentT": "2020-05-07T10:18:49Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/murraycutforth>@murraycutforth</denchmark-link>\n  ,\n Thanks for your bug report.\n I will submit a PR to fix this issue soon.\n Thanks.\n \t\t"}}}, "commit": {"commit_id": "57abc3b502684b5145200d1d385cf9f02521b347", "commit_author": "Nic Ma", "commitT": "2020-05-07 17:15:58+01:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "monai\\transforms\\intensity\\array.py", "file_new_name": "monai\\transforms\\intensity\\array.py", "file_complexity": {"file_NLOC": "207", "file_CCN": "45", "file_NToken": "1357"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "95", "deleted_lines": "95,101", "method_info": {"method_name": "__init__", "method_params": "self,minv,maxv,factor", "method_startline": "95", "method_endline": "104", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "37", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "95", "deleted_lines": "95,101,106", "method_info": {"method_name": "__init__", "method_params": "self,minv,maxv,factor,dtype", "method_startline": "95", "method_endline": "106", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "48", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "44", "deleted_lines": "44", "method_info": {"method_name": "__call__", "method_params": "self,img", "method_startline": "42", "method_endline": "44", "method_complexity": {"method_NLOC": "3", "method_CCN": "2", "method_NToken": "34", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "125", "deleted_lines": "121,127,132", "method_info": {"method_name": "__init__", "method_params": "self,factors,prob,dtype", "method_startline": "121", "method_endline": "133", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "70", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "119,125", "deleted_lines": "121,127", "method_info": {"method_name": "__init__", "method_params": "self,factors,prob", "method_startline": "119", "method_endline": "130", "method_complexity": {"method_NLOC": "5", "method_CCN": "2", "method_NToken": "59", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "monai\\transforms\\intensity\\dictionary.py", "file_new_name": "monai\\transforms\\intensity\\dictionary.py", "file_complexity": {"file_NLOC": "243", "file_CCN": "41", "file_NToken": "1360"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "164", "deleted_lines": "157,166,172", "method_info": {"method_name": "__init__", "method_params": "self,keys,factors,prob,dtype", "method_startline": "157", "method_endline": "173", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "80", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "155,164", "deleted_lines": "157,166", "method_info": {"method_name": "__init__", "method_params": "self,keys,factors,prob", "method_startline": "155", "method_endline": "170", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "69", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "130,138,141", "deleted_lines": "132,140", "method_info": {"method_name": "__init__", "method_params": "self,keys,minv,maxv,factor", "method_startline": "130", "method_endline": "141", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "44", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "61", "deleted_lines": null, "method_info": {"method_name": "__call__", "method_params": "self,data", "method_startline": "53", "method_endline": "62", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "72", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "138,141", "deleted_lines": "132,140,143", "method_info": {"method_name": "__init__", "method_params": "self,keys,minv,maxv,factor,dtype", "method_startline": "132", "method_endline": "143", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "52", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "monai\\transforms\\spatial\\array.py", "file_new_name": "monai\\transforms\\spatial\\array.py", "file_complexity": {"file_NLOC": "784", "file_CCN": "123", "file_NToken": "4784"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "205", "deleted_lines": "205", "method_info": {"method_name": "__call__", "method_params": "self,img", "method_startline": "197", "method_endline": "205", "method_complexity": {"method_NLOC": "5", "method_CCN": "2", "method_NToken": "47", "method_nesting_level": "1"}}}}}}}}