{"BR": {"BR_id": "832", "BR_author": "Nic-Ma", "BRopenT": "2020-07-30T08:07:15Z", "BRcloseT": "2020-07-31T02:29:09Z", "BR_text": {"BRsummary": "Integration test failed on PyTorch 1.6", "BRdescription": "\n Describe the bug\n As PyTorch released v1.6 yesterday, we faced some issue when running 3D segmentation test:\n <denchmark-code>======================================================================\n FAIL: test_training (__main__.IntegrationSegmentation3D)\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"tests/test_integration_segmentation_3d.py\", line 257, in test_training\n     rtol=1e-3,\n   File \"/opt/conda/lib/python3.6/site-packages/numpy/testing/_private/utils.py\", line 1533, in assert_allclose\n     verbose=verbose, header=header, equal_nan=equal_nan)\n   File \"/opt/conda/lib/python3.6/site-packages/numpy/testing/_private/utils.py\", line 846, in assert_array_compare\n     raise AssertionError(msg)\n AssertionError: \n Not equal to tolerance rtol=0.001, atol=0\n \n Mismatched elements: 6 / 6 (100%)\n Max absolute difference: 0.01720129\n Max relative difference: 0.04047175\n  x: array([0.543151, 0.471052, 0.453605, 0.438546, 0.437794, 0.407818])\n  y: array([0.544673, 0.475109, 0.444963, 0.427036, 0.433381, 0.42502 ])\n \n ----------------------------------------------------------------------\n Ran 1 test in 92.377s\n \n FAILED (failures=1)\n </denchmark-code>\n \n Seems some behavior of PyTorch changed in v1.6.\n \t"}, "comments": {}}, "commit": {"commit_id": "c6c5f99a65c3fa88ba3900dc011b3fc7ad5c5515", "commit_author": "Nic Ma", "commitT": "2020-07-31 10:29:08+08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "monai\\data\\nifti_saver.py", "file_new_name": "monai\\data\\nifti_saver.py", "file_complexity": {"file_NLOC": "120", "file_CCN": "12", "file_NToken": "462"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "38,39", "deleted_lines": "38", "method_info": {"method_name": "__init__", "method_params": "self,str,str,str,bool,GridSampleMode,BILINEAR,GridSamplePadMode,BORDER,bool,float64", "method_startline": "30", "method_endline": "39", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "73", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "38", "deleted_lines": "38", "method_info": {"method_name": "__init__", "method_params": "self,str,str,str,bool,GridSampleMode,BILINEAR,GridSamplePadMode,BORDER,None", "method_startline": "30", "method_endline": "38", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "65", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "118,119", "deleted_lines": "113", "method_info": {"method_name": "save", "method_params": "self,Tensor,None", "method_startline": "71", "method_endline": "120", "method_complexity": {"method_NLOC": "47", "method_CCN": "7", "method_NToken": "218", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "monai\\data\\nifti_writer.py", "file_new_name": "monai\\data\\nifti_writer.py", "file_complexity": {"file_NLOC": "129", "file_CCN": "1", "file_NToken": "757"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "33", "deleted_lines": "33", "method_info": {"method_name": "write_nifti", "method_params": "ndarray,str,None,None,bool,None,GridSampleMode,BILINEAR,GridSamplePadMode,BORDER,None", "method_startline": "24", "method_endline": "33", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "89", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "33,34", "deleted_lines": "33", "method_info": {"method_name": "write_nifti", "method_params": "ndarray,str,None,None,bool,None,GridSampleMode,BILINEAR,GridSamplePadMode,BORDER,bool,float64", "method_startline": "24", "method_endline": "34", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "97", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "monai\\transforms\\spatial\\array.py", "file_new_name": "monai\\transforms\\spatial\\array.py", "file_complexity": {"file_NLOC": "1369", "file_CCN": "75", "file_NToken": "7416"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "402", "deleted_lines": null, "method_info": {"method_name": "__call__", "method_params": "self,ndarray,GridSampleMode,None,GridSamplePadMode,None,None,None", "method_startline": "396", "method_endline": "402", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "58", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "72", "deleted_lines": "72", "method_info": {"method_name": "__init__", "method_params": "self,bool,GridSampleMode,BILINEAR,GridSamplePadMode,BORDER,None", "method_startline": "66", "method_endline": "72", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "59", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "634", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,float,0,float,0,float,0,float,bool,GridSampleMode,BILINEAR,GridSamplePadMode,BORDER,bool,float64", "method_startline": "624", "method_endline": "634", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "117", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "114", "deleted_lines": null, "method_info": {"method_name": "__call__", "method_params": "self,ndarray,affine,GridSampleMode,None,GridSamplePadMode,None,None,None", "method_startline": "108", "method_endline": "115", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "62", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "72,73", "deleted_lines": "72", "method_info": {"method_name": "__init__", "method_params": "self,bool,GridSampleMode,BILINEAR,GridSamplePadMode,BORDER,bool,float64", "method_startline": "66", "method_endline": "73", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "67", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "387", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,bool,GridSampleMode,BILINEAR,GridSamplePadMode,BORDER,bool,float64", "method_startline": "380", "method_endline": "387", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "67", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "monai\\transforms\\spatial\\dictionary.py", "file_new_name": "monai\\transforms\\spatial\\dictionary.py", "file_complexity": {"file_NLOC": "865", "file_CCN": "62", "file_NToken": "4333"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "76,77", "deleted_lines": "76", "method_info": {"method_name": "__init__", "method_params": "self,KeysCollection,bool,GridSampleModeSequence,GridSamplePadModeSequence,None,str", "method_startline": "69", "method_endline": "77", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "64", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "729", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,KeysCollection,bool,GridSampleModeSequence,GridSamplePadModeSequence,False,float64", "method_startline": "721", "method_endline": "729", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "82", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "140", "deleted_lines": null, "method_info": {"method_name": "__call__", "method_params": "self,data", "method_startline": "129", "method_endline": "145", "method_complexity": {"method_NLOC": "14", "method_CCN": "2", "method_NToken": "104", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "76,77", "deleted_lines": "76", "method_info": {"method_name": "__init__", "method_params": "self,KeysCollection,bool,GridSampleModeSequence,GridSamplePadModeSequence,False,float64,str", "method_startline": "69", "method_endline": "78", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "80", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "797", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,KeysCollection,float,0,float,0,float,0,float,bool,GridSampleModeSequence,GridSamplePadModeSequence,False,float64", "method_startline": "786", "method_endline": "797", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "132", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tests\\test_integration_segmentation_3d.py", "file_new_name": "tests\\test_integration_segmentation_3d.py", "file_complexity": {"file_NLOC": "276", "file_CCN": "19", "file_NToken": "2317"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "179,180,181,188,206,207,208", "deleted_lines": "176,183,201", "method_info": {"method_name": "run_inference_test", "method_params": "root_dir,device", "method_startline": "169", "method_endline": "221", "method_complexity": {"method_NLOC": "43", "method_CCN": "3", "method_NToken": "464", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "55,56,57,71,72,73,85,88", "deleted_lines": "56,70,82,85", "method_info": {"method_name": "run_training_test", "method_params": "root_dir,device", "method_startline": "43", "method_endline": "166", "method_complexity": {"method_NLOC": "108", "method_CCN": "9", "method_NToken": "1044", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "257,258,259,260,261,262,268,279,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322", "deleted_lines": "250,251,252,253,254,255,261,272,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315", "method_info": {"method_name": "test_training", "method_params": "self", "method_startline": "243", "method_endline": "329", "method_complexity": {"method_NLOC": "81", "method_CCN": "3", "method_NToken": "525", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\test_rotated.py", "file_new_name": "tests\\test_rotated.py", "file_complexity": {"file_NLOC": "91", "file_CCN": "15", "file_NToken": "999"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "81", "deleted_lines": "81", "method_info": {"method_name": "test_correct_results", "method_params": "self,angle,keep_size,mode,padding_mode,align_corners", "method_startline": "66", "method_endline": "87", "method_complexity": {"method_NLOC": "21", "method_CCN": "5", "method_NToken": "267", "method_nesting_level": "1"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\test_spacing.py", "file_new_name": "tests\\test_spacing.py", "file_complexity": {"file_NLOC": "143", "file_CCN": "3", "file_NToken": "2386"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "40", "deleted_lines": "40"}}}}}}