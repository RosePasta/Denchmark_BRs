{"BR": {"BR_id": "369", "BR_author": "cckao", "BRopenT": "2020-05-09T16:37:57Z", "BRcloseT": "2020-05-11T12:15:11Z", "BR_text": {"BRsummary": "Incorrect implementation of generalized Dice loss", "BRdescription": "\n In the line 195 of dice.py the element-wise division cancels out the weights (if smooth is negligible), which destroys the most important property of generalized Dice loss.\n \n \n \n MONAI/monai/losses/dice.py\n \n \n          Line 195\n       in\n       ad06dff\n \n \n \n \n \n \n  f = (2.0 * intersection * w + smooth) / (denominator * w + smooth) \n \n \n \n \n \n \t"}, "comments": {}}, "commit": {"commit_id": "43a704571ce6f09f1b6a015113cc78b752fca725", "commit_author": "Wenqi Li", "commitT": "2020-05-11 13:15:11+01:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "monai\\losses\\dice.py", "file_new_name": "monai\\losses\\dice.py", "file_complexity": {"file_NLOC": "148", "file_CCN": "29", "file_NToken": "856"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "67,70,71,75,76,86,88,91,92,93,94,95,98,99,102,103,105,106", "deleted_lines": "62,65,66,70,71,81,83,86,87,88,89,90,91,94,95,98,99,101,102,109,110", "method_info": {"method_name": "forward", "method_params": "self,pred,ground,smooth", "method_startline": "62", "method_endline": "110", "method_complexity": {"method_NLOC": "35", "method_CCN": "11", "method_NToken": "264", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "41", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,include_background,to_onehot_y,do_sigmoid,do_softmax,squared_pred,jaccard,reduction", "method_startline": "33", "method_endline": "41", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "32", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "134,135,136,137,138,139,140,141,142", "deleted_lines": "124,132,134,146,147", "method_info": {"method_name": "__init__", "method_params": "self,include_background,to_onehot_y,do_sigmoid,do_softmax,w_type", "method_startline": "124", "method_endline": "147", "method_complexity": {"method_NLOC": "15", "method_CCN": "5", "method_NToken": "110", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "134,135,136,137,138,139,140,141", "deleted_lines": "134", "method_info": {"method_name": "__init__", "method_params": "self,include_background,to_onehot_y,do_sigmoid,do_softmax,w_type,reduction", "method_startline": "134", "method_endline": "141", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "67,70,71,75,76,86,88,91,92,93,94,95,98,99,102,103,105,106,113,114,115,116,117,118,119,120", "deleted_lines": "70,71,81,83,86,87,88,89,90,91,94,95,98,99,101,102,109,110", "method_info": {"method_name": "forward", "method_params": "self,input,target,smooth", "method_startline": "67", "method_endline": "120", "method_complexity": {"method_NLOC": "40", "method_CCN": "14", "method_NToken": "291", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "monai\\losses\\focal_loss.py", "file_new_name": "monai\\losses\\focal_loss.py", "file_complexity": {"file_NLOC": "47", "file_CCN": "9", "file_NToken": "401"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "53,54,55,56,57,62,63,65,66,67,68,69,82,89,95,106,108,110", "deleted_lines": "53,54,55,69,76,77,83,94,96,97", "method_info": {"method_name": "forward", "method_params": "self,input,target", "method_startline": "50", "method_endline": "110", "method_complexity": {"method_NLOC": "36", "method_CCN": "8", "method_NToken": "330", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45", "deleted_lines": "26,27,28,29,30,31,32,33,34,35,36,37,38,39,47,48", "method_info": {"method_name": "__init__", "method_params": "self,gamma,weight,reduction", "method_startline": "23", "method_endline": "48", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "42", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "monai\\losses\\tversky.py", "file_new_name": "monai\\losses\\tversky.py", "file_complexity": {"file_NLOC": "74", "file_CCN": "13", "file_NToken": "403"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "34", "deleted_lines": "34", "method_info": {"method_name": "__init__", "method_params": "self,include_background,to_onehot_y,do_sigmoid,do_softmax,alpha,beta", "method_startline": "33", "method_endline": "34", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "31", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "71,74,75,79,80,90,92,95,96,97,98,99,100,101,103,107,116,118,119,120,121,122,123,124", "deleted_lines": "77,79,82,83,84,85,86,87,88,89,91,95,104,106", "method_info": {"method_name": "forward", "method_params": "self,input,target,smooth", "method_startline": "71", "method_endline": "124", "method_complexity": {"method_NLOC": "40", "method_CCN": "12", "method_NToken": "283", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "60,71,74,75,79,80,90,92,95,96,97,98,99,100,101,103", "deleted_lines": "58,61,62,66,67,77,79,82,83,84,85,86,87,88,89,91,95,104,106", "method_info": {"method_name": "forward", "method_params": "self,pred,ground,smooth", "method_startline": "58", "method_endline": "106", "method_complexity": {"method_NLOC": "35", "method_CCN": "9", "method_NToken": "256", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "34,35,36,37,38,39,40,41", "deleted_lines": "34", "method_info": {"method_name": "__init__", "method_params": "self,include_background,to_onehot_y,do_sigmoid,do_softmax,alpha,beta,reduction", "method_startline": "33", "method_endline": "41", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "36", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\__init__.py", "file_new_name": "tests\\__init__.py", "file_complexity": {"file_NLOC": "15", "file_CCN": "3", "file_NToken": "93"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "17,18,19,20,21,22,23,24,25,26,27,28,29", "deleted_lines": null, "method_info": {"method_name": "_enter_pr_4800", "method_params": "self", "method_startline": "17", "method_endline": "29", "method_complexity": {"method_NLOC": "8", "method_CCN": "3", "method_NToken": "71", "method_nesting_level": "0"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tests\\test_dice_loss.py", "file_new_name": "tests\\test_dice_loss.py", "file_complexity": {"file_NLOC": "129", "file_CCN": "4", "file_NToken": "1612"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "135,136,137,138,139,140,141,142,143,144,145,146", "deleted_lines": null, "method_info": {"method_name": "test_input_warnings", "method_params": "self", "method_startline": "135", "method_endline": "146", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "105", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "125,126,127,128,129,130,131,132,133", "deleted_lines": null, "method_info": {"method_name": "test_ill_opts", "method_params": "self", "method_startline": "125", "method_endline": "133", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "95", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "120,121,122,123", "deleted_lines": null, "method_info": {"method_name": "test_ill_shape", "method_params": "self", "method_startline": "120", "method_endline": "123", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "50", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "118", "deleted_lines": null, "method_info": {"method_name": "test_shape", "method_params": "self,input_param,input_data,expected_val", "method_startline": "116", "method_endline": "118", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "52", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 11, "file_old_name": "tests\\test_focal_loss.py", "file_new_name": "tests\\test_focal_loss.py", "file_complexity": {"file_NLOC": "102", "file_CCN": "14", "file_NToken": "1238"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "96", "deleted_lines": null, "method_info": {"method_name": "test_empty_class_2d", "method_params": "self", "method_startline": "84", "method_endline": "98", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "137", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "112", "deleted_lines": null, "method_info": {"method_name": "test_multi_class_seg_2d", "method_params": "self", "method_startline": "100", "method_endline": "114", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "137", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "174,175,176,177,178", "method_info": {"method_name": "test_convergence.forward", "method_params": "self,x", "method_startline": "174", "method_endline": "178", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "45", "method_nesting_level": "3"}}}, "hunk_3": {"Ismethod": 1, "added_lines": null, "deleted_lines": "80,81,82,83", "method_info": {"method_name": "test_bin_seg_2d", "method_params": "self", "method_startline": "69", "method_endline": "86", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "165", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "33,38", "deleted_lines": "32,33,38", "method_info": {"method_name": "test_consistency_with_cross_entropy_2d", "method_params": "self", "method_startline": "22", "method_endline": "43", "method_complexity": {"method_NLOC": "19", "method_CCN": "4", "method_NToken": "198", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "140,141,142,143,144,145,146", "deleted_lines": "141,142,143,144,145,146", "method_info": {"method_name": "test_ill_opts", "method_params": "self", "method_startline": "140", "method_endline": "146", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "75", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "148,149,150,151,152,153,154,155", "deleted_lines": "148,149,150,151,152,153,154,155", "method_info": {"method_name": "test_ill_shape", "method_params": "self", "method_startline": "148", "method_endline": "155", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "87", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "141,142,143,144,145,146,147,148,149,150,151,152,153,154,155", "deleted_lines": "141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214", "method_info": {"method_name": "test_convergence", "method_params": "self", "method_startline": "141", "method_endline": "214", "method_complexity": {"method_NLOC": "35", "method_CCN": "4", "method_NToken": "337", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": null, "deleted_lines": "170,171,172", "method_info": {"method_name": "test_convergence.__init__", "method_params": "self", "method_startline": "170", "method_endline": "172", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "29", "method_nesting_level": "3"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "136", "deleted_lines": null, "method_info": {"method_name": "test_bin_seg_3d", "method_params": "self", "method_startline": "116", "method_endline": "138", "method_complexity": {"method_NLOC": "14", "method_CCN": "1", "method_NToken": "223", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "56,62", "deleted_lines": "56,62", "method_info": {"method_name": "test_consistency_with_cross_entropy_classification", "method_params": "self", "method_startline": "45", "method_endline": "67", "method_complexity": {"method_NLOC": "20", "method_CCN": "4", "method_NToken": "197", "method_nesting_level": "1"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tests\\test_generalized_dice_loss.py", "file_new_name": "tests\\test_generalized_dice_loss.py", "file_complexity": {"file_NLOC": "129", "file_CCN": "4", "file_NToken": "1641"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "135,136,137,138,139,140,141,142,143,144,145,146", "deleted_lines": null, "method_info": {"method_name": "test_input_warnings", "method_params": "self", "method_startline": "135", "method_endline": "146", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "105", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "125,126,127,128,129,130,131,132,133", "deleted_lines": null, "method_info": {"method_name": "test_ill_opts", "method_params": "self", "method_startline": "125", "method_endline": "133", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "95", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "120,121,122,123", "deleted_lines": null, "method_info": {"method_name": "test_ill_shape", "method_params": "self", "method_startline": "120", "method_endline": "123", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "50", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "118", "deleted_lines": null, "method_info": {"method_name": "test_shape", "method_params": "self,input_param,input_data,expected_val", "method_startline": "116", "method_endline": "118", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "52", "method_nesting_level": "1"}}}}}, "file_7": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tests\\test_seg_loss_integration.py", "file_complexity": {"file_NLOC": "85", "file_CCN": "9", "file_NToken": "940"}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tests\\test_tversky_loss.py", "file_new_name": "tests\\test_tversky_loss.py", "file_complexity": {"file_NLOC": "117", "file_CCN": "3", "file_NToken": "1507"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "122,123,124,125,126,127,128,129,130,131,132,133", "deleted_lines": null, "method_info": {"method_name": "test_input_warnings", "method_params": "self", "method_startline": "122", "method_endline": "133", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "105", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "109", "deleted_lines": null, "method_info": {"method_name": "test_shape", "method_params": "self,input_param,input_data,expected_val", "method_startline": "107", "method_endline": "109", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "52", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "111,112,113,114,115,116,117,118,119,120", "deleted_lines": null, "method_info": {"method_name": "test_ill_shape", "method_params": "self", "method_startline": "111", "method_endline": "120", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "120", "method_nesting_level": "1"}}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\utils.py", "file_new_name": "tests\\utils.py", "file_complexity": {"file_NLOC": "40", "file_CCN": "7", "file_NToken": "307"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "14,16", "deleted_lines": "13,15"}}}}}}