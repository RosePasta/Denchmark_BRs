{"BR": {"BR_id": "247", "BR_author": "ryanjulian", "BRopenT": "2018-08-01T14:08:22Z", "BRcloseT": "2018-08-10T18:18:00Z", "BR_text": {"BRsummary": "Pickling is broken in tf/regressors", "BRdescription": "\n def play(pkl_file):\n     with tf.Session() as sess:\n         sess.run(tf.global_variables_initializer())\n \n         # Unpack the snapshot\n         snapshot = joblib.load(pkl_file)\n         env = snapshot[\"env\"]\n         policy = snapshot[\"policy\"]\n Output:\n tensorflow.python.framework.errors_impl.FailedPreconditionError: Attempting to use uninitialized value\n vf/mean_network/hidden_0/W\n          [[Node: _retval_vf/mean_network/hidden_0/W_0_0 = _Retval[T=DT_FLOAT, index=0, _device=\"/job:lo\n calhost/replica:0/task:0/device:CPU:0\"](vf/mean_network/hidden_0/W)]]\n Some notes:\n \n GaussianMLPRegressor defines get/set params:\n     def get_param_values(self, **tags):\n         return LayersPowered.get_param_values(self, **tags)\n \n     def set_param_values(self, flattened_params, **tags):\n         LayersPowered.set_param_values(self, flattened_params, **tags)\n This is not necessary if the regressors inherit from Parameterized and call the Parameterized\n constructor (see garage/tf/policies/base.py).\n However, using Parameterized alone does not seem to correct the problem\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ryanjulian", "commentT": "2018-08-10T07:21:43Z", "comment_text": "\n \t\tI don't quite understand sess.run(tf.global_variables_initializer()). Isn't there no global variable?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ryanjulian", "commentT": "2018-08-10T08:50:50Z", "comment_text": "\n \t\tThis bug occurs because Parameterized calls get_params_internal method in pickling, which is not implemented in tf.baselines.\n \t\t"}}}, "commit": {"commit_id": "38baa8b8d5c719efe3b57b1f18442b36d5c06371", "commit_author": "Chang Su", "commitT": "2018-08-10 11:17:59-07:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "0.6666666666666666"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "garage\\tf\\baselines\\deterministic_mlp_baseline.py", "file_new_name": "garage\\tf\\baselines\\deterministic_mlp_baseline.py", "file_complexity": {"file_NLOC": "44", "file_CCN": "8", "file_NToken": "302"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "65,66", "deleted_lines": null, "method_info": {"method_name": "get_params_internal", "method_params": "self,tags", "method_startline": "65", "method_endline": "66", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "garage\\tf\\baselines\\gaussian_mlp_baseline.py", "file_new_name": "garage\\tf\\baselines\\gaussian_mlp_baseline.py", "file_complexity": {"file_NLOC": "44", "file_CCN": "8", "file_NToken": "302"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "65,66", "deleted_lines": null, "method_info": {"method_name": "get_params_internal", "method_params": "self,tags", "method_startline": "65", "method_endline": "66", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "garage\\tf\\regressors\\bernoulli_mlp_regressor.py", "file_new_name": "garage\\tf\\regressors\\bernoulli_mlp_regressor.py", "file_complexity": {"file_NLOC": "138", "file_CCN": "9", "file_NToken": "891"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "172,173", "method_info": {"method_name": "set_param_values", "method_params": "self,flattened_params,tags", "method_startline": "172", "method_endline": "173", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "169,170", "method_info": {"method_name": "get_param_values", "method_params": "self,tags", "method_startline": "169", "method_endline": "170", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "garage\\tf\\regressors\\categorical_mlp_regressor.py", "file_new_name": "garage\\tf\\regressors\\categorical_mlp_regressor.py", "file_complexity": {"file_NLOC": "162", "file_CCN": "10", "file_NToken": "1110"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "194,195", "method_info": {"method_name": "set_param_values", "method_params": "self,flattened_params,tags", "method_startline": "194", "method_endline": "195", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "191,192", "method_info": {"method_name": "get_param_values", "method_params": "self,tags", "method_startline": "191", "method_endline": "192", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "garage\\tf\\regressors\\deterministic_mlp_regressor.py", "file_new_name": "garage\\tf\\regressors\\deterministic_mlp_regressor.py", "file_complexity": {"file_NLOC": "114", "file_CCN": "6", "file_NToken": "725"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "143,144", "method_info": {"method_name": "set_param_values", "method_params": "self,flattened_params,tags", "method_startline": "143", "method_endline": "144", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "140,141", "method_info": {"method_name": "get_param_values", "method_params": "self,tags", "method_startline": "140", "method_endline": "141", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "garage\\tf\\regressors\\gaussian_mlp_regressor.py", "file_new_name": "garage\\tf\\regressors\\gaussian_mlp_regressor.py", "file_complexity": {"file_NLOC": "275", "file_CCN": "12", "file_NToken": "1607"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "325,326", "method_info": {"method_name": "set_param_values", "method_params": "self,flattened_params,tags", "method_startline": "325", "method_endline": "326", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "21", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "322,323", "method_info": {"method_name": "get_param_values", "method_params": "self,tags", "method_startline": "322", "method_endline": "323", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}}}}}}