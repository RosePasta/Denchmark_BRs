{"BR": {"BR_id": "1969", "BR_author": "robertnishihara", "BRopenT": "2018-04-30T20:12:45Z", "BRcloseT": "2018-08-10T18:08:10Z", "BR_text": {"BRsummary": "ray.wait segfaults with num_returns=0.", "BRdescription": "\n import ray\n \n ray.init()\n \n @ray.remote\n def f():\n     return\n \n ray.wait([f.remote() for _ in range(4)], num_returns=0)\n fails with\n <denchmark-code>/Users/rkn/Workspace/ray/thirdparty/build/arrow/cpp/src/plasma/client.cc:960 Check failed: num_ready_objects > 0 \n Abort trap: 6\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "robertnishihara", "commentT": "2018-08-10T18:08:10Z", "comment_text": "\n \t\tResolved.\n \t\t"}}}, "commit": {"commit_id": "7246ff80a45520bc2d67efcdddafe90fda83201b", "commit_author": "Melih Elibol", "commitT": "2018-06-06 16:56:44-07:00", "commit_complexity": {"commit_NLOC": "0.11822660098522167", "commit_CCN": "0.3669950738916256", "commit_Nprams": "0.46551724137931033"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\worker.py", "file_new_name": "python\\ray\\worker.py", "file_complexity": {"file_NLOC": "1545", "file_CCN": "221", "file_NToken": "9069"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "2532,2533,2534,2535,2536,2579,2580,2581,2582,2583,2584,2585,2586,2588,2589,2590,2591,2592,2593,2594,2595,2596,2597,2598,2599,2600,2601,2602", "deleted_lines": "2543,2544,2545,2577,2578,2579,2581,2582,2583,2584,2585,2586,2587,2588", "method_info": {"method_name": "wait", "method_params": "object_ids,num_returns,timeout,worker", "method_startline": "2520", "method_endline": "2603", "method_complexity": {"method_NLOC": "45", "method_CCN": "16", "method_NToken": "299", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\local_scheduler\\lib\\python\\local_scheduler_extension.cc", "file_new_name": "src\\local_scheduler\\lib\\python\\local_scheduler_extension.cc", "file_complexity": {"file_NLOC": "317", "file_CCN": "38", "file_NToken": "1759"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232", "deleted_lines": null, "method_info": {"method_name": "PyLocalSchedulerClient_wait", "method_params": "self,args", "method_startline": "182", "method_endline": "232", "method_complexity": {"method_NLOC": "42", "method_CCN": "8", "method_NToken": "316", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\local_scheduler\\local_scheduler_client.cc", "file_new_name": "src\\local_scheduler\\local_scheduler_client.cc", "file_complexity": {"file_NLOC": "205", "file_CCN": "21", "file_NToken": "1503"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248", "deleted_lines": null, "method_info": {"method_name": "local_scheduler_wait", "method_params": "conn,object_ids,num_returns,timeout_milliseconds,wait_local", "method_startline": "212", "method_endline": "248", "method_complexity": {"method_NLOC": "33", "method_CCN": "3", "method_NToken": "285", "method_nesting_level": "0"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\local_scheduler\\local_scheduler_client.h", "file_new_name": "src\\local_scheduler\\local_scheduler_client.h", "file_complexity": {"file_NLOC": "46", "file_CCN": "0", "file_NToken": "257"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189", "deleted_lines": null}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 7, "file_old_name": "src\\ray\\object_manager\\object_directory.cc", "file_new_name": "src\\ray\\object_manager\\object_directory.cc", "file_complexity": {"file_NLOC": "129", "file_CCN": "21", "file_NToken": "1019"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "106,107,109", "deleted_lines": "100,103,105,106,107", "method_info": {"method_name": "ray::ObjectDirectory::UnsubscribeObjectLocations", "method_params": "object_id", "method_startline": "100", "method_endline": "109", "method_complexity": {"method_NLOC": "10", "method_CCN": "2", "method_NToken": "84", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "106,107,109,110,111,112,113,114,115,116,117,120,121,122,123,124,125,126,127", "deleted_lines": "106,107", "method_info": {"method_name": "ray::ObjectDirectory::SubscribeObjectLocations", "method_params": "callback_id,object_id,callback", "method_startline": "106", "method_endline": "128", "method_complexity": {"method_NLOC": "21", "method_CCN": "4", "method_NToken": "187", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "89,91,92,95,96,97", "method_info": {"method_name": "ray::ObjectDirectory::SubscribeObjectLocations", "method_params": "object_id,callback", "method_startline": "89", "method_endline": "98", "method_complexity": {"method_NLOC": "10", "method_CCN": "2", "method_NToken": "93", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "146,147,148,149,150,151,152,153,154,155,156,157,158", "deleted_lines": null, "method_info": {"method_name": "ray::ObjectDirectory::LookupLocations", "method_params": "object_id,callback", "method_startline": "146", "method_endline": "160", "method_complexity": {"method_NLOC": "14", "method_CCN": "1", "method_NToken": "106", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "31,32,33,35,37,41,42,43,44,45,46,47,48,49", "deleted_lines": "30,31,32,33,34", "method_info": {"method_name": "ray::ObjectDirectory::RegisterBackend", "method_params": "", "method_startline": "30", "method_endline": "56", "method_complexity": {"method_NLOC": "21", "method_CCN": "4", "method_NToken": "153", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "130,131,132,135,137,138,139,140,141,142,143,144", "deleted_lines": null, "method_info": {"method_name": "ray::ObjectDirectory::UnsubscribeObjectLocations", "method_params": "callback_id,object_id", "method_startline": "130", "method_endline": "144", "method_complexity": {"method_NLOC": "15", "method_CCN": "3", "method_NToken": "118", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28", "deleted_lines": "10,11,12,14,16,20,21,22,23,24,25,26", "method_info": {"method_name": "ray::UpdateObjectLocations", "method_params": "client_ids,location_history", "method_startline": "9", "method_endline": "28", "method_complexity": {"method_NLOC": "13", "method_CCN": "3", "method_NToken": "93", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\ray\\object_manager\\object_directory.h", "file_new_name": "src\\ray\\object_manager\\object_directory.h", "file_complexity": {"file_NLOC": "74", "file_CCN": "1", "file_NToken": "516"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "116,117", "deleted_lines": "116,117", "method_info": {"method_name": "ray::ObjectDirectory::LocationListenerState::LocationListenerState", "method_params": "locations_found_callback", "method_startline": "116", "method_endline": "117", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "14", "method_nesting_level": "3"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 11, "file_old_name": "src\\ray\\object_manager\\object_manager.cc", "file_new_name": "src\\ray\\object_manager\\object_manager.cc", "file_complexity": {"file_NLOC": "533", "file_CCN": "90", "file_NToken": "4224"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "359,360,361,362,363,364,365,366", "deleted_lines": "358,359", "method_info": {"method_name": "ray::ObjectManager::Wait", "method_params": "object_ids,timeout_ms,num_required_objects,wait_local,callback", "method_startline": "358", "method_endline": "368", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "74", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "353,354", "deleted_lines": "352", "method_info": {"method_name": "ray::ObjectManager::Cancel", "method_params": "object_id", "method_startline": "352", "method_endline": "356", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "91,93,94,104", "deleted_lines": "91,93,94,104", "method_info": {"method_name": "ray::ObjectManager::NotifyDirectoryObjectAdd", "method_params": "object_info", "method_startline": "86", "method_endline": "106", "method_complexity": {"method_NLOC": "18", "method_CCN": "4", "method_NToken": "140", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401", "deleted_lines": null, "method_info": {"method_name": "ray::ObjectManager::AddWaitRequest", "method_params": "wait_id,object_ids,timeout_ms,num_required_objects,wait_local,callback", "method_startline": "370", "method_endline": "401", "method_complexity": {"method_NLOC": "28", "method_CCN": "6", "method_NToken": "216", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518", "deleted_lines": null, "method_info": {"method_name": "ray::ObjectManager::WaitComplete", "method_params": "wait_id", "method_startline": "490", "method_endline": "518", "method_complexity": {"method_NLOC": "22", "method_CCN": "7", "method_NToken": "173", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "132,134,135", "deleted_lines": "132,134", "method_info": {"method_name": "ray::ObjectManager::Pull", "method_params": "object_id", "method_startline": "125", "method_endline": "139", "method_complexity": {"method_NLOC": "14", "method_CCN": "2", "method_NToken": "102", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488", "deleted_lines": null, "method_info": {"method_name": "ray::ObjectManager::SubscribeRemainingWaitObjects", "method_params": "wait_id", "method_startline": "435", "method_endline": "488", "method_complexity": {"method_NLOC": "44", "method_CCN": "10", "method_NToken": "319", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "217,218,222", "deleted_lines": "216,217,221", "method_info": {"method_name": "ray::ObjectManager::HandlePushTaskTimeout", "method_params": "object_id,client_id", "method_startline": "213", "method_endline": "224", "method_complexity": {"method_NLOC": "12", "method_CCN": "2", "method_NToken": "99", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "359,360,361", "deleted_lines": "357,358,359", "method_info": {"method_name": "ray::ObjectManager::Wait", "method_params": "object_ids,timeout_ms,num_ready_objects,callback", "method_startline": "356", "method_endline": "361", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "36", "method_nesting_level": "1"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433", "deleted_lines": null, "method_info": {"method_name": "ray::ObjectManager::LookupRemainingWaitObjects", "method_params": "wait_id", "method_startline": "403", "method_endline": "433", "method_complexity": {"method_NLOC": "24", "method_CCN": "5", "method_NToken": "177", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "229", "deleted_lines": "228", "method_info": {"method_name": "ray::ObjectManager::Push", "method_params": "object_id,client_id", "method_startline": "226", "method_endline": "281", "method_complexity": {"method_NLOC": "45", "method_CCN": "8", "method_NToken": "357", "method_nesting_level": "1"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\ray\\object_manager\\object_manager.h", "file_new_name": "src\\ray\\object_manager\\object_manager.h", "file_complexity": {"file_NLOC": "141", "file_CCN": "2", "file_NToken": "1012"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "208,209,210,211,212,213", "deleted_lines": null, "method_info": {"method_name": "ray::ObjectManager::WaitState::WaitState", "method_params": "service,timeout_ms,callback", "method_startline": "208", "method_endline": "213", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "62", "method_nesting_level": "3"}}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 13, "file_old_name": "src\\ray\\object_manager\\test\\object_manager_test.cc", "file_new_name": "src\\ray\\object_manager\\test\\object_manager_test.cc", "file_complexity": {"file_NLOC": "378", "file_CCN": "53", "file_NToken": "2987"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "460", "deleted_lines": null, "method_info": {"method_name": "ray::TEST_F", "method_params": "TestObjectManager,StartTestObjectManager", "method_startline": "460", "method_endline": "464", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "38", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "275,276,277,278,279,280,281,282,283,284,285,286,287,288,289", "deleted_lines": null, "method_info": {"method_name": "ray::TestObjectManager::SubscribeObjectThenWait", "method_params": "", "method_startline": "275", "method_endline": "289", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "97", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353", "deleted_lines": null, "method_info": {"method_name": "ray::TestObjectManager::NextWaitTest", "method_params": "", "method_startline": "324", "method_endline": "353", "method_complexity": {"method_NLOC": "21", "method_CCN": "6", "method_NToken": "126", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "158,159,160", "deleted_lines": null, "method_info": {"method_name": "ray::TestObjectManagerBase::WriteDataToClient", "method_params": "client,data_size", "method_startline": "158", "method_endline": "160", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "2"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322", "deleted_lines": null, "method_info": {"method_name": "ray::TestObjectManager::TestWaitWhileSubscribed", "method_params": "sub_id,object_1,object_2", "method_startline": "291", "method_endline": "322", "method_complexity": {"method_NLOC": "25", "method_CCN": "1", "method_NToken": "231", "method_nesting_level": "2"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "83", "deleted_lines": "83", "method_info": {"method_name": "ray::TestObjectManager::TestObjectManager", "method_params": "", "method_startline": "83", "method_endline": "83", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "5", "method_nesting_level": "2"}}}, "hunk_6": {"Ismethod": 1, "added_lines": null, "deleted_lines": "268", "method_info": {"method_name": "ray::TestObjectManagerCommands::NotificationTestCompleteIfSatisfied", "method_params": "", "method_startline": "264", "method_endline": "270", "method_complexity": {"method_NLOC": "7", "method_CCN": "3", "method_NToken": "41", "method_nesting_level": "2"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "440", "deleted_lines": null, "method_info": {"method_name": "ray::TestObjectManager::TestWaitComplete", "method_params": "", "method_startline": "440", "method_endline": "440", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "11", "method_nesting_level": "2"}}}, "hunk_8": {"Ismethod": 1, "added_lines": null, "deleted_lines": "127,139", "method_info": {"method_name": "ray::TestObjectManager::SetUp", "method_params": "", "method_startline": "106", "method_endline": "146", "method_complexity": {"method_NLOC": "30", "method_CCN": "1", "method_NToken": "254", "method_nesting_level": "2"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "83", "deleted_lines": "83", "method_info": {"method_name": "ray::TestObjectManagerBase::TestObjectManagerBase", "method_params": "", "method_startline": "83", "method_endline": "83", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "5", "method_nesting_level": "2"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438", "deleted_lines": null, "method_info": {"method_name": "ray::TestObjectManager::TestWait", "method_params": "data_size,num_objects,required_objects,timeout_ms,include_nonexistent,test_local", "method_startline": "355", "method_endline": "438", "method_complexity": {"method_NLOC": "73", "method_CCN": "16", "method_NToken": "591", "method_nesting_level": "2"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "271", "deleted_lines": "268", "method_info": {"method_name": "ray::TestObjectManager::NotificationTestCompleteIfSatisfied", "method_params": "", "method_startline": "267", "method_endline": "273", "method_complexity": {"method_NLOC": "7", "method_CCN": "3", "method_NToken": "39", "method_nesting_level": "2"}}}, "hunk_12": {"Ismethod": 1, "added_lines": "290,291,292,293,294", "deleted_lines": "290", "method_info": {"method_name": "ray::TEST_F", "method_params": "TestObjectManagerCommands,StartTestObjectManagerCommands", "method_startline": "290", "method_endline": "294", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "38", "method_nesting_level": "1"}}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\ray\\raylet\\format\\node_manager.fbs", "file_new_name": "src\\ray\\raylet\\format\\node_manager.fbs", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "56,57,58,59,60,61,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142", "deleted_lines": "56"}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\ray\\raylet\\node_manager.cc", "file_new_name": "src\\ray\\raylet\\node_manager.cc", "file_complexity": {"file_NLOC": "598", "file_CCN": "81", "file_NToken": "4872"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483", "deleted_lines": null, "method_info": {"method_name": "ray::raylet::NodeManager::ProcessClientMessage", "method_params": "client,message_type,message_data", "method_startline": "342", "method_endline": "491", "method_complexity": {"method_NLOC": "107", "method_CCN": "16", "method_NToken": "916", "method_nesting_level": "2"}}}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "test\\runtest.py", "file_new_name": "test\\runtest.py", "file_complexity": {"file_NLOC": "1709", "file_CCN": "389", "file_NToken": "14400"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "838,839,840,841,842,843", "deleted_lines": "782,783,784,850,851", "method_info": {"method_name": "testWait", "method_params": "self", "method_startline": "782", "method_endline": "851", "method_complexity": {"method_NLOC": "56", "method_CCN": "2", "method_NToken": "492", "method_nesting_level": "1"}}}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "test\\stress_tests.py", "file_new_name": "test\\stress_tests.py", "file_complexity": {"file_NLOC": "343", "file_CCN": "88", "file_NToken": "2457"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "124,125,126"}}}}}}