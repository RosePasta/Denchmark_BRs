{"BR": {"BR_id": "11551", "BR_author": "PidgeyBE", "BRopenT": "2020-10-22T09:37:54Z", "BRcloseT": "2020-11-23T22:55:13Z", "BR_text": {"BRsummary": "[autoscaler] Too many workers are scaled in kubernetes", "BRdescription": "\n <denchmark-h:h2>What is the problem?</denchmark-h>\n \n \n ray = 1.0.0\n autoscaling on k8s\n \n When autoscaling in kubernetes, it happens sometimes (almost 50% in my case) that instead of 1 worker, 2 workers are scaled up.\n <denchmark-h:h3>Reproduction (REQUIRED)</denchmark-h>\n \n \n Have a ray autoscale cluster on kubernetes\n Deploy an actor that requires new worker resources\n Ray autoscale will start an extra worker\n When the first worker is (almost) ready, for some reason, the autoscaler triggers another worker to start\n I see this happens because for some reason NumNodesConnected becomes equal to NumNodesUsed.\n \n <denchmark-code> - NumNodesConnected: 3\n  - NumNodesUsed: 3\n </denchmark-code>\n \n A few seconds later (while the extra node is already being started and the actor is deployed) I see:\n <denchmark-code> - NumNodesConnected: 3\n  - NumNodesUsed: 1.2\n </denchmark-code>\n \n I've cut the important part out of the monitor.err logs <denchmark-link:https://github.com/ray-project/ray/files/5421744/monitor.err.txt>monitor.err.txt</denchmark-link>\n \n It seems like there is some race condition that causes the autoscaler to trigger a worker to start, while the actor is deploying...\n \n  I have verified my script runs in a clean environment and reproduces the issue.\n  I have verified the issue also occurs with the latest wheels.\n \n BR, Pieterjan\n cc <denchmark-link:https://github.com/edoakes>@edoakes</denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "PidgeyBE", "commentT": "2020-10-22T16:49:53Z", "comment_text": "\n \t\tCc <denchmark-link:https://github.com/wuisawesome>@wuisawesome</denchmark-link>\n  probably should handle asap\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "PidgeyBE", "commentT": "2020-10-22T17:02:47Z", "comment_text": "\n \t\tCc <denchmark-link:https://github.com/AmeerHajAli>@AmeerHajAli</denchmark-link>\n  <denchmark-link:https://github.com/ericl>@ericl</denchmark-link>\n \n I'll look into this, but feel free to steal it if you have the bandwidth\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "PidgeyBE", "commentT": "2020-10-22T18:09:44Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/wuisawesome>@wuisawesome</denchmark-link>\n  I vaguely remember seeing this in the past. IIRC the issue is that the autoscaler has no notion of \"pending\" nodes, so while the node is pending in k8s (which can take awhile), it continues to add more nodes because resource utilization is still high.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "PidgeyBE", "commentT": "2020-10-22T18:22:20Z", "comment_text": "\n \t\tWhat's weird is that the autoscaler is reporting it has 1/1 target nodes, but 2 nodes connected. There seems to be a connected node that is not managed by the autoscaler, which leads to an off-by-one error.\n <denchmark-link:https://github.com/wuisawesome>@wuisawesome</denchmark-link>\n  is this related to that issue you had with an unmanaged node being counted as a node?\n <denchmark-link:https://github.com/edoakes>@edoakes</denchmark-link>\n  I do see  so it seems we do have pending nodes. What's odd is the number of \"used\" nodes is 3 when the load is low, which seems wrong.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "PidgeyBE", "commentT": "2020-10-22T18:25:56Z", "comment_text": "\n \t\thuh, ok, that's actually sort of promising because it indicates that there's just some off-by-one or similar bug somewhere instead of a more intrinsic problem. <denchmark-link:https://github.com/ericl>@ericl</denchmark-link>\n  does this mean you were able to easily reproduce the issue?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "PidgeyBE", "commentT": "2020-10-22T18:37:04Z", "comment_text": "\n \t\tIndeed, I think there is notion of pending nodes in k8s autoscaler.\n e.g. If I do\n <denchmark-code>setup_commands:\n     - sleep 600\n </denchmark-code>\n \n It does not influence the problem (doesnt make it better or worse) ...\n I'm not sure about the off-by-one thing...\n It starts with 0/0, at this time the unmanaged node is already present and not counted.\n Then, when deploying the Actor, it goes to 0/1.\n After some time, the status becomes 1/1 but the added GPU is not yet visible in the Resource list.\n At the point the GPU becomes visible in the ResourceUsage list, the target nodes are 1/2 and an extra node is spawned.\n Then it goes to 2/2 (while actor is not yet deployed (0.0/1.0 GPU)) and quickly to 2/1 as soon as the Actor is actually deployed (1.0/1.0 GPU)\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "PidgeyBE", "commentT": "2020-10-22T19:10:26Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/edoakes>@edoakes</denchmark-link>\n  I was just reading the logs above.\n It's possible this PR fixes the issue: <denchmark-link:https://github.com/ray-project/ray/pull/11458>#11458</denchmark-link>\n  (it should be available in nightly wheels by now)\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "PidgeyBE", "commentT": "2020-10-26T15:59:17Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/PidgeyBE>@PidgeyBE</denchmark-link>\n  have you had a chance to verify that the above PR fixes your issue?\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "PidgeyBE", "commentT": "2020-10-26T15:59:18Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/PidgeyBE>@PidgeyBE</denchmark-link>\n  have you had a chance to verify that the above PR fixes your issue?\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "PidgeyBE", "commentT": "2020-10-27T08:35:47Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/edoakes>@edoakes</denchmark-link>\n  Not yet. I'll try to do it today! Our build chain is not so flexible for changing ray versions but if the API is stable between 1.0 and the nightly it might go faster. I'll try\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "PidgeyBE", "commentT": "2020-10-27T16:55:24Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/edoakes>@edoakes</denchmark-link>\n  I tried with latest nightly wheel, but the autoscaling monitor doesn't seem to start so I can't test...\n <denchmark-code>2020-10-27 16:49:26,179\tINFO log_timer.py:27 -- NodeUpdater: ray-head-qmcx9: Ray start commands succeeded [LogTimer=5822ms]\n 2020-10-27 16:49:26,179\tINFO log_timer.py:27 -- NodeUpdater: ray-head-qmcx9: Applied config 47da8d49fe813c3c58828168d32f7bc8b397761c  [LogTimer=49794ms]\n 2020-10-27 16:49:26,269\tINFO commands.py:716 -- get_or_create_head_node: Head node up-to-date, IP address is: 10.208.0.6\n 2020-10-27 16:48:33,431\tINFO commands.py:204 -- Cluster: dynamic-ray\n To monitor autoscaling activity, you can run:\n   ray exec /etc/ray/config.yaml 'tail -n 100 -f /tmp/ray/session_latest/logs/monitor*'\n To open a console on the cluster:\n   ray attach /etc/ray/config.yaml\n To get a remote shell to the cluster manually, run:\n   kubectl -n dynamic-ray exec -it ray-head-qmcx9 bash\n </denchmark-code>\n \n This looks ok (as in ray 1.0.0), but when I look into the ray head, it seems like the monitor doesnt start:\n <denchmark-code>(regulator) root@ray-head-qmcx9:/app/core# tail -n 100 -f /tmp/ray/session_latest/logs/monitor*\n ==> /tmp/ray/session_latest/logs/monitor.err <==\n                                                                 '\"conda '\n                                                                 'activate '\n                                                                 'regulator\" '\n                                                                 '>> '\n                                                                 '~/.bashrc; '\n                                                                 'trap : '\n                                                                 'TERM INT; '\n                                                                 'sleep '\n                                                                 'infinity '\n                                                                 '& wait;'],\n                                                        'command': ['/bin/bash',\n                                                                    '-c',\n                                                                    '--'],\n                                                        'env': ....}},\n                       'service': {'apiVersion': 'v1',\n                                   'kind': 'Service',\n                                   'spec': {'p.....\n      'worker_setup_commands': ['./deploy/install-pipelines.sh',\n                                'python ./main/run_on_worker_start.py'],\n      'worker_start_ray_commands': ['ray stop',\n                                    'ulimit -n 65536; ray start '\n                                    '--num-cpus=$MY_CPU_REQUEST '\n                                    '--address=$RAY_HEAD_IP:6379 '\n                                    '--object-manager-port=8076 '\n                                    '--resources=\\'{\"READY\":9999}\\'']}\n \n ==> /tmp/ray/session_latest/logs/monitor.out <==\n </denchmark-code>\n \n Also when I start actors, no workers are spawned...\n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "PidgeyBE", "commentT": "2020-11-05T07:35:47Z", "comment_text": "\n \t\tI will try to reproduce this on a local k8s instance.\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "PidgeyBE", "commentT": "2020-11-09T06:35:32Z", "comment_text": "\n \t\tOk so I tried running this\n import ray\n \n ray.init(address=\"auto\")\n \n @ray.remote(num_cpus=1)\n def spin():\n     import time\n     time.sleep(10000)\n \n ray.get(spin.remote())\n On nightly wheel+docker image, using minikube on a pretty beefy machine (32 cores). Running:\n <denchmark-code>$ ray up cluster.yaml\n Cluster: default\n \n Loaded cached provider configuration\n If you experience issues with the cloud provider, try re-running the command with --no-config-cache.\n No head node found. Launching a new cluster. Confirm [y/N]: y\n \n Acquiring an up-to-date head node\n 2020-11-09 06:30:43,901\tINFO node_provider.py:112 -- KubernetesNodeProvider: calling create_namespaced_pod (count=1).\n   Launched a new head node\n   Fetching the new head node\n \n <1/1> Setting up head node\n   Prepared bootstrap config\n 2020-11-09 06:30:43,924\tINFO node_provider.py:85 -- KubernetesNodeProvider: Caught a 409 error while setting node tags. Retrying...\n   New status: waiting-for-ssh\n   [1/6] Waiting for SSH to become available\n     Running `uptime` as a test.\n 2020-11-09 06:30:44,442\tINFO command_runner.py:165 -- NodeUpdater: ray-head-mp2vs: Running kubectl -n ray exec -it ray-head-mp2vs -- bash --login -c -i 'true && source ~/.bashrc && export OMP_NUM_THREADS=1 PYTHONWARNINGS=ignore && (uptime)'\n error: unable to upgrade connection: container not found (\"ray-node\")\n     SSH still not available (Exit Status 1): k u b e c t l   - n   r a y   e x e c   - i t   r a y - h e a d - m p 2 v s   - -   b a s h   - - l o g i n   - c   - i   ' t r u e   & &   s o u r c e   ~ / . b a s h r c   & &   e x p o r t   O M P _ N U M _ T H R E A D S = 1   P Y T H O N W A R N I N G S = i g n o r e   & &   ( u p t i m e ) ', retrying in 5 seconds.\n 2020-11-09 06:30:49,569\tINFO command_runner.py:165 -- NodeUpdater: ray-head-mp2vs: Running kubectl -n ray exec -it ray-head-mp2vs -- bash --login -c -i 'true && source ~/.bashrc && export OMP_NUM_THREADS=1 PYTHONWARNINGS=ignore && (uptime)'\n  06:30:50 up 3 days, 22:46,  0 users,  load average: 0.69, 0.47, 0.35\n     Success.\n   Updating cluster configuration. [hash=a9714d6ad81e442dc995ee12c944110d9ddddcde]\n   New status: syncing-files\n   [3/6] Processing file mounts\n 2020-11-09 06:30:50,132\tINFO command_runner.py:165 -- NodeUpdater: ray-head-mp2vs: Running kubectl -n ray exec -it ray-head-mp2vs -- bash --login -c -i 'true && source ~/.bashrc && export OMP_NUM_THREADS=1 PYTHONWARNINGS=ignore && (mkdir -p ~)'\n /home/ubuntu/.local/lib/python3.8/site-packages/ray/autoscaler/_private/command_runner.py:204: UserWarning: NodeUpdater: ray-head-mp2vs: rsync failed: '[Errno 2] No such file or directory: '/home/ubuntu/.local/lib/python3.8/site-packages/ray/autoscaler/_private/kubernetes/kubectl-rsync.sh''. Falling back to 'kubectl cp'\n   warnings.warn(\n   [4/6] No worker file mounts to sync\n   New status: setting-up\n   [3/6] No initialization commands to run.\n   [4/6] No setup commands to run.\n   [6/6] Starting the Ray runtime\n 2020-11-09 06:30:50,937\tINFO command_runner.py:165 -- NodeUpdater: ray-head-mp2vs: Running kubectl -n ray exec -it ray-head-mp2vs -- bash --login -c -i 'true && source ~/.bashrc && export OMP_NUM_THREADS=1 PYTHONWARNINGS=ignore && (ray stop)'\n Did not find any active Ray processes.\n 2020-11-09 06:30:51,989\tINFO command_runner.py:165 -- NodeUpdater: ray-head-mp2vs: Running kubectl -n ray exec -it ray-head-mp2vs -- bash --login -c -i 'true && source ~/.bashrc && export OMP_NUM_THREADS=1 PYTHONWARNINGS=ignore && (ulimit -n 65536; ray start --head --num-cpus=$MY_CPU_REQUEST --port=6379 --object-manager-port=8076 --autoscaling-config=~/ray_bootstrap_config.yaml --dashboard-host 0.0.0.0)'\n Local node IP: 172.17.0.3\n 2020-11-09 06:30:53,338\tINFO services.py:1110 -- View the Ray dashboard at http://172.17.0.3:8265\n \n --------------------\n Ray runtime started.\n --------------------\n \n Next steps\n   To connect to this Ray runtime from another node, run\n     ray start --address='172.17.0.3:6379' --redis-password='5241590000000000'\n \n   Alternatively, use the following Python code:\n     import ray\n     ray.init(address='auto', _redis_password='5241590000000000')\n \n   If connection fails, check your firewall settings and network configuration.\n \n   To terminate the Ray runtime, run\n     ray stop\n   New status: up-to-date\n \n Useful commands\n   Monitor autoscaling with\n     ray exec /home/ubuntu/robovision-repro/cluster.yaml 'tail -n 100 -f /tmp/ray/session_latest/logs/monitor*'\n   Connect to a terminal on the cluster head:\n     ray attach /home/ubuntu/robovision-repro/cluster.yaml\n   Get a remote shell to the cluster manually:\n     kubectl -n ray exec -it ray-head-mp2vs bash\n \n \n $ ray submit cluster.yaml request_resource.py\n Loaded cached provider configuration\n If you experience issues with the cloud provider, try re-running the command with --no-config-cache.\n /home/ubuntu/.local/lib/python3.8/site-packages/ray/autoscaler/_private/command_runner.py:204: UserWarning: NodeUpdater: ray-head-mp2vs: rsync failed: '[Errno 2] No such file or directory: '/home/ubuntu/.local/lib/python3.8/site-packages/ray/autoscaler/_private/kubernetes/kubectl-rsync.sh''. Falling back to 'kubectl cp'\n   warnings.warn(\n 2020-11-09 06:31:01,227\tINFO command_runner.py:165 -- NodeUpdater: ray-head-mp2vs: Running kubectl -n ray exec -it ray-head-mp2vs -- bash --login -c -i 'true && source ~/.bashrc && export OMP_NUM_THREADS=1 PYTHONWARNINGS=ignore && (python ~/request_resource.py)'\n 2020-11-09 06:31:01,989\tINFO worker.py:672 -- Connecting to existing Ray cluster at address: 172.17.0.3:6379\n 2020-11-09 06:31:45,315\tWARNING worker.py:1111 -- The monitor failed with the following error:\n Traceback (most recent call last):\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/monitor.py\", line 356, in <module>\n     monitor.run()\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/monitor.py\", line 301, in run\n     self._run()\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/monitor.py\", line 257, in _run\n     self.autoscaler.update()\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/autoscaler/_private/autoscaler.py\", line 139, in update\n     raise e\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/autoscaler/_private/autoscaler.py\", line 128, in update\n     self._update()\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/autoscaler/_private/autoscaler.py\", line 222, in _update\n     self.load_metrics.get_static_node_resources_by_ip())\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/autoscaler/_private/resource_demand_scheduler.py\", line 84, in get_nodes_to_launch\n     self._infer_legacy_node_resources_if_needed(static_node_resources)\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/autoscaler/_private/resource_demand_scheduler.py\", line 182, in _infer_legacy_node_resources_if_needed\n     assert len(static_node_resources) == 1  # Only the head node.\n AssertionError\n \n ^CTraceback (most recent call last):\n   File \"/root/request_resource.py\", line 10, in <module>\n     ray.get(spin.remote())\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/worker.py\", line 1465, in get\n     values = worker.get_objects(object_refs, timeout=timeout)\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/worker.py\", line 315, in get_objects\n     object_refs, self.current_task_id, timeout_ms)\n   File \"python/ray/_raylet.pyx\", line 817, in ray._raylet.CoreWorker.get_objects\n   File \"python/ray/_raylet.pyx\", line 142, in ray._raylet.check_status\n KeyboardInterrupt\n command terminated with exit code 1\n 2020-11-09 06:32:04,619\tERROR command_runner.py:175 -- NodeUpdater: ray-head-mp2vs: Command failed:\n \n   kubectl -n ray exec -it ray-head-mp2vs --'bash --login -c -i '\"'\"'true && source ~/.bashrc && export OMP_NUM_THREADS=1 PYTHONWARNINGS=ignore && (python ~/request_resource.py)'\"'\"''\n </denchmark-code>\n \n I saw what <denchmark-link:https://github.com/PidgeyBE>@PidgeyBE</denchmark-link>\n  observed, even though the head node has enough resource, an extra worker is started, and after 10+ seconds, that worker not crashed somehow. And monitor failed with\n <denchmark-code>  File \"/root/anaconda3/lib/python3.7/site-packages/ray/autoscaler/_private/resource_demand_scheduler.py\", line 84, in get_nodes_to_launch\n     self._infer_legacy_node_resources_if_needed(static_node_resources)\n   File \"/root/anaconda3/lib/python3.7/site-packages/ray/autoscaler/_private/resource_demand_scheduler.py\", line 182, in _infer_legacy_node_resources_if_needed\n     assert len(static_node_resources) == 1  # Only the head node.\n AssertionError\n </denchmark-code>\n \n \t\t"}, "comments_13": {"comment_id": 14, "comment_author": "PidgeyBE", "commentT": "2020-11-09T08:06:56Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/simon-mo>@simon-mo</denchmark-link>\n  , thanks for reporting this.\n Will make a quick fix.\n \t\t"}, "comments_14": {"comment_id": 15, "comment_author": "PidgeyBE", "commentT": "2020-11-09T09:09:19Z", "comment_text": "\n \t\tI haven't seen the exact issue of <denchmark-link:https://github.com/simon-mo>@simon-mo</denchmark-link>\n , but have faced several others. I was wondering if k8s autoscaling is tested in CI/CD?\n \t\t"}, "comments_15": {"comment_id": 16, "comment_author": "PidgeyBE", "commentT": "2020-11-23T22:55:13Z", "comment_text": "\n \t\tThis is fixed in the new autoscaler (nightly), please re-open if it still happens there.\n \t\t"}}}, "commit": {"commit_id": "85197deece837a1f4ffdbbffb72af6028a9b6e32", "commit_author": "Ameer Haj Ali", "commitT": "2020-11-11 13:36:48-08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.3333333333333333"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "doc\\source\\cluster\\autoscaling.rst", "file_new_name": "doc\\source\\cluster\\autoscaling.rst", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "11,12,13,17,18,32,33,34,35,36,45,66", "deleted_lines": "11,15,16,30,31,32,33,34,35,44,65,69,70"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 11, "file_old_name": "python\\ray\\autoscaler\\_private\\autoscaler.py", "file_new_name": "python\\ray\\autoscaler\\_private\\autoscaler.py", "file_complexity": {"file_NLOC": "500", "file_CCN": "87", "file_NToken": "3042"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "369,370,371,372,373,374,375,377,379,380,381", "deleted_lines": "369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398", "method_info": {"method_name": "target_num_workers", "method_params": "self", "method_startline": "369", "method_endline": "398", "method_complexity": {"method_NLOC": "23", "method_CCN": "6", "method_NToken": "166", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "257,258", "deleted_lines": null, "method_info": {"method_name": "_sort_based_on_last_used", "method_params": "self,str", "method_startline": "257", "method_endline": "258", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "26", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "270,271,272", "deleted_lines": null, "method_info": {"method_name": "last_time_used", "method_params": "NodeID", "method_startline": "270", "method_endline": "272", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "148,153,161,162,163,164,167,168,169,173,185,200,201,202,203,204,205,206,207,208,209,210,211,212,213,231", "deleted_lines": "151,152,153,154,159,160,161,162,163,164,165,173,176,180,181,182,194,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,226,227,228,229,230,231,232,233,234,235,236,237,238", "method_info": {"method_name": "_update", "method_params": "self", "method_startline": "138", "method_endline": "255", "method_complexity": {"method_NLOC": "86", "method_CCN": "25", "method_NToken": "603", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "581,583,591", "deleted_lines": "580,582,586,587,588,589,592", "method_info": {"method_name": "log_info_string", "method_params": "self,nodes,target", "method_startline": "580", "method_endline": "592", "method_complexity": {"method_NLOC": "13", "method_CCN": "3", "method_NToken": "89", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,377,379,380,381", "deleted_lines": "352,353,354,355,357,359,360,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388", "method_info": {"method_name": "reset", "method_params": "self,errors_fatal", "method_startline": "312", "method_endline": "388", "method_complexity": {"method_NLOC": "70", "method_CCN": "11", "method_NToken": "338", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "593,594,597,602,603", "deleted_lines": "594,596,597,603", "method_info": {"method_name": "request_resources", "method_params": "self", "method_startline": "593", "method_endline": "603", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "41", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "594,597,602,603", "deleted_lines": "594,596,597,603,604,606", "method_info": {"method_name": "info_string", "method_params": "self,nodes,target", "method_startline": "594", "method_endline": "606", "method_complexity": {"method_NLOC": "12", "method_CCN": "5", "method_NToken": "87", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "570,572,576,577,578,581", "deleted_lines": "580", "method_info": {"method_name": "log_info_string", "method_params": "self,nodes", "method_startline": "570", "method_endline": "581", "method_complexity": {"method_NLOC": "12", "method_CCN": "2", "method_NToken": "80", "method_nesting_level": "1"}}}, "hunk_9": {"Ismethod": 1, "added_lines": null, "deleted_lines": "608,609,612,613,618,619,620,621,622,623", "method_info": {"method_name": "request_resources", "method_params": "self,resources", "method_startline": "608", "method_endline": "623", "method_complexity": {"method_NLOC": "10", "method_CCN": "4", "method_NToken": "66", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "583,591", "deleted_lines": "586,587,588,589", "method_info": {"method_name": "info_string", "method_params": "self,nodes", "method_startline": "583", "method_endline": "591", "method_complexity": {"method_NLOC": "8", "method_CCN": "3", "method_NToken": "58", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\autoscaler\\_private\\aws\\node_provider.py", "file_new_name": "python\\ray\\autoscaler\\_private\\aws\\node_provider.py", "file_complexity": {"file_NLOC": "403", "file_CCN": "73", "file_NToken": "2403"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "305,306,307,308,309,310", "method_info": {"method_name": "_create_node", "method_params": "self,node_config,tags,count", "method_startline": "301", "method_endline": "395", "method_complexity": {"method_NLOC": "70", "method_CCN": "14", "method_NToken": "355", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "python\\ray\\autoscaler\\_private\\load_metrics.py", "file_new_name": "python\\ray\\autoscaler\\_private\\load_metrics.py", "file_complexity": {"file_NLOC": "169", "file_CCN": "39", "file_NToken": "1113"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "102,103", "method_info": {"method_name": "approx_workers_used", "method_params": "self", "method_startline": "102", "method_endline": "103", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "14", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "167", "deleted_lines": "166,167,168,169,170,183,184", "method_info": {"method_name": "_info", "method_params": "self", "method_startline": "166", "method_endline": "206", "method_complexity": {"method_NLOC": "33", "method_CCN": "12", "method_NToken": "262", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "154", "deleted_lines": "131,133,146", "method_info": {"method_name": "_get_resource_usage", "method_params": "self", "method_startline": "123", "method_endline": "154", "method_complexity": {"method_NLOC": "29", "method_CCN": "10", "method_NToken": "181", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": null, "deleted_lines": "105,106", "method_info": {"method_name": "num_workers_connected", "method_params": "self", "method_startline": "105", "method_endline": "106", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "14", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 9, "file_old_name": "python\\ray\\autoscaler\\_private\\resource_demand_scheduler.py", "file_new_name": "python\\ray\\autoscaler\\_private\\resource_demand_scheduler.py", "file_complexity": {"file_NLOC": "561", "file_CCN": "30", "file_NToken": "2864"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "56,57,58,59,60", "deleted_lines": "57", "method_info": {"method_name": "reset_config", "method_params": "self,NodeProvider,NodeType,int,float", "method_startline": "56", "method_endline": "60", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "30", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "224", "deleted_lines": "223,224,225,226", "method_info": {"method_name": "_legacy_worker_node_to_launch", "method_params": "self,NodeType", "method_startline": "223", "method_endline": "226", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "42", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "108", "deleted_lines": "105,113", "method_info": {"method_name": "get_nodes_to_launch", "method_params": "self,NodeType,NodeIP,NodeIP,None", "method_startline": "105", "method_endline": "113", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "54,55,56,57,58,59,60,61,62", "deleted_lines": "57", "method_info": {"method_name": "get_nodes_to_launch", "method_params": "self,NodeType,NodeIP,NodeIP,None", "method_startline": "54", "method_endline": "62", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": null, "deleted_lines": "173", "method_info": {"method_name": "_legacy_worker_node_to_launch", "method_params": "self,NodeType", "method_startline": "172", "method_endline": "175", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "42", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "94,95,96", "deleted_lines": null, "method_info": {"method_name": "is_legacy_yaml", "method_params": "self,NodeType,None", "method_startline": "94", "method_endline": "96", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "18", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "46,47,49,50", "deleted_lines": "49,50", "method_info": {"method_name": "__init__", "method_params": "self,NodeProvider,NodeType,int,float", "method_startline": "46", "method_endline": "50", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "30", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": null, "deleted_lines": "43,45", "method_info": {"method_name": "__init__", "method_params": "self,NodeProvider,NodeType,int", "method_startline": "43", "method_endline": "45", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "71,72,73,74,75,76,77,78,79,80,81,82,83", "deleted_lines": "78", "method_info": {"method_name": "_update_based_on_node_config", "method_params": "NodeType", "method_startline": "71", "method_endline": "83", "method_complexity": {"method_NLOC": "10", "method_CCN": "3", "method_NToken": "74", "method_nesting_level": "4"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\_private\\util.py", "file_new_name": "python\\ray\\autoscaler\\_private\\util.py", "file_complexity": {"file_NLOC": "187", "file_CCN": "36", "file_NToken": "1229"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "104,105,108,112,118,119,120,125,126", "deleted_lines": "104,105,106,112,118,119,120,125"}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\aws\\defaults.yaml", "file_new_name": "python\\ray\\autoscaler\\aws\\defaults.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,27,28,29,30,31,32,33"}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\aws\\development-example.yaml", "file_new_name": "python\\ray\\autoscaler\\aws\\development-example.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17"}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\aws\\example-full.yaml", "file_new_name": "python\\ray\\autoscaler\\aws\\example-full.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,40,41,42,43,44,45,46"}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\aws\\example-gpu-docker.yaml", "file_new_name": "python\\ray\\autoscaler\\aws\\example-gpu-docker.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,34,35,36,37,38,39,40"}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\aws\\example-ml.yaml", "file_new_name": "python\\ray\\autoscaler\\aws\\example-ml.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "17,18,19,20,21", "deleted_lines": "17,18,19,20,21,22,23,24,25,43,44,45,46,47,48,49"}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\aws\\example-multi-node-type.yaml", "file_new_name": "python\\ray\\autoscaler\\aws\\example-multi-node-type.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "6,7,8,9,10,11", "deleted_lines": "65,66"}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\azure\\defaults.yaml", "file_new_name": "python\\ray\\autoscaler\\azure\\defaults.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,27,28,29,30,31,32,33"}}}, "file_13": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\azure\\example-full.yaml", "file_new_name": "python\\ray\\autoscaler\\azure\\example-full.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,40,41,42,43,44,45,46"}}}, "file_14": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\azure\\example-gpu-docker.yaml", "file_new_name": "python\\ray\\autoscaler\\azure\\example-gpu-docker.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,34,35,36,37,38,39,40"}}}, "file_15": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\azure\\example-gpu.yaml", "file_new_name": "python\\ray\\autoscaler\\azure\\example-gpu.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,38,39,40,41,42,43,44"}}}, "file_16": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\gcp\\defaults.yaml", "file_new_name": "python\\ray\\autoscaler\\gcp\\defaults.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,27,28,29,30,31,32,33,34"}}}, "file_17": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\gcp\\example-full.yaml", "file_new_name": "python\\ray\\autoscaler\\gcp\\example-full.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,40,41,42,43,44,45,46,47"}}}, "file_18": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\gcp\\example-gpu-docker.yaml", "file_new_name": "python\\ray\\autoscaler\\gcp\\example-gpu-docker.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,35,36,37,38,39,40,41,42"}}}, "file_19": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\kubernetes\\defaults.yaml", "file_new_name": "python\\ray\\autoscaler\\kubernetes\\defaults.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27"}}}, "file_20": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\kubernetes\\example-full.yaml", "file_new_name": "python\\ray\\autoscaler\\kubernetes\\example-full.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27"}}}, "file_21": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\kubernetes\\example-ingress.yaml", "file_new_name": "python\\ray\\autoscaler\\kubernetes\\example-ingress.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "12,13,14,15,16", "deleted_lines": "12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27"}}}, "file_22": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\local\\defaults.yaml", "file_new_name": "python\\ray\\autoscaler\\local\\defaults.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "4,8,13,16,17,18,19,20,21", "deleted_lines": "4,8,10,11,12,16,19,20,21,22"}}}, "file_23": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\local\\development-example.yaml", "file_new_name": "python\\ray\\autoscaler\\local\\development-example.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "7", "deleted_lines": "7"}}}, "file_24": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\local\\example-full.yaml", "file_new_name": "python\\ray\\autoscaler\\local\\example-full.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "4,8,13,16,17,18,19,20,21", "deleted_lines": "4,8,10,11,12,16,19,20,21,22"}}}, "file_25": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\ray-schema.json", "file_new_name": "python\\ray\\autoscaler\\ray-schema.json", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "52,53,54,55,56", "deleted_lines": null}}}, "file_26": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\staroid\\defaults.yaml", "file_new_name": "python\\ray\\autoscaler\\staroid\\defaults.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "13,14,15,16,17", "deleted_lines": "13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28"}}}, "file_27": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\staroid\\example-full.yaml", "file_new_name": "python\\ray\\autoscaler\\staroid\\example-full.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "13,14,15,16,17", "deleted_lines": "13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28"}}}, "file_28": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\staroid\\example-gpu.yaml", "file_new_name": "python\\ray\\autoscaler\\staroid\\example-gpu.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "13,14,15,16,17", "deleted_lines": "13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28"}}}, "file_29": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\autoscaler\\staroid\\example-multi-node-type.yaml", "file_new_name": "python\\ray\\autoscaler\\staroid\\example-multi-node-type.yaml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "6,7,8,9,10,11", "deleted_lines": "111,112"}}}, "file_30": {"file_change_type": "MODIFY", "file_Nmethod": 21, "file_old_name": "python\\ray\\tests\\test_autoscaler.py", "file_new_name": "python\\ray\\tests\\test_autoscaler.py", "file_complexity": {"file_NLOC": "1321", "file_CCN": "128", "file_NToken": "8311"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "595,613", "deleted_lines": "594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612", "method_info": {"method_name": "testInitialWorkers", "method_params": "self", "method_startline": "594", "method_endline": "613", "method_complexity": {"method_NLOC": "19", "method_CCN": "1", "method_NToken": "98", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "813,837,838,841,844,845", "deleted_lines": null, "method_info": {"method_name": "testDelayedLaunchWithMinWorkers", "method_params": "self", "method_startline": "813", "method_endline": "849", "method_complexity": {"method_NLOC": "33", "method_CCN": "1", "method_NToken": "227", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "257,258,259,260,261,262,263,264", "method_info": {"method_name": "testUpdate", "method_params": "self", "method_startline": "257", "method_endline": "264", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "103", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "585,586,587,588,589,590,595", "deleted_lines": "582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611", "method_info": {"method_name": "testManualAutoscaling", "method_params": "self", "method_startline": "582", "method_endline": "611", "method_complexity": {"method_NLOC": "30", "method_CCN": "3", "method_NToken": "195", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "1215,1216,1217,1218", "deleted_lines": null, "method_info": {"method_name": "testExternalNodeScalerWrongModuleFormat", "method_params": "self", "method_startline": "1209", "method_endline": "1221", "method_complexity": {"method_NLOC": "13", "method_CCN": "1", "method_NToken": "79", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "899,902,912,924,925,926,927,928", "deleted_lines": "895,896,898,899,900,901,902,903,904,906,907,908,909,910,913,914,915,916,917,918,920,921", "method_info": {"method_name": "testIgnoresCorruptedConfig", "method_params": "self", "method_startline": "895", "method_endline": "930", "method_complexity": {"method_NLOC": "30", "method_CCN": "2", "method_NToken": "200", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": null, "deleted_lines": "378,381", "method_info": {"method_name": "write_config", "method_params": "self,config", "method_startline": "378", "method_endline": "382", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "44", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "560,563,585,586,587,588,589,590", "deleted_lines": "582,583,584,585,586,587,588,589,590,591,592", "method_info": {"method_name": "testDynamicScaling", "method_params": "self", "method_startline": "556", "method_endline": "592", "method_complexity": {"method_NLOC": "31", "method_CCN": "1", "method_NToken": "186", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "325,326,327,328,331", "deleted_lines": "334,335", "method_info": {"method_name": "testDebugString", "method_params": "self", "method_startline": "319", "method_endline": "335", "method_complexity": {"method_NLOC": "17", "method_CCN": "1", "method_NToken": "112", "method_nesting_level": "1"}}}, "hunk_9": {"Ismethod": 1, "added_lines": "288", "deleted_lines": "266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296", "method_info": {"method_name": "testLoadMessages", "method_params": "self", "method_startline": "266", "method_endline": "296", "method_complexity": {"method_NLOC": "25", "method_CCN": "1", "method_NToken": "436", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "325,326,327,328,331", "deleted_lines": null, "method_info": {"method_name": "write_config", "method_params": "self,config,call_prepare_config", "method_startline": "325", "method_endline": "332", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "65", "method_nesting_level": "1"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "288", "deleted_lines": "285,286,287,288,289,290", "method_info": {"method_name": "setUp", "method_params": "self", "method_startline": "285", "method_endline": "290", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "40", "method_nesting_level": "1"}}}, "hunk_12": {"Ismethod": 1, "added_lines": "1095,1098,1099,1114,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1128,1129,1130,1131,1132,1133,1134,1135,1136,1137,1138,1139,1140,1141,1142,1143,1144,1145,1146,1147,1148,1149,1150,1151,1152,1153,1154,1155", "deleted_lines": "1123,1124,1127,1150,1153,1154", "method_info": {"method_name": "testTargetUtilizationFraction", "method_params": "self", "method_startline": "1095", "method_endline": "1156", "method_complexity": {"method_NLOC": "56", "method_CCN": "2", "method_NToken": "374", "method_nesting_level": "1"}}}, "hunk_13": {"Ismethod": 1, "added_lines": null, "deleted_lines": "389", "method_info": {"method_name": "testAutoscalerConfigValidationFailNotFatal", "method_params": "self", "method_startline": "384", "method_endline": "403", "method_complexity": {"method_NLOC": "18", "method_CCN": "1", "method_NToken": "106", "method_nesting_level": "1"}}}, "hunk_14": {"Ismethod": 1, "added_lines": null, "deleted_lines": "298,299,300,301,302,303", "method_info": {"method_name": "testPruneByNodeIp", "method_params": "self", "method_startline": "298", "method_endline": "303", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "72", "method_nesting_level": "1"}}}, "hunk_15": {"Ismethod": 1, "added_lines": "899,902,912,924", "deleted_lines": "871,895,896,898,899,900,901,902,903,904,906,907,908,909,910,913,914,915,916,917,918,920,921", "method_info": {"method_name": "testDelayedLaunchWithFailure", "method_params": "self", "method_startline": "871", "method_endline": "924", "method_complexity": {"method_NLOC": "40", "method_CCN": "1", "method_NToken": "273", "method_nesting_level": "1"}}}, "hunk_16": {"Ismethod": 1, "added_lines": "727,728,729,730,731", "deleted_lines": "688,689,690,691,699,703,705,721,722,723,724,725,726,727,728,729,730,731,732,733", "method_info": {"method_name": "testUnmanagedNodes", "method_params": "self", "method_startline": "686", "method_endline": "733", "method_complexity": {"method_NLOC": "40", "method_CCN": "1", "method_NToken": "288", "method_nesting_level": "1"}}}, "hunk_17": {"Ismethod": 1, "added_lines": "1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1067,1068,1069,1070,1071,1086", "deleted_lines": null, "method_info": {"method_name": "testScaleUpBasedOnLoad", "method_params": "self", "method_startline": "1030", "method_endline": "1093", "method_complexity": {"method_NLOC": "57", "method_CCN": "1", "method_NToken": "422", "method_nesting_level": "1"}}}, "hunk_18": {"Ismethod": 1, "added_lines": null, "deleted_lines": "305,306,307,308,309", "method_info": {"method_name": "testBottleneckResource", "method_params": "self", "method_startline": "305", "method_endline": "309", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "70", "method_nesting_level": "1"}}}, "hunk_19": {"Ismethod": 1, "added_lines": "621,625,626,627,628,630,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684", "deleted_lines": "644,666", "method_info": {"method_name": "testAggressiveAutoscaling", "method_params": "self", "method_startline": "615", "method_endline": "684", "method_complexity": {"method_NLOC": "64", "method_CCN": "2", "method_NToken": "373", "method_nesting_level": "1"}}}, "hunk_20": {"Ismethod": 1, "added_lines": "1150,1151,1152,1153,1154,1155", "deleted_lines": "1150,1153,1154,1169,1170,1171,1172,1173,1177,1178,1179,1180,1181,1184,1185,1186,1187", "method_info": {"method_name": "testDontScaleBelowTarget", "method_params": "self", "method_startline": "1150", "method_endline": "1187", "method_complexity": {"method_NLOC": "30", "method_CCN": "1", "method_NToken": "249", "method_nesting_level": "1"}}}}}, "file_31": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_attach.txt", "file_new_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_attach.txt", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "1,2"}}}, "file_32": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_exec.txt", "file_new_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_exec.txt", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "1,2"}}}, "file_33": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_submit.txt", "file_new_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_submit.txt", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "1,2,5,6"}}}, "file_34": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_up.txt", "file_new_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_up.txt", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "3,4"}}}, "file_35": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_up_record.txt", "file_new_name": "python\\ray\\tests\\test_cli_patterns\\test_ray_up_record.txt", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "2,3"}}}, "file_36": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "python\\ray\\tests\\test_multi_node_2.py", "file_new_name": "python\\ray\\tests\\test_multi_node_2.py", "file_complexity": {"file_NLOC": "138", "file_CCN": "34", "file_NToken": "996"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "81,82,83,84,87,89,90,91,97", "deleted_lines": "83,85,86,87,88,92,93,94,97", "method_info": {"method_name": "verify_load_metrics", "method_params": "monitor,expected_resource_usage,timeout", "method_startline": "75", "method_endline": "110", "method_complexity": {"method_NLOC": "32", "method_CCN": "16", "method_NToken": "231", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "128,142,162", "deleted_lines": "128,142,143,144,145,146", "method_info": {"method_name": "test_heartbeats_single", "method_params": "ray_start_cluster_head", "method_startline": "120", "method_endline": "165", "method_complexity": {"method_NLOC": "21", "method_CCN": "1", "method_NToken": "179", "method_nesting_level": "0"}}}}}, "file_37": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "python\\ray\\tests\\test_resource_demand_scheduler.py", "file_new_name": "python\\ray\\tests\\test_resource_demand_scheduler.py", "file_complexity": {"file_NLOC": "1274", "file_CCN": "71", "file_NToken": "8989"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1117", "deleted_lines": "1115,1116", "method_info": {"method_name": "testScaleUpMinWorkers", "method_params": "self", "method_startline": "1113", "method_endline": "1161", "method_complexity": {"method_NLOC": "46", "method_CCN": "5", "method_NToken": "322", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "1028,1029,1030,1031", "deleted_lines": "1028", "method_info": {"method_name": "testScaleUpMinSanity", "method_params": "self", "method_startline": "1027", "method_endline": "1044", "method_complexity": {"method_NLOC": "18", "method_CCN": "1", "method_NToken": "108", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "1471,1472,1473,1486", "deleted_lines": "1470,1483", "method_info": {"method_name": "testUpdateConfig", "method_params": "self", "method_startline": "1470", "method_endline": "1491", "method_complexity": {"method_NLOC": "22", "method_CCN": "1", "method_NToken": "143", "method_nesting_level": "1"}}}}}}}}