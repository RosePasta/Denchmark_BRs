{"BR": {"BR_id": "12461", "BR_author": "ingambe", "BRopenT": "2020-11-27T17:26:38Z", "BRcloseT": "2020-11-28T18:07:55Z", "BR_text": {"BRsummary": "[rllib][tune] HyperOpt transform list in tuple and cause an exception", "BRdescription": "\n <denchmark-h:h3>What is the problem?</denchmark-h>\n \n HyperOpt seems to transform the config[\"input_evaluation\"] and convert it to a tuple (rather than a list) and it leads to an exception:\n \n 2020-11-27 17:55:26,360\tINFO services.py:1106 -- View the Ray dashboard at http://127.0.0.1:8265\n Traceback (most recent call last):\n File \"/home/local/IWAS/pierre/PycharmProjects/JSS/JSS/train.py\", line 133, in \n train_func()\n File \"/home/local/IWAS/pierre/PycharmProjects/JSS/JSS/train.py\", line 126, in train_func\n loggers=DEFAULT_LOGGERS)\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/tune/tune.py\", line 411, in run\n runner.step()\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/tune/trial_runner.py\", line 379, in step\n next_trial = self._get_next_trial()  # blocking\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/tune/trial_runner.py\", line 478, in _get_next_trial\n self._update_trial_queue(blocking=wait_for_trial)\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/tune/trial_runner.py\", line 855, in _update_trial_queue\n trial = self._search_alg.next_trial()\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/tune/suggest/search_generator.py\", line 114, in next_trial\n self._experiment.dir_name)\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/tune/suggest/search_generator.py\", line 144, in create_trial_if_possible\n trial_id=trial_id)\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/tune/config_parser.py\", line 198, in create_trial_from_spec\n **trial_kwargs)\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/tune/trial.py\", line 215, in init\n self.config)\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/rllib/agents/trainer.py\", line 472, in default_resource_request\n Trainer._validate_config(cf)\n File \"/home/local/IWAS/pierre/anaconda3/envs/JSS_Scratch/lib/python3.7/site-packages/ray/rllib/agents/trainer.py\", line 1064, in _validate_config\n config[\"input_evaluation\"]))\n ValueError: input_evaluation must be a list of strings, got ('is', 'wis')\n \n To fix this issue, I just convert input_evaluation from tuple to list if it's a tuple (as tuples can be converted into a list in Python without problem).\n I've open this issue just to link it to my pull request \ud83d\ude0a\n Ray version and other system information (Python version, TensorFlow version, OS):\n Nighlty ray build\n Pytorch 1.7.0\n Python 3.8.0\n Ubuntu 20\n <denchmark-h:h3>Reproduction (REQUIRED)</denchmark-h>\n \n <denchmark-code>hyperopt_search = HyperOptSearch(\n     metric=\"episode_reward_mean\", mode=\"max\",\n     points_to_evaluate=current_best_params)\n \n analysis = tune.run(PPOTrainer,\n                     config=config,\n                     stop=stop,\n                     search_alg=hyperopt_search,\n                     num_samples=1200,\n                     checkpoint_freq=10)\n </denchmark-code>\n \n If we cannot run your script, we cannot fix your issue.\n \n  I have verified my script runs in a clean environment and reproduces the issue.\n  I have verified the issue also occurs with the latest wheels.\n \n \t"}, "comments": {}}, "commit": {"commit_id": "60a545ab57ec3bb9475812fec4f799d400c84b2c", "commit_author": "Pierre TASSEL", "commitT": "2020-11-28 10:07:54-08:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "rllib\\agents\\trainer.py", "file_new_name": "rllib\\agents\\trainer.py", "file_complexity": {"file_NLOC": "731", "file_CCN": "103", "file_NToken": "4029"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1056,1057,1058", "deleted_lines": "1056", "method_info": {"method_name": "_validate_config", "method_params": "PartialTrainerConfigDict", "method_startline": "1050", "method_endline": "1072", "method_complexity": {"method_NLOC": "20", "method_CCN": "6", "method_NToken": "137", "method_nesting_level": "1"}}}}}}}}