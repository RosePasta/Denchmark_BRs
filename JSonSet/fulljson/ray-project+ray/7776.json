{"BR": {"BR_id": "7776", "BR_author": "richardliaw", "BRopenT": "2020-03-27T18:38:38Z", "BRcloseT": "2020-03-29T02:08:32Z", "BR_text": {"BRsummary": "[rllib] Torch should be soft-import?", "BRdescription": "\n <denchmark-h:h3>What is the problem?</denchmark-h>\n \n Seems like this error is showing up on Travis after Contextual Bandits were merged:\n <denchmark-code>Traceback (most recent call last):\n   File \"/private/var/tmp/_bazel_travis/7c557718f3877739c657a427203800b1/execroot/com_github_ray_project_ray/bazel-out/darwin-opt/bin/python/ray/tune/test_trial_runner.runfiles/com_github_ray_project_ray/python/ray/tune/tests/test_trial_runner.py\", line 6, in <module>\n     from ray.rllib import _register_all\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/__init__.py\", line 60, in <module>\n     _register_all()\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/__init__.py\", line 37, in _register_all\n     register_trainable(key, get_agent_class(key))\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/agents/registry.py\", line 130, in get_agent_class\n     return _get_agent_class(alg)\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/agents/registry.py\", line 140, in _get_agent_class\n     return CONTRIBUTED_ALGORITHMS[alg]()\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/registry.py\", line 21, in _import_bandit_lints\n     from ray.rllib.contrib.bandits.agents.lin_ts import LinTSTrainer\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/bandits/agents/__init__.py\", line 1, in <module>\n     from ray.rllib.contrib.bandits.agents.lin_ts import LinTSTrainer\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/bandits/agents/lin_ts.py\", line 5, in <module>\n     from ray.rllib.contrib.bandits.agents.policy import BanditPolicy\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/bandits/agents/policy.py\", line 6, in <module>\n     from ray.rllib.contrib.bandits.models.linear_regression import \\\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/bandits/models/linear_regression.py\", line 9, in <module>\n     class OnlineLinearRegression(nn.Module):\n AttributeError: 'NoneType' object has no attribute 'Module'\n ================================================================================\n ==================== Test output for //python/ray/tune:test_trial_runner:\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\n /Users/travis/miniconda/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n   np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\n lz4 not available, disabling sample compression. This will significantly impact RLlib performance. To install lz4, run `pip install lz4`.\n Traceback (most recent call last):\n   File \"/private/var/tmp/_bazel_travis/7c557718f3877739c657a427203800b1/execroot/com_github_ray_project_ray/bazel-out/darwin-opt/bin/python/ray/tune/test_trial_runner.runfiles/com_github_ray_project_ray/python/ray/tune/tests/test_trial_runner.py\", line 6, in <module>\n     from ray.rllib import _register_all\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/__init__.py\", line 60, in <module>\n     _register_all()\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/__init__.py\", line 37, in _register_all\n     register_trainable(key, get_agent_class(key))\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/agents/registry.py\", line 130, in get_agent_class\n     return _get_agent_class(alg)\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/agents/registry.py\", line 140, in _get_agent_class\n     return CONTRIBUTED_ALGORITHMS[alg]()\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/registry.py\", line 21, in _import_bandit_lints\n     from ray.rllib.contrib.bandits.agents.lin_ts import LinTSTrainer\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/bandits/agents/__init__.py\", line 1, in <module>\n     from ray.rllib.contrib.bandits.agents.lin_ts import LinTSTrainer\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/bandits/agents/lin_ts.py\", line 5, in <module>\n     from ray.rllib.contrib.bandits.agents.policy import BanditPolicy\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/bandits/agents/policy.py\", line 6, in <module>\n     from ray.rllib.contrib.bandits.models.linear_regression import \\\n   File \"/Users/travis/build/ray-project/ray/python/ray/rllib/contrib/bandits/models/linear_regression.py\", line 9, in <module>\n     class OnlineLinearRegression(nn.Module):\n AttributeError: 'NoneType' object has no attribute 'Module'\n </denchmark-code>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "d6255c3395f17a697b76e53891ee40a86e287ff3", "commit_author": "Eric Liang", "commitT": "2020-03-28 19:08:31-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.5"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": ".travis.yml", "file_new_name": ".travis.yml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "153,171", "deleted_lines": "153,171"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "rllib\\utils\\framework.py", "file_new_name": "rllib\\utils\\framework.py", "file_complexity": {"file_NLOC": "83", "file_CCN": "28", "file_NToken": "415"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "109,110", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,a,kw", "method_startline": "109", "method_endline": "110", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "16", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "132,133,134,135", "deleted_lines": "121", "method_info": {"method_name": "try_import_torch", "method_params": "error", "method_startline": "113", "method_endline": "135", "method_complexity": {"method_NLOC": "14", "method_CCN": "4", "method_NToken": "63", "method_nesting_level": "0"}}}}}}}}