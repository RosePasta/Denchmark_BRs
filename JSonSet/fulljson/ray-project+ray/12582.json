{"BR": {"BR_id": "12582", "BR_author": "wuisawesome", "BRopenT": "2020-12-02T22:13:00Z", "BRcloseT": "2020-12-15T03:04:35Z", "BR_text": {"BRsummary": "[New scheduler] Queued ready tasks may be reported as infeasible in heartbeat", "BRdescription": "\n <denchmark-h:h3>What is the problem?</denchmark-h>\n \n When the cluster is fully utilized, tasks which are feasible but not schedulable may be incorrectly classified as infeasible.\n This has no consequences because we always treat both sets of tasks the same way.\n Ray version and other system information (Python version, TensorFlow version, OS):\n <denchmark-h:h3>Reproduction (REQUIRED)</denchmark-h>\n \n Please provide a script that can be run to reproduce the issue. The script should have no external library dependencies (i.e., use fake or mock data / environments):\n If we cannot run your script, we cannot fix your issue.\n \n  I have verified my script runs in a clean environment and reproduces the issue.\n  I have verified the issue also occurs with the latest wheels.\n \n \t"}, "comments": {}}, "commit": {"commit_id": "aa64cd45343427ca03f4f997ecf163d84d0154bb", "commit_author": "Alex Wu", "commitT": "2020-12-11 21:47:01-08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\tests\\test_global_state.py", "file_new_name": "python\\ray\\tests\\test_global_state.py", "file_complexity": {"file_NLOC": "252", "file_CCN": "48", "file_NToken": "1639"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "198,199", "deleted_lines": "147", "method_info": {"method_name": "test_load_report", "method_params": "shutdown_only,max_shapes", "method_startline": "147", "method_endline": "217", "method_complexity": {"method_NLOC": "42", "method_CCN": "8", "method_NToken": "238", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\ray\\common\\task\\task.cc", "file_new_name": "src\\ray\\common\\task\\task.cc", "file_complexity": {"file_NLOC": "35", "file_CCN": "11", "file_NToken": "258"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "38", "deleted_lines": null, "method_info": {"method_name": "ray::Task::SetBacklogSize", "method_params": "backlog_size", "method_startline": "38", "method_endline": "38", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "13", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\ray\\common\\task\\task.h", "file_new_name": "src\\ray\\common\\task\\task.h", "file_complexity": {"file_NLOC": "47", "file_CCN": "7", "file_NToken": "308"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "92,93", "deleted_lines": null}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\ray\\raylet\\scheduling\\cluster_resource_scheduler.cc", "file_new_name": "src\\ray\\raylet\\scheduling\\cluster_resource_scheduler.cc", "file_complexity": {"file_NLOC": "707", "file_CCN": "169", "file_NToken": "5038"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "79,80,81,82,83,84,85,86", "deleted_lines": null, "method_info": {"method_name": "ray::ClusterResourceScheduler::IsLocallyFeasible", "method_params": "shape", "method_startline": "79", "method_endline": "86", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "77", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\ray\\raylet\\scheduling\\cluster_resource_scheduler.h", "file_new_name": "src\\ray\\raylet\\scheduling\\cluster_resource_scheduler.h", "file_complexity": {"file_NLOC": "98", "file_CCN": "6", "file_NToken": "768"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "76,77,78,79,80,81,82", "deleted_lines": null}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 9, "file_old_name": "src\\ray\\raylet\\scheduling\\cluster_task_manager.cc", "file_new_name": "src\\ray\\raylet\\scheduling\\cluster_task_manager.cc", "file_complexity": {"file_NLOC": "451", "file_CCN": "79", "file_NToken": "3458"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "243,244,245,260,261,262,275,276", "deleted_lines": "239,254", "method_info": {"method_name": "ray::raylet::ClusterTaskManager::CancelTask", "method_params": "task_id", "method_startline": "238", "method_endline": "283", "method_complexity": {"method_NLOC": "44", "method_CCN": "10", "method_NToken": "338", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "140", "deleted_lines": "137", "method_info": {"method_name": "ray::raylet::ClusterTaskManager::DispatchScheduledTasksToWorkers", "method_params": "worker_pool,leased_workers", "method_startline": "103", "method_endline": "157", "method_complexity": {"method_NLOC": "45", "method_CCN": "9", "method_NToken": "350", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "524,525,526,527,528,529", "deleted_lines": null, "method_info": {"method_name": "ray::raylet::ClusterTaskManager::AddToBacklogTracker", "method_params": "task", "method_startline": "524", "method_endline": "529", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "41", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "288,289,290,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,342,343,344,345,346,347,348,349,350,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,387,388,389,390,391,392,393,394,395,412,413,414,415,416,417", "deleted_lines": "285,304,305,306,328,329,330,350", "method_info": {"method_name": "ray::raylet::ClusterTaskManager::FillResourceUsage", "method_params": "light_report_resource_usage_enabled,data", "method_startline": "285", "method_endline": "420", "method_complexity": {"method_NLOC": "104", "method_CCN": "20", "method_NToken": "721", "method_nesting_level": "2"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "531,532,533,534,535,536,537,538,539", "deleted_lines": null, "method_info": {"method_name": "ray::raylet::ClusterTaskManager::RemoveFromBacklogTracker", "method_params": "task", "method_startline": "531", "method_endline": "539", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "64", "method_nesting_level": "2"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "205", "deleted_lines": null, "method_info": {"method_name": "ray::raylet::ClusterTaskManager::QueueTask", "method_params": "task,reply,callback", "method_startline": "199", "method_endline": "206", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "91", "method_nesting_level": "2"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "437,439", "deleted_lines": null, "method_info": {"method_name": "ray::raylet::ClusterTaskManager::Dispatch", "method_params": "worker,leased_workers,task,reply,send_reply_callback", "method_startline": "434", "method_endline": "498", "method_complexity": {"method_NLOC": "57", "method_CCN": "10", "method_NToken": "492", "method_nesting_level": "2"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "20,21,22,23", "deleted_lines": "20", "method_info": {"method_name": "ray::raylet::ClusterTaskManager::ClusterTaskManager", "method_params": "self_node_id,cluster_resource_scheduler,fulfills_dependencies_func,is_owner_alive,get_node_info", "method_startline": "10", "method_endline": "23", "method_complexity": {"method_NLOC": "14", "method_CCN": "1", "method_NToken": "103", "method_nesting_level": "2"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "347,348,349,350,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,387,388,389,390,391,392,393,394,395", "deleted_lines": "350", "method_info": {"method_name": "ray::raylet::ClusterTaskManager::Dispatch", "method_params": "worker,leased_workers,task_spec,reply,send_reply_callback", "method_startline": "347", "method_endline": "410", "method_complexity": {"method_NLOC": "56", "method_CCN": "10", "method_NToken": "481", "method_nesting_level": "2"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\ray\\raylet\\scheduling\\cluster_task_manager.h", "file_new_name": "src\\ray\\raylet\\scheduling\\cluster_task_manager.h", "file_complexity": {"file_NLOC": "60", "file_CCN": "0", "file_NToken": "461"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "131,132,133,146,147,148,158,162,163,164", "deleted_lines": "152"}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\ray\\raylet\\scheduling\\cluster_task_manager_test.cc", "file_new_name": "src\\ray\\raylet\\scheduling\\cluster_task_manager_test.cc", "file_complexity": {"file_NLOC": "399", "file_CCN": "29", "file_NToken": "3348"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538", "deleted_lines": null, "method_info": {"method_name": "ray::raylet::TEST_F", "method_params": "ClusterTaskManagerTest,BacklogReportTest", "method_startline": "483", "method_endline": "538", "method_complexity": {"method_NLOC": "40", "method_CCN": "3", "method_NToken": "383", "method_nesting_level": "2"}}}}}}}}