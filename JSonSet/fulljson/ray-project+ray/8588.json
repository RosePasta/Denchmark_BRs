{"BR": {"BR_id": "8588", "BR_author": "mehrdadn", "BRopenT": "2020-05-25T06:30:37Z", "BRcloseT": "2020-06-16T22:30:16Z", "BR_text": {"BRsummary": "Possible deadlock in ReferenceCounter (caught by debug mode)", "BRdescription": "\n There's a mutex-related error <denchmark-link:https://travis-ci.com/github/ray-project/ray/jobs/339356136#L4052>here</denchmark-link>\n  in :\n <denchmark-code>_raylet.so((anonymous namespace)::RawLogVA(absl::lts_2019_08_08::LogSeverity, char const*, int, char const*, __va_list_tag*)+0x204) [0x15f485d]\n _raylet.so(absl::lts_2019_08_08::raw_logging_internal::RawLog(absl::lts_2019_08_08::LogSeverity, char const*, int, char const*, ...)+0xaf) [0x15f4958]\n _raylet.so(absl::lts_2019_08_08::DeadlockCheck(absl::lts_2019_08_08::Mutex*)+0x4d7) [0x15bd09a]\n _raylet.so(absl::lts_2019_08_08::DebugOnlyDeadlockCheck(absl::lts_2019_08_08::Mutex*)+0x32) [0x15bd161]\n _raylet.so(absl::lts_2019_08_08::Mutex::Lock()+0x18) [0x15bd544]\n _raylet.so(absl::lts_2019_08_08::MutexLock::MutexLock(absl::lts_2019_08_08::Mutex*)+0x2a) [0xab1c54]\n _raylet.so(ray::ReferenceCounter::UpdateFinishedTaskReferences(std::vector<ray::ObjectID> const&, bool, ray::rpc::Address const&, google::protobuf::RepeatedPtrField<ray::rpc::ObjectReferenceCount> const&, std::vector<ray::ObjectID>*)+0x6a) [0xbfb8f2]\n _raylet.so(ray::TaskManager::RemoveFinishedTaskReferences(ray::TaskSpecification&, bool, ray::rpc::Address const&, google::protobuf::RepeatedPtrField<ray::rpc::ObjectReferenceCount> const&)+0x2c0) [0xbcf6fe]\n _raylet.so(ray::TaskManager::PendingTaskFailed(ray::TaskID const&, ray::rpc::ErrorType, ray::Status*)+0x89e) [0xbceff8]\n _raylet.so(ray::CoreWorkerDirectActorTaskSubmitter::SubmitTask(ray::TaskSpecification)+0x3b4) [0xba517a]\n _raylet.so(ray::CoreWorker::SubmitActorTask(ray::ActorID const&, ray::RayFunction const&, std::vector<ray::TaskArg> const&, ray::TaskOptions const&, std::vector<ray::ObjectID>*)+0x443) [0xa9d441]\n _raylet.so(__pyx_pf_3ray_7_raylet_10CoreWorker_42submit_actor_task(__pyx_obj_3ray_7_raylet_CoreWorker*, __pyx_obj_3ray_7_raylet_Language*, __pyx_obj_3ray_7_raylet_ActorID*, __pyx_obj_3ray_7_raylet_FunctionDescriptor*, _object*, int, double)+0xa9b) [0x9ed973]\n </denchmark-code>\n \n The stack trace should be reproducible by putting stdlib in debug mode, e.g.:\n <denchmark-code>bazel test -c dbg --copt=\"-D_GLIBCXX_DEBUG\" //python/ray/tests:test_actor_failures\n </denchmark-code>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "fa16c7666a0f97e66b8334fbbb6ac448f281f4e7", "commit_author": "Stephanie Wang", "commitT": "2020-06-16 15:30:15-07:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\ray\\core_worker\\transport\\direct_actor_transport.cc", "file_new_name": "src\\ray\\core_worker\\transport\\direct_actor_transport.cc", "file_complexity": {"file_NLOC": "283", "file_CCN": "49", "file_NToken": "2357"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "71,86,87,100,101,102,103,104,105,106,107", "deleted_lines": "71,72,73,74,75,76,77,78", "method_info": {"method_name": "ray::CoreWorkerDirectActorTaskSubmitter::SubmitTask", "method_params": "task_spec", "method_startline": "61", "method_endline": "113", "method_complexity": {"method_NLOC": "37", "method_CCN": "4", "method_NToken": "300", "method_nesting_level": "1"}}}}}}}}