{"BR": {"BR_id": "11336", "BR_author": "AmeerHajAli", "BRopenT": "2020-10-12T03:16:26Z", "BRcloseT": "2020-10-14T23:50:42Z", "BR_text": {"BRsummary": "[C++ API] The cluster_mode_test.cc fails if it was made run functions that have no arguments.", "BRdescription": "\n The cluster_mode_test.cc fails if it was made run functions that have no arguments.\n e.g.,\n <denchmark-code>int func() { return 1; }\n \n   auto task_obj = Ray::Task(func).Remote();\n   int task_result = *(Ray::Get(task_obj));\n   EXPECT_EQ(1, task_result);\n </denchmark-code>\n \n The output error:\n <denchmark-code>E1013 08:11:39.012250  2800  2917 core_worker.cc:419] Will resubmit task after a 5000ms delay: Type=NORMAL_TASK, Language=CPP, Resources: {}, function_descriptor={type=CppFunctionDescriptor, lib_name=, function_offset=961856, exec_function_offset=982992}, task_id=df5a1a828c9685d3ffffffff01000000, task_name=+961856, job_id=01000000, num_args=1, num_returns=1\n E1013 08:11:45.001149  2800  2917 task_manager.cc:323] Task failed: IOError: 14: Socket closed: Type=NORMAL_TASK, Language=CPP, Resources: {}, function_descriptor={type=CppFunctionDescriptor, lib_name=, function_offset=961856, exec_function_offset=982992}, task_id=df5a1a828c9685d3ffffffff01000000, task_name=+961856, job_id=01000000, num_args=1, num_returns=1\n </denchmark-code>\n \n \n  I have verified my script runs in a clean environment and reproduces the issue.\n  I have verified the issue also occurs with the latest wheels.\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "AmeerHajAli", "commentT": "2020-10-12T03:18:32Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/SongGuyang>@SongGuyang</denchmark-link>\n , can you please look into this issue?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "AmeerHajAli", "commentT": "2020-10-12T07:18:35Z", "comment_text": "\n \t\tThanks, I will see this.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "AmeerHajAli", "commentT": "2020-10-14T23:50:42Z", "comment_text": "\n \t\tFixed in <denchmark-link:https://github.com/ray-project/ray/pull/11363>#11363</denchmark-link>\n .\n \t\t"}}}, "commit": {"commit_id": "34191107a3c532d723ec728c1db1107870b530ae", "commit_author": "SongGuyang", "commitT": "2020-10-14 16:48:34-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "0.6666666666666666", "commit_Nprams": "0.6666666666666666"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "cpp\\src\\ray\\runtime\\task\\native_task_submitter.cc", "file_new_name": "cpp\\src\\ray\\runtime\\task\\native_task_submitter.cc", "file_complexity": {"file_NLOC": "71", "file_CCN": "9", "file_NToken": "527"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "11,18,19", "deleted_lines": "11,12,13,14,15,18", "method_info": {"method_name": "ray::api::BuildRayFunction", "method_params": "invocation", "method_startline": "11", "method_endline": "19", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "93", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "54,70,71", "deleted_lines": "52,53,54,55,56,57,58,59,60,61,63,64,65", "method_info": {"method_name": "ray::api::NativeTaskSubmitter::CreateActor", "method_params": "invocation", "method_startline": "52", "method_endline": "76", "method_complexity": {"method_NLOC": "23", "method_CCN": "2", "method_NToken": "130", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "33,34,35,39,40,42,43", "deleted_lines": "36,37,39,40", "method_info": {"method_name": "ray::api::NativeTaskSubmitter::Submit", "method_params": "invocation", "method_startline": "33", "method_endline": "46", "method_complexity": {"method_NLOC": "14", "method_CCN": "2", "method_NToken": "132", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "21,22,23,24,25,26,27,28,29,30,31", "deleted_lines": "23,25,26,27,28,29,30,31", "method_info": {"method_name": "ray::api::BuildTaskArgs", "method_params": "invocation,args", "method_startline": "21", "method_endline": "31", "method_complexity": {"method_NLOC": "11", "method_CCN": "2", "method_NToken": "116", "method_nesting_level": "2"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "cpp\\src\\ray\\runtime\\task\\task_executor.cc", "file_new_name": "cpp\\src\\ray\\runtime\\task\\task_executor.cc", "file_complexity": {"file_NLOC": "113", "file_CCN": "12", "file_NToken": "1129"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "41,42,43,44,45,46,47,48,49,50", "deleted_lines": "41,42,43,44,45,46,48", "method_info": {"method_name": "ray::api::TaskExecutor::ExecuteTask", "method_params": "task_type,task_name,ray_function,required_resources,args,arg_reference_ids,return_ids,results", "method_startline": "25", "method_endline": "96", "method_complexity": {"method_NLOC": "69", "method_CCN": "8", "method_NToken": "732", "method_nesting_level": "2"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "cpp\\src\\ray\\test\\cluster\\cluster_mode_test.cc", "file_new_name": "cpp\\src\\ray\\test\\cluster\\cluster_mode_test.cc", "file_complexity": {"file_NLOC": "55", "file_CCN": "11", "file_NToken": "453"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "10", "deleted_lines": null, "method_info": {"method_name": "Return1", "method_params": "", "method_startline": "10", "method_endline": "10", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "19", "deleted_lines": null, "method_info": {"method_name": "Counter::FactoryCreate", "method_params": "", "method_startline": "19", "method_endline": "19", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "12", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "44,45,47,48,49,50,51,54,55,56,57,58,59,60,61,62,63,64", "deleted_lines": "39,43,44,45,46", "method_info": {"method_name": "TEST", "method_params": "RayClusterModeTest,FullTest", "method_startline": "32", "method_endline": "67", "method_complexity": {"method_NLOC": "23", "method_CCN": "1", "method_NToken": "264", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "22,23,24,25", "deleted_lines": null, "method_info": {"method_name": "Counter::Plus1", "method_params": "", "method_startline": "22", "method_endline": "25", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "12", "method_nesting_level": "1"}}}}}}}}