{"BR": {"BR_id": "1105", "BR_author": "erik-hasse", "BRopenT": "2020-02-16T16:55:27Z", "BRcloseT": "2020-10-28T06:45:26Z", "BR_text": {"BRsummary": "Bad sortColumnIdx error after a dataframe is changed", "BRdescription": "\n <denchmark-h:h1>Summary</denchmark-h>\n \n When a dataframe is loaded, sorted on a column at the end, and then the number of columns is reduced, a \"Bad sortColumnIdx\" error is thrown.\n <denchmark-h:h1>Steps to reproduce</denchmark-h>\n \n Minimal, Reproducible Example:\n <denchmark-code>import numpy as np\n import pandas as pd\n import streamlit as st\n \n n = st.sidebar.number_input('Number of columns', value=5)\n df = pd.DataFrame(np.random.randint(0, 10, size=(10, n)))\n st.dataframe(df)\n </denchmark-code>\n \n \n Run the app\n Sort the dataframe on the last column\n Reduce the number of columns\n \n <denchmark-h:h2>Expected behavior:</denchmark-h>\n \n The dataframe should revert to unsorted or be sorted by its last column.\n <denchmark-h:h2>Actual behavior:</denchmark-h>\n \n The dataframe is not displayed and a Bad sortColumnIdx error is shown.\n <denchmark-h:h2>Is this a regression?</denchmark-h>\n \n No\n <denchmark-h:h1>Debug info</denchmark-h>\n \n \n Streamlit version: 0.56.0\n Python version: 3.8.1\n Conda environment\n OS version: macOS 10.14.6\n Browser version: Firefox 72.0.1, Chrome 79.0.3945.130\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "erik-hasse", "commentT": "2020-02-20T00:17:33Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/erik-hasse>@erik-hasse</denchmark-link>\n ! We're currently overhauling our dataframe logic (see <denchmark-link:https://github.com/streamlit/streamlit/pull/1021>#1021</denchmark-link>\n ), which will hopefully fix this.\n I've moved this bug to our internal triage board, and we'll take another look at it after the above PR lands.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "erik-hasse", "commentT": "2020-10-15T18:57:02Z", "comment_text": "\n \t\tQuick note, <denchmark-link:https://github.com/kellyamanda>@kellyamanda</denchmark-link>\n  just saw this bug pop up in our metrics dashboard, so i'm bumping it up in priority as it clearly didn't get washed away by any PRs over the year.\n \t\t"}}}, "commit": {"commit_id": "0b8505befef010abe3c5f9cf095f1a4af872ecbe", "commit_author": "Henrikh Kantuni", "commitT": "2020-10-28 02:45:25-04:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "e2e\\scripts\\st_dataframe_sort_column.py", "file_complexity": {"file_NLOC": "6", "file_CCN": "0", "file_NToken": "55"}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "e2e\\specs\\st_dataframe.spec.js", "file_new_name": "e2e\\specs\\st_dataframe.spec.js", "file_complexity": {"file_NLOC": "27", "file_CCN": "7", "file_NToken": "178"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "49,50,51,52", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "18", "method_endline": "53", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "60", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "e2e\\specs\\st_dataframe_sort_column.spec.js", "file_complexity": {"file_NLOC": "15", "file_CCN": "3", "file_NToken": "81"}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "frontend\\src\\components\\elements\\DataFrame\\DataFrame.tsx", "file_new_name": "frontend\\src\\components\\elements\\DataFrame\\DataFrame.tsx", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "18,25,40,59,65,69,70,71,72,73,74,75,76,77,78,86,115,118,141,146,153,181,207,208,209,210,211,212,213,214", "deleted_lines": "18,39,73,130,137,165,166,167,168,169,170,171,172,173,174"}}}}}}