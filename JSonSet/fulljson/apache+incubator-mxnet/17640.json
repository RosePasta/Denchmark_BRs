{"BR": {"BR_id": "17640", "BR_author": "apeforest", "BRopenT": "2020-02-20T22:35:39Z", "BRcloseT": "2020-02-26T06:25:42Z", "BR_text": {"BRsummary": "[OPPERF] opperf error out if I use python timer instead of the builtin mxnet profiler", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n Seems the python timer did not parse the argument to broadcast_axis properly. It is fine if I use the 'native' profiler.\n <denchmark-h:h3>Error Message</denchmark-h>\n \n <denchmark-code>Traceback (most recent call last):\n   File \"perf.py\", line 12, in <module>\n     warmup=20, runs=100, profiler='python')\n   File \"/home/ubuntu/src/incubator-mxnet/benchmark/opperf/utils/benchmark_utils.py\", line 177, in run_performance_test\n     benchmark_result = _run_nd_operator_performance_test(op, inputs, run_backward, warmup, runs, kwargs_list, profiler)\n   File \"/home/ubuntu/src/incubator-mxnet/benchmark/opperf/utils/benchmark_utils.py\", line 114, in _run_nd_operator_performance_test\n     _, _ = benchmark_helper_func(op, warmup, **kwargs_list[0])\n   File \"/home/ubuntu/src/incubator-mxnet/benchmark/opperf/utils/profiler_utils.py\", line 251, in python_profile_it\n     modified_args = (args[0], 1, args[2])\n </denchmark-code>\n \n <denchmark-h:h2>To Reproduce</denchmark-h>\n \n <denchmark-code>#!/usr/bin/python\n import mxnet as mx\n from mxnet import nd\n \n from benchmark.opperf.utils.benchmark_utils import run_performance_test\n \n mx.random.seed(17)\n res = run_performance_test(nd.broadcast_axis, run_backward=True, dtype='float32', ctx=mx.gpu(),\n                            inputs=[\n                                {\"data\" : (1, 1024, 1), \"axis\" : (0, 2), \"size\" : (1024, 8)}\n                            ],\n                            warmup=20, runs=100, profiler='python')\n print(res)\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "apeforest", "commentT": "2020-02-20T22:36:10Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ChaiBapchya>@ChaiBapchya</denchmark-link>\n  <denchmark-link:https://github.com/connorgoggins>@connorgoggins</denchmark-link>\n  Would you like to take a look at this?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "apeforest", "commentT": "2020-02-20T22:38:11Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/apeforest>@apeforest</denchmark-link>\n  working to reproduce now.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "apeforest", "commentT": "2020-02-20T23:10:56Z", "comment_text": "\n \t\tReproduced on CPU, debugging now.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "apeforest", "commentT": "2020-02-20T23:38:37Z", "comment_text": "\n \t\tImplemented fix here: <denchmark-link:https://github.com/apache/incubator-mxnet/pull/17642>[OpPerf] Fixed Python profiler bug</denchmark-link>\n  <denchmark-link:https://github.com/apeforest>@apeforest</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "1906eff6b8a1eb96903f61583e722d1819ac657e", "commit_author": "Connor Goggins", "commitT": "2020-02-25 22:25:41-08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "benchmark\\opperf\\utils\\profiler_utils.py", "file_new_name": "benchmark\\opperf\\utils\\profiler_utils.py", "file_complexity": {"file_NLOC": "151", "file_CCN": "29", "file_NToken": "729"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "251", "deleted_lines": "251", "method_info": {"method_name": "python_profile", "method_params": "func", "method_startline": "223", "method_endline": "280", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "251", "deleted_lines": "251", "method_info": {"method_name": "python_profile.python_profile_it", "method_params": "args,kwargs", "method_startline": "249", "method_endline": "279", "method_complexity": {"method_NLOC": "26", "method_CCN": "4", "method_NToken": "194", "method_nesting_level": "1"}}}}}}}}