{"BR": {"BR_id": "10866", "BR_author": "jessebrizzi", "BRopenT": "2018-05-09T15:57:30Z", "BRcloseT": "2018-06-02T06:52:37Z", "BR_text": {"BRsummary": "Scala Module API not resizing properly when returning to original binded size", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n Create and bind a MXNet Module with batch size N. Pass DataBatch that requires net resize to some input NEW_N batch size where NEW_N < N. Then Pass DataBatch that requires module to resize back to the original batch size where NEW_N == n The output of the net will return for the wrong input size (batch size of NEW_N instead of N).\n <denchmark-h:h2>Environment info (Required)</denchmark-h>\n \n <denchmark-code>----------Python Info----------\n Version      : 3.4.3\n Compiler     : GCC 4.8.4\n Build        : ('default', 'Nov 17 2016 01:08:31')\n Arch         : ('64bit', 'ELF')\n ------------Pip Info-----------\n Version      : 10.0.1\n Directory    : /usr/local/lib/python3.4/dist-packages/pip\n ----------MXNet Info-----------\n Version      : 1.1.0\n Directory    : /home/paperspace/src/mxnet/python/mxnet\n Hashtag not found. Not installed from pre-built package.\n ----------System Info----------\n Platform     : Linux-4.4.0-31-generic-x86_64-with-Ubuntu-14.04-trusty\n system       : Linux\n node         : psplnlbg\n release      : 4.4.0-31-generic\n version      : #50~14.04.1-Ubuntu SMP Wed Jul 13 01:07:32 UTC 2016\n ----------Hardware Info----------\n machine      : x86_64\n processor    : x86_64\n Architecture:          x86_64\n CPU op-mode(s):        32-bit, 64-bit\n Byte Order:            Little Endian\n CPU(s):                8\n On-line CPU(s) list:   0-7\n Thread(s) per core:    1\n Core(s) per socket:    8\n Socket(s):             1\n NUMA node(s):          1\n Vendor ID:             GenuineIntel\n CPU family:            6\n Model:                 79\n Stepping:              1\n CPU MHz:               2600.072\n BogoMIPS:              5200.14\n Hypervisor vendor:     Microsoft\n Virtualization type:   full\n L1d cache:             32K\n L1i cache:             32K\n L2 cache:              256K\n L3 cache:              10240K\n NUMA node0 CPU(s):     0-7\n ----------Network Test----------\n Setting timeout: 10\n Timing for FashionMNIST: https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/dataset/fashion-mnist/train-labels-idx1-ubyte.gz, DNS: 0.0884 sec, LOAD: 0.4182 sec.\n Timing for MXNet: https://github.com/apache/incubator-mxnet, DNS: 0.0131 sec, LOAD: 0.4660 sec.\n Timing for Gluon Tutorial(cn): https://zh.gluon.ai, DNS: 0.0957 sec, LOAD: 0.6263 sec.\n Timing for PYPI: https://pypi.python.org/pypi/pip, DNS: 0.0099 sec, LOAD: 0.3049 sec.\n Timing for Gluon Tutorial(en): http://gluon.mxnet.io, DNS: 0.0134 sec, LOAD: 0.6473 sec.\n Timing for Conda: https://repo.continuum.io/pkgs/free/, DNS: 0.0126 sec, LOAD: 0.0343 sec.\n \n </denchmark-code>\n \n Package used (Python/R/Scala/Julia):\n Scala. This seems to be specific to the Scala API. Can not reproduce in Python.\n For Scala user, please provide:\n \n \n Java version: (java -version)\n java version \"1.8.0_131\"\n Java(TM) SE Runtime Environment (build 1.8.0_131-b11)\n Java HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode)\n \n \n Maven version: (mvn -version)\n Apache Maven 3.0.5\n Maven home: /usr/share/maven\n Java version: 1.8.0_131, vendor: Oracle Corporation\n Java home: /usr/lib/jvm/java-8-oracle/jre\n Default locale: en_US, platform encoding: UTF-8\n OS name: \"linux\", version: \"4.4.0-31-generic\", arch: \"amd64\", family: \"unix\"\n \n \n Scala runtime if applicable: (scala -version)\n 2.11.11\n \n \n <denchmark-h:h2>Build info (Required if built from source)</denchmark-h>\n \n Compiler (gcc/clang/mingw/visual studio): GCC 4.8.4\n MXNet commit hash:\n <denchmark-link:https://github.com/apache/incubator-mxnet/commit/07a83a0325a3d782513a04f47d711710972cb144>07a83a0</denchmark-link>\n \n Build config:\n make  -j $(nproc) USE_OPENCV=1 USE_BLAS=openblas USE_CUDA=1 USE_CUDA_PATH=/usr/local/cuda USE_CUDNN=1\n make scalainstall -j $(nproc) USE_OPENCV=1 USE_BLAS=openblas USE_CUDA=1 USE_CUDA_PATH=/usr/local/cuda USE_CUDNN=1\n <denchmark-h:h2>Error Message:</denchmark-h>\n \n None\n <denchmark-h:h2>Minimum reproducible example</denchmark-h>\n \n link to simple Scala project/code to reproduce issue\n <denchmark-link:https://github.com/jessebrizzi/MXNet-Bug/blob/master/scala/TestBug1.scala>https://github.com/jessebrizzi/MXNet-Bug/blob/master/scala/TestBug1.scala</denchmark-link>\n \n <denchmark-h:h2>Steps to reproduce</denchmark-h>\n \n (Paste the commands you ran that produced the error.)\n \n Pull this project and run it with SBT to test this issue.\n \n <denchmark-h:h2>What have you tried to solve it?</denchmark-h>\n \n \n You can avoid this bug by initially binding your Module to N+1 and than resize all you want up to your desired N value.\n Not using the Scala API\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "jessebrizzi", "commentT": "2018-05-20T23:54:00Z", "comment_text": "\n \t\tAlso tested on master branch <denchmark-link:https://github.com/apache/incubator-mxnet/commit/10ac52993aeaf2fa589a6b3636c8e23a65c8e639>10ac529</denchmark-link>\n  and bug is present\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "jessebrizzi", "commentT": "2018-05-27T22:42:20Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lanking520>@lanking520</denchmark-link>\n  - Any inputs on this?\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "jessebrizzi", "commentT": "2018-06-01T04:51:15Z", "comment_text": "\n \t\tSorry for the late reply, will start looking this today.\n \t\t"}}}, "commit": {"commit_id": "7eb78d8833dc11f42f43e1a665da713ef6db7c81", "commit_author": "Jesse Brizzi", "commitT": "2018-06-01 23:52:36-07:00", "commit_complexity": {"commit_NLOC": "0.5", "commit_CCN": "0.5", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CONTRIBUTORS.md", "file_new_name": "CONTRIBUTORS.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "173", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "scala-package\\core\\src\\main\\scala\\org\\apache\\mxnet\\module\\DataParallelExecutorGroup.scala", "file_new_name": "scala-package\\core\\src\\main\\scala\\org\\apache\\mxnet\\module\\DataParallelExecutorGroup.scala", "file_complexity": {"file_NLOC": "520", "file_CCN": "102", "file_NToken": "4263"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "433", "deleted_lines": "430", "method_info": {"method_name": "reshape", "method_params": "", "method_startline": "430", "method_endline": "447", "method_complexity": {"method_NLOC": "9", "method_CCN": "4", "method_NToken": "83", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "359,382,383,384,433", "deleted_lines": "359,430", "method_info": {"method_name": "bindExec", "method_params": "Boolean", "method_startline": "359", "method_endline": "433", "method_complexity": {"method_NLOC": "60", "method_CCN": "13", "method_NToken": "475", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "359", "deleted_lines": "359", "method_info": {"method_name": "decideSlices", "method_params": "", "method_startline": "331", "method_endline": "359", "method_complexity": {"method_NLOC": "20", "method_CCN": "4", "method_NToken": "142", "method_nesting_level": "0"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "359,382,383,384", "deleted_lines": "359,430", "method_info": {"method_name": "bindExec", "method_params": "Boolean", "method_startline": "359", "method_endline": "430", "method_complexity": {"method_NLOC": "58", "method_CCN": "13", "method_NToken": "465", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "433", "deleted_lines": null, "method_info": {"method_name": "reshape", "method_params": "", "method_startline": "433", "method_endline": "450", "method_complexity": {"method_NLOC": "9", "method_CCN": "4", "method_NToken": "83", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "scala-package\\core\\src\\main\\scala\\org\\apache\\mxnet\\module\\Module.scala", "file_new_name": "scala-package\\core\\src\\main\\scala\\org\\apache\\mxnet\\module\\Module.scala", "file_complexity": {"file_NLOC": "426", "file_CCN": "92", "file_NToken": "3094"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "344,345", "deleted_lines": null, "method_info": {"method_name": "reshape", "method_params": "None", "method_startline": "339", "method_endline": "358", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "77", "method_nesting_level": "0"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scala-package\\core\\src\\test\\scala\\org\\apache\\mxnet\\ModuleSuite.scala", "file_new_name": "scala-package\\core\\src\\test\\scala\\org\\apache\\mxnet\\ModuleSuite.scala", "file_complexity": {"file_NLOC": "312", "file_CCN": "3", "file_NToken": "4035"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "160,170,171,172,173,174,175,176,177,178,179,180", "deleted_lines": null}}}}}}