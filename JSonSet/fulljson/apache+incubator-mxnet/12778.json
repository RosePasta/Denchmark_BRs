{"BR": {"BR_id": "12778", "BR_author": "haven-jeon", "BRopenT": "2018-10-10T05:28:50Z", "BRcloseT": "2018-10-16T19:39:06Z", "BR_text": {"BRsummary": "Cannot print parameter summary of embedding layer", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n 0  parameter of Embedding layer, when print_summary()\n <denchmark-h:h2>Environment info (Required)</denchmark-h>\n \n MXNet 1.3.0\n Package used (Python/R/Scala/Julia):\n I am using python\n <denchmark-h:h2>Minimum reproducible example</denchmark-h>\n \n <denchmark-code>class SentClassificationModel(gluon.HybridBlock):\n     def __init__(self, vocab_size, num_embed, **kwargs):\n         super(SentClassificationModel, self).__init__(**kwargs)\n         with self.name_scope():\n             self.embed = nn.Embedding(input_dim=vocab_size, output_dim=num_embed)\n             self.drop = nn.Dropout(0.3)\n             self.fc = nn.Dense(100, activation='relu')\n             self.out = nn.Dense(2)  \n     def hybrid_forward(self, F ,inputs):\n         em_out = self.drop(self.embed(inputs))\n         fc_out = self.fc(em_out) \n         return(self.out(fc_out))\n \n ctx = mx.gpu()\n \n model = SentClassificationModel(vocab_size = len(vocab.idx_to_token), num_embed=50)\n \n model.initialize(mx.init.Xavier(),ctx=ctx)\n model.hybridize()\n \n mx.viz.print_summary(\n     model(mx.sym.var('data')), \n     shape={'data':(1,30)}, #set your shape here\n )\n </denchmark-code>\n \n <denchmark-code>________________________________________________________________________________________________________________________\n Layer (type)                                        Output Shape            Param #     Previous Layer                  \n ========================================================================================================================\n data(null)                                          30                      0                                           \n ________________________________________________________________________________________________________________________\n sentclassificationmodel0_embedding0_fwd(Embedding)  30x50                   0           data                            \n ________________________________________________________________________________________________________________________\n sentclassificationmodel0_dropout0_fwd(Dropout)      30x50                   0           sentclassificationmodel0_embeddi\n ________________________________________________________________________________________________________________________\n sentclassificationmodel0_dense0_fwd(FullyConnected) 100                     3100        sentclassificationmodel0_dropout\n ________________________________________________________________________________________________________________________\n sentclassificationmodel0_dense0_relu_fwd(Activation)100                     0           sentclassificationmodel0_dense0_\n ________________________________________________________________________________________________________________________\n sentclassificationmodel0_dense1_fwd(FullyConnected) 2                       202         sentclassificationmodel0_dense0_\n ========================================================================================================================\n Total params: 3302\n ________________________________________________________________________________________________________________________\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "haven-jeon", "commentT": "2018-10-10T05:30:59Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/haven-jeon>@haven-jeon</denchmark-link>\n  Thank you submitting this issue. We will look into this\n <denchmark-link:https://github.com/mxnet-label-bot>@mxnet-label-bot</denchmark-link>\n  [Bug, Gluon]\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "haven-jeon", "commentT": "2018-10-10T06:36:45Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/apache/incubator-mxnet/blob/master/python/mxnet/visualization.py>https://github.com/apache/incubator-mxnet/blob/master/python/mxnet/visualization.py</denchmark-link>\n \n It seems that the Embedding layers is currently missing.\n So It needs to be added at Line 162 as below.\n <denchmark-code>elif op == 'Embedding':\n     cur_param = int(node[\"attrs\"]['input_dim']) * int(node[\"attrs\"]['output_dim'])\n </denchmark-code>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "haven-jeon", "commentT": "2018-10-10T16:42:56Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/soeque1>@soeque1</denchmark-link>\n  Thank you for your suggestion! Maybe you can raise a PR for this fix and contribute to the development of MXNet community :)\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "haven-jeon", "commentT": "2018-10-11T05:09:05Z", "comment_text": "\n \t\tThank you for the quick reply. I will PR soon :)\n \t\t"}}}, "commit": {"commit_id": "d096aa5e88307c6e08c03c686893ef35470c8485", "commit_author": "Hyung-jun Kim", "commitT": "2018-10-16 12:39:05-07:00", "commit_complexity": {"commit_NLOC": "0.3333333333333333", "commit_CCN": "0.3333333333333333", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "python\\mxnet\\visualization.py", "file_new_name": "python\\mxnet\\visualization.py", "file_complexity": {"file_NLOC": "224", "file_CCN": "43", "file_NToken": "1757"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "160,161", "deleted_lines": null, "method_info": {"method_name": "print_summary.print_layer_summary", "method_params": "node,out_shape", "method_startline": "103", "method_endline": "175", "method_complexity": {"method_NLOC": "60", "method_CCN": "23", "method_NToken": "482", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "160,161", "deleted_lines": null, "method_info": {"method_name": "print_summary", "method_params": "symbol,shape,line_length,positions,64,74", "method_startline": "47", "method_endline": "196", "method_complexity": {"method_NLOC": "43", "method_CCN": "15", "method_NToken": "315", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\python\\unittest\\test_viz.py", "file_new_name": "tests\\python\\unittest\\test_viz.py", "file_complexity": {"file_NLOC": "41", "file_CCN": "4", "file_NToken": "491"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "27,28,37", "deleted_lines": "27,36", "method_info": {"method_name": "test_print_summary", "method_params": "", "method_startline": "24", "method_endline": "38", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "274", "method_nesting_level": "0"}}}}}}}}