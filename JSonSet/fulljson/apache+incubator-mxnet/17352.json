{"BR": {"BR_id": "17352", "BR_author": "apeforest", "BRopenT": "2020-01-17T00:13:34Z", "BRcloseT": "2020-01-25T08:31:12Z", "BR_text": {"BRsummary": "Error in mkldnn unit test", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n When I ran nosetests -v tests/python/mkl/test_mkldnn.py, all the tests passed.\n If I ran nosetests -v tests/python/mkl/test_mkldnn.py:test_mkldnn_engine_threading, it failed with\n <denchmark-code>test_mkldnn.test_mkldnn_engine_threading ... ERROR\n \n ======================================================================\n ERROR: test_mkldnn.test_mkldnn_engine_threading\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"/home/ubuntu/.virtualenvs/mxnet/lib/python3.6/site-packages/nose/case.py\", line 198, in runTest\n     self.test(*self.arg)\n   File \"/home/ubuntu/src/mxnet/tests/python/mkl/test_mkldnn.py\", line 98, in test_mkldnn_engine_threading\n     assert_almost_equal(y[0, 0, 0, 0], np.array(0.016711406))\n   File \"/home/ubuntu/src/mxnet/python/mxnet/test_utils.py\", line 610, in assert_almost_equal\n     aTmp[index] = bTmp[index] = 0\n TypeError: 'numpy.float32' object does not support item assignment\n -------------------- >> begin captured stdout << ---------------------\n \n *** Maximum errors for vector of size 1:  rtol=1e-05, atol=1e-20\n \n   1: Error 1920385.369517  Location of error: (), a=0.33763480, b=0.01671141\n \n --------------------- >> end captured stdout << ----------------------\n </denchmark-code>\n \n <denchmark-h:h2>To Reproduce</denchmark-h>\n \n nosetests -v tests/python/mkl/test_mkldnn.py:test_mkldnn_engine_threading\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "apeforest", "commentT": "2020-01-17T00:17:29Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/PatricZhao>@PatricZhao</denchmark-link>\n  <denchmark-link:https://github.com/TaoLv>@TaoLv</denchmark-link>\n  Did you encounter this before? Thanks\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "apeforest", "commentT": "2020-01-17T05:03:42Z", "comment_text": "\n \t\tYes, we're aware of this problem as in our local validation system, python tests are split into single run for each test. We didn't dive into the problem as we thought it's a problem of nosetests or how the nosetests file is implemented. I remember these was an similar issue but cannot find it anymore.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "apeforest", "commentT": "2020-01-17T05:04:41Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/juliusshufan>@juliusshufan</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "47349ce50004d52af7844ea7c3c509de96678928", "commit_author": "heaseny", "commitT": "2020-01-25 16:31:11+08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tests\\python\\mkl\\test_mkldnn.py", "file_new_name": "tests\\python\\mkl\\test_mkldnn.py", "file_complexity": {"file_NLOC": "515", "file_CCN": "96", "file_NToken": "6088"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "75", "deleted_lines": "74", "method_info": {"method_name": "test_mkldnn_ndarray_slice", "method_params": "", "method_startline": "65", "method_endline": "75", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "120", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "99,100", "deleted_lines": "97,98", "method_info": {"method_name": "test_mkldnn_engine_threading", "method_params": "", "method_startline": "78", "method_endline": "101", "method_complexity": {"method_NLOC": "15", "method_CCN": "2", "method_NToken": "176", "method_nesting_level": "0"}}}}}}}}