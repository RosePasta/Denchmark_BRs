{"BR": {"BR_id": "10868", "BR_author": "eric-haibin-lin", "BRopenT": "2018-05-09T16:56:58Z", "BRcloseT": "2018-07-20T22:10:01Z", "BR_text": {"BRsummary": "_backward_softsign activation is incorrect", "BRdescription": "\n The following test case will fail:\n Adding modify the test case in <denchmark-link:https://github.com/apache/incubator-mxnet/blob/master/tests/python/unittest/test_operator.py#L5867>https://github.com/apache/incubator-mxnet/blob/master/tests/python/unittest/test_operator.py#L5867</denchmark-link>\n \n <denchmark-code>def test_activation():\n     shape=(9, 10)\n     dtype_l = [np.float64, np.float32, np.float16]\n     rtol_l = [1e-7, 1e-6, 1e-2]\n     atol_l = [1e-7, 1e-6, 1e-2]\n     rtol_fd = 1e-5\n     atol_fd = 1e-6\n     num_eps = 1e-6\n     unary_ops = {\n         'softsign': [lambda x: mx.sym.Activation(x, act_type='softsign'),\n                     lambda x: x / (1. + np.abs(x)),\n                     lambda x: 1. / np.square(1. + np.abs(x)),\n \n     }\n     # Loop over operators\n     for name, op in unary_ops.items():\n         # Loop over dtype's\n         for ind in range(len(dtype_l)):\n             dtype = dtype_l[ind]\n             rtol = rtol_l[ind]\n             atol = atol_l[ind]\n             compare_forw_backw_unary_op(\n                 name, op[0], op[1], op[2], shape, op[3], op[4], rtol, atol,\n                 dtype)\n         # Finite difference testing\n         finite_diff_unary_op(\n             name, op[0], shape, op[3], op[4], rtol_fd, atol_fd, num_eps)\n </denchmark-code>\n \n Reason: For y = softsign(x), the inputs for _backward_softsign and _backward_Activation are different:\n _backward_softsign takes (dy, x) as input, backward_Activation takes (dy, y) as input.\n <denchmark-link:https://github.com/nswamy>@nswamy</denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "eric-haibin-lin", "commentT": "2018-07-20T22:05:15Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/eric-haibin-lin>@eric-haibin-lin</denchmark-link>\n  Should be good for closing as the fix was just merged?\n \t\t"}}}, "commit": {"commit_id": "95de76758a18fc070fac11bcd1d2d24a5263a1df", "commit_author": "samskalicky", "commitT": "2018-07-20 14:16:23-07:00", "commit_complexity": {"commit_NLOC": "0.35294117647058826", "commit_CCN": "0.5882352941176471", "commit_Nprams": "0.5294117647058824"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "src\\operator\\nn\\activation-inl.h", "file_new_name": "src\\operator\\nn\\activation-inl.h", "file_complexity": {"file_NLOC": "167", "file_CCN": "24", "file_NToken": "1345"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "202,206,207", "deleted_lines": "201,206", "method_info": {"method_name": "mxnet::op::ActivationGradCompute", "method_params": "attrs,ctx,inputs,req,outputs", "method_startline": "196", "method_endline": "212", "method_complexity": {"method_NLOC": "14", "method_CCN": "4", "method_NToken": "153", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "177", "deleted_lines": "177", "method_info": {"method_name": "mxnet::op::ActivationGradComputeImpl", "method_params": "attrs,ctx,inputs,req,outputs", "method_startline": "154", "method_endline": "182", "method_complexity": {"method_NLOC": "29", "method_CCN": "6", "method_NToken": "296", "method_nesting_level": "2"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "src\\operator\\nn\\activation.cc", "file_new_name": "src\\operator\\nn\\activation.cc", "file_complexity": {"file_NLOC": "153", "file_CCN": "22", "file_NToken": "1291"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "130,144,145,146,147,148,149,150,151,152,153,154", "deleted_lines": "136,137,138,139", "method_info": {"method_name": "mxnet::op::BackwardActStorageType", "method_params": "attrs,dev_mask,dispatch_mode,in_attrs,out_attrs", "method_startline": "123", "method_endline": "163", "method_complexity": {"method_NLOC": "35", "method_CCN": "7", "method_NToken": "275", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "47,49,50,51,52,53,54,55,58,59", "deleted_lines": "47,51", "method_info": {"method_name": "mxnet::op::ActivationGrad::operator ( )", "method_params": "n,ograds", "method_startline": "43", "method_endline": "64", "method_complexity": {"method_NLOC": "15", "method_CCN": "5", "method_NToken": "163", "method_nesting_level": "3"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\operator\\nn\\activation.cu", "file_new_name": "src\\operator\\nn\\activation.cu", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "90", "deleted_lines": "90"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\python\\unittest\\test_operator.py", "file_new_name": "tests\\python\\unittest\\test_operator.py", "file_complexity": {"file_NLOC": "5804", "file_CCN": "950", "file_NToken": "73671"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "6855,6856,6857,6858", "deleted_lines": null, "method_info": {"method_name": "test_activation", "method_params": "", "method_startline": "6830", "method_endline": "6872", "method_complexity": {"method_NLOC": "40", "method_CCN": "3", "method_NToken": "500", "method_nesting_level": "0"}}}}}}}}