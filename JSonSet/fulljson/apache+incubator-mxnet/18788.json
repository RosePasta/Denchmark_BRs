{"BR": {"BR_id": "18788", "BR_author": "leezu", "BRopenT": "2020-07-25T00:23:42Z", "BRcloseT": "2020-12-14T18:09:29Z", "BR_text": {"BRsummary": "bfloat16 rendered as uint16", "BRdescription": "\n <denchmark-code>[ins] In [1]: import mxnet as mx\n \n [ins] In [3]: a = mx.nd.arange(10)\n \n [ins] In [6]: import numpy as np\n \n [ins] In [7]: a.astype(np.dtype([('bfloat16', np.uint16)]))\n Out[7]:\n \n [(    0,) (16256,) (16384,) (16448,) (16512,) (16544,) (16576,) (16608,)\n  (16640,) (16656,)]\n <NDArray 10 @cpu(0)>\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "leezu", "commentT": "2020-07-26T06:18:14Z", "comment_text": "\n \t\tcc <denchmark-link:https://github.com/rongzha1>@rongzha1</denchmark-link>\n  <denchmark-link:https://github.com/pengzhao-intel>@pengzhao-intel</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "leezu", "commentT": "2020-07-28T02:26:05Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/bgawrych>@bgawrych</denchmark-link>\n  <denchmark-link:https://github.com/luc>@luc</denchmark-link>\n ,pior\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "leezu", "commentT": "2020-07-29T07:45:56Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/leezu>@leezu</denchmark-link>\n  could you give more description of what's the problem is and where it is used?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "leezu", "commentT": "2020-07-29T17:19:32Z", "comment_text": "\n \t\tMXNet bfloat16 type is registered as having numpy equivalent np.dtype([('bfloat16', np.uint16)]):\n \n \n \n incubator-mxnet/python/mxnet/ndarray/ndarray.py\n \n \n          Line 86\n       in\n       c1098aa\n \n \n \n \n \n \n  12: np.dtype([('bfloat16', np.uint16)]), \n \n \n \n \n \n As printing a NDArray works via converting to numpy, this causes bfloat16 arrays to be printed as uint16.\n The fundamental issue here is that numpy does not support bfloat16. We can consider if there is a better solution\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "leezu", "commentT": "2020-08-07T05:40:09Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ElaineBao>@ElaineBao</denchmark-link>\n  could you explain the background?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "leezu", "commentT": "2020-08-07T05:58:46Z", "comment_text": "\n \t\tAs <denchmark-link:https://github.com/leezu>@leezu</denchmark-link>\n  said, numpy doesn't support the data type of , when printing a NDArray as type , it will be printed as pre-defined .\n I think it's not a bug actually, if printing a NDArray has to work via converting to numpy, and numpy has no support of bfloat16, the only way to print is converting to another numpy supported data type.\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "leezu", "commentT": "2020-08-07T15:36:39Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ElaineBao>@ElaineBao</denchmark-link>\n  I agree it's expected for people who understand how the internal mxnet printing logic works. But I'm not sure if this is the optimal user experience.\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "leezu", "commentT": "2020-08-08T00:33:27Z", "comment_text": "\n \t\tYes, I think so, it's not that friendly for users to print out bfloat16 values. We can consider if there is a better solution for this.\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "leezu", "commentT": "2020-08-08T04:59:51Z", "comment_text": "\n \t\t\n MXNet bfloat16 type is registered as having numpy equivalent np.dtype([('bfloat16', np.uint16)]):\n \n \n \n incubator-mxnet/python/mxnet/ndarray/ndarray.py\n \n \n          Line 86\n       in\n       c1098aa\n \n \n \n \n \n \n  12: np.dtype([('bfloat16', np.uint16)]), \n \n \n \n \n \n As printing a NDArray works via converting to numpy, this causes bfloat16 arrays to be printed as uint16.\n The fundamental issue here is that numpy does not support bfloat16. We can consider if there is a better solution\n \n Should we just convert to float32 in Numpy?\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "leezu", "commentT": "2020-08-13T20:49:12Z", "comment_text": "\n \t\tIs it possible to customized a dtype in numpy just for printing?\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "leezu", "commentT": "2020-08-31T04:09:04Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/anko-intel>@anko-intel</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "ed4aa23dba78def23abfe08c7e74eb4dbab1bbbb", "commit_author": "Pawe\u0142 G\u0142omski", "commitT": "2020-12-14 10:09:28-08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CONTRIBUTORS.md", "file_new_name": "CONTRIBUTORS.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "290", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\mxnet\\ndarray\\ndarray.py", "file_new_name": "python\\mxnet\\ndarray\\ndarray.py", "file_complexity": {"file_NLOC": "1824", "file_CCN": "591", "file_NToken": "13671"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "461,462,463,464,465,466", "deleted_lines": null, "method_info": {"method_name": "__str__", "method_params": "self", "method_startline": "461", "method_endline": "466", "method_complexity": {"method_NLOC": "5", "method_CCN": "2", "method_NToken": "55", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\python\\unittest\\test_ndarray.py", "file_new_name": "tests\\python\\unittest\\test_ndarray.py", "file_complexity": {"file_NLOC": "1660", "file_CCN": "263", "file_NToken": "22494"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "2060,2061,2062,2063,2064,2065", "deleted_lines": null, "method_info": {"method_name": "test_readable_bfloat16_print", "method_params": "", "method_startline": "2060", "method_endline": "2065", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "98", "method_nesting_level": "0"}}}}}}}}