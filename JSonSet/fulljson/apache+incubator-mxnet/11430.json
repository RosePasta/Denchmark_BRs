{"BR": {"BR_id": "11430", "BR_author": "liyujiel", "BRopenT": "2018-06-27T21:24:33Z", "BRcloseT": "2018-07-18T19:19:47Z", "BR_text": {"BRsummary": "lstm_bucketing example has evenly divide problem with self create dataset", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n problem happened with a self-created dataset for lstm_bucketing example on CPU\n But dataset with rnn-time-major works good\n <denchmark-h:h2>Environment info (Required)</denchmark-h>\n \n <denchmark-code>----------Python Info----------\n Version      : 3.6.4\n Compiler     : GCC 7.2.0\n Build        : ('default', 'Jan 16 2018 18:10:19')\n Arch         : ('64bit', '')\n ------------Pip Info-----------\n Version      : 9.0.1\n Directory    : /home/ubuntu/anaconda3/lib/python3.6/site-packages/pip\n ----------MXNet Info-----------\n /home/ubuntu/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n   from ._conv import register_converters as _register_converters\n Version      : 1.3.0\n Directory    : /home/ubuntu/anaconda3/lib/python3.6/site-packages/mxnet\n Commit Hash   : 5550c0afe4b202c573a1cc0e2387447c8a888769\n ----------System Info----------\n Platform     : Linux-4.4.0-1061-aws-x86_64-with-debian-stretch-sid\n system       : Linux\n node         : ip-172-31-25-194\n release      : 4.4.0-1061-aws\n version      : #70-Ubuntu SMP Fri May 25 21:47:34 UTC 2018\n ----------Hardware Info----------\n machine      : x86_64\n processor    : x86_64\n Architecture:          x86_64\n CPU op-mode(s):        32-bit, 64-bit\n Byte Order:            Little Endian\n CPU(s):                32\n On-line CPU(s) list:   0-31\n Thread(s) per core:    2\n Core(s) per socket:    16\n Socket(s):             1\n NUMA node(s):          1\n Vendor ID:             GenuineIntel\n CPU family:            6\n Model:                 79\n Model name:            Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz\n Stepping:              1\n CPU MHz:               2699.625\n CPU max MHz:           3000.0000\n CPU min MHz:           1200.0000\n BogoMIPS:              4600.08\n Hypervisor vendor:     Xen\n Virtualization type:   full\n L1d cache:             32K\n L1i cache:             32K\n L2 cache:              256K\n L3 cache:              46080K\n NUMA node0 CPU(s):     0-31\n Flags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single kaiser fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm rdseed adx xsaveopt\n ----------Network Test----------\n Setting timeout: 10\n Timing for MXNet: https://github.com/apache/incubator-mxnet, DNS: 0.0021 sec, LOAD: 0.3551 sec.\n Timing for Gluon Tutorial(en): http://gluon.mxnet.io, DNS: 0.0739 sec, LOAD: 0.0567 sec.\n Timing for Gluon Tutorial(cn): https://zh.gluon.ai, DNS: 0.0908 sec, LOAD: 0.4070 sec.\n Timing for FashionMNIST: https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/dataset/fashion-mnist/train-labels-idx1-ubyte.gz, DNS: 0.0037 sec, LOAD: 0.9360 sec.\n Timing for PYPI: https://pypi.python.org/pypi/pip, DNS: 0.0038 sec, LOAD: 0.1142 sec.\n Timing for Conda: https://repo.continuum.io/pkgs/free/, DNS: 0.0030 sec, LOAD: 0.0294 sec.\n \n </denchmark-code>\n \n Package used (Python/R/Scala/Julia):\n Python\n MXNet commit hash:\n <denchmark-link:https://github.com/apache/incubator-mxnet/commit/7c1acb489a2d7546ffac55f5c2764f1e92e77306>7c1acb4</denchmark-link>\n \n Build config:\n (Paste the content of config.mk, or the build command.)\n <denchmark-h:h2>Error Message:</denchmark-h>\n \n /anaconda3/lib/python3.6/site-packages/h5py/init.py:36: FutureWarning: Conversion of the second argument of issubdtype from float to np.floating is deprecated. In future, it will be treated as np.float64 == np.dtype(float).type.\n from ._conv import register_converters as _register_converters\n WARNING: discarded 0 sentences longer than the largest bucket.\n WARNING: discarded 0 sentences longer than the largest bucket.\n Traceback (most recent call last):\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/symbol/symbol.py\", line 1521, in simple_bind\n ctypes.byref(exe_handle)))\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/base.py\", line 210, in check_call\n raise MXNetError(py_str(LIB.MXGetLastError()))\n mxnet.base.MXNetError: Error in operator split0: [13:51:38] src/operator/./slice_channel-inl.h:208: Check failed: dshape[real_axis] % param.num_outputs == 0U (10 vs. 0) You are trying to split the 1-th axis of input tensor with shape [32,30,200] into num_outputs=20 evenly sized chunks, but this is not possible because 20 does not evenly divide 30\n Stack trace returned 10 entries:\n [bt] (0) 0   libmxnet.so                         0x000000011c0dcab4 libmxnet.so + 19124\n [bt] (1) 1   libmxnet.so                         0x000000011c0dc86f libmxnet.so + 18543\n [bt] (2) 2   libmxnet.so                         0x000000011d6873f1 MXTVMBridge + 3552369\n [bt] (3) 3   libmxnet.so                         0x000000011d3170ce MXNDListFree + 1644494\n [bt] (4) 4   libmxnet.so                         0x000000011d1d477a MXNDListFree + 323194\n [bt] (5) 5   libmxnet.so                         0x000000011d1cce8c MXNDListFree + 292236\n [bt] (6) 6   libmxnet.so                         0x000000011d1bf8d6 MXNDListFree + 237526\n [bt] (7) 7   libmxnet.so                         0x000000011d1c544a MXNDListFree + 260938\n [bt] (8) 8   libmxnet.so                         0x000000011d151e40 MXExecutorSimpleBind + 8656\n [bt] (9) 9   libffi.6.dylib                      0x000000010dea8884 ffi_call_unix64 + 76\n During handling of the above exception, another exception occurred:\n Traceback (most recent call last):\n File \"lstm_bucketing.py\", line 126, in \n batch_end_callback  = mx.callback.Speedometer(args.batch_size, args.disp_batches, auto_reset=False))\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/module/base_module.py\", line 515, in fit\n self.forward_backward(data_batch)\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/module/base_module.py\", line 194, in forward_backward\n self.forward(data_batch, is_train=True)\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/module/bucketing_module.py\", line 455, in forward\n data_batch.provide_label)\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/module/bucketing_module.py\", line 376, in switch_bucket\n force_rebind=False, shared_module=self._buckets[self._default_bucket_key])\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/module/module.py\", line 430, in bind\n state_names=self._state_names)\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/module/executor_group.py\", line 279, in init\n self.bind_exec(data_shapes, label_shapes, shared_group)\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/module/executor_group.py\", line 375, in bind_exec\n shared_group))\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/module/executor_group.py\", line 662, in bind_ith_exec\n shared_buffer=shared_data_arrays, **input_shapes)\n File \"/anaconda3/lib/python3.6/site-packages/mxnet/symbol/symbol.py\", line 1527, in simple_bind\n raise RuntimeError(error_msg)\n RuntimeError: simple_bind error. Arguments:\n data: (32, 30)\n softmax_label: (32, 30)\n Error in operator split0: [13:51:38] src/operator/./slice_channel-inl.h:208: Check failed: dshape[real_axis] % param.num_outputs == 0U (10 vs. 0) You are trying to split the 1-th axis of input tensor with shape [32,30,200] into num_outputs=20 evenly sized chunks, but this is not possible because 20 does not evenly divide 30\n Stack trace returned 10 entries:\n [bt] (0) 0   libmxnet.so                         0x000000011c0dcab4 libmxnet.so + 19124\n [bt] (1) 1   libmxnet.so                         0x000000011c0dc86f libmxnet.so + 18543\n [bt] (2) 2   libmxnet.so                         0x000000011d6873f1 MXTVMBridge + 3552369\n [bt] (3) 3   libmxnet.so                         0x000000011d3170ce MXNDListFree + 1644494\n [bt] (4) 4   libmxnet.so                         0x000000011d1d477a MXNDListFree + 323194\n [bt] (5) 5   libmxnet.so                         0x000000011d1cce8c MXNDListFree + 292236\n [bt] (6) 6   libmxnet.so                         0x000000011d1bf8d6 MXNDListFree + 237526\n [bt] (7) 7   libmxnet.so                         0x000000011d1c544a MXNDListFree + 260938\n [bt] (8) 8   libmxnet.so                         0x000000011d151e40 MXExecutorSimpleBind + 8656\n [bt] (9) 9   libffi.6.dylib                      0x000000010dea8884 ffi_call_unix64 + 76\n <denchmark-h:h2>Steps to reproduce</denchmark-h>\n \n (Paste the commands you ran that produced the error.)\n \n python lstm_bucketing.py\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "liyujiel", "commentT": "2018-06-28T15:52:57Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/liyujiel>@liyujiel</denchmark-link>\n  thanks for submitting the issue, <denchmark-link:https://github.com/sandeep-krishnamurthy>@sandeep-krishnamurthy</denchmark-link>\n  requesting this be labeled.\n \t\t"}}}, "commit": {"commit_id": "904052d620a88898928def0f2e47ce70903892cb", "commit_author": "Soonhwan-Kwon", "commitT": "2018-07-18 09:40:52-07:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\mxnet\\rnn\\io.py", "file_new_name": "python\\mxnet\\rnn\\io.py", "file_complexity": {"file_NLOC": "144", "file_CCN": "8", "file_NToken": "1003"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "120,121,122,123,126,133", "deleted_lines": "128"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\python\\train\\test_bucketing.py", "file_new_name": "tests\\python\\train\\test_bucketing.py", "file_complexity": {"file_NLOC": "71", "file_CCN": "5", "file_NToken": "558"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "39,48", "deleted_lines": "39,48", "method_info": {"method_name": "test_bucket_module", "method_params": "", "method_startline": "25", "method_endline": "103", "method_complexity": {"method_NLOC": "54", "method_CCN": "4", "method_NToken": "375", "method_nesting_level": "0"}}}}}}}}