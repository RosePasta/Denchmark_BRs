{"BR": {"BR_id": "17562", "BR_author": "eric-haibin-lin", "BRopenT": "2020-02-11T01:57:11Z", "BRcloseT": "2020-02-18T23:49:19Z", "BR_text": {"BRsummary": "Fail to import MXNet in distributed kvstore test", "BRdescription": "\n The distributed kvstore test has been failing on the master branch:\n <denchmark-code>[2020-02-10T20:44:37.605Z] + ../../tools/launch.py -n 4 --launcher local python dist_device_sync_kvstore.py\n \n [2020-02-10T20:44:38.537Z] Traceback (most recent call last):\n \n [2020-02-10T20:44:38.537Z]   File \"dist_device_sync_kvstore.py\", line 22, in <module>\n \n [2020-02-10T20:44:38.537Z]     import mxnet as mx\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/__init__.py\", line 34, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import contrib\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/__init__.py\", line 30, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import text\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/text/__init__.py\", line 23, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import embedding\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/text/embedding.py\", line 39, in <module>\n \n [2020-02-10T20:44:38.537Z]     from ... import numpy as _mx_np\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/__init__.py\", line 24, in <module>\n \n [2020-02-10T20:44:38.537Z]     from .multiarray import *  # pylint: disable=wildcard-import\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/multiarray.py\", line 49, in <module>\n \n [2020-02-10T20:44:38.537Z]     from .fallback import *  # pylint: disable=wildcard-import,unused-wildcard-import\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/fallback.py\", line 29, in <module>\n \n [2020-02-10T20:44:38.537Z]     heaviside = onp.heaviside\n \n [2020-02-10T20:44:38.537Z] AttributeError: 'module' object has no attribute 'heaviside'\n \n [2020-02-10T20:44:38.537Z] Traceback (most recent call last):\n \n [2020-02-10T20:44:38.537Z]   File \"dist_device_sync_kvstore.py\", line 22, in <module>\n \n [2020-02-10T20:44:38.537Z]     import mxnet as mx\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/__init__.py\", line 34, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import contrib\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/__init__.py\", line 30, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import text\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/text/__init__.py\", line 23, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import embedding\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/text/embedding.py\", line 39, in <module>\n \n [2020-02-10T20:44:38.537Z]     from ... import numpy as _mx_np\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/__init__.py\", line 24, in <module>\n \n [2020-02-10T20:44:38.537Z]     from .multiarray import *  # pylint: disable=wildcard-import\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/multiarray.py\", line 49, in <module>\n \n [2020-02-10T20:44:38.537Z]     from .fallback import *  # pylint: disable=wildcard-import,unused-wildcard-import\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/fallback.py\", line 29, in <module>\n \n [2020-02-10T20:44:38.537Z]     heaviside = onp.heaviside\n \n [2020-02-10T20:44:38.537Z] AttributeError: 'module' object has no attribute 'heaviside'\n \n [2020-02-10T20:44:38.537Z] Traceback (most recent call last):\n \n [2020-02-10T20:44:38.537Z]   File \"dist_device_sync_kvstore.py\", line 22, in <module>\n \n [2020-02-10T20:44:38.537Z]     import mxnet as mx\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/__init__.py\", line 34, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import contrib\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/__init__.py\", line 30, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import text\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/text/__init__.py\", line 23, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import embedding\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/text/embedding.py\", line 39, in <module>\n \n [2020-02-10T20:44:38.537Z]     from ... import numpy as _mx_np\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/__init__.py\", line 24, in <module>\n \n [2020-02-10T20:44:38.537Z]     from .multiarray import *  # pylint: disable=wildcard-import\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/multiarray.py\", line 49, in <module>\n \n [2020-02-10T20:44:38.537Z]     from .fallback import *  # pylint: disable=wildcard-import,unused-wildcard-import\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/fallback.py\", line 29, in <module>\n \n [2020-02-10T20:44:38.537Z]     heaviside = onp.heaviside\n \n [2020-02-10T20:44:38.537Z] AttributeError: 'module' object has no attribute 'heaviside'\n \n [2020-02-10T20:44:38.537Z] Traceback (most recent call last):\n \n [2020-02-10T20:44:38.537Z]   File \"dist_device_sync_kvstore.py\", line 22, in <module>\n \n [2020-02-10T20:44:38.537Z]     import mxnet as mx\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/__init__.py\", line 34, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import contrib\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/__init__.py\", line 30, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import text\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/text/__init__.py\", line 23, in <module>\n \n [2020-02-10T20:44:38.537Z]     from . import embedding\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/contrib/text/embedding.py\", line 39, in <module>\n \n [2020-02-10T20:44:38.537Z]     from ... import numpy as _mx_np\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/__init__.py\", line 24, in <module>\n \n [2020-02-10T20:44:38.537Z]     from .multiarray import *  # pylint: disable=wildcard-import\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/multiarray.py\", line 49, in <module>\n \n [2020-02-10T20:44:38.537Z]     from .fallback import *  # pylint: disable=wildcard-import,unused-wildcard-import\n \n [2020-02-10T20:44:38.537Z]   File \"../../python/mxnet/numpy/fallback.py\", line 29, in <module>\n \n [2020-02-10T20:44:38.537Z]     heaviside = onp.heaviside\n \n [2020-02-10T20:44:38.537Z] AttributeError: 'module' object has no attribute 'heaviside'\n \n [2020-02-10T20:44:38.537Z] Exception in thread Thread-2:\n \n [2020-02-10T20:44:38.537Z] Traceback (most recent call last):\n \n [2020-02-10T20:44:38.537Z]   File \"/usr/lib/python2.7/threading.py\", line 801, in __bootstrap_inner\n \n [2020-02-10T20:44:38.537Z]     self.run()\n \n [2020-02-10T20:44:38.537Z]   File \"/usr/lib/python2.7/threading.py\", line 754, in run\n \n [2020-02-10T20:44:38.537Z]     self.__target(*self.__args, **self.__kwargs)\n \n [2020-02-10T20:44:38.537Z]   File \"/work/mxnet/tools/../3rdparty/dmlc-core/tracker/dmlc_tracker/local.py\", line 49, in exec_cmd\n \n [2020-02-10T20:44:38.537Z]     raise RuntimeError('Get nonzero return code=%d on %s %s' % (ret, cmd, env))\n \n [2020-02-10T20:44:38.537Z] RuntimeError: Get nonzero return code=1 on ['python', 'dist_device_sync_kvstore.py'] {'MXNET_SUBGRAPH_VERBOSE': '0', 'CCACHE_TEMPDIR': '/tmp/ccache', 'BUILD_TAG': 'jenkins-mxnet-validation-unix-gpu-master-1622', 'CCACHE_MAXSIZE': '500G', 'CUDA_VERSION': '10.1.105', 'HOME': '/home/jenkins_slave', 'CCACHE_LOGFILE': '/tmp/ccache.log', 'LD_LIBRARY_PATH': '/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/cuda/compat', 'DMLC_LOG_STACK_TRACE_DEPTH': '10', 'LIBRARY_PATH': '/usr/local/cuda/lib64/stubs', 'CUDA_PKG_VERSION': '10-1=10.1.243-1', 'SHLVL': '1', 'DMLC_PS_ROOT_URI': '172.17.0.2', 'NCCL_VERSION': '2.4.8', 'NVIDIA_VISIBLE_DEVICES': 'all', 'CUDNN_VERSION': '7.6.5.32', 'DMLC_TASK_ID': '0', 'BUILD_ID': '1622', 'BUILD_NUMBER': '1622', 'PYTHONPATH': './python/', 'DMLC_PS_ROOT_PORT': '9091', 'PATH': '/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'DMLC_NUM_WORKER': '4', 'NVIDIA_DRIVER_CAPABILITIES': 'compute,utility', '_': '../../tools/launch.py', 'NVIDIA_REQUIRE_CUDA': 'cuda>=10.1 brand=tesla,driver>=384,driver<385 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411', 'OLDPWD': '/work/mxnet', 'HOSTNAME': 'a9f40a381df5', 'MXNET_STORAGE_FALLBACK_LOG_VERBOSE': '0', 'DMLC_ROLE': 'worker', 'DMLC_JOB_CLUSTER': 'local', 'PWD': '/work/mxnet/tests/nightly', 'DMLC_NUM_SERVER': '4', 'CCACHE_DIR': '/work/ccache'}\n \n </denchmark-code>\n \n CI reports test passes by mistake. MXNet actually cannot be imported due to some changed from mxnet.numpy.\n <denchmark-link:http://jenkins.mxnet-ci.amazon-ml.com/blue/organizations/jenkins/mxnet-validation%2Funix-gpu/detail/master/1622/pipeline>http://jenkins.mxnet-ci.amazon-ml.com/blue/organizations/jenkins/mxnet-validation%2Funix-gpu/detail/master/1622/pipeline</denchmark-link>\n \n <denchmark-link:https://github.com/haojin2>@haojin2</denchmark-link>\n  have you seen this?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "eric-haibin-lin", "commentT": "2020-02-14T06:37:28Z", "comment_text": "\n \t\tThe test failure is on Python2. The test should be launched using Python3 instead.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "eric-haibin-lin", "commentT": "2020-02-18T23:49:19Z", "comment_text": "\n \t\tFixed by <denchmark-link:https://github.com/apache/incubator-mxnet/pull/17600>#17600</denchmark-link>\n .\n \t\t"}}}, "commit": {"commit_id": "bc1fc55ec6bd37f649ad4d38e3f4fc1bc49b6767", "commit_author": "reminisce", "commitT": "2020-02-16 14:38:29-05:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "ci\\docker\\runtime_functions.sh", "file_new_name": "ci\\docker\\runtime_functions.sh", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "1335,1336,1337,1338,1339,1340,1341,1342,1343,1372,1373,1374,1375", "deleted_lines": "1335,1336,1337,1338,1339,1340,1341,1342,1343,1372,1373,1374,1375"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\mxnet\\ndarray\\numpy\\_op.py", "file_new_name": "python\\mxnet\\ndarray\\numpy\\_op.py", "file_complexity": {"file_NLOC": "3590", "file_CCN": "302", "file_NToken": "8824"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "4903", "deleted_lines": "4903", "method_info": {"method_name": "diag_indices_from", "method_params": "arr", "method_startline": "4900", "method_endline": "4936", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "16", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\mxnet\\numpy\\multiarray.py", "file_new_name": "python\\mxnet\\numpy\\multiarray.py", "file_complexity": {"file_NLOC": "4026", "file_CCN": "507", "file_NToken": "13073"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "6645", "deleted_lines": "6645", "method_info": {"method_name": "diag_indices_from", "method_params": "arr", "method_startline": "6642", "method_endline": "6678", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "13", "method_nesting_level": "0"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\mxnet\\symbol\\numpy\\_symbol.py", "file_new_name": "python\\mxnet\\symbol\\numpy\\_symbol.py", "file_complexity": {"file_NLOC": "3161", "file_CCN": "450", "file_NToken": "11964"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "4568", "deleted_lines": "4568", "method_info": {"method_name": "diag_indices_from", "method_params": "arr", "method_startline": "4565", "method_endline": "4601", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "13", "method_nesting_level": "0"}}}}}}}}