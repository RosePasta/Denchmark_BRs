{"BR": {"BR_id": "14590", "BR_author": "lanking520", "BRopenT": "2019-04-02T03:24:52Z", "BRcloseT": "2019-04-03T17:08:03Z", "BR_text": {"BRsummary": "Scala/Java reshape problem", "BRdescription": "\n Currently I am facing an issue with Scala/Java. If tried to do the following reshape method, the function will fail:\n package mxnet;\n \n import org.apache.mxnet.javaapi.Context;\n import org.apache.mxnet.javaapi.NDArray;\n import org.apache.mxnet.javaapi.NDArray$;\n \n public class Test {\n     private static NDArray$ NDArray = NDArray$.MODULE$;\n     public static void main(String[] args) {\n         NDArray nd = NDArray.ones(Context.cpu(), new int[] {1, 384, 1});\n         nd.reshape(new int[]{0, -3});\n     }\n }\n Error:\n <denchmark-code>Exception in thread \"main\" org.apache.mxnet.MXNetError: [20:03:16] src/ndarray/ndarray.cc:224: Check failed: shape_.Size() >= shape.Size() (384 vs. 18446744073709551613) NDArray.Reshape: target shape size is larger current shape\n </denchmark-code>\n \n On the backend, this is being called:\n <denchmark-code>_LIB.mxNDArrayReshape(handle, dims.length, dims, reshapeHandle)\n </denchmark-code>\n \n However, Python seemed to be fine:\n test = mx.nd.ones((1, 384, 1))\n print(test.reshape((0, -3)))\n I think this might be some bugs in the operator side.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "lanking520", "commentT": "2019-04-02T03:24:54Z", "comment_text": "\n \t\tHey, this is the MXNet Label Bot.\n Thank you for submitting the issue! I will try and suggest some labels so that the appropriate MXNet community members can help resolve it.\n Here are my recommended labels: Scala, Bug\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "lanking520", "commentT": "2019-04-02T20:19:51Z", "comment_text": "\n \t\tHere is the corresponding <denchmark-link:https://github.com/apache/incubator-mxnet/blob/master/python/mxnet/ndarray/ndarray.py#L1065>Python method</denchmark-link>\n .\n This method  is being called:\n <denchmark-code>_LIB.MXNDArrayReshape64(self.handle, len(shape), c_array(ctypes.c_int64, shape), reverse, ctypes.byref(handle)))\n </denchmark-code>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "lanking520", "commentT": "2019-04-02T20:29:32Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/stu1130>@stu1130</denchmark-link>\n  finding, the Actual PR is here where Python made the switch:\n <denchmark-link:https://github.com/apache/incubator-mxnet/pull/10360>#10360</denchmark-link>\n \n <denchmark-link:https://github.com/apache/incubator-mxnet/pull/10767>#10767</denchmark-link>\n \n Will raise a PR to update the corresponding Scala code\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "lanking520", "commentT": "2019-04-03T17:08:03Z", "comment_text": "\n \t\tClose this one since the problem solved\n \t\t"}}}, "commit": {"commit_id": "b482a44fa8cd932ed48d62bafadb11299c7cd381", "commit_author": "Lanking", "commitT": "2019-04-03 10:07:38-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.8333333333333334"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scala-package\\core\\src\\main\\scala\\org\\apache\\mxnet\\LibInfo.scala", "file_new_name": "scala-package\\core\\src\\main\\scala\\org\\apache\\mxnet\\LibInfo.scala", "file_complexity": {"file_NLOC": "278", "file_CCN": "0", "file_NToken": "2349"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "89,91,92", "deleted_lines": "89,91"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "scala-package\\core\\src\\main\\scala\\org\\apache\\mxnet\\NDArray.scala", "file_new_name": "scala-package\\core\\src\\main\\scala\\org\\apache\\mxnet\\NDArray.scala", "file_complexity": {"file_NLOC": "902", "file_CCN": "229", "file_NToken": "7675"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "953,954,955,956,957,958,959,960,961,962", "deleted_lines": "954", "method_info": {"method_name": "reshape", "method_params": "", "method_startline": "952", "method_endline": "962", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "962,964,965", "deleted_lines": null, "method_info": {"method_name": "reshape", "method_params": "None", "method_startline": "962", "method_endline": "975", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "69", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scala-package\\core\\src\\test\\scala\\org\\apache\\mxnet\\NDArraySuite.scala", "file_new_name": "scala-package\\core\\src\\test\\scala\\org\\apache\\mxnet\\NDArraySuite.scala", "file_complexity": {"file_NLOC": "797", "file_CCN": "6", "file_NToken": "9006"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "881,883,889,890,891,892", "deleted_lines": "881,883"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "scala-package\\native\\src\\main\\native\\org_apache_mxnet_native_c_api.cc", "file_new_name": "scala-package\\native\\src\\main\\native\\org_apache_mxnet_native_c_api.cc", "file_complexity": {"file_NLOC": "2175", "file_CCN": "240", "file_NToken": "18997"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "407,408,409,411,412,413,415", "deleted_lines": "407,408,410,411,412,414", "method_info": {"method_name": "Java_org_apache_mxnet_LibInfo_mxNDArrayReshape", "method_params": "env,obj,ndArrayPtr,ndim,dims,reshapedHandle", "method_startline": "407", "method_endline": "416", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "96", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "407,408,409,411,412,413,415", "deleted_lines": "407,408,410,411,412,414", "method_info": {"method_name": "Java_org_apache_mxnet_LibInfo_mxNDArrayReshape64", "method_params": "env,obj,ndArrayPtr,ndim,dims,reverse,reshapedHandle", "method_startline": "407", "method_endline": "417", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "101", "method_nesting_level": "0"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scala-package\\native\\src\\main\\native\\org_apache_mxnet_native_c_api.h", "file_new_name": "scala-package\\native\\src\\main\\native\\org_apache_mxnet_native_c_api.h", "file_complexity": {"file_NLOC": "215", "file_CCN": "0", "file_NToken": "1798"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "164,165,167,168", "deleted_lines": "164,165,167,168"}}}}}}