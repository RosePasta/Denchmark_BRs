{"BR": {"BR_id": "9605", "BR_author": "y1xiaoc", "BRopenT": "2018-01-27T22:42:16Z", "BRcloseT": "2018-01-31T17:09:22Z", "BR_text": {"BRsummary": "SGLD Optimizer in python cannot work due to wrong argument position", "BRdescription": "\n Note: Providing complete information in the most concise form is the best way to get help. This issue template serves as the checklist for essential information to most of the technical issues and bug reports. For non-technical issues and feature requests, feel free to present the information in what you believe is the best form.\n For Q & A and discussion, please start a discussion thread at <denchmark-link:https://discuss.mxnet.io>https://discuss.mxnet.io</denchmark-link>\n \n <denchmark-h:h2>Description</denchmark-h>\n \n when calling SGLD optimizer's update method, an error occur due to the false argument position of calling ramdom.normal\n <denchmark-h:h2>Environment info (Required)</denchmark-h>\n \n ----------Python Info----------\n Version      : 3.6.2\n Compiler     : MSC v.1900 64 bit (AMD64)\n Build        : ('default', 'Jul 20 2017 12:30:02')\n Arch         : ('64bit', 'WindowsPE')\n ------------Pip Info-----------\n Version      : 9.0.1\n Directory    : C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\pip\n ----------MXNet Info-----------\n C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\h5py__.py:34: FutureWarning: Conversion of the second argument of issubdtype from  to  is deprecated. In future, it will be treated as .\n from ._conv import register_converters as _register_converters\n Version      : 1.0.0\n Directory    : C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\mxnet\n Hashtag not found. Not installed from pre-built package.\n ----------System Info----------\n Platform     : Windows-10-10.0.17074-SP0\n system       : Windows\n node         : Xiao-pc\n release      : 10\n version      : 10.0.17074\n ----------Hardware Info----------\n machine      : AMD64\n processor    : Intel64 Family 6 Model 60 Stepping 3, GenuineIntel\n \u9519\u8bef:\n \u63cf\u8ff0 = \u53d1\u751f\u610f\u5916\u3002\n ----------Network Test----------\n Setting timeout: 10\n Timing for MXNet: <denchmark-link:https://github.com/apache/incubator-mxnet>https://github.com/apache/incubator-mxnet</denchmark-link>\n , DNS: 0.0060 sec, LOAD: 1.4936 sec.\n Timing for Gluon Tutorial(en): <denchmark-link:http://gluon.mxnet.io>http://gluon.mxnet.io</denchmark-link>\n , DNS: 0.0937 sec, LOAD: 0.1105 sec.\n Timing for Gluon Tutorial(cn): <denchmark-link:https://zh.gluon.ai>https://zh.gluon.ai</denchmark-link>\n , DNS: 0.0120 sec, LOAD: 0.3488 sec.\n Timing for FashionMNIST: <denchmark-link:https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/dataset/fashion-mnist/train-labels-idx1-ubyte.gz>https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/dataset/fashion-mnist/train-labels-idx1-ubyte.gz</denchmark-link>\n , DNS: 0.0210 sec, LOAD: 0.4903 sec.\n Timing for PYPI: <denchmark-link:https://pypi.python.org/pypi/pip>https://pypi.python.org/pypi/pip</denchmark-link>\n , DNS: 0.0120 sec, LOAD: 0.0540 sec.\n Timing for Conda: <denchmark-link:https://repo.continuum.io/pkgs/free/>https://repo.continuum.io/pkgs/free/</denchmark-link>\n , DNS: 0.0100 sec, LOAD: 0.0442 sec.\n Package used (Python/R/Scala/Julia):\n python\n <denchmark-h:h2>Error Message:</denchmark-h>\n \n Traceback (most recent call last):\n File \"d:/Research/deepLearning/mxnet/mx_model.py\", line 180, in \n trainer.train(model)\n File \"d:/Research/deepLearning/mxnet/mx_model.py\", line 142, in train\n trainer.step(1)\n File \"C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\mxnet\\gluon\\trainer.py\", line 199, in step\n upd(i, grad, arr)\n File \"C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\mxnet\\optimizer.py\", line 1163, in call\n self.optimizer.update_multi_precision(index, weight, grad, self.states[index])\n File \"C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\mxnet\\optimizer.py\", line 275, in update_multi_precision\n self.update(index, weight, grad, state)\n File \"C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\mxnet\\optimizer.py\", line 653, in update\n weight.shape, weight.context)\n File \"C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\mxnet\\ndarray\\random.py\", line 152, in normal\n [loc, scale], shape, dtype, ctx, out, kwargs)\n File \"C:\\Users\\Xiao\\Anaconda3\\lib\\site-packages\\mxnet\\ndarray\\random.py\", line 47, in _random_helper\n return random(*params, shape=shape, dtype=dtype, ctx=ctx, out=out, **kwargs)\n File \"\", line 55, in _random_normal\n TypeError: data type not understood\n <denchmark-h:h2>Steps to reproduce</denchmark-h>\n \n simply call SGLD's update method.\n <denchmark-h:h2>What have you tried to solve it?</denchmark-h>\n \n change the line     weight.shape, weight.context)\n (\n \n \n incubator-mxnet/python/mxnet/optimizer.py\n \n \n          Line 767\n       in\n       9ae63d1\n \n \n \n \n \n \n  weight.shape, weight.context) \n \n \n \n \n )\n into    weight.shape, ctx=weight.context\n as the position of weight.context is belong to dtype\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "y1xiaoc", "commentT": "2018-01-29T19:43:16Z", "comment_text": "\n \t\tThanks for reporting this! Would you like to submit a pull request to fix the problem? We can change the code to normal(0, math.sqrt(lr), shape=weight.shape, dtype=weight.dtype, ctx=weight.context)\n \t\t"}}}, "commit": {"commit_id": "60ae6d4445fe3ca3f3686074863f1b0e4c4b3278", "commit_author": "dongzhuoyao", "commitT": "2018-01-31 09:09:12-08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\mxnet\\optimizer.py", "file_new_name": "python\\mxnet\\optimizer.py", "file_complexity": {"file_NLOC": "1113", "file_CCN": "180", "file_NToken": "6535"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "955,956", "deleted_lines": "955,956", "method_info": {"method_name": "update", "method_params": "self,index,weight,grad,state", "method_startline": "945", "method_endline": "956", "method_complexity": {"method_NLOC": "11", "method_CCN": "2", "method_NToken": "130", "method_nesting_level": "1"}}}}}}}}