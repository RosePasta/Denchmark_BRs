{"BR": {"BR_id": "978", "BR_author": "parano", "BRopenT": "2020-08-10T20:08:59Z", "BRcloseT": "2020-08-11T09:14:24Z", "BR_text": {"BRsummary": "Failed to package local pip installed dependency in 0.8.4", "BRdescription": "\n An issue first reported in #bentoml-users slack channel by <denchmark-link:https://github.com/fernandocamargoti>@fernandocamargoti</denchmark-link>\n \n In some python environment, we see the following error when doing a BenoService#save:\n <denchmark-code>TypeError: expected str, bytes or os.PathLike object, not NoneType\n </denchmark-code>\n \n The reason is some packages ended up with a module_path == None when accessing form pkg_resources.working_set:\n import pkg_resources\n [dist for dist in pkg_resources.working_set if not dist.module_path]\n Out[4]: [terminado 0.8.3 (/home/fernandocamargo/anaconda3/envs/logit/lib/python3.6/site-packages)]\n Here is a conda environment yaml file that can reproduce this issue:\n <denchmark-code>name: logit\n channels:\n #- anaconda\n - conda-forge\n - anaconda\n - pytorch\n - https://public.dhe.ibm.com/ibmdl/export/pub/software/server/ibm-ai/conda\n - powerai\n dependencies:\n - python=3.6\n - pandas=1.0\n - pyarrow=0.15\n - matplotlib=3.1\n - plotly=4.6\n - scipy=1.3\n - numpy=1.16\n - seaborn=0.10\n - scikit-learn=0.22\n - pytorch=1.2\n - statsmodels=0.11\n - holidays=0.9\n - convertdate=2.2\n - python-dateutil=2.8\n - fbprophet=0.6\n - luigi=2.8\n - tqdm=4.44\n - jupyterlab=1.2\n - ipywidgets=7.5\n - pyspark=2.4.5\n - psutil=5.5\n - pydantic=1.6\n - sqlalchemy=1.3\n - psycopg2=2.8\n # GPU:\n - cudatoolkit=10.1\n - pip\n - pip:\n #  CPU:\n #  - mxnet==1.4.1\n #  GPU:\n   - mxnet-cu101mkl==1.4.1\n #  Power-9:\n #  - /root/packages/mxnet/mxnet-1.4.1-cp36-cp36m-linux_ppc64le.whl\n   - gluonts==0.5\n   - pmdarima==1.4\n   - torchbearer==0.5\n   - imbalanced-learn==0.6\n   - tensorboardx==2.0\n   - diskcache==3.0\n   - bentoml==0.8.3\n </denchmark-code>\n \n Interestingly, installing terminado alone does not cause this problem. I'm not sure if this is caused by other packages in this list. But will submit a fix to ensure BentoML handles this scenario properly.\n We will release a new version including this fix very soon.\n \t"}, "comments": {}}, "commit": {"commit_id": "7fa13e0913437f41da50189f69b3c27e92b9893f", "commit_author": "Chaoyu", "commitT": "2020-08-11 02:14:22-07:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "bentoml\\saved_bundle\\pip_pkg.py", "file_new_name": "bentoml\\saved_bundle\\pip_pkg.py", "file_complexity": {"file_NLOC": "169", "file_CCN": "62", "file_NToken": "1120"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "85,86,87,88,89,90,92", "deleted_lines": "85,87", "method_info": {"method_name": "__init__", "method_params": "self", "method_startline": "75", "method_endline": "113", "method_complexity": {"method_NLOC": "32", "method_CCN": "10", "method_NToken": "234", "method_nesting_level": "1"}}}}}}}}