{"BR": {"BR_id": "512", "BR_author": "omrihar", "BRopenT": "2020-02-04T21:24:12Z", "BRcloseT": "2020-02-10T21:36:50Z", "BR_text": {"BRsummary": "Problem importing handlers from external files using bentoml serve", "BRdescription": "\n Describe the bug\n I have a custom handler I created to tackle the problem with CORS support in lambda deployments. It resides in a second file which I import in my main service definition file. This file also gets copied into the service environment. The problem, however, is that when I try to serve the model using bentoml serve I get an import error saying this module does not exist.\n I've been able to solve this temporarily by adding the current directory of the service module to the python path using sys.path.append(os.path.dirname(__file__)), which is of course not a long-term solution.\n To Reproduce\n Steps to reproduce the behavior:\n \n Import anything from a self-written module in the script defining the service class.\n Build the model\n Serve it using bentoml serve ...\n See error\n \n Expected behavior\n The model should work.\n Environment:\n \n OS: Manjaro Linux\n Python/BentoML Version Python 3.7.6, BentoML-0.6.1\n \n Additional context\n As discussed on the BentoML Slack channel.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "omrihar", "commentT": "2020-02-10T10:46:26Z", "comment_text": "\n \t\tThanks for reporting the issue <denchmark-link:https://github.com/omrihar>@omrihar</denchmark-link>\n !\n It's actually a regression introduced when we refactored the service loading code path, due to the lack of related tests.  Here's the PR  including the fix and adding tests: <denchmark-link:https://github.com/bentoml/BentoML/pull/518>#518</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "omrihar", "commentT": "2020-02-10T21:36:50Z", "comment_text": "\n \t\tClosing this issue now as <denchmark-link:https://github.com/bentoml/BentoML/pull/518>#518</denchmark-link>\n  has been merged. The upcoming release 0.6.2 will include the fix in <denchmark-link:https://github.com/bentoml/BentoML/pull/518>#518</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "11ae828cc592590be79127e43a9ab0a513a0eb7b", "commit_author": "Chaoyu", "commitT": "2020-02-10 02:51:22-08:00", "commit_complexity": {"commit_NLOC": "0.9", "commit_CCN": "0.9", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "bentoml\\bundler\\loader.py", "file_new_name": "bentoml\\bundler\\loader.py", "file_complexity": {"file_NLOC": "103", "file_CCN": "17", "file_NToken": "654"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "110", "deleted_lines": null, "method_info": {"method_name": "load_bento_service_class", "method_params": "bundle_path", "method_startline": "78", "method_endline": "144", "method_complexity": {"method_NLOC": "42", "method_CCN": "7", "method_NToken": "286", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "bentoml\\handlers\\fastai_image_handler.py", "file_new_name": "bentoml\\handlers\\fastai_image_handler.py", "file_complexity": {"file_NLOC": "183", "file_CCN": "29", "file_NToken": "889"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "115", "method_info": {"method_name": "config", "method_params": "self", "method_startline": "111", "method_endline": "121", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "63", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "bentoml\\handlers\\image_handler.py", "file_new_name": "bentoml\\handlers\\image_handler.py", "file_complexity": {"file_NLOC": "145", "file_CCN": "29", "file_NToken": "740"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "109", "method_info": {"method_name": "config", "method_params": "self", "method_startline": "105", "method_endline": "112", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "29", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scripts\\e2e_tests\\aws_lambda\\e2e_lambda_deployment.py", "file_new_name": "scripts\\e2e_tests\\aws_lambda\\e2e_lambda_deployment.py", "file_complexity": {"file_NLOC": "66", "file_CCN": "1", "file_NToken": "343"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "27,28,29,30,31,32", "deleted_lines": "14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29"}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scripts\\e2e_tests\\aws_lambda\\e2e_lambda_update_deployment.py", "file_new_name": "scripts\\e2e_tests\\aws_lambda\\e2e_lambda_update_deployment.py", "file_complexity": {"file_NLOC": "78", "file_CCN": "2", "file_NToken": "299"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "28,29,30,31,32,33", "deleted_lines": "11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27"}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scripts\\e2e_tests\\aws_sagemaker\\e2e_sagemaker_deployment.py", "file_new_name": "scripts\\e2e_tests\\aws_sagemaker\\e2e_sagemaker_deployment.py", "file_complexity": {"file_NLOC": "81", "file_CCN": "1", "file_NToken": "380"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "27,28,29,30,31,32", "deleted_lines": "15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32"}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scripts\\e2e_tests\\aws_sagemaker\\e2e_sagemaker_update_deployment.py", "file_new_name": "scripts\\e2e_tests\\aws_sagemaker\\e2e_sagemaker_update_deployment.py", "file_complexity": {"file_NLOC": "89", "file_CCN": "4", "file_NToken": "358"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "35,36,37,38,39,40", "deleted_lines": "9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24"}}}, "file_7": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "scripts\\e2e_tests\\bento_service\\dynamically_imported_dependency.py", "file_complexity": {"file_NLOC": "2", "file_CCN": "1", "file_NToken": "8"}}, "file_8": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "scripts\\e2e_tests\\bento_service\\e2e_test_bundle_local_python_module.py", "file_complexity": {"file_NLOC": "42", "file_CCN": "1", "file_NToken": "241"}}, "file_9": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "scripts\\e2e_tests\\bento_service\\my_test_dependency.py", "file_complexity": {"file_NLOC": "2", "file_CCN": "1", "file_NToken": "8"}}}}}