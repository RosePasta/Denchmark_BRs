{"BR": {"BR_id": "601", "BR_author": "sbanori", "BRopenT": "2019-07-31T06:17:02Z", "BRcloseT": "2019-08-24T15:25:22Z", "BR_text": {"BRsummary": "No default attributes in dumped annotation", "BRdescription": "\n Hello,\n I have a little problem after dump annotation. But first... My labels look this like:\n Label_1 <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Shelf_ID:1,10,1 <denchmark-link:https://github.com/checkbox>@checkbox</denchmark-link>\n =Face:true <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Order_on_shelf:1,50,1\n Label_2 <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Shelf_ID:1,10,1 <denchmark-link:https://github.com/checkbox>@checkbox</denchmark-link>\n =Face:true <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Order_on_shelf:1,50,1\n Label_3 <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Shelf_ID:1,10,1 <denchmark-link:https://github.com/checkbox>@checkbox</denchmark-link>\n =Face:true <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Order_on_shelf:1,50,1\n Label_4 <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Shelf_ID:1,10,1 <denchmark-link:https://github.com/checkbox>@checkbox</denchmark-link>\n =Face:true <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Order_on_shelf:1,50,1\n Label_5 <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Shelf_ID:1,10,1 <denchmark-link:https://github.com/checkbox>@checkbox</denchmark-link>\n =Face:true <denchmark-link:https://github.com/Number>@Number</denchmark-link>\n =Order_on_shelf:1,50,1\n On annotated photo we see a rack in the shop with few shelfs. We use attributes to count on which shelf and on which place on shelf is annotated product. Of course on every photo we don't need to change attributes for only one product (this product which have posistion on first shelf and on the first position on shelf) so it means that default attributes are good for him.\n And here we have a problem because if we won't do anything with any attribute on this instance of label, after dump annotation, in xml file we can see only his name but with no values of attributes like below:\n <denchmark-code><box label=\"Label_1\" occluded=\"0\" xtl=\"308.15\" ytl=\"1436.57\" xbr=\"536.26\" ybr=\"1707.47\">\n       <attribute name=\"Order_on_shelf\">2</attribute>\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">false</attribute>\n     </box>\n     <box label=\"Label_2\" occluded=\"0\" xtl=\"3.26\" ytl=\"1410.68\" xbr=\"119.15\" ybr=\"1680.02\">\n     </box>\n     <box label=\"Label_3\" occluded=\"0\" xtl=\"527.86\" ytl=\"1492.75\" xbr=\"760.65\" ybr=\"1722.92\">\n       <attribute name=\"Order_on_shelf\">3</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Shelf_ID\">1</attribute>\n     </box>\n </denchmark-code>\n \n When I will change any attribute on this instance for example:\n \n Shelf_ID=1 ---> ShelfId=2\n Save work\n Shelf_ID=2 ---> Shelft_ID=1\n Save work.\n \n Then everything is OK, instance was \"touched\" so we can see his default values, but only because I changed them for a moment. After dump anotation we see now correct values.:\n <denchmark-code><box label=\"Label_1\" occluded=\"0\" xtl=\"308.15\" ytl=\"1436.57\" xbr=\"536.26\" ybr=\"1707.47\">\n       <attribute name=\"Order_on_shelf\">2</attribute>\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">false</attribute>\n     </box>\n     <box label=\"Label_2\" occluded=\"0\" xtl=\"3.26\" ytl=\"1410.68\" xbr=\"119.15\" ybr=\"1680.02\">\n       <attribute name=\"Order_on_shelf\">1</attribute>\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n     </box>\n     <box label=\"Label_3\" occluded=\"0\" xtl=\"527.86\" ytl=\"1492.75\" xbr=\"760.65\" ybr=\"1722.92\">\n       <attribute name=\"Order_on_shelf\">3</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Shelf_ID\">1</attribute>\n     </box>\n </denchmark-code>\n \n EDIT: Or maybe this is normal funcionality in CVAT, which means that no changes on default values of attributes aren't copied on every line of unchanged instance of objects.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "sbanori", "commentT": "2019-07-31T07:21:56Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/sbanori>@sbanori</denchmark-link>\n  , it looks like a bug. We should dump attributes in the case I believe. Let us reproduce the issue on our side. <denchmark-link:https://github.com/azhavoro>@azhavoro</denchmark-link>\n  , could you please look at the issue?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "sbanori", "commentT": "2019-07-31T07:56:25Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/sbanori>@sbanori</denchmark-link>\n , I can reproduce this behaviour only if I uploaded (via 'upload annotation' button on dashboard view) annotation that doesn't contain a attribute values. After that a dumped annotation will have attributes only for a changed objects. Does it look like on you scenario?\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "sbanori", "commentT": "2019-07-31T08:25:11Z", "comment_text": "\n \t\tHello <denchmark-link:https://github.com/azhavoro>@azhavoro</denchmark-link>\n  , no it doesn't look exactly like this. I don't use \"upload annotation\" functionality in this case.\n I do annotation myself. Let's take example from my first post in this issue.\n If the product on photo is first product on first shelf, it means that I don't need to touch attributes on this instance of label (Label_2) so I stay on default values of attributes. If now we have next product, it will be next instance (of Label_1) next to first instance (Label_2), it means that is still first shelf (so I don't touch this attribute Shelf_ID) but I change value of attribute \"Order_on_shelf\" from 1 to 2. Label_1 will have changed one value (Order_on_shelf). On Label_2 we haven't changed any value so we still have default values of attributes. And here is a problem, if we don't change anything in attributes on instance, this instance won't have attributes in xml dumped file.\n I solved this temporary by change for a while on any other values and after Save Work, come back to default value, then it will be in xml file.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "sbanori", "commentT": "2019-07-31T09:12:29Z", "comment_text": "\n \t\tOk, it's very strange...\n Could you please little bit help to investigate issue? It would be nice if you do following steps:\n \n Open any your own job\n open devtools (F12) and go to Network tab\n add any object (dont touch attributes, just draw a box)\n save job\n In devtools you can see several requests, you should choose annotations?action=create from the list. Click on it, expand 'request payload' section and please post a screenshot or json that you find on this section\n \n For example:\n <denchmark-link:https://user-images.githubusercontent.com/41117609/62199440-2c356180-b38c-11e9-8f51-c2b5401bd789.png></denchmark-link>\n \n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "sbanori", "commentT": "2019-07-31T09:54:27Z", "comment_text": "\n \t\tI know why wee see another effects :) But first, here is json from your steps:\n <denchmark-code>{\n   \"version\": 5,\n   \"shapes\": [\n     {\n       \"attributes\": [\n         {\n           \"value\": \"1\",\n           \"spec_id\": 399\n         },\n         {\n           \"value\": \"true\",\n           \"spec_id\": 400\n         },\n         {\n           \"value\": \"1\",\n           \"spec_id\": 401\n         }\n       ],\n       \"label_id\": 3441,\n       \"group\": 0,\n       \"frame\": 0,\n       \"type\": \"rectangle\",\n       \"occluded\": false,\n       \"z_order\": 1,\n       \"points\": [\n         333.80078125,\n         1746.416015625,\n         566.4331359863281,\n         1996.9431610107422\n       ]\n     }\n   ],\n   \"tracks\": [],\n   \"tags\": []\n }\n </denchmark-code>\n \n And it work properly when I did it like you said. Default attributes are in the xml file and it works without bug.\n I made some tests and know I see when is this bug. It's when I use AutoAnnotation.\n When I write boundingbox by my hand, with default attributes, it's OK. Xml will show these attributes. But when I use AutoAnnotation, then untouched default attributes aren't visible in Xml files.\n And here we have a file which is annotataed in both ways in one task. These without attributes, are from AutoAnnotation, and these from handAnnotation ale with attributes:\n <denchmark-code> <image id=\"0\" name=\"A65_00.jpg\" width=\"2448\" height=\"3264\">\n     <box label=\"Label_4\" occluded=\"0\" xtl=\"309.72\" ytl=\"1389.80\" xbr=\"499.20\" ybr=\"1606.56\">\n     </box>\n     <box label=\"Label_3\" occluded=\"0\" xtl=\"7.12\" ytl=\"1388.27\" xbr=\"158.04\" ybr=\"1598.04\">\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"412.98\" ytl=\"1033.03\" xbr=\"616.50\" ybr=\"1212.46\">\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"236.77\" ytl=\"1006.49\" xbr=\"440.74\" ybr=\"1216.72\">\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"194.46\" ytl=\"210.67\" xbr=\"415.19\" ybr=\"463.48\">\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"445.06\" ytl=\"201.70\" xbr=\"613.23\" ybr=\"449.56\">\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"229.17\" ytl=\"552.18\" xbr=\"419.61\" ybr=\"799.78\">\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"408.63\" ytl=\"550.74\" xbr=\"606.38\" ybr=\"798.35\">\n     </box>\n     <box label=\"Label_2\" occluded=\"0\" xtl=\"98.93\" ytl=\"963.27\" xbr=\"259.68\" ybr=\"1192.88\">\n     </box>\n     <box label=\"Label_2\" occluded=\"0\" xtl=\"30.80\" ytl=\"195.85\" xbr=\"228.04\" ybr=\"462.64\">\n     </box>\n     <box label=\"Label_2\" occluded=\"0\" xtl=\"7.48\" ytl=\"547.47\" xbr=\"228.95\" ybr=\"808.97\">\n     </box>\n     <box label=\"Label_5\" occluded=\"0\" xtl=\"383.55\" ytl=\"2605.37\" xbr=\"473.38\" ybr=\"2841.58\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_4\" occluded=\"0\" xtl=\"888.18\" ytl=\"2594.63\" xbr=\"1156.96\" ybr=\"2812.95\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_3\" occluded=\"0\" xtl=\"1711.34\" ytl=\"2752.10\" xbr=\"1919.28\" ybr=\"2909.58\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_2\" occluded=\"0\" xtl=\"2173.03\" ytl=\"2222.42\" xbr=\"2391.70\" ybr=\"2548.10\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_2\" occluded=\"0\" xtl=\"2015.91\" ytl=\"1692.73\" xbr=\"2230.65\" ybr=\"1921.78\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"1632.96\" ytl=\"568.94\" xbr=\"1790.44\" ybr=\"840.94\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"1156.96\" ytl=\"1012.73\" xbr=\"1364.54\" ybr=\"1238.20\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"1096.12\" ytl=\"1388.52\" xbr=\"1296.54\" ybr=\"1606.84\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"1074.64\" ytl=\"2068.52\" xbr=\"1264.33\" ybr=\"2329.79\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"226.43\" ytl=\"2057.79\" xbr=\"401.80\" ybr=\"2336.94\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n     <box label=\"Label_1\" occluded=\"0\" xtl=\"330.22\" ytl=\"1363.47\" xbr=\"512.75\" ybr=\"1621.15\">\n       <attribute name=\"Shelf_ID\">1</attribute>\n       <attribute name=\"Face\">true</attribute>\n       <attribute name=\"Order_on_shelf\">1</attribute>\n     </box>\n   </image>\n </denchmark-code>\n \n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "sbanori", "commentT": "2019-07-31T10:07:25Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/sbanori>@sbanori</denchmark-link>\n  Got it, thanks for help! We'll fix this issue.\n \t\t"}}}, "commit": {"commit_id": "fc2b9c94ccf80d32142ff94ff66ddde17719c7af", "commit_author": "Andrey Zhavoronkov", "commitT": "2019-08-24 18:25:21+03:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "1.0", "commit_Nprams": "0.6065573770491803"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "42,43", "deleted_lines": "42"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 8, "file_old_name": "cvat\\apps\\engine\\annotation.py", "file_new_name": "cvat\\apps\\engine\\annotation.py", "file_complexity": {"file_NLOC": "600", "file_CCN": "121", "file_NToken": "4103"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "230,244", "deleted_lines": "217,231", "method_info": {"method_name": "_save_tracks_to_db", "method_params": "self,tracks", "method_startline": "215", "method_endline": "295", "method_complexity": {"method_NLOC": "65", "method_CCN": "13", "method_NToken": "452", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "311,313", "deleted_lines": "298,338", "method_info": {"method_name": "_save_shapes_to_db", "method_params": "self,shapes", "method_startline": "297", "method_endline": "338", "method_complexity": {"method_NLOC": "31", "method_CCN": "7", "method_NToken": "225", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "593,594,595,600,601", "deleted_lines": null, "method_info": {"method_name": "_init_tracks_from_db", "method_params": "self", "method_startline": "532", "method_endline": "604", "method_complexity": {"method_NLOC": "66", "method_CCN": "3", "method_NToken": "260", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "488,489,490,491,492", "deleted_lines": null, "method_info": {"method_name": "_init_tags_from_db", "method_params": "self", "method_startline": "463", "method_endline": "494", "method_complexity": {"method_NLOC": "29", "method_CCN": "2", "method_NToken": "121", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "525,526,527", "deleted_lines": null, "method_info": {"method_name": "_init_shapes_from_db", "method_params": "self", "method_startline": "496", "method_endline": "530", "method_complexity": {"method_NLOC": "33", "method_CCN": "2", "method_NToken": "129", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "196,197,198,199,200,201,202,203,204,205,206,207,208,209,210", "deleted_lines": "195,196,197", "method_info": {"method_name": "__init__", "method_params": "self,pk,user", "method_startline": "182", "method_endline": "210", "method_complexity": {"method_NLOC": "24", "method_CCN": "5", "method_NToken": "223", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "454,455,456,457,458,459,460,461", "deleted_lines": null, "method_info": {"method_name": "_extend_attributes", "method_params": "attributeval_set,attribute_specs", "method_startline": "454", "method_endline": "461", "method_complexity": {"method_NLOC": "8", "method_CCN": "4", "method_NToken": "58", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "352,367", "deleted_lines": "353", "method_info": {"method_name": "_save_tags_to_db", "method_params": "self,tags", "method_startline": "340", "method_endline": "378", "method_complexity": {"method_NLOC": "31", "method_CCN": "7", "method_NToken": "225", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "cvat\\apps\\engine\\tests\\test_rest_api.py", "file_new_name": "cvat\\apps\\engine\\tests\\test_rest_api.py", "file_complexity": {"file_NLOC": "1950", "file_CCN": "246", "file_NToken": "14560"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1216,1217,1218,1219,1220,1221,1222,1223,1224,1225,1226,1227,1228,1229,1230,1231,1232,1233,1234", "deleted_lines": null, "method_info": {"method_name": "_get_default_attr_values", "method_params": "task", "method_startline": "1216", "method_endline": "1234", "method_complexity": {"method_NLOC": "19", "method_CCN": "4", "method_NToken": "123", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "1312,1334,1335,1336,1337,1338,1339,1350,1351,1382,1383,1391,1392,1393,1432,1454,1455,1456,1457,1458,1459,1470,1471,1510,1511,1512,1610", "deleted_lines": "1291,1313,1322,1323,1324,1325,1328,1329,1405,1427,1436,1437,1438,1439,1442,1443,1579", "method_info": {"method_name": "_run_api_v1_jobs_id_annotations", "method_params": "self,owner,assignee,annotator", "method_startline": "1269", "method_endline": "1644", "method_complexity": {"method_NLOC": "360", "method_CCN": "3", "method_NToken": "2307", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "1767,1768,1769,1770,1771,1772,1783,1817,1821,1823,1824,1825,1887,1888,1889,1890,1891,1892,1903,1942,1943,1944", "deleted_lines": "1736,1745,1746,1747,1748,1751,1850,1859,1860,1861,1862,1865", "method_info": {"method_name": "_run_api_v1_tasks_id_annotations", "method_params": "self,owner,assignee,annotator", "method_startline": "1698", "method_endline": "2092", "method_complexity": {"method_NLOC": "376", "method_CCN": "4", "method_NToken": "2459", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "1180", "deleted_lines": "1180", "method_info": {"method_name": "_create_task", "method_params": "self,owner,assignee", "method_startline": "1162", "method_endline": "1213", "method_complexity": {"method_NLOC": "47", "method_CCN": "1", "method_NToken": "254", "method_nesting_level": "1"}}}}}}}}