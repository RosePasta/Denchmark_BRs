{"BR": {"BR_id": "305", "BR_author": "kl2792", "BRopenT": "2018-08-11T21:21:38Z", "BRcloseT": "2018-08-15T00:02:03Z", "BR_text": {"BRsummary": "Tqdm for Jupyter Notebook", "BRdescription": "\n Each iteration of TQDM starts a new line in Jupyter Notebook -- is there any way to integrate one of the suggested fixes into torchbearer?\n (ref: <denchmark-link:https://github.com/tqdm/tqdm/issues/375>tqdm/tqdm#375</denchmark-link>\n , <denchmark-link:https://stackoverflow.com/a/47200571>https://stackoverflow.com/a/47200571</denchmark-link>\n )\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "kl2792", "commentT": "2018-08-11T22:50:38Z", "comment_text": "\n \t\tRestarting the notebook temporarily fixed the problem, but it looks like 1 extra newline is added for every fit_generator call.\n On the 1st fit_generator call, it works fine.\n On the 2nd fit_generator call:\n <denchmark-code>0/1000(t):   0%|          | 0/1000 [00:00<?, ?it/s]\n 0/1000(t):   0%|          | 1/1000 [00:00<07:57,  2.09it/s]\n 0/1000(t):   0%|          | 1/1000 [00:00<07:57,  2.09it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   0%|          | 2/1000 [00:00<07:24,  2.24it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   0%|          | 2/1000 [00:00<07:24,  2.24it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   0%|          | 3/1000 [00:01<07:48,  2.13it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   0%|          | 3/1000 [00:01<07:48,  2.13it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   0%|          | 4/1000 [00:01<07:17,  2.28it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   0%|          | 4/1000 [00:01<07:17,  2.28it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   0%|          | 5/1000 [00:02<06:48,  2.44it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   0%|          | 5/1000 [00:02<06:48,  2.44it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 6/1000 [00:02<06:36,  2.51it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 6/1000 [00:02<06:36,  2.51it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 7/1000 [00:02<06:17,  2.63it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 7/1000 [00:02<06:17,  2.63it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 8/1000 [00:03<05:59,  2.76it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 8/1000 [00:03<05:59,  2.76it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 9/1000 [00:03<05:58,  2.76it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 9/1000 [00:03<05:58,  2.76it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 10/1000 [00:03<05:32,  2.98it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 10/1000 [00:03<05:32,  2.98it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 11/1000 [00:04<05:37,  2.93it/s, running_loss=7.09, running_acc=0.632]\n 0/1000(t):   1%|          | 11/1000 [00:04<05:37,  2.93it/s, running_loss=5.01, running_acc=0.113]\n 0/1000(t):   1%|          | 12/1000 [00:04<05:34,  2.96it/s, running_loss=5.01, running_acc=0.113]\n ...\n </denchmark-code>\n \n On the third:\n <denchmark-code>\n \n 0/1000(t):   0%|          | 0/1000 [00:00<?, ?it/s]\n \n 0/1000(t):   0%|          | 1/1000 [00:00<07:21,  2.26it/s]\n \n 0/1000(t):   0%|          | 1/1000 [00:00<07:21,  2.26it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   0%|          | 2/1000 [00:00<06:59,  2.38it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   0%|          | 2/1000 [00:00<06:59,  2.38it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   0%|          | 3/1000 [00:01<07:29,  2.22it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   0%|          | 3/1000 [00:01<07:29,  2.22it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   0%|          | 4/1000 [00:01<07:03,  2.35it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   0%|          | 4/1000 [00:01<07:03,  2.35it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   0%|          | 5/1000 [00:02<06:40,  2.49it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   0%|          | 5/1000 [00:02<06:40,  2.49it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 6/1000 [00:02<06:32,  2.54it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 6/1000 [00:02<06:32,  2.54it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 7/1000 [00:02<06:11,  2.67it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 7/1000 [00:02<06:11,  2.67it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 8/1000 [00:03<05:55,  2.79it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 8/1000 [00:03<05:55,  2.79it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 9/1000 [00:03<05:54,  2.80it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 9/1000 [00:03<05:54,  2.80it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 10/1000 [00:03<05:28,  3.02it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 10/1000 [00:03<05:28,  3.02it/s, running_loss=3.67, running_acc=0.085]\n \n 0/1000(t):   1%|          | 11/1000 [00:04<05:34,  2.96it/s, running_loss=3.67, running_acc=0.085]\n </denchmark-code>\n \n And so on. Is there some callback that's supposed to be removed on KeyboardInterrupt? Happy to put in a PR to fix this behavior, but does anyone know why it's occurring?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "kl2792", "commentT": "2018-08-11T23:00:43Z", "comment_text": "\n \t\tI'm not sure why this behaviour is happening myself, any ideas <denchmark-link:https://github.com/ethanwharris>@ethanwharris</denchmark-link>\n ?\n The tqdm_notebook fix looks simple enough to implement, I'll look into it on Monday and hopefully it will fix this.\n Although feel free to put in a pr for this in the mean time.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "kl2792", "commentT": "2018-08-12T09:52:06Z", "comment_text": "\n \t\tSeems like the issue is just tqdm not handling notebooks very well. Simplest idea is to have a tqdm_notebook callback which uses the notebook variant. Or perhaps, allow the tqdm callback to be given the tqdm module to use, assuming the commands are the same. I prefer the second option if possible. Thoughts?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "kl2792", "commentT": "2018-08-12T10:07:53Z", "comment_text": "\n \t\tYeah, I agree the second option is better. Not sure how we decide to integrate it with the verbose flag though, unless we change verbose to \"printer_type\" or something. Could still keep the integer flags as in verbose but also allow strings.\n Alternatively we allow a printer callback to be passed and just default it to Tqdm. So then arguments such as notebook could be given when the callback is initialised.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "kl2792", "commentT": "2018-08-13T13:14:59Z", "comment_text": "\n \t\tThis should now be fixed in master, the callback list was persisting through the fit calls (which wasn't the original intention) leading to multiple Tqdm callbacks being added and running simultaneously, thus the new lines.\n <denchmark-link:https://github.com/kl2792>@kl2792</denchmark-link>\n  Tqdm now works properly for multiple fit calls in my local jupyter, could you verify if this works for you too? Thanks!\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "kl2792", "commentT": "2018-08-15T00:02:03Z", "comment_text": "\n \t\tWorks for me, thanks so much!\n \t\t"}}}, "commit": {"commit_id": "31bed5e0e56cb7b038e44cbdf8e57d15b67dffbd", "commit_author": "Matt Painter", "commitT": "2018-08-13 12:59:26+01:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "9,14", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tests\\callbacks\\test_printer.py", "file_new_name": "tests\\callbacks\\test_printer.py", "file_complexity": {"file_NLOC": "49", "file_CCN": "2", "file_NToken": "425"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "32,35,36", "deleted_lines": "32,33,34,35,36,37,38", "method_info": {"method_name": "test_tqdm", "method_params": "self", "method_startline": "32", "method_endline": "65", "method_complexity": {"method_NLOC": "27", "method_CCN": "1", "method_NToken": "246", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "35,36", "deleted_lines": "33,34,35,36,37,38", "method_info": {"method_name": "test_tqdm", "method_params": "self,mock_tqdm", "method_startline": "33", "method_endline": "69", "method_complexity": {"method_NLOC": "29", "method_CCN": "1", "method_NToken": "270", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "torchbearer\\callbacks\\callbacks.py", "file_new_name": "torchbearer\\callbacks\\callbacks.py", "file_complexity": {"file_NLOC": "102", "file_CCN": "43", "file_NToken": "702"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "189,190", "deleted_lines": null, "method_info": {"method_name": "copy", "method_params": "self", "method_startline": "189", "method_endline": "190", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "11", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "186,187", "deleted_lines": null, "method_info": {"method_name": "__copy__", "method_params": "self", "method_startline": "186", "method_endline": "187", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "12", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "175", "method_info": {"method_name": "__init__", "method_params": "self,callback_list", "method_startline": "174", "method_endline": "178", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "26", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "torchbearer\\callbacks\\printer.py", "file_new_name": "torchbearer\\callbacks\\printer.py", "file_complexity": {"file_NLOC": "80", "file_CCN": "31", "file_NToken": "660"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "51,52", "deleted_lines": "51", "method_info": {"method_name": "__init__", "method_params": "self,validation_label_letter,on_epoch", "method_startline": "51", "method_endline": "54", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "71", "deleted_lines": "70", "method_info": {"method_name": "on_start", "method_params": "self,state", "method_startline": "69", "method_endline": "71", "method_complexity": {"method_NLOC": "3", "method_CCN": "2", "method_NToken": "29", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "59", "deleted_lines": "58", "method_info": {"method_name": "_on_start", "method_params": "self,state,letter,steps", "method_startline": "57", "method_endline": "59", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "49", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "51,52", "deleted_lines": "51", "method_info": {"method_name": "__init__", "method_params": "self,tqdm_module,validation_label_letter,on_epoch", "method_startline": "51", "method_endline": "55", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "37", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "torchbearer\\torchbearer.py", "file_new_name": "torchbearer\\torchbearer.py", "file_complexity": {"file_NLOC": "260", "file_CCN": "54", "file_NToken": "2580"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "145", "deleted_lines": null}}}}}}