{"BR": {"BR_id": "166", "BR_author": "HunterMcGushion", "BRopenT": "2019-07-26T23:04:15Z", "BRcloseT": "2019-07-27T05:09:55Z", "BR_text": {"BRsummary": "Dataset hashes change between Pandas versions", "BRdescription": "\n <denchmark-h:h1>Problem</denchmark-h>\n \n \n Updating Pandas from 0.24.2 to 0.25.0 produces different Environment.cross_experiment_key values\n \n Of all parameters included in the cross_experiment_key, only the (hashed) values of the\n datasets actually changed\n \n \n This can be seen in the broken TravisCI build #738\n \n Note: This was made for PR #165, fixing an unrelated bug concerning Categorical.optional Feature Engineering steps\n \n \n Specifically, the following tests in tests.test_environment are failing:\n \n test_environment_init_cv_params (both scenarios)\n test_environment_init_metrics (both scenarios)\n test_environment_init_cross_experiment_params (both scenarios)\n \n \n All six of the failing tests are checking for expected Environment.cross_experiment_key\n \n <denchmark-h:h1>Battle-Plan</denchmark-h>\n \n \n Need dataset hashes to be consistent across different Pandas versions\n Add new clause to :func:hyperparameter_hunter.keys.hashing.to_hashable to handle DataFrames\n \n Because to_hashable is used by make_hash_sha256, this change will apply not only to key hashes, but also to the WIP hashes generated by :mod:feature_engineering to track changes made by different EngineerSteps\n \n \n \n <denchmark-h:h1>Options for New DataFrame Clause</denchmark-h>\n \n return hashlib.sha256(\n     pd.util.hash_pandas_object(obj, index=True).values\n ).hexdigest()\n or something like\n return obj.to_csv().encode(\"utf-8\")\n Both produce consistent values for datasets for Pandas 0.24.2 and 0.25.0. However, the first feels safer, whereas the second is easier to understand and follows some representation of the object, rather than an actual hash, which is the intended purpose of to_hashable\n \t"}, "comments": {}}, "commit": {"commit_id": "fe581c64027c50fd94610aeec4194db786c70aa4", "commit_author": "Hunter McGushion", "commitT": "2019-07-26 22:09:52-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "0.0", "commit_Nprams": "0.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "hyperparameter_hunter\\feature_engineering.py", "file_new_name": "hyperparameter_hunter\\feature_engineering.py", "file_complexity": {"file_NLOC": "702", "file_CCN": "118", "file_NToken": "2562"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1208,1209,1210,1211,1212,1213,1214,1215,1216,1217", "deleted_lines": "1208,1209,1210,1211,1212,1213,1214,1215,1216,1217,1218,1219,1220,1221,1222,1223,1224,1225", "method_info": {"method_name": "_hash_dataset", "method_params": "DataFrame", "method_startline": "1191", "method_endline": "1226", "method_complexity": {"method_NLOC": "36", "method_CCN": "5", "method_NToken": "90", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "hyperparameter_hunter\\keys\\hashing.py", "file_new_name": "hyperparameter_hunter\\keys\\hashing.py", "file_complexity": {"file_NLOC": "51", "file_CCN": "12", "file_NToken": "420"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "52,53,54", "deleted_lines": null, "method_info": {"method_name": "to_hashable", "method_params": "obj,kwargs", "method_startline": "30", "method_endline": "56", "method_complexity": {"method_NLOC": "12", "method_CCN": "9", "method_NToken": "155", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "scripts\\test_nonsmoking.sh", "file_new_name": "scripts\\test_nonsmoking.sh", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "28,29", "deleted_lines": "28"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\test_environment.py", "file_new_name": "tests\\test_environment.py", "file_complexity": {"file_NLOC": "177", "file_CCN": "23", "file_NToken": "1358"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "86,87,88,89,90,91,95,96,97,98,99,100", "deleted_lines": "86,87,88,89,90,91,95,96,97,98,99,100"}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tests\\test_keys.py", "file_new_name": "tests\\test_keys.py", "file_complexity": {"file_NLOC": "163", "file_CCN": "18", "file_NToken": "1275"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "108,111,115,116,117,118,119,120,121,122,123", "deleted_lines": "108,111,115"}}}}}}