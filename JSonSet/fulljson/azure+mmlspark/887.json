{"BR": {"BR_id": "887", "BR_author": "dantetrick", "BRopenT": "2020-07-07T20:12:35Z", "BRcloseT": "2020-08-12T15:34:43Z", "BR_text": {"BRsummary": "Issues Fitting \"Same\" Data into Light GBM Classifier", "BRdescription": "\n I have an issue fitting my data to a LightGBM Classifier that hopefully I can get some help with.\n \n I have 1 notebook that works fine so I cloned it in order to try to optimize the flow.\n The cloned notebook fails using nearly the same code on the same data. The difference between the codes is found in how I 'filter' out test and training data.\n The row count is exactly the same when I try to fit() the model.\n The notebook fails after I place a filter prior to the StringVectorization and OneHotEncoding steps instead of filtering out the data post steps. The actual data that is Vectorized and Encoded is the same columns between notebooks.\n Below is a 1 row data sample of the data that goes into the 'working' classifier.\n image\n \n \n <denchmark-link:https://user-images.githubusercontent.com/11829494/86834367-9dc36880-c04f-11ea-9f60-75505810319e.png></denchmark-link>\n \n Below is a data sample of the same row of data that goes into the 'non-working' classifier as an example.\n <denchmark-link:https://user-images.githubusercontent.com/11829494/86836960-1c6dd500-c053-11ea-95ca-a103614c165e.png></denchmark-link>\n \n <denchmark-link:https://user-images.githubusercontent.com/11829494/86836982-22fc4c80-c053-11ea-9e08-af22e942f459.png></denchmark-link>\n \n <denchmark-link:https://user-images.githubusercontent.com/11829494/86837031-30b1d200-c053-11ea-96a3-df2cb4e776d4.png></denchmark-link>\n \n <denchmark-link:https://user-images.githubusercontent.com/11829494/86837057-37d8e000-c053-11ea-8ad3-877dab0cf016.png></denchmark-link>\n \n NOTES:\n A. The noticeable difference in the data is the numbers assigned to the column values from the indexer. I don't know why that would affect the fit() function but it may.\n B. I updated to the newest snapshot of mmlspark and the error maintains\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "dantetrick", "commentT": "2020-07-07T20:12:36Z", "comment_text": "\n \t\t\ud83d\udc4b Thanks for opening your first issue here! If you're reporting a \ud83d\udc1e bug, please make sure you include steps to reproduce it.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "dantetrick", "commentT": "2020-07-10T05:10:22Z", "comment_text": "\n \t\tDiscussed via Teams chat, we discovered there was an issue with the column names that caused LightGBM to fail.  Will be putting in a fix to improve the error message to detect the bad column names and fail early in the future as a follow-up.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "dantetrick", "commentT": "2020-08-12T15:34:43Z", "comment_text": "\n \t\tclosing issue as fix has been merged to master <denchmark-link:https://github.com/Azure/mmlspark/pull/897>#897</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "96f0b7775629d6e7b521d1ed8ca0e54655deef00", "commit_author": "Ilya Matiach", "commitT": "2020-08-12 11:33:18-04:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "1.0", "commit_Nprams": "0.05"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "src\\main\\scala\\com\\microsoft\\ml\\spark\\lightgbm\\LightGBMBase.scala", "file_new_name": "src\\main\\scala\\com\\microsoft\\ml\\spark\\lightgbm\\LightGBMBase.scala", "file_complexity": {"file_NLOC": "164", "file_CCN": "31", "file_NToken": "1501"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "223", "deleted_lines": null, "method_info": {"method_name": "innerTrain", "method_params": "Int", "method_startline": "187", "method_endline": "241", "method_complexity": {"method_NLOC": "40", "method_CCN": "5", "method_NToken": "388", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "161", "deleted_lines": null, "method_info": {"method_name": "getCategoricalIndexes", "method_params": "DataFrame", "method_startline": "154", "method_endline": "161", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "64", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179", "deleted_lines": null, "method_info": {"method_name": "validateSlotNames", "method_params": "DataFrame,ColumnParams,TrainParams", "method_startline": "161", "method_endline": "187", "method_complexity": {"method_NLOC": "19", "method_CCN": "4", "method_NToken": "151", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "src\\test\\scala\\com\\microsoft\\ml\\spark\\lightgbm\\split2\\VerifyLightGBMRegressor.scala", "file_new_name": "src\\test\\scala\\com\\microsoft\\ml\\spark\\lightgbm\\split2\\VerifyLightGBMRegressor.scala", "file_complexity": {"file_NLOC": "162", "file_CCN": "6", "file_NToken": "1493"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "132,133,134,135,136,137", "deleted_lines": null}}}}}}