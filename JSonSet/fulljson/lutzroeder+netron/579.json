{"BR": {"BR_id": "579", "BR_author": "dashesy", "BRopenT": "2020-08-21T17:01:41Z", "BRcloseT": "2020-08-26T23:24:14Z", "BR_text": {"BRsummary": "Very high CPU usage when idle", "BRdescription": "\n \n Netron app and version: 4.4.7\n OS and browser version: Windows 10, Edge\n \n Steps to Reproduce:\n \n Seems like it starts after searching for a node and selecting it\n Then doing nothing, idle\n \n Please attach or link model files to reproduce the issue if necessary.\n Seems any model.\n This morning I realized the open onnx file from last night was heating my laptop.\n <denchmark-link:https://user-images.githubusercontent.com/873905/90915977-1e86bb80-e395-11ea-882f-2ffe544e1863.png></denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "dashesy", "commentT": "2020-08-21T17:31:01Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/dashesy>@dashesy</denchmark-link>\n  can you investigate why this is happening?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "dashesy", "commentT": "2020-08-21T17:54:33Z", "comment_text": "\n \t\tYes if you let me know where to look.\n This is completely reproducible for me, even for a small ONNX file (the attached small one takes 12% CPU)\n <denchmark-link:https://github.com/lutzroeder/netron/files/5110453/test.zip>test.zip</denchmark-link>\n \n .\n I just have to search (Ctrl+F) and hit Enter on a node\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "dashesy", "commentT": "2020-08-22T15:31:57Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/dashesy>@dashesy</denchmark-link>\n  does it happen in the browser version or when running the Electron app using <denchmark-link:https://github.com/lutzroeder/netron/blob/main/DEVELOPMENT.md>DEVELOPMENT.md</denchmark-link>\n . Could the dashed line animation of the selected node be causing it. <denchmark-link:https://www.electronjs.org/docs/tutorial/performance>This</denchmark-link>\n  might help as well getting started.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "dashesy", "commentT": "2020-08-24T17:53:08Z", "comment_text": "\n \t\tI can repro this on Chrome too\n While dashed line animation is running:\n <denchmark-link:https://user-images.githubusercontent.com/873905/91078599-b84da300-e5f7-11ea-88c9-a3d5162038e8.png></denchmark-link>\n \n Then I hit Esc it goes down but remains high\n <denchmark-link:https://user-images.githubusercontent.com/873905/91078645-cac7dc80-e5f7-11ea-944a-133821a4aa02.png></denchmark-link>\n \n After unselecting (Esc) and after  a few minutes it went down to 3%\n <denchmark-h:hr></denchmark-h>\n \n P.S. To try the debugging you mentioned I tried the same steps on PC and the CPU usage goes up to 10% (instead of 70%) after I search and select a node (animation starts) then it goes back to 0% when I hit Esc.\n So this issue is specially acute on my Laptop. I use Laptop just to remote, unless I wanted to open something.\n I will install the dev tools on laptop and try again.\n From inside VSCode is there a way to gather profiling?\n I added --cpu-prof to launch.json but cannot find .cpuprofile anywhere.  Also npx does not have --cpu-prof, sorry my js-fu is not strong\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "dashesy", "commentT": "2020-08-26T15:54:56Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/dashesy>@dashesy</denchmark-link>\n  did you try removing the animation(s) for  in ?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "dashesy", "commentT": "2020-08-26T17:48:04Z", "comment_text": "\n \t\tAfter removing animation from .select .node.border the CPU usage went down:\n <denchmark-link:https://user-images.githubusercontent.com/873905/91337846-ddbde680-e788-11ea-8b44-9b8d0df08237.png></denchmark-link>\n \n I first did not remove animation from .select.edge-path and the CPU usage after selecting an edge was still high:\n <denchmark-link:https://user-images.githubusercontent.com/873905/91337970-0d6cee80-e789-11ea-83be-4e8287b17afe.png></denchmark-link>\n \n After removing animation from there, it went down too\n <denchmark-link:https://user-images.githubusercontent.com/873905/91338237-7c4a4780-e789-11ea-9152-5ef33f16697c.png></denchmark-link>\n \n \n This is more acute on the laptop (Surface)\n It is more acute on large models, even though searching a node and selecting it zooms in\n \n So it is animation, but not sure why a small animation has such effect, and why this is mostly seen on large models.\n Let me know, will send you a model offline to look\n \t\t"}}}, "commit": {"commit_id": "5a75f4f833383ac1defa25ead4771838ee33b74e", "commit_author": "Lutz Roeder", "commitT": "2020-08-26 20:58:16-04:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "source\\view-grapher.css", "file_new_name": "source\\view-grapher.css", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "66,67,72,73,74,81,82,87,88,89,90", "deleted_lines": "66,67,72,73,80,81,86,87,88"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "source\\view-grapher.js", "file_new_name": "source\\view-grapher.js", "file_complexity": {"file_NLOC": "572", "file_CCN": "108", "file_NToken": "4452"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122", "deleted_lines": "107,108,109,110,111,112,113,114,115,116,117,118,119,120,121", "method_info": {"method_name": "marker", "method_params": "", "method_startline": "107", "method_endline": "122", "method_complexity": {"method_NLOC": "16", "method_CCN": "1", "method_NToken": "124", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124", "deleted_lines": "107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,129", "method_info": {"method_name": "render", "method_params": "graph", "method_startline": "13", "method_endline": "159", "method_complexity": {"method_NLOC": "120", "method_CCN": "18", "method_NToken": "1104", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "source\\view.js", "file_new_name": "source\\view.js", "file_complexity": {"file_NLOC": "1360", "file_CCN": "350", "file_NToken": "11485"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "765,766", "deleted_lines": "765,766", "method_info": {"method_name": "(anonymous)", "method_params": "", "method_startline": "765", "method_endline": "767", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "0"}}}}}}}}