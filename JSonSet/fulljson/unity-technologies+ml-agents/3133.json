{"BR": {"BR_id": "3133", "BR_author": "weiziqian", "BRopenT": "2019-12-29T04:03:15Z", "BRcloseT": "2020-01-02T18:40:16Z", "BR_text": {"BRsummary": "BUG?  gym wrapper's step() returns \"BatchedStepResult\" instead of \"dict\" for the fourth param.", "BRdescription": "\n the 4th. return parameter (\"info\") for function step() should be \"dict\";\n however in a recent update (2019 dec 10) it was changed into \"BatchedStepResult\".\n which at least caused troubles when training with baseline,\n e.g.:\n File \"/xxx/stable-baselines/stable_baselines/td3/td3.py\", line 343, in learn\n maybe_ep_info = info.get('episode')\n AttributeError: 'BatchedStepResult' object has no attribute 'get'\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "weiziqian", "commentT": "2019-12-30T21:05:43Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/weiziqian>@weiziqian</denchmark-link>\n  - this does look like a bug. I've logged it as MLA-486 in our internal tracker, and we should have a fix for it soon.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "weiziqian", "commentT": "2019-12-30T23:04:38Z", "comment_text": "\n \t\tI believe <denchmark-link:https://github.com/Unity-Technologies/ml-agents/pull/3136>#3136</denchmark-link>\n  will fix this, but I want to run it by some other folks that are more familiar with the gym interface.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "weiziqian", "commentT": "2020-01-02T18:41:01Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/weiziqian>@weiziqian</denchmark-link>\n  - this is fixed on  branch now, and will be in the next release. Thanks for the report!\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "weiziqian", "commentT": "2020-01-02T18:42:03Z", "comment_text": "\n \t\tI also logged a longer-term issue for us to add better testing around this; we have a few unit tests but no integration tests that run training with the gym wrapper.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "weiziqian", "commentT": "2020-01-05T19:17:32Z", "comment_text": "\n \t\thi Chris, thank you so much for such a prompt response!\n \t\t"}}}, "commit": {"commit_id": "0422a540cfc0209606546a80387de41e8412e5d6", "commit_author": "Chris Elion", "commitT": "2020-01-02 10:40:15-08:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.5882352941176471", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 22, "file_old_name": "gym-unity\\gym_unity\\envs\\__init__.py", "file_new_name": "gym-unity\\gym_unity\\envs\\__init__.py", "file_complexity": {"file_NLOC": "316", "file_CCN": "57", "file_NToken": "1787"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "258,259,260,261,262", "deleted_lines": "257,258,261", "method_info": {"method_name": "_get_vis_obs_list", "method_params": "self,step_result", "method_startline": "257", "method_endline": "262", "method_complexity": {"method_NLOC": "6", "method_CCN": "3", "method_NToken": "35", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "163,165,166,168", "deleted_lines": "159,206,207,209,210,211", "method_info": {"method_name": "step", "method_params": "self,action", "method_startline": "159", "method_endline": "211", "method_complexity": {"method_NLOC": "34", "method_CCN": "8", "method_NToken": "235", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "278,279,282,285", "deleted_lines": "278", "method_info": {"method_name": "_preprocess_multi", "method_params": "self,multiple_visual_obs", "method_startline": "278", "method_endline": "285", "method_complexity": {"method_NLOC": "8", "method_CCN": "3", "method_NToken": "37", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "150,163,165,166", "deleted_lines": "154,156,157,159", "method_info": {"method_name": "reset", "method_params": "self", "method_startline": "150", "method_endline": "166", "method_complexity": {"method_NLOC": "16", "method_CCN": "2", "method_NToken": "88", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "272,276", "deleted_lines": null, "method_info": {"method_name": "_get_vis_obs_shape", "method_params": "self", "method_startline": "272", "method_endline": "276", "method_complexity": {"method_NLOC": "5", "method_CCN": "3", "method_NToken": "31", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "246", "deleted_lines": null, "method_info": {"method_name": "_preprocess_single", "method_params": "self,ndarray", "method_startline": "246", "method_endline": "250", "method_complexity": {"method_NLOC": "5", "method_CCN": "2", "method_NToken": "39", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "313,320", "deleted_lines": "304", "method_info": {"method_name": "_check_agents", "method_params": "self,n_agents", "method_startline": "304", "method_endline": "322", "method_complexity": {"method_NLOC": "19", "method_CCN": "7", "method_NToken": "74", "method_nesting_level": "1"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "252,258,259,260,261,262,263", "deleted_lines": "252,257,258,261", "method_info": {"method_name": "_multi_step", "method_params": "self,BatchedStepResult", "method_startline": "252", "method_endline": "263", "method_complexity": {"method_NLOC": "12", "method_CCN": "2", "method_NToken": "74", "method_nesting_level": "1"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "352", "deleted_lines": null, "method_info": {"method_name": "reward_range", "method_params": "self", "method_startline": "352", "method_endline": "353", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "23", "method_nesting_level": "1"}}}, "hunk_9": {"Ismethod": 1, "added_lines": null, "deleted_lines": "264,265,268", "method_info": {"method_name": "_get_vector_obs", "method_params": "self,step_result", "method_startline": "264", "method_endline": "269", "method_complexity": {"method_NLOC": "6", "method_CCN": "3", "method_NToken": "44", "method_nesting_level": "1"}}}, "hunk_10": {"Ismethod": 1, "added_lines": "299,300,301", "deleted_lines": "297", "method_info": {"method_name": "seed", "method_params": "self,seed", "method_startline": "297", "method_endline": "302", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "21", "method_nesting_level": "1"}}}, "hunk_11": {"Ismethod": 1, "added_lines": "278,279,282", "deleted_lines": "278", "method_info": {"method_name": "_get_vis_obs_list", "method_params": "self,BatchedStepResult", "method_startline": "278", "method_endline": "283", "method_complexity": {"method_NLOC": "6", "method_CCN": "3", "method_NToken": "52", "method_nesting_level": "1"}}}, "hunk_12": {"Ismethod": 1, "added_lines": "320", "deleted_lines": null, "method_info": {"method_name": "seed", "method_params": "self,Any", "method_startline": "320", "method_endline": "325", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "25", "method_nesting_level": "1"}}}, "hunk_13": {"Ismethod": 1, "added_lines": "313", "deleted_lines": null, "method_info": {"method_name": "close", "method_params": "self", "method_startline": "313", "method_endline": "318", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "15", "method_nesting_level": "1"}}}, "hunk_14": {"Ismethod": 1, "added_lines": "327", "deleted_lines": "329", "method_info": {"method_name": "_check_agents", "method_params": "self,int", "method_startline": "327", "method_endline": "345", "method_complexity": {"method_NLOC": "19", "method_CCN": "7", "method_NToken": "78", "method_nesting_level": "1"}}}, "hunk_15": {"Ismethod": 1, "added_lines": "239,240,241,242,243", "deleted_lines": "237,243", "method_info": {"method_name": "_multi_step", "method_params": "self,info", "method_startline": "237", "method_endline": "243", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "65", "method_nesting_level": "1"}}}, "hunk_16": {"Ismethod": 1, "added_lines": "285,286,289", "deleted_lines": "290", "method_info": {"method_name": "_get_vector_obs", "method_params": "self,BatchedStepResult", "method_startline": "285", "method_endline": "290", "method_complexity": {"method_NLOC": "6", "method_CCN": "3", "method_NToken": "58", "method_nesting_level": "1"}}}, "hunk_17": {"Ismethod": 1, "added_lines": "215,216,217,219,220,221,223", "deleted_lines": "213,229", "method_info": {"method_name": "_single_step", "method_params": "self,info", "method_startline": "213", "method_endline": "229", "method_complexity": {"method_NLOC": "14", "method_CCN": "4", "method_NToken": "111", "method_nesting_level": "1"}}}, "hunk_18": {"Ismethod": 1, "added_lines": null, "deleted_lines": "231", "method_info": {"method_name": "_preprocess_single", "method_params": "self,single_visual_obs", "method_startline": "231", "method_endline": "235", "method_complexity": {"method_NLOC": "5", "method_CCN": "2", "method_NToken": "31", "method_nesting_level": "1"}}}, "hunk_19": {"Ismethod": 1, "added_lines": "168,215,216,217,219,220,221", "deleted_lines": "206,207,209,210,211,213", "method_info": {"method_name": "step", "method_params": "self", "method_startline": "168", "method_endline": "221", "method_complexity": {"method_NLOC": "48", "method_CCN": "8", "method_NToken": "232", "method_nesting_level": "1"}}}, "hunk_20": {"Ismethod": 1, "added_lines": "223,239,240,241,242,243,244", "deleted_lines": "229,231,237,243", "method_info": {"method_name": "_single_step", "method_params": "self,BatchedStepResult", "method_startline": "223", "method_endline": "244", "method_complexity": {"method_NLOC": "19", "method_CCN": "4", "method_NToken": "120", "method_nesting_level": "1"}}}, "hunk_21": {"Ismethod": 1, "added_lines": "299,300", "deleted_lines": null, "method_info": {"method_name": "_preprocess_multi", "method_params": "self", "method_startline": "299", "method_endline": "300", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "12", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "gym-unity\\gym_unity\\tests\\test_gym.py", "file_new_name": "gym-unity\\gym_unity\\tests\\test_gym.py", "file_complexity": {"file_NLOC": "102", "file_CCN": "9", "file_NToken": "903"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "26", "deleted_lines": null, "method_info": {"method_name": "test_gym_wrapper", "method_params": "mock_env", "method_startline": "11", "method_endline": "26", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "134", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "84", "deleted_lines": null, "method_info": {"method_name": "test_gym_wrapper_visual", "method_params": "mock_env,use_uint8", "method_startline": "69", "method_endline": "84", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "146", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "45", "deleted_lines": null, "method_info": {"method_name": "test_multi_agent", "method_params": "mock_env", "method_startline": "30", "method_endline": "45", "method_complexity": {"method_NLOC": "14", "method_CCN": "2", "method_NToken": "129", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "ml-agents-envs\\mlagents_envs\\rpc_utils.py", "file_new_name": "ml-agents-envs\\mlagents_envs\\rpc_utils.py", "file_complexity": {"file_NLOC": "151", "file_CCN": "9", "file_NToken": "974"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "126,128,130,132", "deleted_lines": "126,128,130,132"}}}}}}