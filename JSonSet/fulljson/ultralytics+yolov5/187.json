{"BR": {"BR_id": "187", "BR_author": "yxNONG", "BRopenT": "2020-06-24T05:38:55Z", "BRcloseT": "2020-06-30T23:16:42Z", "BR_text": {"BRsummary": "can't test with my finetune weights", "BRdescription": "\n i train a model in my custom data, can get the weights (last.pt and best.pt)\n i run:\n python test.py --img 640 --batch 16 --data ./data/patrol.yaml --weights weights/last.pt --device 4\n python test.py --img 640 --batch 16 --data ./data/patrol.yaml --weights weights/best.pt --device 4\n both raise the error:\n Traceback (most recent call last):\n File \"test.py\", line 277, in \n opt.verbose)\n File \"test.py\", line 86, in test\n names = model.names if hasattr(model, 'names') else model.module.names\n File \"/home/anaconda3/envs/yolov5/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 594, in getattr\n type(self).name, name))\n AttributeError: 'Model' object has no attribute 'module'\n However, i can run with the default weight yolov5s.pt\n python test.py --img 640 --batch 16 --data ./data/patrol.yaml --device 4\n pytorch = 1.5\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "yxNONG", "commentT": "2020-06-24T05:44:26Z", "comment_text": "\n \t\tAlso, train with my weights (last.pt adn best.pt) is not avaliable:\n Traceback (most recent call last):\n File \"train.py\", line 408, in \n train(hyp)\n File \"train.py\", line 366, in train\n print('%g epochs completed in %.3f hours.\\n' % (epoch - start_epoch + 1, (time.time() - t0) / 3600))\n UnboundLocalError: local variable 'epoch' referenced before assignment\n am i missing something to do with the weight(.pt) after traning done?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "yxNONG", "commentT": "2020-06-24T05:48:54Z", "comment_text": "\n \t\tNot 100% sure but most likely using the --resume flag with last.pt when running train.py should fix it\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "yxNONG", "commentT": "2020-06-24T06:25:10Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ml5ah>@ml5ah</denchmark-link>\n \n i see the reason why i can't train with my weights now.\n seems like the --resume is same as use --weights last.pt\n the problem is in the --epochs n, n should be the total epochs not the additional epochs\n ex:\n i train 300 epochs get the weights(last.pt), if i want to train 200 more epochs on last.pt,\n thing i should do is set --epoch 500, not --epoch 200\n still, have no idea how to test the last.pt by test.py\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "yxNONG", "commentT": "2020-06-24T06:28:54Z", "comment_text": "\n \t\tDuplicate of <denchmark-link:https://github.com/ultralytics/yolov5/issues/94>#94</denchmark-link>\n ?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "yxNONG", "commentT": "2020-06-24T08:47:54Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/glenn-jocher>@glenn-jocher</denchmark-link>\n \n i guess i slove the problem\n in the 337 line in train.py\n \n i train with the muti-gpu, so the model save is \n however,  is define after the\n \n instead of  we only have  which is not save if use muti-gpu\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "yxNONG", "commentT": "2020-06-24T18:34:43Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/yxNONG>@yxNONG</denchmark-link>\n  ah, ok thanks for the insight! Can you test your fix on single and multi-gpu and submit a PR with the proposed changes if all the tests pass? Thank you!\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "yxNONG", "commentT": "2020-06-30T03:27:38Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/glenn-jocher>@glenn-jocher</denchmark-link>\n   just see the message now, i will try\n \t\t"}}}, "commit": {"commit_id": "ad4c22cbfeb1acbf804e3d6411c263ccc4069a2e", "commit_author": "Glenn Jocher", "commitT": "2020-06-30 16:16:29-07:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "train.py", "file_new_name": "train.py", "file_complexity": {"file_NLOC": "315", "file_CCN": "65", "file_NToken": "3393"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "136,138,139,140,141,142,173", "deleted_lines": "137,138,169", "method_info": {"method_name": "train", "method_params": "hyp", "method_startline": "62", "method_endline": "355", "method_complexity": {"method_NLOC": "199", "method_CCN": "65", "method_NToken": "2168", "method_nesting_level": "0"}}}}}}}}