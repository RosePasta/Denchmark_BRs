{"BR": {"BR_id": "512", "BR_author": "zeyuanlicbpm", "BRopenT": "2018-08-02T07:25:40Z", "BRcloseT": "2018-08-03T03:13:53Z", "BR_text": {"BRsummary": "Release\u548cDebug\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e00\u4e2aBug\uff1a", "BRdescription": "\n name: \"Darkent2Caffe\"\n layer {\n name: \"data\"\n type: \"Input\"\n top: \"data\"\n input_param { shape: { dim: 1 dim: 3 dim: 416 dim: 416 } }\n }\n layer {\n bottom: \"data\"\n top: \"layer1-conv\"\n name: \"layer1-conv\"\n type: \"Convolution\"\n convolution_param {\n num_output: 32\n kernel_size: 3\n pad: 1\n stride: 1\n bias_term: false\n }\n }\n layer {\n bottom: \"layer1-conv\"\n top: \"layer1-conv\"\n name: \"layer1-bn\"\n type: \"BatchNorm\"\n batch_norm_param {\n use_global_stats: true\n }\n }\n layer {\n bottom: \"layer1-conv\"\n top: \"layer1-conv\"\n name: \"layer1-scale\"\n type: \"Scale\"\n scale_param {\n bias_term: true\n }\n }\n layer {\n bottom: \"layer1-conv\"\n top: \"layer1-conv\"\n name: \"layer1-act\"\n type: \"ReLU\"\n relu_param {\n negative_slope: 0.1\n }\n }\n layer {\n bottom: \"layer1-conv\"\n top: \"layer2-conv\"\n name: \"layer2-conv\"\n type: \"Convolution\"\n convolution_param {\n num_output: 64\n kernel_size: 3\n pad: 1\n stride: 2\n bias_term: false\n }\n }\n layer {\n bottom: \"layer2-conv\"\n top: \"layer2-conv\"\n name: \"layer2-bn\"\n type: \"BatchNorm\"\n batch_norm_param {\n use_global_stats: true\n }\n }\n layer {\n bottom: \"layer2-conv\"\n top: \"layer2-conv\"\n name: \"layer2-scale\"\n type: \"Scale\"\n scale_param {\n bias_term: true\n }\n }\n layer {\n bottom: \"layer2-conv\"\n top: \"layer2-conv\"\n name: \"layer2-act\"\n type: \"ReLU\"\n relu_param {\n negative_slope: 0.1\n }\n }\n layer {\n bottom: \"layer2-conv\"\n top: \"layer3-conv\"\n name: \"layer3-conv\"\n type: \"Convolution\"\n convolution_param {\n num_output: 32\n kernel_size: 1\n pad: 0\n stride: 1\n bias_term: false\n }\n }\n layer {\n bottom: \"layer3-conv\"\n top: \"layer3-conv\"\n name: \"layer3-bn\"\n type: \"BatchNorm\"\n batch_norm_param {\n use_global_stats: true\n }\n }\n layer {\n bottom: \"layer3-conv\"\n top: \"layer3-conv\"\n name: \"layer3-scale\"\n type: \"Scale\"\n scale_param {\n bias_term: true\n }\n }\n layer {\n bottom: \"layer3-conv\"\n top: \"layer3-conv\"\n name: \"layer3-act\"\n type: \"ReLU\"\n relu_param {\n negative_slope: 0.1\n }\n }\n layer {\n bottom: \"layer3-conv\"\n top: \"layer4-conv\"\n name: \"layer4-conv\"\n type: \"Convolution\"\n convolution_param {\n num_output: 64\n kernel_size: 3\n pad: 1\n stride: 1\n bias_term: false\n }\n }\n layer {\n bottom: \"layer4-conv\"\n top: \"layer4-conv\"\n name: \"layer4-bn\"\n type: \"BatchNorm\"\n batch_norm_param {\n use_global_stats: true\n }\n }\n layer {\n bottom: \"layer4-conv\"\n top: \"layer4-conv\"\n name: \"layer4-scale\"\n type: \"Scale\"\n scale_param {\n bias_term: true\n }\n }\n layer {\n bottom: \"layer4-conv\"\n top: \"layer4-conv\"\n name: \"layer4-act\"\n type: \"ReLU\"\n relu_param {\n negative_slope: 0.1\n }\n }\n layer {\n bottom: \"layer2-conv\"\n bottom: \"layer4-conv\"\n top: \"layer5-shortcut\"\n name: \"layer5-shortcut\"\n type: \"Eltwise\"\n eltwise_param {\n operation: SUM\n }\n }\n layer {\n bottom: \"layer5-shortcut\"\n top: \"layer6-conv\"\n name: \"layer6-conv\"\n type: \"Convolution\"\n convolution_param {\n num_output: 128\n kernel_size: 3\n pad: 1\n stride: 2\n bias_term: false\n }\n }\n \u8fd9\u4e2a\u7f51\u7edc\u7ed3\u6784\uff0c\u6309\u7167\u4ee5\u4e0b\u4ee3\u7801\u63d0\u53d6\u6700\u540e\u4e00\u5c42\u7279\u5f81\uff1a\n ncnn::Net net;\n net.load_param(\"yolov3_ncnn.param\");\n net.load_model(\"yolov3_ncnn.bin\");\n <denchmark-code>ncnn::Extractor ex = net.create_extractor();\n int w = 416;\n int h = 416;\n unsigned char* rgbdata = new unsigned char[w * h * 3];\n memset(rgbdata, 0, w * h * 3);\n ncnn::Mat in = ncnn::Mat::from_pixels(rgbdata, ncnn::Mat::PIXEL_BGR, w, h);\n ex.set_num_threads(4);\n ncnn::Mat out;\n ex.input(\"data\", in);\n ex.extract(\"layer5-shortcut\", out);\n printf(\"width: %d, height: %d\", out.w, out.h);\n </denchmark-code>\n \n Release\u6a21\u5f0f\u4e0b\u80fd\u591f\u6b63\u5e38\u8fd0\u884c\uff1b\u4f46\u662fDebug\u6a21\u5f0f\u4e0b\uff0c\u62a5\u9519Vector\u8d8a\u754c\u9519\u8bef\uff1b\u6211\u8ddf\u8e2a\u5b9a\u4f4d\u5230\n <denchmark-link:https://user-images.githubusercontent.com/33452561/43568709-e829c14e-9667-11e8-94d4-390cb7f5b536.png></denchmark-link>\n \n \u5728\u8fdb\u5165\u5230layer5-shortcut\u8fd9\u5c42\u4ee5\u540e\uff0c\u56fe\u7247\u4e2d1\u4f4d\u7f6e\u7684\u4ee3\u7801\u5c06opt.int8_scales\u7684\u5927\u5c0fresize\u52302\uff1b\u4f46\u662f\u57282\u5904\u7684\u9012\u5f52\u8c03\u7528\u8fc7\u7a0b\u4e2d\uff0c\u8fd9\u4e2aopt.int8_scales\u7684\u5927\u5c0f\u88ab\u4fee\u6539\u4e3a1\uff1b\u5bfc\u81f4for\u5faa\u73af\u8fdb\u5165\u5230\u7b2c\u4e8c\u6b21\u65f6\uff0c3\u5904\u7684\u8bbf\u95ee\u8d8a\u754c\uff01  \u539f\u56e0\u662f\u4ec0\u4e48\u5462\uff1f\u8bf7\u5927\u795e\u6307\u70b9\uff01\uff01\uff01\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "zeyuanlicbpm", "commentT": "2018-08-02T08:59:51Z", "comment_text": "\n \t\t\u6211\u4e5f\u78b0\u5230\u4e00\u6837\u7684bug\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "zeyuanlicbpm", "commentT": "2018-08-03T03:14:11Z", "comment_text": "\n \t\tfixed in <denchmark-link:https://github.com/Tencent/ncnn/commit/2bc504925e385fd56a2189015a907e05dd050909>2bc5049</denchmark-link>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "zeyuanlicbpm", "commentT": "2018-08-04T06:17:06Z", "comment_text": "\n \t\t\u6d4b\u8bd5\u901a\u8fc7\uff0c\u8c22\u8c22\uff01\n \t\t"}}}, "commit": {"commit_id": "2bc504925e385fd56a2189015a907e05dd050909", "commit_author": "nihuini", "commitT": "2018-08-03 11:12:38+08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\net.cpp", "file_new_name": "src\\net.cpp", "file_complexity": {"file_NLOC": "737", "file_CCN": "142", "file_NToken": "4250"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "850,852,866,880,881", "deleted_lines": "851,865", "method_info": {"method_name": "ncnn::Net::forward_layer", "method_params": "layer_index,blob_mats,opt", "method_startline": "774", "method_endline": "935", "method_complexity": {"method_NLOC": "112", "method_CCN": "27", "method_NToken": "776", "method_nesting_level": "1"}}}}}}}}