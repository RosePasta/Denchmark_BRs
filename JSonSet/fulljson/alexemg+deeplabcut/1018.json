{"BR": {"BR_id": "1018", "BR_author": "felixhol", "BRopenT": "2020-12-01T19:08:16Z", "BRcloseT": "2020-12-12T18:24:34Z", "BR_text": {"BRsummary": "Save error when saving labeled data in DLC 2.2b8 Index / Key error", "BRdescription": "\n DLC is awesome!\n Here is a short summary of a conversation on <denchmark-link:https://forum.image.sc/t/error-when-labeling-saving/45661/2>forum.image.sc</denchmark-link>\n  regarding a saving issue experienced when labeling data in DLC 2.2b8. As it seems to be a bug, I thought it was good to mention it here:\n I have been getting a KeyError or IndexError which occurs the second or third time I try to save my labeling. It has to do with the indexing of the CollectedData.h5 file - it uses the file names of the images in the folder as indexes, yet after saving for a second time, it removes all the not-yet-labeled images from the index of the h5 file. Hence when clicking advance to go the next frame it cannot find the next index image (as the index does not exist anymore in the h5 file).\n My only solution so far has been to only save after all images in a folder are done - this is of course bad practice.\n I\u2019ve experienced this using DLC 2.2b8 on both macOS and ubuntu 18.04. User WSin initially posted this on forum.image.sc and noted that rolling back to 2.2b7 resolves the issue.\n \n OS: Linux 18.04 and macOS\n DeepLabCut Version: 2.2b8\n DeepLabCut mode: multi animal\n \n To Reproduce\n Steps to reproduce the behavior, i.e.:\n \n deeplabcut.label_frames(config_path)\n start labelling in a new project (or any folder that does not have Collected Data)\n add some labels\n click save.\n advance to next frame.\n crash, see error:\n \n Traceback (most recent call last):\n   File \"/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/deeplabcut/generate_training_dataset/multiple_individuals_labeling_toolbox.py\", line 1081, in nextImage\n     self.buttonCounter = MainFrame.plot(self, self.img)\n   File \"/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/deeplabcut/generate_training_dataset/multiple_individuals_labeling_toolbox.py\", line 1180, in plot\n     self.dataFrame[self.scorer][ind][bp][\"x\"].values[self.iter],\n IndexError: index 2 is out of bounds for axis 0 with size 1</summary><p>\n \n Expected behavior\n no crash, if I don't until I'm on the last file it all works fine.\n Additional context\n This does not happen when using 2.2b7\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "felixhol", "commentT": "2020-12-02T20:24:38Z", "comment_text": "\n \t\tHey <denchmark-link:https://github.com/felixhol>@felixhol</denchmark-link>\n ! Thanks for opening the issue and troubleshooting, that's very helpful! I'll have a look and get back to you.\n \t\t"}}}, "commit": {"commit_id": "264e47d1f06445bf4735e3048a4e9bafcfaf790f", "commit_author": "Jessy Lauer", "commitT": "2020-12-12 19:24:34+01:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "deeplabcut\\generate_training_dataset\\multiple_individuals_labeling_toolbox.py", "file_new_name": "deeplabcut\\generate_training_dataset\\multiple_individuals_labeling_toolbox.py", "file_complexity": {"file_NLOC": "1138", "file_CCN": "133", "file_NToken": "8811"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "1305,1306,1307", "method_info": {"method_name": "saveDataSet", "method_params": "self,event", "method_startline": "1257", "method_endline": "1322", "method_complexity": {"method_NLOC": "48", "method_CCN": "15", "method_NToken": "389", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "821,822,823,824", "deleted_lines": null, "method_info": {"method_name": "browseDir", "method_params": "self,event", "method_startline": "675", "method_endline": "933", "method_complexity": {"method_NLOC": "222", "method_CCN": "23", "method_NToken": "1478", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "setup.py", "file_new_name": "setup.py", "file_complexity": {"file_NLOC": "83", "file_CCN": "0", "file_NToken": "191"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "6,9,22,26", "deleted_lines": "6,9,22,26"}}}}}}