{"BR": {"BR_id": "142", "BR_author": "thomasopsomer", "BRopenT": "2016-10-13T09:46:02Z", "BRcloseT": "2018-01-19T15:19:00Z", "BR_text": {"BRsummary": "Invalid Format Error in OSX", "BRdescription": "\n Problem running grobid on osx (actually macOS).\n I used the installation process described in the doc :\n <denchmark-code>wget https://github.com/kermitt2/grobid/archive/grobid-parent-0.4.1.zip\n unzip grobid-grobid-parent-0.4.1.zip\n mvn clean install\n </denchmark-code>\n \n And then the tests don't pass, because \"invalid format error\" when loading the wapiti models. If skip the test I get the same error when I try grobid on a PDF.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "thomasopsomer", "commentT": "2016-10-13T10:13:57Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/thomasopsomer>@thomasopsomer</denchmark-link>\n  for reporting this issue.\n I've tried to reproduce your problem without success.\n I'm running Mac OSX El Capitan. I've downloaded the zip and run the build without skipping the tests, everything was fine. Also running the service I didn't get your issues.\n Could you provide me a more detailed error log and some more information about your system? Can you also check that your zip was correctly downloaded?\n Thanks\n Luca\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "thomasopsomer", "commentT": "2016-10-13T10:32:42Z", "comment_text": "\n \t\tHello Luca,\n So I'm running the new osx version: macOS Sierra v10.12. Like you it was working on El Capitan :)\n I downloaded the zip and then when building with tests, here is a sample of logs:\n <denchmark-code>Running org.grobid.core.test.TestFullTextParser\n Loading external native CRF library\n Loading Wapiti native library...\n Library crfpp loaded\n Loading model: /Users/thomasopsomer/grobid/grobid-home/models/fulltext/model.wapiti (size: 6685602)\n [Wapiti] Loading model: \"/Users/thomasopsomer/grobid/grobid-home/models/fulltext/model.wapiti\"\n error: invalid model format\n Running org.grobid.core.test.TestHeaderParser\n Loading external native CRF library\n Loading Wapiti native library...\n Library crfpp loaded\n Loading model: /Users/thomasopsomer/grobid/grobid-home/models/header/model.wapiti (size: 36094028)\n [Wapiti] Loading model: \"/Users/thomasopsomer/grobid/grobid-home/models/header/model.wapiti\"\n error: invalid model format\n Running org.grobid.core.test.TestNameParser\n Loading external native CRF library\n Loading Wapiti native library...\n Library crfpp loaded\n Loading model: /Users/thomasopsomer/grobid/grobid-home/models/name/header/model.wapiti (size: 2055704)\n [Wapiti] Loading model: \"/Users/thomasopsomer/grobid/grobid-home/models/name/header/model.wapiti\"\n error: invalid model format\n Running org.grobid.core.test.TestReferencesParser\n Loading external native CRF library\n Loading Wapiti native library...\n Library crfpp loaded\n Loading model: /Users/thomasopsomer/grobid/grobid-home/models/citation/model.wapiti (size: 12972361)\n [Wapiti] Loading model: \"/Users/thomasopsomer/grobid/grobid-home/models/citation/model.wapiti\"\n error: invalid model format\n \n ....\n \n [INFO] ------------------------------------------------------------------------\n [INFO] Reactor Summary:\n [INFO] \n [INFO] grobid-parent ...................................... SUCCESS [  0.484 s]\n [INFO] grobid-home ........................................ SUCCESS [ 16.847 s]\n [INFO] grobid-core ........................................ FAILURE [ 55.110 s]\n [INFO] grobid-trainer ..................................... SKIPPED\n [INFO] grobid-service ..................................... SKIPPED\n [INFO] ------------------------------------------------------------------------\n [INFO] BUILD FAILURE\n [INFO] ------------------------------------------------------------------------\n [INFO] Total time: 01:12 min\n [INFO] Finished at: 2016-10-13T12:31:04+02:00\n [INFO] Final Memory: 26M/425M\n [INFO] ------------------------------------------------------------------------\n [ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.12.4:test (default-test) on project grobid-core: ExecutionException; nested exception is java.util.concurrent.ExecutionException: java.lang.RuntimeException: The forked VM terminated without saying properly goodbye. VM crash or System.exit called ? -> [Help 1]\n </denchmark-code>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "thomasopsomer", "commentT": "2016-10-13T10:45:42Z", "comment_text": "\n \t\tWow, what Apple didn't say about Sierra? :-o\n Can we check that the md5sum, checksum and dimension of the models has not been changed? I doubt so.\n There are mine:\n Md5:\n <denchmark-code>Johan:models lfoppiano$ md5 fulltext/model.wapiti \n MD5 (fulltext/model.wapiti) = e7a234087a43f18daaafe41f7a1e6426\n Johan:models lfoppiano$ md5 header/model.wapiti \n MD5 (header/model.wapiti) = 1ae582a2abc0ad27dc8d08b9d1edbf1d\n </denchmark-code>\n \n Checksum:\n <denchmark-code>Johan:models lfoppiano$ shasum header/model.wapiti \n b33401ac16516fff2aa7d25b9a163719032d9cbb  header/model.wapiti\n Johan:models lfoppiano$ shasum fulltext/model.wapiti \n 02d6627b690894da5b848b119e580ed7aa0de49f  fulltext/model.wapiti\n </denchmark-code>\n \n dimension:\n <denchmark-code>Johan:models lfoppiano$ ls -l  fulltext/model.wapiti \n -rw-r--r--  1 lfoppiano  staff  6685602 Oct  2 00:10 fulltext/model.wapiti\n Johan:models lfoppiano$ ls -l  header/model.wapiti \n -rw-r--r--  1 lfoppiano  staff  36094028 Oct  2 00:10 header/model.wapiti\n </denchmark-code>\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "thomasopsomer", "commentT": "2016-10-13T10:52:00Z", "comment_text": "\n \t\tmine :)\n MD5:\n <denchmark-code>md5 fulltext/model.wapiti \n MD5 (fulltext/model.wapiti) = e7a234087a43f18daaafe41f7a1e6426\n md5 header/model.wapiti \n MD5 (header/model.wapiti) = 1ae582a2abc0ad27dc8d08b9d1edbf1d\n </denchmark-code>\n \n Checksum\n <denchmark-code>shasum header/model.wapiti \n b33401ac16516fff2aa7d25b9a163719032d9cbb  header/model.wapiti\n shasum fulltext/model.wapiti \n 02d6627b690894da5b848b119e580ed7aa0de49f  fulltext/model.wapiti\n </denchmark-code>\n \n dimension\n <denchmark-code>-rw-r--r--  1 thomasopsomer  staff  6685602  2 oct 00:10 fulltext/model.wapiti\n -rw-r--r--  1 thomasopsomer  staff  36094028  2 oct 00:10 header/model.wapiti\n </denchmark-code>\n \n Everything seems identical.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "thomasopsomer", "commentT": "2016-10-13T11:12:15Z", "comment_text": "\n \t\tI'm baffled...\n Let's see the termination lines. If you run this command it should compare the file with LF termination line with the original:\n <denchmark-code>dos2unix < fulltext/model.wapiti | cmp -s - fulltext/model.wapiti \n </denchmark-code>\n \n If this is negative... I'm out of ideas for the moment :(\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "thomasopsomer", "commentT": "2016-10-13T11:30:50Z", "comment_text": "\n \t\tthe cmd doesn't return anything, I guess it's positive ?\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "thomasopsomer", "commentT": "2016-10-13T11:59:11Z", "comment_text": "\n \t\tit depends :) it means there is no difference... so the problem is somewhere else \ud83d\udde1\n ...thinking...\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "thomasopsomer", "commentT": "2016-10-13T12:01:30Z", "comment_text": "\n \t\tHello Thomas,\n Well negative to find the problem ;)\n Just another idea, what is your locale settings?\n \n locale\n \n Normally, the issue related to locale have been solved since ~2 years with our Wapiti fork, but who knows...\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "thomasopsomer", "commentT": "2016-10-13T12:17:07Z", "comment_text": "\n \t\tHello Patrice,\n locale gives:\n <denchmark-code>LANG=\"fr_FR.UTF-8\"\n LC_COLLATE=\"fr_FR.UTF-8\"\n LC_CTYPE=\"fr_FR.UTF-8\"\n LC_MESSAGES=\"fr_FR.UTF-8\"\n LC_MONETARY=\"fr_FR.UTF-8\"\n LC_NUMERIC=\"fr_FR.UTF-8\"\n LC_TIME=\"fr_FR.UTF-8\"\n </denchmark-code>\n \n Anyway the good turn-around is to use Docker :)\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "thomasopsomer", "commentT": "2016-10-13T12:21:23Z", "comment_text": "\n \t\tAh sure, Docker is the hammer solution !\n What happens if you change your LOCALE in your terminal before launching GROBID? Simply try:\n \n export LC_ALL=C\n \n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "thomasopsomer", "commentT": "2016-10-13T12:28:13Z", "comment_text": "\n \t\twow magic, the test passed and build completed with success :)\n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "thomasopsomer", "commentT": "2016-10-13T12:43:53Z", "comment_text": "\n \t\tIt means to check why the change of LOCALE integrated in our Wapiti fork (just before reading the CRF model, in order to be sure to have portable models) is not working anymore on Mac OS X 10.12 :(\n The other related problem is that the architecture info changed, because Apple renamed \"OS X\" into \"macOS\", this could impact the resolution of the path to the native stuff based on the architecture.\n Thanks a lot Thomas for helping us!\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "thomasopsomer", "commentT": "2017-09-13T14:00:04Z", "comment_text": "\n \t\tI've had similar problems on macOs sierra on which the workaround setting LC_ALL=\"C\" worked.\n I've managed to solve the issues by recompiling wapiti on macOS sierra. See pull request <denchmark-link:https://github.com/kermitt2/grobid/pull/240>#240</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "27bf59ebe45213c997171e0fa0f04dbc1f62403e", "commit_author": "iorala", "commitT": "2017-09-25 16:40:52+02:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "grobid-core\\lib\\fr\\limsi\\wapiti\\wapiti\\maven-metadata-local.xml", "file_new_name": "grobid-core\\lib\\fr\\limsi\\wapiti\\wapiti\\maven-metadata-local.xml", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "10", "deleted_lines": "10"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "grobid-home\\lib\\mac-64\\libwapiti.dylib", "file_new_name": "grobid-home\\lib\\mac-64\\libwapiti.dylib", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": null}}}}}}