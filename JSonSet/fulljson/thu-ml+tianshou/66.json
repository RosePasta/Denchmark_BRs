{"BR": {"BR_id": "66", "BR_author": "duburcqa", "BRopenT": "2020-05-30T09:22:43Z", "BRcloseT": "2020-05-30T13:29:34Z", "BR_text": {"BRsummary": "Batch not serializable", "BRdescription": "\n \n  I have marked all applicable categories:\n \n  exception-raising bug\n  RL algorithm bug\n  documentation request (i.e. \"X is missing from the documentation.\")\n  new feature request\n \n \n  I have visited the source website, and in particular read the known issues\n  I have searched through the issue tracker and issue categories for duplicates\n  I have mentioned version numbers, operating system and environment, where applicable\n \n <denchmark-h:hr></denchmark-h>\n \n Batch instances are creating infinite recursive loop when used in argument of a multiprocessing Pipe. Here is a snippet to reproduce the issue.\n <denchmark-code>from tianshou.data import Batch\n from multiprocessing import Pipe\n (p, c) = Pipe()\n c.send(Batch(a=1.0))\n print(p.recv())\n </denchmark-code>\n \n Similarly, using Pickle without multiprocessing produces the same issue.\n <denchmark-code>from tianshou.data import Batch\n import pickle\n pickle.dump(Batch(a=1.0), open(\"save.p\", \"wb\"))                                                                                                                                                     \n pickle.load(open(\"save.p\", \"rb\"))\n </denchmark-code>\n \n I'm going to open a PR that fixes the issue.\n \t"}, "comments": {}}, "commit": {"commit_id": "529a4cf44c183e0581e1db8ac55b68c775ff35d1", "commit_author": "Alexis DUBURCQ", "commitT": "2020-05-30 21:29:33+08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.8"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "test\\base\\test_batch.py", "file_new_name": "test\\base\\test_batch.py", "file_complexity": {"file_NLOC": "48", "file_CCN": "5", "file_NToken": "506"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "34,35,36,37,38,39,40", "deleted_lines": null, "method_info": {"method_name": "test_batch_pickle", "method_params": "", "method_startline": "34", "method_endline": "40", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "104", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tianshou\\data\\batch.py", "file_new_name": "tianshou\\data\\batch.py", "file_complexity": {"file_NLOC": "217", "file_CCN": "57", "file_NToken": "1233"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "76,77,78,79", "deleted_lines": null, "method_info": {"method_name": "__new__", "method_params": "cls,kwargs", "method_startline": "76", "method_endline": "79", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "76,77,78,79,80", "deleted_lines": "71", "method_info": {"method_name": "__init__", "method_params": "self,kwargs", "method_startline": "69", "method_endline": "87", "method_complexity": {"method_NLOC": "19", "method_CCN": "10", "method_NToken": "204", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "112,113,114,115,116,117", "deleted_lines": null, "method_info": {"method_name": "__setstate__", "method_params": "self,state", "method_startline": "112", "method_endline": "117", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "15", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "100,101,102,103,104,105,106,107,108,109,110", "deleted_lines": null, "method_info": {"method_name": "__getstate__", "method_params": "self", "method_startline": "100", "method_endline": "110", "method_complexity": {"method_NLOC": "8", "method_CCN": "3", "method_NToken": "48", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tianshou\\env\\vecenv.py", "file_new_name": "tianshou\\env\\vecenv.py", "file_complexity": {"file_NLOC": "291", "file_CCN": "85", "file_NToken": "2056"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "100,101,102,103,104", "deleted_lines": null, "method_info": {"method_name": "close", "method_params": "self", "method_startline": "99", "method_endline": "105", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "9", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "82,83,84,85,86,87,88,89", "deleted_lines": "82,83", "method_info": {"method_name": "seed", "method_params": "self,int,None", "method_startline": "81", "method_endline": "91", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "26", "method_nesting_level": "1"}}}}}}}}