{"BR": {"BR_id": "12205", "BR_author": "facaiy", "BRopenT": "2017-08-11T08:21:10Z", "BRcloseT": "2017-08-21T23:56:32Z", "BR_text": {"BRsummary": "BUG: TypeError in DNNClassifier.eval() when using same name for feature in feature_engineering_fn", "BRdescription": "\n <denchmark-h:h3>Describe the problem</denchmark-h>\n \n If we use the  same key to replace a feature, tensorflow might throw TypeError when evaluating:\n eg:\n def feature_engineering_fn(features, label):\n   features[\"x\"] = some_func(features[\"x\"])\n When  is , it is a mutable object. Hence the bug is caused by  method which runs  again, see <denchmark-link:https://github.com/facaiy/tensorflow/blob/c7b80d51da4fb6d51ea54a0bdf2601afa379d60c/tensorflow/contrib/learn/python/learn/estimators/estimator.py#L1165>code</denchmark-link>\n .\n I'll open a PR later.\n \t"}, "comments": {}}, "commit": {"commit_id": "f47c3ad964f42121cbab02afed52e2df367ea9ef", "commit_author": "Yan Facai (\u989c\u53d1\u624d)", "commitT": "2017-08-21 16:56:32-07:00", "commit_complexity": {"commit_NLOC": "0.8484848484848485", "commit_CCN": "0.8484848484848485", "commit_Nprams": "0.9696969696969697"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py", "file_new_name": "tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py", "file_complexity": {"file_NLOC": "845", "file_CCN": "147", "file_NToken": "5620"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1136,1143,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175,1176,1177,1178,1179,1180,1181,1182,1183", "deleted_lines": "1136,1165,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175", "method_info": {"method_name": "_call_model_fn", "method_params": "self,features,labels,mode,metrics", "method_startline": "1136", "method_endline": "1183", "method_complexity": {"method_NLOC": "28", "method_CCN": "8", "method_NToken": "187", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "1227", "deleted_lines": "1219,1220,1221,1222,1223,1224,1225", "method_info": {"method_name": "_get_eval_ops", "method_params": "self,features,labels,metrics", "method_startline": "1201", "method_endline": "1232", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "65", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "1136,1143,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175", "deleted_lines": "1136,1165,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175", "method_info": {"method_name": "_call_model_fn", "method_params": "self,features,labels,mode", "method_startline": "1136", "method_endline": "1175", "method_complexity": {"method_NLOC": "23", "method_CCN": "7", "method_NToken": "155", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimators_test.py", "file_new_name": "tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimators_test.py", "file_complexity": {"file_NLOC": "135", "file_CCN": "14", "file_NToken": "1066"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117", "deleted_lines": null, "method_info": {"method_name": "testFeatureEngineeringFnWithSameName", "method_params": "self", "method_startline": "81", "method_endline": "117", "method_complexity": {"method_NLOC": "14", "method_CCN": "1", "method_NToken": "107", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "83,84,85,86,87,88", "deleted_lines": null, "method_info": {"method_name": "testFeatureEngineeringFnWithSameName.input_fn", "method_params": "", "method_startline": "83", "method_endline": "88", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "30", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "90,91,92,93,94,95", "deleted_lines": null, "method_info": {"method_name": "testFeatureEngineeringFnWithSameName.feature_engineering_fn", "method_params": "features,labels", "method_startline": "90", "method_endline": "95", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "50", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "97,98,99,100,101,102,103,104", "deleted_lines": null, "method_info": {"method_name": "testFeatureEngineeringFnWithSameName.model_fn", "method_params": "features,labels", "method_startline": "97", "method_endline": "104", "method_complexity": {"method_NLOC": "7", "method_CCN": "1", "method_NToken": "56", "method_nesting_level": "2"}}}}}}}}