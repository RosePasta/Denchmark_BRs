{"BR": {"BR_id": "45662", "BR_author": "Flamefire", "BRopenT": "2020-12-14T17:00:46Z", "BRcloseT": "2021-01-05T22:24:28Z", "BR_text": {"BRsummary": "Wrong device returned for GPUCompatibleFIFOQueueTests.testEnqueueDequeue test", "BRdescription": "\n System information\n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04): CentOS 7\n TensorFlow installed from (source or binary): source\n TensorFlow version (use command below): 2.4.0rc4\n Python version: 3.7.4\n Bazel version (if compiling from source): 3.4.1\n GCC/Compiler version (if compiling from source): GCC 8.3.0\n CUDA/cuDNN version: 10.1\n GPU model and memory: V100\n \n Describe the current behavior\n In the //tensorflow/python/kernel_tests:fifo_queue_test target the GPUCompatibleFIFOQueueTests.testEnqueueDequeue returns the wrong device:  /job:localhost/replica:0/task:0/device:CPU:0 vs /job:localhost/replica:0/task:0/device:GPU:0\n See below log\n Standalone code to reproduce the issue\n Run bazel test\n Other info / logs\n <denchmark-code>FAIL: testEnqueueDequeue (__main__.GPUCompatibleFIFOQueueTests)\n GPUCompatibleFIFOQueueTests.testEnqueueDequeue\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"/tmp/bazel-tf/20db8ac50b74c328e6dea9b20829b459/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/python/kernel_tests/fifo_queue_test.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py\", line 1221, in decorated\n     run_eagerly(self, **kwargs)\n   File \"/tmp/bazel-tf/20db8ac50b74c328e6dea9b20829b459/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/python/kernel_tests/fifo_queue_test.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py\", line 1205, in run_eagerly\n     f(self, *args, **kwargs)\n   File \"/tmp/bazel-tf/20db8ac50b74c328e6dea9b20829b459/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/python/kernel_tests/fifo_queue_test.runfiles/org_tensorflow/tensorflow/python/kernel_tests/fifo_queue_test.py\", line 425, in testEnqueueDequeue\n     self.assertEqual(elems[0].device, dequeued_tensor.device)\n AssertionError: \n - /job:localhost/replica:0/task:0/device:CPU:0\n ?                                        ^\n + /job:localhost/replica:0/task:0/device:GPU:0\n ?                                        ^\n \n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "Flamefire", "commentT": "2021-01-05T22:24:29Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/45662>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tensorflow/issues/45662>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "671c78343c3427858bd5674baab80c3c8c429815", "commit_author": "Allen Lavoie", "commitT": "2021-01-05 14:23:18-08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\python\\kernel_tests\\fifo_queue_test.py", "file_new_name": "tensorflow\\python\\kernel_tests\\fifo_queue_test.py", "file_complexity": {"file_NLOC": "1333", "file_CCN": "203", "file_NToken": "12937"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "418,419,420", "deleted_lines": "418", "method_info": {"method_name": "testEnqueueDequeue", "method_params": "self", "method_startline": "414", "method_endline": "429", "method_complexity": {"method_NLOC": "13", "method_CCN": "4", "method_NToken": "131", "method_nesting_level": "1"}}}}}}}}