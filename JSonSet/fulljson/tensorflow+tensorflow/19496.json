{"BR": {"BR_id": "19496", "BR_author": "arogozhnikov", "BRopenT": "2018-05-23T11:18:27Z", "BRcloseT": "2018-05-30T18:17:18Z", "BR_text": {"BRsummary": "Segfault with rpc ops in eager mode", "BRdescription": "\n <denchmark-h:h3>System information</denchmark-h>\n \n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\n TensorFlow installed from (source or binary): binary, pip\n TensorFlow version (use command below): 1.8\n Python version:  3.6\n Bazel version (if compiling from source): NA\n GCC/Compiler version (if compiling from source): NA\n CUDA/cuDNN version: NA\n GPU model and memory: NA\n Exact command to reproduce: see below\n \n <denchmark-h:h3>Describe the problem</denchmark-h>\n \n Rpc ops (rpc, try_rpc)  are not working in eager mode. See minimal examples below.\n <denchmark-h:h3>Source code / logs</denchmark-h>\n \n Non-eager version works\n import tensorflow as tf\n from tensorflow.contrib.rpc.python.ops.gen_rpc_op import try_rpc\n \n with tf.Graph().as_default():\n     response = try_rpc('localhost:80', '/Test', 'some simple message', protocol='grpc')\n     session = tf.InteractiveSession()\n     print( session.run([response], feed_dict={}) )\n Eager version does not (results in segfault):\n import tensorflow as tf\n from tensorflow.contrib.rpc.python.ops.gen_rpc_op import try_rpc\n tf.enable_eager_execution()\n response = try_rpc('localhost:80', '/Test', 'some simple message', protocol='grpc')\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "arogozhnikov", "commentT": "2018-05-25T07:18:33Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/jsimsa>@jsimsa</denchmark-link>\n  : Mind taking a look?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "arogozhnikov", "commentT": "2018-05-29T19:45:48Z", "comment_text": "\n \t\twill do\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "arogozhnikov", "commentT": "2018-05-30T18:17:18Z", "comment_text": "\n \t\tThis was just fixed internally and will be pushed to master in the next sync.\n \t\t"}}}, "commit": {"commit_id": "2c75dbfd2d37a3c06d34cc4b12682a63a75503f7", "commit_author": "Jiri Simsa", "commitT": "2018-05-29 18:12:55-07:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "0.0", "commit_Nprams": "0.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\core\\util\\rpc\\call_container.h", "file_new_name": "tensorflow\\core\\util\\rpc\\call_container.h", "file_complexity": {"file_NLOC": "108", "file_CCN": "13", "file_NToken": "668"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "105,106,107,115,116,117,132,133,134,135,136,137,138,139", "deleted_lines": "105,113,128,129,130,131,132", "method_info": {"method_name": "tensorflow::CallContainer<Call>::CallContainer", "method_params": "ctx,num_calls,fail_fast,try_rpc,done,create_call_fn,start_call_fn", "method_startline": "98", "method_endline": "158", "method_complexity": {"method_NLOC": "48", "method_CCN": "6", "method_NToken": "328", "method_nesting_level": "1"}}}}}}}}