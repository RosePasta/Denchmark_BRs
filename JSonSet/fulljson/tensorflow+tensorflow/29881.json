{"BR": {"BR_id": "29881", "BR_author": "durandg12", "BRopenT": "2019-06-17T17:27:01Z", "BRcloseT": "2019-06-23T01:30:39Z", "BR_text": {"BRsummary": "The call method of DenseFeatures and SequenceFeatures use deprecated attribute _num_buckets", "BRdescription": "\n System information\n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow): no\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS 10.13.6\n TensorFlow installed from (source or binary): from pip install\n TensorFlow version (use command below): v1.12.1-3259-gf59745a381 2.0.0-beta0\n Python version: v3.6.7:6ec5cf24b7, Oct 20 2018, 03:02:14\n \n Describe the current behavior\n By simply calling the call method of DenseFeatures and SequenceFeatures defined with categorical_column_with_identity and sequence_categorical_column_with_identity feature columns (along with embedding_column), we get warnings that the deprecated attributes _num_buckets are used (instead of the non-deprecated num_buckets I guess).\n Also note, on the code example below, that a third warning about a deprecated method, add_dispatch_support.<locals>.wrapper arises. I do not understand it but there are instructions for updating given in the warning, see the code below.\n Describe the expected behavior\n I think that we should not get warnings about deprecated objects when we are not calling any deprecated method, attribute, etc. I think that somewhere in the code of the call method of DenseFeatures and SequenceFeatures there is a use of _num_buckets that should be replaced by num_buckets. Following the updating instructions about the third warning may be enough to get rid of it.\n Code to reproduce the issue\n <denchmark-code>import numpy as np\n import tensorflow as tf\n from tensorflow.feature_column import categorical_column_with_identity, embedding_column, \\\n                                             sequence_categorical_column_with_identity\n from tensorflow.keras.layers import DenseFeatures\n from tensorflow.keras.experimental import SequenceFeatures\n \n #print(tf.version.GIT_VERSION, tf.version.VERSION)\n \n nb_features = 10\n emb_dim = 3\n \n fc = categorical_column_with_identity('feature1', nb_features)\n emb_fc = embedding_column(fc, emb_dim)\n layer = DenseFeatures(emb_fc)\n \n seq_fc = sequence_categorical_column_with_identity('feature2', nb_features)\n emb_seq_fc = embedding_column(seq_fc, emb_dim)\n seq_layer = SequenceFeatures(emb_seq_fc)\n \n data1 = np.array(range(nb_features))\n batch_size, sequence_length = 2, 5\n raw_data2 = np.array(range(nb_features))\n data2 = np.reshape(raw_data2, (batch_size, sequence_length))\n \n dict_data = {'feature1': data1, 'feature2': data2}\n print(layer(dict_data))\n print(seq_layer(dict_data))\n </denchmark-code>\n \n produces the following three warnings:\n <denchmark-code>WARNING: Logging before flag parsing goes to stderr.\n W0617 19:19:42.823884 140735678825344 deprecation.py:323] From /Users/myusername/Documents/tf2beta/lib/python3.6/site-packages/tensorflow/python/feature_column/feature_column_v2.py:3040: IdentityCategoricalColumn._num_buckets (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.\n Instructions for updating:\n The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.\n W0617 19:19:42.827694 140735678825344 deprecation.py:323] From /Users/myusername/Documents/tf2beta/lib/python3.6/site-packages/tensorflow/python/feature_column/feature_column_v2.py:2655: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.\n Instructions for updating:\n Use tf.where in 2.0, which has the same broadcast rule as np.where\n W0617 19:19:42.833320 140735678825344 deprecation.py:323] From /Users/myusername/Documents/tf2beta/lib/python3.6/site-packages/tensorflow/python/feature_column/feature_column_v2.py:3040: SequenceCategoricalColumn._num_buckets (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.\n Instructions for updating:\n The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "durandg12", "commentT": "2019-06-18T10:08:52Z", "comment_text": "\n \t\tI could see the warning message on colab with Tf 2.0.0.beta0. Thanks!\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "durandg12", "commentT": "2019-06-19T08:17:10Z", "comment_text": "\n \t\tSimilar problem here from beta1:\n \n tensorflow\\python\\ops\\math_grad.py:1250: add_dispatch_support..wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.\n Instructions for updating:\n Use tf.where in 2.0, which has the same broadcast rule as np.where\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "durandg12", "commentT": "2019-06-19T12:24:35Z", "comment_text": "\n \t\tI've got exactly the same issue ^^ I hope someone fixes it\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "durandg12", "commentT": "2019-06-22T03:04:26Z", "comment_text": "\n \t\tSame here\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "durandg12", "commentT": "2019-06-22T14:21:52Z", "comment_text": "\n \t\t+1 - most annoying comment ever <3\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "durandg12", "commentT": "2019-06-23T01:30:40Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=29881>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=29881>No</denchmark-link>\n \n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "durandg12", "commentT": "2019-08-27T10:43:26Z", "comment_text": "\n \t\tThe warnings are still here in tf2.0.0-rc0.\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "durandg12", "commentT": "2019-09-25T12:19:21Z", "comment_text": "\n \t\tActually there is even one new warning when using tf2.0.0-rc0, I didn't see it the first time I tested. For the same code as above, now the output is:\n <denchmark-code>WARNING: Logging before flag parsing goes to stderr.\n W0925 14:12:28.993772 140735485318016 deprecation.py:323] From /path/to/python3.6/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py:3089: IdentityCategoricalColumn._num_buckets (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.\n Instructions for updating:\n The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.\n W0925 14:12:28.994673 140735485318016 deprecation.py:323] From /path/to/python3.6/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py:353: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.\n Instructions for updating:\n Please use `layer.add_weight` method instead.\n W0925 14:12:29.005573 140735485318016 deprecation.py:323] From /path/to/python3.6/site-packages/tensorflow_core/python/ops/embedding_ops.py:802: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.\n Instructions for updating:\n Use tf.where in 2.0, which has the same broadcast rule as np.where\n W0925 14:12:29.010264 140735485318016 deprecation.py:323] From /path/to/python3.6/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py:3089: SequenceCategoricalColumn._num_buckets (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.\n Instructions for updating:\n The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.\n </denchmark-code>\n \n See the new warning\n <denchmark-code>Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.\n Instructions for updating:\n Please use `layer.add_weight` method instead.\n </denchmark-code>\n \n Is it possible to re-open this issue? Or should I open a new one?\n Edit: it says I unassigned <denchmark-link:https://github.com/bananabowl>@bananabowl</denchmark-link>\n  but I don't know how to do that, I just posted this new comment and then edited it.\n Edit 2: mentioning <denchmark-link:https://github.com/martinwicke>@martinwicke</denchmark-link>\n  as he is the author of the commit which caused this issue to be closed.\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "durandg12", "commentT": "2019-10-01T13:58:38Z", "comment_text": "\n \t\tAll warnings have disappeared in tf2.0.0. This one can stay closed for good.\n \t\t"}}}, "commit": {"commit_id": "d7e858192d1de827bc03705ac62e1bd38daf06d8", "commit_author": "Martin Wicke", "commitT": "2019-06-22 18:25:57-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tensorflow\\python\\feature_column\\feature_column_v2.py", "file_new_name": "tensorflow\\python\\feature_column\\feature_column_v2.py", "file_complexity": {"file_NLOC": "2490", "file_CCN": "392", "file_NToken": "13768"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "3859", "deleted_lines": "3857", "method_info": {"method_name": "_transform_input_tensor", "method_params": "self,input_tensor", "method_startline": "3836", "method_endline": "3870", "method_complexity": {"method_NLOC": "30", "method_CCN": "3", "method_NToken": "235", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "3102,3103,3104", "deleted_lines": "3102", "method_info": {"method_name": "create_state", "method_params": "self,state_manager", "method_startline": "3100", "method_endline": "3112", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "69", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "2714", "deleted_lines": "2714", "method_info": {"method_name": "_to_sparse_input_and_drop_ignore_values", "method_params": "input_tensor,ignore_value", "method_startline": "2679", "method_endline": "2720", "method_complexity": {"method_NLOC": "22", "method_CCN": "5", "method_NToken": "164", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\python\\ops\\array_ops.py", "file_new_name": "tensorflow\\python\\ops\\array_ops.py", "file_complexity": {"file_NLOC": "1743", "file_CCN": "328", "file_NToken": "11341"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "3632,3635,3639,3650,3652", "deleted_lines": "3647", "method_info": {"method_name": "where_v2", "method_params": "condition,x,y,name", "method_startline": "3622", "method_endline": "3664", "method_complexity": {"method_NLOC": "10", "method_CCN": "5", "method_NToken": "113", "method_nesting_level": "0"}}}}}}}}