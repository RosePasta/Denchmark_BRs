{"BR": {"BR_id": "1853", "BR_author": "yaroslavvb", "BRopenT": "2016-04-11T17:40:39Z", "BRcloseT": "2017-06-13T23:58:22Z", "BR_text": {"BRsummary": "shuffle_batch gives ZeroDivisionError when computing capacity stat", "BRdescription": "\n <denchmark-code>import tensorflow as tf\n raw = tf.ones((2))\n tf.train.shuffle_batch([raw], batch_size=2, capacity=4, min_after_dequeue=4, seed=5)\n \n </denchmark-code>\n \n this fails with\n <denchmark-code>ZeroDivisionError                         Traceback (most recent call last)\n <ipython-input-11-86e4af7ca1ee> in <module>()\n       1 import tensorflow as tf\n       2 raw = tf.ones((2))\n ----> 3 tf.train.shuffle_batch([raw], batch_size=2, capacity=4, min_after_dequeue=4, seed=5)\n \n /Users/yaroslav/anaconda/envs/tim-jan17/lib/python3.5/site-packages/tensorflow/python/training/input.py in shuffle_batch(tensors, batch_size, capacity, min_after_dequeue, num_threads, seed, enqueue_many, shapes, allow_smaller_final_batch, shared_name, name)\n    1220       allow_smaller_final_batch=allow_smaller_final_batch,\n    1221       shared_name=shared_name,\n -> 1222       name=name)\n    1223 \n    1224 \n \n /Users/yaroslav/anaconda/envs/tim-jan17/lib/python3.5/site-packages/tensorflow/python/training/input.py in _shuffle_batch(tensors, batch_size, capacity, min_after_dequeue, keep_input, num_threads, seed, enqueue_many, shapes, allow_smaller_final_batch, shared_name, name)\n     779     full = (math_ops.cast(math_ops.maximum(0, queue.size() - min_after_dequeue),\n     780                           dtypes.float32) *\n --> 781             (1. / (capacity - min_after_dequeue)))\n     782     # Note that name contains a '/' at the end so we intentionally do not place\n     783     # a '/' after %s below.\n \n </denchmark-code>\n \n Unlike TF tensors, Python doesn't handle float division by zero. One solution is to wrap \"capacity\" and \"min_after_dequeue\" into TF tensors so that you get \"inf\" as a result instead of RuntimeError\n \t"}, "comments": {}}, "commit": {"commit_id": "70ade1b64f65d0a2275672d27129627ff116a997", "commit_author": "Jing Jun Yin", "commitT": "2017-06-13 16:58:21-07:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\training\\input.py", "file_new_name": "tensorflow\\python\\training\\input.py", "file_complexity": {"file_NLOC": "612", "file_CCN": "120", "file_NToken": "4281"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "765,766,767", "deleted_lines": null}}}}}}