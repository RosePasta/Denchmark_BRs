{"BR": {"BR_id": "29342", "BR_author": "ageron", "BRopenT": "2019-06-03T01:51:19Z", "BRcloseT": "2019-07-03T23:37:49Z", "BR_text": {"BRsummary": "tf.config.set_soft_device_placement() seems to have no effect", "BRdescription": "\n System information\n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\n Yes\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\n MacOSX 10.13.6\n Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\n N/A\n TensorFlow installed from (source or binary):\n binary\n TensorFlow version (use command below):\n VERSION='2.0.0-dev20190527'\n GIT_VERSION='v1.12.1-2821-gc5b8e15064'\n Python version:\n 3.5\n Bazel version (if compiling from source):\n N/A\n GCC/Compiler version (if compiling from source):\n N/A\n CUDA/cuDNN version:\n CUDA 10.0 (it's just a Colab GPU instance)\n GPU model and memory:\n Tesla P4 15079MiB\n \n Describe the current behavior\n The tf.config.set_soft_device_placement() function seems to have no effect when I create an integer variable and try to place it on a GPU, I still get an exception.\n Describe the expected behavior\n I expect soft placement to fallback to using the CPU. No error.\n Code to reproduce the issue\n import tensorflow as tf\n tf.config.set_soft_device_placement(True)\n with tf.device(\"/gpu:0\"):\n     f = tf.Variable(42)\n Other info / logs\n The code above causes the following exception:\n <denchmark-code>---------------------------------------------------------------------------\n NotFoundError                             Traceback (most recent call last)\n <ipython-input-3-1babaf613bc3> in <module>()\n       2 tf.config.set_soft_device_placement(True)\n       3 with tf.device(\"/gpu:0\"):\n ----> 4     f = tf.Variable(42)\n \n 10 frames\n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/variables.py in __call__(cls, *args, **kwargs)\n     260       return cls._variable_v1_call(*args, **kwargs)\n     261     elif cls is Variable:\n --> 262       return cls._variable_v2_call(*args, **kwargs)\n     263     else:\n     264       return super(VariableMetaclass, cls).__call__(*args, **kwargs)\n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/variables.py in _variable_v2_call(cls, initial_value, trainable, validate_shape, caching_device, name, variable_def, dtype, import_scope, constraint, synchronization, aggregation, shape)\n     254         synchronization=synchronization,\n     255         aggregation=aggregation,\n --> 256         shape=shape)\n     257 \n     258   def __call__(cls, *args, **kwargs):\n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/variables.py in <lambda>(**kws)\n     235                         shape=None):\n     236     \"\"\"Call on Variable class. Useful to force the signature.\"\"\"\n --> 237     previous_getter = lambda **kws: default_variable_creator_v2(None, **kws)\n     238     for _, getter in ops.get_default_graph()._variable_creator_stack:  # pylint: disable=protected-access\n     239       previous_getter = _make_getter(getter, previous_getter)\n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/variable_scope.py in default_variable_creator_v2(next_creator, **kwargs)\n    2549       synchronization=synchronization,\n    2550       aggregation=aggregation,\n -> 2551       shape=shape)\n    2552 \n    2553 \n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/variables.py in __call__(cls, *args, **kwargs)\n     262       return cls._variable_v2_call(*args, **kwargs)\n     263     else:\n --> 264       return super(VariableMetaclass, cls).__call__(*args, **kwargs)\n     265 \n     266 \n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py in __init__(self, initial_value, trainable, collections, validate_shape, caching_device, name, dtype, variable_def, import_scope, constraint, distribute_strategy, synchronization, aggregation, shape)\n     462           synchronization=synchronization,\n     463           aggregation=aggregation,\n --> 464           shape=shape)\n     465 \n     466   def __repr__(self):\n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py in _init_from_args(self, initial_value, trainable, collections, caching_device, name, dtype, constraint, synchronization, aggregation, shape)\n     616               shared_name=shared_name,\n     617               name=name,\n --> 618               graph_mode=self._in_graph_mode)\n     619         # pylint: disable=protected-access\n     620         if (self._in_graph_mode and initial_value is not None and\n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py in eager_safe_variable_handle(initial_value, shape, shared_name, name, graph_mode)\n     223   dtype = initial_value.dtype.base_dtype\n     224   return variable_handle_from_shape_and_dtype(\n --> 225       shape, dtype, shared_name, name, graph_mode, initial_value)\n     226 \n     227 \n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py in variable_handle_from_shape_and_dtype(shape, dtype, shared_name, name, graph_mode, extra_handle_data)\n     139                                                    shared_name=shared_name,\n     140                                                    name=name,\n --> 141                                                    container=container)\n     142   if extra_handle_data is None:\n     143     extra_handle_data = handle\n \n /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gen_resource_variable_ops.py in var_handle_op(dtype, shape, container, shared_name, name)\n    1416       else:\n    1417         message = e.message\n -> 1418       _six.raise_from(_core._status_to_exception(e.code, message), None)\n    1419   # Add nodes to the TensorFlow graph.\n    1420   dtype = _execute.make_type(dtype, \"dtype\")\n \n /usr/local/lib/python3.6/dist-packages/six.py in raise_from(value, from_value)\n \n NotFoundError: No registered 'VarHandleOp' OpKernel for GPU devices compatible with node {{node VarHandleOp}}\n \t (OpKernel was found, but attributes didn't match) Requested Attributes: container=\"\", dtype=DT_INT32, shape=[], shared_name=\"cd2c89b7-88b7-44c8-ad83-06c2a9158347\"\n \t.  Registered:  device='GPU'; dtype in [DT_VARIANT]\n   device='GPU'; dtype in [DT_INT64]\n   device='GPU'; dtype in [DT_COMPLEX128]\n   device='GPU'; dtype in [DT_COMPLEX64]\n   device='GPU'; dtype in [DT_BOOL]\n   device='GPU'; dtype in [DT_DOUBLE]\n   device='GPU'; dtype in [DT_FLOAT]\n   device='GPU'; dtype in [DT_HALF]\n   device='CPU'\n   device='XLA_CPU'\n   device='XLA_GPU'\n  [Op:VarHandleOp] name: Variable/\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ageron", "commentT": "2019-06-03T02:18:24Z", "comment_text": "\n \t\tAlso, if I activate soft placement and I try to place an operation on a GPU device that does not exist, I still get an exception. I expected TF to fallback to using the CPU:\n import tensorflow as tf\n tf.config.set_soft_device_placement(True)\n with tf.device(\"/gpu:1\"):\n     f = tf.Variable(42.0)\n Raises this exception:\n <denchmark-code>---------------------------------------------------------------------------\n RuntimeError                              Traceback (most recent call last)\n <ipython-input-1-3a03536f5e27> in <module>\n       2 tf.config.set_soft_device_placement(True)\n       3 with tf.device(\"/gpu:1\"):\n ----> 4         f = tf.Variable(42.5)\n       5\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/ops/variables.py in __call__(cls, *args, **kwargs)\n     259       return cls._variable_v1_call(*args, **kwargs)\n     260     elif cls is Variable:\n --> 261       return cls._variable_v2_call(*args, **kwargs)\n     262     else:\n     263       return super(VariableMetaclass, cls).__call__(*args, **kwargs)\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/ops/variables.py in _variable_v2_call(cls, initial_value, trainable, validate_shape, caching_device, name, variable_def, dtype, import_scope, constraint, synchronization, aggregation, shape)\n     253         synchronization=synchronization,\n     254         aggregation=aggregation,\n --> 255         shape=shape)\n     256\n     257   def __call__(cls, *args, **kwargs):\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/ops/variables.py in <lambda>(**kws)\n     234                         shape=None):\n     235     \"\"\"Call on Variable class. Useful to force the signature.\"\"\"\n --> 236     previous_getter = lambda **kws: default_variable_creator_v2(None, **kws)\n     237     for _, getter in ops.get_default_graph()._variable_creator_stack:  # pylint: disable=protected-access\n     238       previous_getter = _make_getter(getter, previous_getter)\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py in default_variable_creator_v2(next_creator, **kwargs)\n    2542       synchronization=synchronization,\n    2543       aggregation=aggregation,\n -> 2544       shape=shape)\n    2545\n    2546\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/ops/variables.py in __call__(cls, *args, **kwargs)\n     261       return cls._variable_v2_call(*args, **kwargs)\n     262     else:\n --> 263       return super(VariableMetaclass, cls).__call__(*args, **kwargs)\n     264\n     265\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/ops/resource_variable_ops.py in __init__(self, initial_value, trainable, collections, validate_shape, caching_device, name, dtype, variable_def, import_scope, constraint, distribute_strategy, synchronization, aggregation, shape)\n     462           synchronization=synchronization,\n     463           aggregation=aggregation,\n --> 464           shape=shape)\n     465\n     466   def __repr__(self):\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/ops/resource_variable_ops.py in _init_from_args(self, initial_value, trainable, collections, caching_device, name, dtype, constraint, synchronization, aggregation, shape)\n     607             initial_value = ops.convert_to_tensor(\n     608                 initial_value() if init_from_fn else initial_value,\n --> 609                 name=\"initial_value\", dtype=dtype)\n     610           # Don't use `shape or initial_value.shape` since TensorShape has\n     611           # overridden `__bool__`.\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py in convert_to_tensor(value, dtype, name, preferred_dtype, dtype_hint)\n    1095   preferred_dtype = deprecation.deprecated_argument_lookup(\n    1096       \"dtype_hint\", dtype_hint, \"preferred_dtype\", preferred_dtype)\n -> 1097   return convert_to_tensor_v2(value, dtype, preferred_dtype, name)\n    1098\n    1099\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py in convert_to_tensor_v2(value, dtype, dtype_hint, name)\n    1153       name=name,\n    1154       preferred_dtype=dtype_hint,\n -> 1155       as_ref=False)\n    1156\n    1157\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py in internal_convert_to_tensor(value, dtype, name, as_ref, preferred_dtype, ctx, accept_symbolic_tensors, accept_composite_tensors)\n    1232\n    1233     if ret is None:\n -> 1234       ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n    1235\n    1236     if ret is NotImplemented:\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/framework/constant_op.py in _constant_tensor_conversion_function(v, dtype, name, as_ref)\n     303                                          as_ref=False):\n     304   _ = as_ref\n --> 305   return constant(v, dtype=dtype, name=name)\n     306\n     307\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/framework/constant_op.py in constant(value, dtype, shape, name)\n     244   \"\"\"\n     245   return _constant_impl(value, dtype, shape, name, verify_shape=False,\n --> 246                         allow_broadcast=True)\n     247\n     248\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/framework/constant_op.py in _constant_impl(value, dtype, shape, name, verify_shape, allow_broadcast)\n     252   ctx = context.context()\n     253   if ctx.executing_eagerly():\n --> 254     t = convert_to_eager_tensor(value, ctx, dtype)\n     255     if shape is None:\n     256       return t\n \n ~/miniconda3/envs/tf2/lib/python3.6/site-packages/tensorflow/python/framework/constant_op.py in convert_to_eager_tensor(value, ctx, dtype)\n     109       return ops.EagerTensor(\n     110           value, handle, device, dtype, tensor)\n --> 111     t = ops.EagerTensor(value, handle, device, dtype)\n     112     scalar_cache[cache_key] = t\n     113     return t\n \n RuntimeError: Error copying tensor to device: /job:localhost/replica:0/task:0/device:GPU:1. /job:localhost/replica:0/task:0/device:GPU:1 unknown device.\n </denchmark-code>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ageron", "commentT": "2019-06-03T07:12:43Z", "comment_text": "\n \t\tHey, have you had a look at this example from the GPU guide at tensorflow.org\n tf.debugging.set_log_device_placement(True)\n # Create some tensors\n a = tf.constant([[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]])\n b = tf.constant([[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]])\n c = tf.matmul(a, b)\n print(c)\n To me it looks like TF is choosing which device is then suitable to execute this op:\n \n If enabled, an op will be placed on CPU if any of the following are true\n 1. there's no GPU implementation for the OP\n 2. no GPU devices are known or registered\n 3. need to co-locate with reftype input(s) which are from CPU\n \n from <denchmark-link:https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/framework/config.py>TF config</denchmark-link>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "ageron", "commentT": "2019-06-03T10:32:31Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/lufol>@lufol</denchmark-link>\n ,\n Thanks for your answer. Yes I saw this doc, that's actually why I filed this bug. I don't see what soft placement would change in this example.\n I expect soft placement to change something when the user requests a specific device but there is no op for that device, or the device does not exist. This would be useful if you want to write a program and deploy it on machines that may or may not have GPUs, for example. So on a machine without any GPU, I expect the following code to work without any error, and just fallback to placing the variable on the CPU:\n tf.config.set_soft_device_placement(True)\n with tf.device(\"/gpu:0\"):\n     x = tf.Variable(1.0)\n Perhaps I'm misunderstanding what set_soft_device_placement() is designed for?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "ageron", "commentT": "2019-06-03T10:34:38Z", "comment_text": "\n \t\tOkay, I got it: the semantics of soft placement have changed since TF 1.\n In TF 1, the following code works fine on a machine without any GPU (I just tried it):\n import tensorflow as tf\n \n with tf.device(\"/gpu:42\"): # there is no such device\n     i = tf.Variable(123) # plus integers are not allowed on GPUs\n \n # but let's make TF super soft and tolerant:\n config = tf.ConfigProto()\n config.allow_soft_placement = True\n with tf.Session(config=config) as sess:\n     sess.run(i.initializer)\n     print(sess.run(i))\n Prints 123, no problem. :)\n That's why I was surprised that it didn't work in TF 2.0. I'm actually not sure when you would ever need to call set_soft_device_placement(False) in TF 2.0, what's the use case?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "ageron", "commentT": "2019-06-03T12:13:56Z", "comment_text": "\n \t\tFrom what I understand, you either use\n \n \n tf.config.set_soft_device_placement(True) to let tf automatically decide, which device to use.\n \n \n or you use tf.config.set_soft_device_placement(False) and decide for each tensor where to place it like this with tf.device('/CPU:0'): ...\n \n \n So I guess in your case the first option would be best.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "ageron", "commentT": "2019-06-04T04:24:30Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/lufol>@lufol</denchmark-link>\n ,\n I just ran some tests, and it really seems like tf.config.set_soft_device_placement(False) makes no difference at all. Whether it's True or False, the default behavior is applied.\n I'm quite puzzled.\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "ageron", "commentT": "2019-06-04T12:03:48Z", "comment_text": "\n \t\tHave tried to reproduce on Colab with TF 2.0.0-dev20190527  with set_soft_device_placement as True as well as False and was able to get same result in both the scenarios as mentioned in the issue.\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "ageron", "commentT": "2019-06-04T19:15:06Z", "comment_text": "\n \t\tYes <denchmark-link:https://github.com/ageron>@ageron</denchmark-link>\n  , you are right.\n But I guess at least the doc does not explicitly says to execute the tensors on CPU if  according to the doc:\n \n If enabled, an op will be placed on CPU if any of the following are true\n 1. there's no GPU implementation for the OP\n 2. no GPU devices are known or registered\n 3. need to co-locate with reftype input(s) which are from CPU\n \n Maybe one could add something to the doc explaining the behaviour if tf.config.set_soft_device_placement() is set to False?\n Behaviour is reproducable <denchmark-link:https://colab.research.google.com/drive/1rtGjX9O_3rEI7yarMHMHBvu0l222dFXd>here</denchmark-link>\n .\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "ageron", "commentT": "2019-06-04T20:32:25Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/jaingaurav>@jaingaurav</denchmark-link>\n  any comments?\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "ageron", "commentT": "2019-06-13T20:18:59Z", "comment_text": "\n \t\tSorry for the delay. There have been multiple discussions about this internally. It seems that soft placement is respected by tf.function but not by the tf.device placement. We'd like to resolve this, however given it is a behavior change we're unlikely to be able to change the default in 1.0.\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "ageron", "commentT": "2019-06-13T23:47:35Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/jaingaurav>@jaingaurav</denchmark-link>\n . I'm just thinking about TF 2.x, I understand that it must keep the same behavior in TF 1.x.\n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "ageron", "commentT": "2019-07-03T23:37:49Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=29342>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=29342>No</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "7360531c13113a19120d798278cd20bec2e5e0c3", "commit_author": "Xiao Yu", "commitT": "2019-07-03 16:35:41-07:00", "commit_complexity": {"commit_NLOC": "0.6242038216560509", "commit_CCN": "0.5286624203821656", "commit_Nprams": "0.7197452229299363"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\c\\eager\\c_api.cc", "file_new_name": "tensorflow\\c\\eager\\c_api.cc", "file_complexity": {"file_NLOC": "907", "file_CCN": "188", "file_NToken": "6972"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "633", "deleted_lines": "633", "method_info": {"method_name": "TFE_OpSetDevice", "method_params": "op,device_name,status", "method_startline": "632", "method_endline": "634", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "30", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\c\\eager\\c_api_experimental_test.cc", "file_new_name": "tensorflow\\c\\eager\\c_api_experimental_test.cc", "file_complexity": {"file_NLOC": "258", "file_CCN": "15", "file_NToken": "2149"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "63,64", "method_info": {"method_name": "tensorflow::ExecuteWithProfiling", "method_params": "async", "method_startline": "41", "method_endline": "112", "method_complexity": {"method_NLOC": "63", "method_CCN": "4", "method_NToken": "578", "method_nesting_level": "2"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\core\\BUILD", "file_new_name": "tensorflow\\core\\BUILD", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "3204,3231", "deleted_lines": "3260,3278"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tensorflow\\core\\common_runtime\\colocation_graph.cc", "file_new_name": "tensorflow\\core\\common_runtime\\colocation_graph.cc", "file_complexity": {"file_NLOC": "978", "file_CCN": "187", "file_NToken": "6397"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111", "method_info": {"method_name": "tensorflow::FilterSupportedDevices", "method_params": "devices,supported_device_types,default_device", "method_startline": "58", "method_endline": "111", "method_complexity": {"method_NLOC": "46", "method_CCN": "11", "method_NToken": "327", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "1291,1292,1293,1294,1295,1296,1297,1298,1299,1300,1301,1302,1303,1304,1305,1306,1307,1308,1309,1310,1311,1312,1313,1314,1315,1316,1317,1318,1319,1320,1321,1322,1323,1324,1325,1326,1327,1328,1329,1330,1331,1332,1333,1334,1335,1336,1337,1338,1339,1340,1341,1342,1343,1344", "deleted_lines": null, "method_info": {"method_name": "tensorflow::ColocationGraph::FilterSupportedDevices", "method_params": "devices,supported_device_types,default_device", "method_startline": "1291", "method_endline": "1344", "method_complexity": {"method_NLOC": "46", "method_CCN": "11", "method_NToken": "329", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\core\\common_runtime\\colocation_graph.h", "file_new_name": "tensorflow\\core\\common_runtime\\colocation_graph.h", "file_complexity": {"file_NLOC": "120", "file_CCN": "7", "file_NToken": "804"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "251,252,253,254,255,256,257,258", "deleted_lines": null}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\core\\common_runtime\\eager\\BUILD", "file_new_name": "tensorflow\\core\\common_runtime\\eager\\BUILD", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "89", "deleted_lines": null}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "tensorflow\\core\\common_runtime\\eager\\context.cc", "file_new_name": "tensorflow\\core\\common_runtime\\eager\\context.cc", "file_complexity": {"file_NLOC": "619", "file_CCN": "127", "file_NToken": "3809"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "81", "deleted_lines": null, "method_info": {"method_name": "tensorflow::EagerContext::EagerContext", "method_params": "opts,default_device_placement_policy,default_mirroring_policy,async,device_mgr,device_mgr_owned,rendezvous,custom_kernel_creator,cluster_flr", "method_startline": "63", "method_endline": "112", "method_complexity": {"method_NLOC": "46", "method_CCN": "2", "method_NToken": "336", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": null, "deleted_lines": "752", "method_info": {"method_name": "tensorflow::EagerContext::InitializeRemoteWorker", "method_params": "remote_eager_workers,remote_device_mgr,remote_contexts,context_id,rendezvous_creator", "method_startline": "732", "method_endline": "760", "method_complexity": {"method_NLOC": "23", "method_CCN": "4", "method_NToken": "136", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "574,575,581,582,583,584,585,592,593", "deleted_lines": "574,583,584", "method_info": {"method_name": "tensorflow::EagerContext::GetClient", "method_params": "device_name,client", "method_startline": "574", "method_endline": "603", "method_complexity": {"method_NLOC": "26", "method_CCN": "5", "method_NToken": "152", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "571,572", "deleted_lines": null, "method_info": {"method_name": "tensorflow::EagerContext::GetClient", "method_params": "device,client", "method_startline": "570", "method_endline": "572", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": null, "deleted_lines": "663", "method_info": {"method_name": "tensorflow::EagerContext::InitializeRemoteMaster", "method_params": "server,worker_env,worker_session,remote_eager_workers,remote_device_manager,remote_contexts,context_id,r,local_device_mgr,keep_alive_secs,cluster_flr", "method_startline": "620", "method_endline": "730", "method_complexity": {"method_NLOC": "92", "method_CCN": "11", "method_NToken": "497", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "557,558,559,560,561,562,563,564,565,566,567", "deleted_lines": "561,562,563,564,565,567", "method_info": {"method_name": "tensorflow::EagerContext::IsLocalDeviceName", "method_params": "device_name", "method_startline": "557", "method_endline": "567", "method_complexity": {"method_NLOC": "11", "method_CCN": "7", "method_NToken": "79", "method_nesting_level": "1"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\core\\common_runtime\\eager\\context.h", "file_new_name": "tensorflow\\core\\common_runtime\\eager\\context.h", "file_complexity": {"file_NLOC": "258", "file_CCN": "41", "file_NToken": "1725"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "191", "deleted_lines": null, "method_info": {"method_name": "tensorflow::EagerContext::AllowSoftPlacement", "method_params": "", "method_startline": "191", "method_endline": "191", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "9", "method_nesting_level": "2"}}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tensorflow\\core\\common_runtime\\eager\\eager_operation.cc", "file_new_name": "tensorflow\\core\\common_runtime\\eager\\eager_operation.cc", "file_complexity": {"file_NLOC": "43", "file_CCN": "10", "file_NToken": "350"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "19,21,22,23,24,26", "deleted_lines": "19,20,22,24,25", "method_info": {"method_name": "tensorflow::EagerOperation::SetDeviceName", "method_params": "device", "method_startline": "19", "method_endline": "27", "method_complexity": {"method_NLOC": "9", "method_CCN": "4", "method_NToken": "64", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "51,52", "deleted_lines": null, "method_info": {"method_name": "tensorflow::EagerOperation::DebugString", "method_params": "", "method_startline": "46", "method_endline": "64", "method_complexity": {"method_NLOC": "17", "method_CCN": "3", "method_NToken": "158", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "18,19,21,22,23,24,26", "deleted_lines": "18,19,20,22,24,25", "method_info": {"method_name": "tensorflow::EagerOperation::SetDevice", "method_params": "device", "method_startline": "18", "method_endline": "26", "method_complexity": {"method_NLOC": "9", "method_CCN": "3", "method_NToken": "65", "method_nesting_level": "1"}}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tensorflow\\core\\common_runtime\\eager\\eager_operation.h", "file_new_name": "tensorflow\\core\\common_runtime\\eager\\eager_operation.h", "file_complexity": {"file_NLOC": "60", "file_CCN": "15", "file_NToken": "394"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "65,66,67,68", "deleted_lines": "65", "method_info": {"method_name": "tensorflow::EagerOperation::SetDevice", "method_params": "device", "method_startline": "65", "method_endline": "68", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "22", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "69,70,71", "deleted_lines": null, "method_info": {"method_name": "tensorflow::EagerOperation::GetDeviceName", "method_params": "", "method_startline": "69", "method_endline": "71", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "9", "method_nesting_level": "2"}}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 9, "file_old_name": "tensorflow\\core\\common_runtime\\eager\\execute.cc", "file_new_name": "tensorflow\\core\\common_runtime\\eager\\execute.cc", "file_complexity": {"file_NLOC": "1027", "file_CCN": "178", "file_NToken": "8179"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1034,1041,1042,1043", "deleted_lines": null, "method_info": {"method_name": "tensorflow::EagerExecute", "method_params": "op,retvals,num_retvals", "method_startline": "1026", "method_endline": "1055", "method_complexity": {"method_NLOC": "23", "method_CCN": "6", "method_NToken": "188", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "71,72,73,74,75,76,77,78", "deleted_lines": null, "method_info": {"method_name": "tensorflow::DevicesToString", "method_params": "devices", "method_startline": "71", "method_endline": "78", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "57", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "806,807,808,809,810,811,812,813,814,815,817", "deleted_lines": "840", "method_info": {"method_name": "tensorflow::EagerRemoteExecute", "method_params": "op,retvals,num_retvals", "method_startline": "802", "method_endline": "913", "method_complexity": {"method_NLOC": "73", "method_CCN": "11", "method_NToken": "642", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": null, "deleted_lines": "219,220,222,223,224,229,230,231,232,235,236", "method_info": {"method_name": "tensorflow::SelectDevice", "method_params": "ndef,ctx,device", "method_startline": "219", "method_endline": "237", "method_complexity": {"method_NLOC": "19", "method_CCN": "4", "method_NToken": "140", "method_nesting_level": "2"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "404,405,406,407,423,437,438,439,442", "deleted_lines": "411,412", "method_info": {"method_name": "tensorflow::ShouldCompileWithXLA", "method_params": "op,ctx,compile_with_xla", "method_startline": "404", "method_endline": "449", "method_complexity": {"method_NLOC": "38", "method_CCN": "11", "method_NToken": "300", "method_nesting_level": "2"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "475,476,559,572,573", "deleted_lines": "495,496,509,510", "method_info": {"method_name": "tensorflow::EagerLocalExecute", "method_params": "op,retvals,num_retvals", "method_startline": "465", "method_endline": "687", "method_complexity": {"method_NLOC": "164", "method_CCN": "27", "method_NToken": "1375", "method_nesting_level": "2"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "110,111,112,113,114", "deleted_lines": null, "method_info": {"method_name": "tensorflow::DeviceNameOrUnspecified", "method_params": "name", "method_startline": "110", "method_endline": "114", "method_complexity": {"method_NLOC": "5", "method_CCN": "2", "method_NToken": "28", "method_nesting_level": "2"}}}, "hunk_7": {"Ismethod": 1, "added_lines": null, "deleted_lines": "342,343,344,360,374,375,378", "method_info": {"method_name": "tensorflow::ShouldCompileWithXLA", "method_params": "op,device,ctx,compile_with_xla", "method_startline": "342", "method_endline": "385", "method_complexity": {"method_NLOC": "36", "method_CCN": "11", "method_NToken": "290", "method_nesting_level": "2"}}}, "hunk_8": {"Ismethod": 1, "added_lines": "238,239,240,241,243,244,245,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,293,294,295,296,297,298", "deleted_lines": null, "method_info": {"method_name": "tensorflow::SelectDevice", "method_params": "op,ndef,ctx,device", "method_startline": "238", "method_endline": "299", "method_complexity": {"method_NLOC": "55", "method_CCN": "9", "method_NToken": "405", "method_nesting_level": "2"}}}}}, "file_11": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tensorflow\\core\\common_runtime\\process_function_library_runtime.h", "file_new_name": "tensorflow\\core\\common_runtime\\process_function_library_runtime.h", "file_complexity": {"file_NLOC": "187", "file_CCN": "8", "file_NToken": "1274"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "144,145,146", "deleted_lines": null, "method_info": {"method_name": "tensorflow::ProcessFunctionLibraryRuntime::GetFunctionLibraryDefinition", "method_params": "", "method_startline": "144", "method_endline": "146", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "9", "method_nesting_level": "2"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "142", "deleted_lines": null, "method_info": {"method_name": "tensorflow::ProcessFunctionLibraryRuntime::device_set", "method_params": "", "method_startline": "142", "method_endline": "142", "method_complexity": {"method_NLOC": "1", "method_CCN": "1", "method_NToken": "9", "method_nesting_level": "2"}}}}}, "file_12": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\core\\distributed_runtime\\eager\\eager_service_impl.cc", "file_new_name": "tensorflow\\core\\distributed_runtime\\eager\\eager_service_impl.cc", "file_complexity": {"file_NLOC": "290", "file_CCN": "36", "file_NToken": "2055"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "205", "deleted_lines": "205", "method_info": {"method_name": "tensorflow::eager::EagerServiceImpl::ExecuteOp", "method_params": "operation,server_context,queue_response", "method_startline": "185", "method_endline": "238", "method_complexity": {"method_NLOC": "44", "method_CCN": "6", "method_NToken": "354", "method_nesting_level": "2"}}}}}, "file_13": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorflow\\core\\util\\device_name_utils.cc", "file_new_name": "tensorflow\\core\\util\\device_name_utils.cc", "file_complexity": {"file_NLOC": "478", "file_CCN": "185", "file_NToken": "3402"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "509,510,511,512,513,514,515,516,517,518,519,520,521", "deleted_lines": null, "method_info": {"method_name": "tensorflow::DeviceNameUtils::GetTaskName", "method_params": "pn,task", "method_startline": "509", "method_endline": "521", "method_complexity": {"method_NLOC": "13", "method_CCN": "4", "method_NToken": "111", "method_nesting_level": "1"}}}}}, "file_14": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\core\\util\\device_name_utils.h", "file_new_name": "tensorflow\\core\\util\\device_name_utils.h", "file_complexity": {"file_NLOC": "84", "file_CCN": "24", "file_NToken": "614"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "177,178,179,180", "deleted_lines": null}}}, "file_15": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\eager\\BUILD", "file_new_name": "tensorflow\\python\\eager\\BUILD", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "726,727,728,729,730,731,732,733,734,735,736,737,738", "deleted_lines": null}}}, "file_16": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tensorflow\\python\\eager\\device_placement_test.py", "file_complexity": {"file_NLOC": "81", "file_CCN": "10", "file_NToken": "595"}}}}}