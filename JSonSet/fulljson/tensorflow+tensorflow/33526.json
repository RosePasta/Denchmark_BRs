{"BR": {"BR_id": "33526", "BR_author": "MeghnaNatraj", "BRopenT": "2019-10-19T06:22:11Z", "BRcloseT": "2020-05-04T18:27:52Z", "BR_text": {"BRsummary": "Error while trying to use tf.broadcast_weights", "BRdescription": "\n Please make sure that this is a bug. As per our GitHub Policy, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template\n System information\n \n Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\n OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux (Google Colab)\n Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Google Colab\n TensorFlow installed from (source or binary): binary\n TensorFlow version (use command below): 2.0\n Python version: 3.x\n Bazel version (if compiling from source): -\n GCC/Compiler version (if compiling from source): -\n CUDA/cuDNN version: -\n GPU model and memory: -\n \n You can collect some of this information using our environment capture\n <denchmark-link:https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh>script</denchmark-link>\n \n You can also obtain the TensorFlow version with: 1. TF 1.0:  2. TF 2.0: \n Describe the current behavior\n Unable to import tf.broadcast_weights in TF 2.0.\n Describe the expected behavior\n Should be able to import tf.broadcast_weights in TF 2.0\n Code to reproduce the issue\n Provide a reproducible test case that is the bare minimum necessary to generate the problem.\n Method 1: Plain python + TF 2.0\n <denchmark-code>import tensorflow as tf     # version 2.0\n tf.broadcast_weights\n </denchmark-code>\n \n throws ** AttributeError: module 'tensorflow' has no attribute 'broadcast_weights'**\n Method 2: Codelab\n I found this error in a recent TF 2.0 + Keras tutorial - <denchmark-link:https://colab.sandbox.google.com/drive/1UCJt8EYjlzCs1H1d1X0iDGYJsHKwu-NO>https://colab.sandbox.google.com/drive/1UCJt8EYjlzCs1H1d1X0iDGYJsHKwu-NO</denchmark-link>\n \n \n Search for \"broadcast_weights\" in this codelab.\n Run all cells before this.\n Modify code \"m.update_state([0, 1, 1, 1], [0, 1, 0, 0])\" to \"m.update_state([0, 1, 1, 1], [0, 1, 0, 0]), sample_weight=[0.1,0.2,0.3,0.4]\"\n Run this cell\n throws AttributeError: module 'tensorflow' has no attribute 'broadcast_weights'\n \n Other info / logs\n Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "MeghnaNatraj", "commentT": "2019-10-21T06:59:18Z", "comment_text": "\n \t\tI have tried on colab with TF version 2.0  and was able to reproduce the issue. Please, find the gist here.<denchmark-link:https://colab.sandbox.google.com/gist/ravikyram/a2a526b2e1d95d7a70d6361efdc04da9/tensorflow-2-0-keras-crash-course.ipynb>Method1</denchmark-link>\n  and <denchmark-link:https://colab.sandbox.google.com/gist/ravikyram/dc8967174fec9d63a6630c2bff684c10/untitled288.ipynb>Method2</denchmark-link>\n .Thanks!\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "MeghnaNatraj", "commentT": "2019-10-22T19:51:20Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/MeghnaNatraj>@MeghnaNatraj</denchmark-link>\n  Thanks for finding the bug in the doc. Could you point us to the source of the notebook. Where did you find this notebook? Thanks!\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "MeghnaNatraj", "commentT": "2019-10-22T21:03:41Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/jvishnuvardhan>@jvishnuvardhan</denchmark-link>\n  I found this issue while trying out a recent tutorial published by Fran\u00e7ois Chollet\n <denchmark-link:http://link.oreilly.com/P000Q3rFWM0iPY010sCSs30>http://link.oreilly.com/P000Q3rFWM0iPY010sCSs30</denchmark-link>\n \n (Original Link: <denchmark-link:https://colab.sandbox.google.com/drive/1UCJt8EYjlzCs1H1d1X0iDGYJsHKwu-NO>https://colab.sandbox.google.com/drive/1UCJt8EYjlzCs1H1d1X0iDGYJsHKwu-NO</denchmark-link>\n )\n Search for \"tf.broadcast_weights\" in this tutorial.\n Usage 2:\n This API is also used in the TF website here: <denchmark-link:https://www.tensorflow.org/api_docs/python/tf/keras/metrics/Metric>https://www.tensorflow.org/api_docs/python/tf/keras/metrics/Metric</denchmark-link>\n \n Definition:\n \n \n \n tensorflow/tensorflow/python/ops/weights_broadcast_ops.py\n \n \n          Line 136\n       in\n       9590c4c\n \n \n \n \n \n \n  def broadcast_weights(weights, values): \n \n \n \n \n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "MeghnaNatraj", "commentT": "2019-10-23T22:22:16Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/MeghnaNatraj>@MeghnaNatraj</denchmark-link>\n  Thanks for the links. First link is already updated by the author. We will work on updating link in the . Thanks!\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "MeghnaNatraj", "commentT": "2019-10-23T22:31:22Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/MarkDaoust>@MarkDaoust</denchmark-link>\n  I think we need to update <denchmark-link:https://www.tensorflow.org/api_docs/python/tf/keras/metrics/Metric>this page</denchmark-link>\n . The issue is in this line\n sample_weight = tf.broadcast_weights(sample_weight, values)\n where tf.broadcast_weights throws AttributeError: module 'tensorflow' has no attribute 'broadcast_weights'.\n I don't think this tf.broadcast_weights is exposed to the public. Thank you!\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "MeghnaNatraj", "commentT": "2019-11-16T08:39:35Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/MarkDaoust>@MarkDaoust</denchmark-link>\n  I confirmed all the codes of the tf.broadcast_weights in \n ,\n \n \n \n tensorflow/tensorflow/python/ops/metrics.py\n \n \n          Line 23\n       in\n       9590c4c\n \n \n \n \n \n \n  from tensorflow.python.ops.metrics_impl import * \n \n \n \n \n ,\n \n \n \n tensorflow/tensorflow/python/ops/metrics_impl.py\n \n \n          Line 35\n       in\n       9590c4c\n \n \n \n \n \n \n  from tensorflow.python.ops import weights_broadcast_ops \n \n \n \n \n \n And these all seem fine. But still, tf.broadcast_weights throughs Attribute error.\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "MeghnaNatraj", "commentT": "2020-02-06T16:38:30Z", "comment_text": "\n \t\ttf.broadcast_weights does not work and is still referenced here (<denchmark-link:https://www.tensorflow.org/api_docs/python/tf/keras/metrics/Metric>https://www.tensorflow.org/api_docs/python/tf/keras/metrics/Metric</denchmark-link>\n ).\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "MeghnaNatraj", "commentT": "2020-05-03T20:38:33Z", "comment_text": "\n \t\tThe issue is that tf.broadcast_weights is not exposed through tf_export, wondering if it makes sense to expose this API given it is referenced in multiple places?\n /cc <denchmark-link:https://github.com/orgs/tensorflow/teams/api-owners>@tensorflow/api-owners</denchmark-link>\n \n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "MeghnaNatraj", "commentT": "2020-05-04T14:54:21Z", "comment_text": "\n \t\tI think we need to remove the reference to tf.broadcast_weights from the documentation.\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "MeghnaNatraj", "commentT": "2020-05-04T17:45:54Z", "comment_text": "\n \t\tI take a look at the usage of tf.broadcast_weights in docstring. The related docstring is just an example,  and broadcast_weights by itself is just to make sure it follow a subset of broadcast rules than tf.multiply. It actually makes sense to remove this line as it does not add much to be an example in docs:\n          sample_weight = tf.cast(sample_weight, self.dtype)\n -        sample_weight = tf.broadcast_weights(sample_weight, values)\n          values = tf.multiply(values, sample_weight)\n Created a PR <denchmark-link:https://github.com/tensorflow/tensorflow/pull/39161>#39161</denchmark-link>\n  for the fix.\n \t\t"}}}, "commit": {"commit_id": "5dd0b6a589f4f2c66b66a0d022a3d753588bca80", "commit_author": "Mark Daoust", "commitT": "2020-05-04 11:25:40-07:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow\\python\\keras\\metrics.py", "file_new_name": "tensorflow\\python\\keras\\metrics.py", "file_complexity": {"file_NLOC": "2690", "file_CCN": "211", "file_NToken": "9317"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "141", "deleted_lines": "141"}}}}}}