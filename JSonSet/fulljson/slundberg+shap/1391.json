{"BR": {"BR_id": "1391", "BR_author": "yuuuxt", "BRopenT": "2020-08-29T16:16:31Z", "BRcloseT": "2020-08-29T17:27:18Z", "BR_text": {"BRsummary": "waterfall & bar plot broken with matplotlib&gt;=3.3.0", "BRdescription": "\n tested on  and .\n with  plots work well.\n to reproduce: have  and run this <denchmark-link:https://github.com/slundberg/shap/blob/master/notebooks/general/Explainable%20AI%20with%20Shapley%20Values.ipynb>sample notebook</denchmark-link>\n .\n broken plot samples:\n <denchmark-link:https://user-images.githubusercontent.com/3153534/91641204-67093d80-ea55-11ea-8af5-59a300c7e9b7.png></denchmark-link>\n \n <denchmark-link:https://user-images.githubusercontent.com/3153534/91641208-6b355b00-ea55-11ea-8ac5-3c12f342f403.png></denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "yuuuxt", "commentT": "2020-08-29T16:49:41Z", "comment_text": "\n \t\tThanks! That explains why some others had seen those layout issues.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "yuuuxt", "commentT": "2020-08-29T17:24:17Z", "comment_text": "\n \t\tThe issue turned out to be that matplotlib started \"merging\" tick marks that we at the same location in 3.3. And this broke a lot of the overlays we were using to draw multi-color labels. It is now fixed :) (by adding 1e-8 to the second copy of the tick marks)\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "yuuuxt", "commentT": "2020-08-30T01:53:47Z", "comment_text": "\n \t\tThanks for your quick response and the fix! :)\n \t\t"}}}, "commit": {"commit_id": "13c6141ebe459f34c0b69293135124eca1211fa1", "commit_author": "Scott Lundberg", "commitT": "2020-08-29 10:27:08-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "notebooks\\plots\\bar.ipynb", "file_new_name": "notebooks\\plots\\bar.ipynb", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "27,28,29,30,31,32,33,34,35,42,65,97,133,169,204,254,279,304,312", "deleted_lines": "27,34,57,89,125,161,196,246,271,296,304"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "notebooks\\plots\\waterfall.ipynb", "file_new_name": "notebooks\\plots\\waterfall.ipynb", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "32,65,73,97,129,136", "deleted_lines": "32,65,73,97,129,136"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "shap\\explainers\\_exact.py", "file_new_name": "shap\\explainers\\_exact.py", "file_complexity": {"file_NLOC": "176", "file_CCN": "46", "file_NToken": "1628"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "75", "deleted_lines": "75", "method_info": {"method_name": "explain_row", "method_params": "self,row_args,max_evals,main_effects,error_bounds,batch_size,outputs,silent", "method_startline": "75", "method_endline": "151", "method_complexity": {"method_NLOC": "41", "method_CCN": "13", "method_NToken": "422", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "75", "deleted_lines": "75", "method_info": {"method_name": "explain_row", "method_params": "self,row_args,max_evals,main_effects,error_bounds,batch_size,silent", "method_startline": "75", "method_endline": "151", "method_complexity": {"method_NLOC": "41", "method_CCN": "13", "method_NToken": "420", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "shap\\explainers\\_explainer.py", "file_new_name": "shap\\explainers\\_explainer.py", "file_complexity": {"file_NLOC": "169", "file_CCN": "36", "file_NToken": "1467"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "276", "deleted_lines": "276", "method_info": {"method_name": "explain_row", "method_params": "self,row_args,max_evals,main_effects,error_bounds,outputs,silent,kwargs", "method_startline": "276", "method_endline": "290", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "25", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "276", "deleted_lines": "276", "method_info": {"method_name": "explain_row", "method_params": "self,row_args,max_evals,main_effects,error_bounds,silent,kwargs", "method_startline": "276", "method_endline": "290", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "23", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "shap\\explainers\\_partition.py", "file_new_name": "shap\\explainers\\_partition.py", "file_complexity": {"file_NLOC": "687", "file_CCN": "138", "file_NToken": "6985"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "499,508,510,516,517,518,519,520,521,522,523,524,555,556,557,558,559,560,561,562,563", "deleted_lines": "499,501,507,508,509,510,511,512,513,514,515,546", "method_info": {"method_name": "owen", "method_params": "self,fm,f00,f11,npartitions,output_indexes,fixed_context,batch_size,silent", "method_startline": "499", "method_endline": "634", "method_complexity": {"method_NLOC": "78", "method_CCN": "27", "method_NToken": "830", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "491,492,493,499,508,510,516,517,518,519,520,521,522,523,524,555,556,557,558,559,560,561,562,563", "deleted_lines": "490,499,501,507,508,509,510,511,512,513,514,515,546", "method_info": {"method_name": "owen", "method_params": "self,fm,npartitions,output_indexes,fixed_context,batch_size,silent", "method_startline": "490", "method_endline": "617", "method_complexity": {"method_NLOC": "83", "method_CCN": "29", "method_NToken": "928", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "428,435,436,437,438,439,440,445,446,447,448,449,450,451,452,455,456,457,458,459,464,466,467,468,469,470,471,472,473,474,475,476,478,479,480,481,482,483,484,485,486,487,488,491,492,493", "deleted_lines": "434,435,440,441,442,443,444,445,446,452,454,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,476,477,478,480,482,483,484,490", "method_info": {"method_name": "explain_row", "method_params": "self,row_args,max_evals,main_effects,error_bounds,batch_size,outputs,silent", "method_startline": "428", "method_endline": "497", "method_complexity": {"method_NLOC": "35", "method_CCN": "11", "method_NToken": "387", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "475,476,478,479,480,481,482,483,484,485,486,487", "deleted_lines": "476,477,478,480,482,483,484", "method_info": {"method_name": "explain_row.lower_credit", "method_params": "i,value", "method_startline": "475", "method_endline": "487", "method_complexity": {"method_NLOC": "13", "method_CCN": "4", "method_NToken": "154", "method_nesting_level": "2"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "428,435,436,437,438,439,440,445,446,447,448,449,450,451,452,455,456,457,458,459,464,466,467,468,469,470,471,472,473,474,475,476,478,479,480,481,482,483,484,485,486,487,488", "deleted_lines": "427,434,435,440,441,442,443,444,445,446,452,454,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,476,477,478,480,482,483,484", "method_info": {"method_name": "explain_row", "method_params": "self,row_args,max_evals,main_effects,error_bounds,batch_size,silent", "method_startline": "427", "method_endline": "488", "method_complexity": {"method_NLOC": "38", "method_CCN": "8", "method_NToken": "325", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "84", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,model,masker,partition_tree,output_names,link", "method_startline": "22", "method_endline": "104", "method_complexity": {"method_NLOC": "17", "method_CCN": "7", "method_NToken": "211", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "shap\\explainers\\_permutation.py", "file_new_name": "shap\\explainers\\_permutation.py", "file_complexity": {"file_NLOC": "61", "file_CCN": "11", "file_NToken": "458"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "42", "deleted_lines": "42", "method_info": {"method_name": "explain_row", "method_params": "self,row_args,max_evals,main_effects,error_bounds,batch_size,outputs,silent", "method_startline": "42", "method_endline": "100", "method_complexity": {"method_NLOC": "37", "method_CCN": "9", "method_NToken": "324", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "42", "deleted_lines": "42", "method_info": {"method_name": "explain_row", "method_params": "self,row_args,max_evals,main_effects,error_bounds,batch_size,silent", "method_startline": "42", "method_endline": "100", "method_complexity": {"method_NLOC": "37", "method_CCN": "9", "method_NToken": "322", "method_nesting_level": "1"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "shap\\maskers\\_image.py", "file_new_name": "shap\\maskers\\_image.py", "file_complexity": {"file_NLOC": "127", "file_CCN": "36", "file_NToken": "1169"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "112,114,116,121,122,124,126,129,175,176,177,178,179,180,181,182", "deleted_lines": "109,111,113,118,119,121,123,126,172", "method_info": {"method_name": "build_partition_tree", "method_params": "self", "method_startline": "107", "method_endline": "182", "method_complexity": {"method_NLOC": "55", "method_CCN": "14", "method_NToken": "494", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "52,54,57,75", "deleted_lines": "54,72", "method_info": {"method_name": "__call__", "method_params": "self,mask,x", "method_startline": "52", "method_endline": "88", "method_complexity": {"method_NLOC": "27", "method_CCN": "13", "method_NToken": "297", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "27,29,30,31,32,43,47,49", "deleted_lines": "27,29,40,44,46,49", "method_info": {"method_name": "__init__", "method_params": "self,mask_value,shape", "method_startline": "12", "method_endline": "50", "method_complexity": {"method_NLOC": "21", "method_CCN": "6", "method_NToken": "179", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "49,52,54,57,75", "deleted_lines": "49,51,54,72", "method_info": {"method_name": "__call__", "method_params": "self,x,mask", "method_startline": "49", "method_endline": "85", "method_complexity": {"method_NLOC": "27", "method_CCN": "13", "method_NToken": "299", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "94,95,96,101", "deleted_lines": "93,98", "method_info": {"method_name": "inpaint", "method_params": "self,x,mask,method", "method_startline": "93", "method_endline": "105", "method_complexity": {"method_NLOC": "13", "method_CCN": "2", "method_NToken": "138", "method_nesting_level": "1"}}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "shap\\maskers\\_text.py", "file_new_name": "shap\\maskers\\_text.py", "file_complexity": {"file_NLOC": "226", "file_CCN": "89", "file_NToken": "2171"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "33", "deleted_lines": "33", "method_info": {"method_name": "__init__", "method_params": "self,tokenizer,mask_token,output_type", "method_startline": "12", "method_endline": "37", "method_complexity": {"method_NLOC": "20", "method_CCN": "3", "method_NToken": "180", "method_nesting_level": "1"}}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "shap\\plots\\_bar.py", "file_new_name": "shap\\plots\\_bar.py", "file_complexity": {"file_NLOC": "345", "file_CCN": "106", "file_NToken": "3222"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "161,162", "deleted_lines": "161,162", "method_info": {"method_name": "bar", "method_params": "shap_values,max_display,order,clustering,cluster_threshold,show", "method_startline": "18", "method_endline": "260", "method_complexity": {"method_NLOC": "151", "method_CCN": "51", "method_NToken": "1570", "method_nesting_level": "0"}}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "shap\\plots\\_image.py", "file_new_name": "shap\\plots\\_image.py", "file_complexity": {"file_NLOC": "82", "file_CCN": "26", "file_NToken": "1061"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "48,49", "deleted_lines": "48,49", "method_info": {"method_name": "image", "method_params": "shap_values,pixel_values,labels,width,aspect,hspace,labelpad,show", "method_startline": "15", "method_endline": "128", "method_complexity": {"method_NLOC": "73", "method_CCN": "26", "method_NToken": "1024", "method_nesting_level": "0"}}}}}, "file_10": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "shap\\plots\\_waterfall.py", "file_new_name": "shap\\plots\\_waterfall.py", "file_complexity": {"file_NLOC": "398", "file_CCN": "73", "file_NToken": "4345"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "233,234,258,267,281", "deleted_lines": "233,257,266", "method_info": {"method_name": "waterfall", "method_params": "shap_values,max_display,show", "method_startline": "18", "method_endline": "291", "method_complexity": {"method_NLOC": "192", "method_CCN": "36", "method_NToken": "2147", "method_nesting_level": "0"}}}}}}}}