{"BR": {"BR_id": "110", "BR_author": "UltimateNidhogg", "BRopenT": "2019-09-12T11:52:45Z", "BRcloseT": "2019-09-25T14:31:55Z", "BR_text": {"BRsummary": "ByteScheduler: 'ByteCore' object has no attribute 'set_broadcaster' in Pytorch plugin", "BRdescription": "\n \n The core.set_broadcaster function is called in <denchmark-link:https://github.com/bytedance/byteps/blob/bytescheduler/bytescheduler/bytescheduler/pytorch/horovod.py>horovod.py</denchmark-link>\n , but this function seems not declared in <denchmark-link:https://github.com/bytedance/byteps/blob/bytescheduler/bytescheduler/bytescheduler/common/bytecore.py>bytecore.py</denchmark-link>\n \n To Reproduce\n Steps to reproduce the behavior:\n \n sudo nvidia-docker run -it --network=host -v /mnt/share/ssh:/root/.ssh bsc-pytorch-horovod:20190911-145015\n root@mynode:~/byteps/byteschuler/examples# mpirun --allow-run-as-root -np 1 -H my_IP:1 -mca plm_rsh_args \"-p 12945\" python pytorch_horovod_benchmark.py\n See error\n \n Screenshot\n <denchmark-code>root@mynode:~/byteps/byteschuler/examples# mpirun --allow-run-as-root -np 1 -H my_IP:1 -mca plm_rsh_args \"-p 12945\" python pytorch_horovod_benchmark.py \n hijack function <unbound method _DistributedOptimizer._register_hooks>\n 16:44:58.106 comm.py:185 INFO: Comm host: localhost, port: 58888\n 16:44:58.107 search.py:119 INFO: Bayesian Search is enabled, space {'credit': (4.0, 64.0)}, max_num_steps 15.\n 16:44:58.107 bytecore.py:124 INFO: start Core 0: credit 4000000.0, partition 1000000, credit tuning 1, partition tuning 0.\n Traceback (most recent call last):\n   File \"pytorch_horovod_benchmark.py\", line 78, in <module>\n     optimizer = bsc.ScheduledOptimizer(model, optimizer, args.num_warmup_batches + args.num_iters * args.num_batches_per_iter)\n   File \"/usr/local/lib/python2.7/dist-packages/bytescheduler-0.1.0-py2.7-linux-x86_64.egg/bytescheduler/pytorch/horovod.py\", line 79, in __init__\n     core.set_broadcaster(self._broadcast_partition, synchronize)\n AttributeError: 'ByteCore' object has no attribute 'set_broadcaster'\n </denchmark-code>\n \n Environment (please complete the following information):\n \n Docker Image: bsc-pytorch-horovod (made by pytorch_horovod.Dockerfile with some bugfix)\n OS: Ubuntu18.04 (in the docker image)\n GCC version: gcc version 5.4.0 (in the docker image)\n CUDA and NCCL version: NCCL2.4.7-1 + CUDA10.0 (in the docker image)\n Framework (TF, PyTorch, MXNet): PyTorch1.2.0\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "UltimateNidhogg", "commentT": "2019-09-12T13:00:40Z", "comment_text": "\n \t\t@bjwdttz Thanks for your issue. For a quick fix, please comment out this line \"core.set_broadcaster(self._broadcast_partition, synchronize)\". We will fix it soon.\n \t\t"}}}, "commit": {"commit_id": "0088c0e6d4ccfaa78a079957cd1434764a8ce352", "commit_author": "yhpeng", "commitT": "2019-09-12 21:51:48+08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "README.md", "file_new_name": "README.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "80,81,82,83,84", "deleted_lines": "73"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "byteps\\common\\operations.cc", "file_new_name": "byteps\\common\\operations.cc", "file_complexity": {"file_NLOC": "261", "file_CCN": "50", "file_NToken": "2124"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "242,277", "deleted_lines": "242,277", "method_info": {"method_name": "byteps::common::InitTensor", "method_params": "context,size,dtype,cpubuff", "method_startline": "200", "method_endline": "293", "method_complexity": {"method_NLOC": "66", "method_CCN": "10", "method_NToken": "650", "method_nesting_level": "2"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "bytescheduler\\bytescheduler\\pytorch\\horovod.py", "file_new_name": "bytescheduler\\bytescheduler\\pytorch\\horovod.py", "file_complexity": {"file_NLOC": "250", "file_CCN": "78", "file_NToken": "2085"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "79", "method_info": {"method_name": "__init__", "method_params": "self,model,hvd_opt,num_steps", "method_startline": "21", "method_endline": "79", "method_complexity": {"method_NLOC": "30", "method_CCN": "6", "method_NToken": "248", "method_nesting_level": "1"}}}}}}}}