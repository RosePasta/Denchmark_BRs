{"BR": {"BR_id": "468", "BR_author": "buoyancy99", "BRopenT": "2020-04-25T16:36:33Z", "BRcloseT": "2020-05-26T18:53:25Z", "BR_text": {"BRsummary": "TopK error from onnx model misses \"k\" attribute", "BRdescription": "\n File \"/opt/intel/openvino_2019.3.376/deployment_tools/model_optimizer/extensions/front/TopKNormalize.py\", line 38, in find_and_replace_pattern\n assert topk_node.has_valid('k'), 'The TopK node \"{}\" misses \"k\" attribute'.format(topk_node.name)\n AssertionError: The TopK node \"TopK_101\" misses \"k\" attribute\n Some debug gives me:\n \n \n 'k' is not in self.graph.node[\"TopK_101\"].keys()\n \n \n However, 'k' is present in the attribute of self.graph.node[\"TopK_101\"].['pb']\n \n \n input: \"253\"\n output: \"254\"\n output: \"255\"\n name: \"TopK_101\"\n op_type: \"TopK\"\n attribute {\n name: \"axis\"\n i: 3\n type: INT\n }\n attribute {\n name: \"k\"\n i: 100\n type: INT\n }\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "buoyancy99", "commentT": "2020-05-25T06:36:07Z", "comment_text": "\n \t\tThis is a known bug which occurs because of the specification change of the ONNX TopK operation. Previously it had 'K' as attribute and starting from opset-10 it is an input.\n <denchmark-link:https://github.com/mvafin>@mvafin</denchmark-link>\n , please, make the TopK extractor capable support both cases.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "buoyancy99", "commentT": "2020-05-25T08:17:17Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/jane-intel>@jane-intel</denchmark-link>\n  will take care of this issue.\n \t\t"}}}, "commit": {"commit_id": "73f3b7c8fc4b2844576f831e958d1fce9c4dec74", "commit_author": "Evgenya Stepyreva", "commitT": "2020-05-26 21:53:24+03:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "model-optimizer\\extensions\\front\\onnx\\top_k_ext.py", "file_new_name": "model-optimizer\\extensions\\front\\onnx\\top_k_ext.py", "file_complexity": {"file_NLOC": "32", "file_CCN": "4", "file_NToken": "148"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "28,29,30,31,32,33,34,35,36,37,38,39,40,41", "deleted_lines": "28,29", "method_info": {"method_name": "extract", "method_params": "cls,node", "method_startline": "27", "method_endline": "42", "method_complexity": {"method_NLOC": "10", "method_CCN": "4", "method_NToken": "102", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "model-optimizer\\mo\\front\\onnx\\extractors\\utils.py", "file_new_name": "model-optimizer\\mo\\front\\onnx\\extractors\\utils.py", "file_complexity": {"file_NLOC": "65", "file_CCN": "17", "file_NToken": "359"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "23,24,25", "deleted_lines": null, "method_info": {"method_name": "onnx_node_has_attr", "method_params": "Node,str", "method_startline": "23", "method_endline": "25", "method_complexity": {"method_NLOC": "3", "method_CCN": "3", "method_NToken": "37", "method_nesting_level": "0"}}}}}}}}