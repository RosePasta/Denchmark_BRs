{"BR": {"BR_id": "16780", "BR_author": "zenghsh3", "BRopenT": "2019-04-11T04:34:08Z", "BRcloseT": "2019-04-17T06:56:04Z", "BR_text": {"BRsummary": "[Bug] sampling_id op \u5728\u7f16\u8bd1\u65f6\u63a8\u65ad\u7684shape\u4e0d\u6b63\u786e", "BRdescription": "\n paddlepaddle-gpu==1.3.2.post97\n from paddle import fluid\n import numpy as np\n \n x = fluid.layers.data(name='x', shape=[3], dtype='float32')\n output = fluid.layers.sampling_id(x)\n print('Compile shape: ', output.shape)\n \n place = fluid.CPUPlace()\n exe = fluid.Executor(place=place)\n exe.run(fluid.default_startup_program())\n \n feed = {'x': np.array([[0.2, 0.3, 0.5], [0.2, 0.3, 0.5]], dtype='float32')}\n output_np = exe.run(feed=feed, fetch_list=[output])[0]\n \n print('Runtime shape: ', output_np.shape)\n <denchmark-code>Compile shape:  (-1, 3)\n Runtime shape:  (2,)\n </denchmark-code>\n \n Compile shape \u5e94\u8be5\u662f(-1)\uff0c\u8fd9\u4e2a\u9519\u8bef\u4f1a\u5f71\u54cd\u540e\u7eed\u7f51\u7edc\u7684\u6784\u5efa\u3002\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "zenghsh3", "commentT": "2019-04-11T05:44:11Z", "comment_text": "\n \t\t\u611f\u8c22\u60a8\u7684\u53cd\u9988\uff0c\u8fd9\u5e94\u8be5\u662f\u4e00\u4e2abug\uff0c\u6211\u4eec\u4f1a\u5c3d\u5feb\u4fee\u590d\u3002\n \t\t"}}}, "commit": {"commit_id": "2b61db07d1300165e28596a8595bfef56265f37a", "commit_author": "tangwei12", "commitT": "2019-04-17 14:56:03+08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "paddle\\fluid\\operators\\sampling_id_op.cc", "file_new_name": "paddle\\fluid\\operators\\sampling_id_op.cc", "file_complexity": {"file_NLOC": "54", "file_CCN": "2", "file_NToken": "310"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "31,32,38,39", "deleted_lines": "31,32,33,39", "method_info": {"method_name": "paddle::operators::SamplingIdOp::InferShape", "method_params": "ctx", "method_startline": "26", "method_endline": "42", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "132", "method_nesting_level": "3"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\paddle\\fluid\\tests\\unittests\\test_sampling_id_op.py", "file_new_name": "python\\paddle\\fluid\\tests\\unittests\\test_sampling_id_op.py", "file_complexity": {"file_NLOC": "51", "file_CCN": "5", "file_NToken": "488"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79", "deleted_lines": null, "method_info": {"method_name": "test_shape", "method_params": "self", "method_startline": "62", "method_endline": "79", "method_complexity": {"method_NLOC": "15", "method_CCN": "1", "method_NToken": "180", "method_nesting_level": "1"}}}}}}}}