{"BR": {"BR_id": "225", "BR_author": "thisray", "BRopenT": "2020-11-16T11:52:57Z", "BRcloseT": "2020-11-16T15:27:47Z", "BR_text": {"BRsummary": "[Bug] arguments order error in explained_variance()", "BRdescription": "\n Hi,\n The calculation method of explained variance in the comment is: 1 - Var[y-ypred] / Var[y]. In the scenario of value loss, I think the y_true is return and y_pred is value.\n The calculation of explained variance in ppo.py:\n <denchmark-link:https://github.com/DLR-RM/stable-baselines3/blob/master/stable_baselines3/ppo/ppo.py#L223>https://github.com/DLR-RM/stable-baselines3/blob/master/stable_baselines3/ppo/ppo.py#L223</denchmark-link>\n \n <denchmark-code>explained_var = explained_variance(self.rollout_buffer.returns.flatten(), self.rollout_buffer.values.flatten())\n </denchmark-code>\n \n But the arguments in this function:\n <denchmark-link:https://github.com/DLR-RM/stable-baselines3/blob/master/stable_baselines3/common/utils.py#L42>https://github.com/DLR-RM/stable-baselines3/blob/master/stable_baselines3/common/utils.py#L42</denchmark-link>\n \n <denchmark-code>def explained_variance(y_pred: np.ndarray, y_true: np.ndarray) -> np.ndarray:\n </denchmark-code>\n \n It seems the order is not right?\n thanks!\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "thisray", "commentT": "2020-11-16T11:59:37Z", "comment_text": "\n \t\tYou are right, it seems to be the wrong way around! <denchmark-link:https://github.com/araffin>@araffin</denchmark-link>\n  Can you double-confirm this, as you seem to be one who touched the code last?\n In case this is a bug, we need to calls to explained_variance for typos like this.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "thisray", "commentT": "2020-11-16T12:07:57Z", "comment_text": "\n \t\tHello,\n nice catch ;) (the good news is that this variable is only used for debugging purposes)\n We would be happy if you could submit a PR that solves this issue ;)\n EDIT: the bug may be present in A2C too\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "thisray", "commentT": "2020-11-16T12:12:01Z", "comment_text": "\n \t\tYes, it just a little bug. Many thanks for this library, it is very useful and make me learn a lot!\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "thisray", "commentT": "2020-11-16T12:16:37Z", "comment_text": "\n \t\t\n Yes, it just a little bug. Many thanks for this library, it is very useful and make me learn a lot!\n \n I edited my message a bit late, but we would be happy if you could submit a PR that solves this issue ;)\n \t\t"}}}, "commit": {"commit_id": "5ddda44a747c8c07c607493c06024f1cae6f89b0", "commit_author": "thisray", "commitT": "2020-11-16 16:27:46+01:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\misc\\changelog.rst", "file_new_name": "docs\\misc\\changelog.rst", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "30,519", "deleted_lines": "518"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "stable_baselines3\\a2c\\a2c.py", "file_new_name": "stable_baselines3\\a2c\\a2c.py", "file_complexity": {"file_NLOC": "156", "file_CCN": "8", "file_NToken": "860"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "159", "deleted_lines": "159", "method_info": {"method_name": "train", "method_params": "self", "method_startline": "111", "method_endline": "168", "method_complexity": {"method_NLOC": "35", "method_CCN": "6", "method_NToken": "348", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "stable_baselines3\\ppo\\ppo.py", "file_new_name": "stable_baselines3\\ppo\\ppo.py", "file_complexity": {"file_NLOC": "210", "file_CCN": "17", "file_NToken": "1275"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "223", "deleted_lines": "223", "method_info": {"method_name": "train", "method_params": "self", "method_startline": "133", "method_endline": "239", "method_complexity": {"method_NLOC": "68", "method_CCN": "12", "method_NToken": "692", "method_nesting_level": "1"}}}}}}}}