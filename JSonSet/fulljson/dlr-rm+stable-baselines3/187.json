{"BR": {"BR_id": "187", "BR_author": "SwamyDev", "BRopenT": "2020-10-14T14:04:52Z", "BRcloseT": "2020-10-16T15:34:50Z", "BR_text": {"BRsummary": "[Bug] Excluding json or csv formats is ignored by the logger's record function", "BRdescription": "\n Describe the bug\n When running record(\"some_log_tag\", some_data, exclude=(\"json\", \"csv\")) the exclude parameter is ignored and some_data is still logged to json and csv.\n Code example\n The following is a minimal test code snipped that reproduces the bug and could also be used as a basis for an automated regression test\n from stable_baselines3.common.logger import make_output_format, read_json\n \n \n def test_ignore_json_formatter(tmp_path):\n     writer = make_output_format(\"json\", tmp_path)\n     writer.write(dict(some_tag=42), dict(some_tag=(\"json\")))\n     assert read_json(tmp_path / \"progress.json\").empty\n For a real regression test I'd use test parametrization to check all the different format writers in one test, following the pattern of test_logger.py.\n System Info\n Describe the characteristic of your environment:\n \n Install: pip install -e .[extra] within the source root directory\n python 3.8\n PyTorch 1.6.0\n Gym 0.17.3\n \n As already mentioned in <denchmark-link:https://github.com/DLR-RM/stable-baselines3/issues/186>#186</denchmark-link>\n  I'd be happy to provide a PR with a fix and regression tests. Let me know if there is anything else I should consider, or if I should proceed with a PR.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "SwamyDev", "commentT": "2020-10-14T14:35:56Z", "comment_text": "\n \t\t\n As already mentioned in #186 I'd be happy to provide a PR with a fix and regression tests. Let me know if there is anything else I should consider, or if I should proceed with a PR.\n \n Please go ahead ;) (don't forget to read the contributing guide)\n \t\t"}}}, "commit": {"commit_id": "97b81f9e9ee2e5ba7eb37328bbd21f8eade44e72", "commit_author": "Bernhard Raml", "commitT": "2020-10-16 17:34:49+02:00", "commit_complexity": {"commit_NLOC": "0.43137254901960786", "commit_CCN": "0.6470588235294118", "commit_Nprams": "0.6666666666666666"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\misc\\changelog.rst", "file_new_name": "docs\\misc\\changelog.rst", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "20,459", "deleted_lines": "458"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "stable_baselines3\\common\\logger.py", "file_new_name": "stable_baselines3\\common\\logger.py", "file_complexity": {"file_NLOC": "484", "file_CCN": "104", "file_NToken": "2715"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "83", "deleted_lines": "83", "method_info": {"method_name": "write", "method_params": "self,Dict,Dict,int", "method_startline": "77", "method_endline": "120", "method_complexity": {"method_NLOC": "31", "method_CCN": "11", "method_NToken": "308", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "171,175,178,179", "deleted_lines": null, "method_info": {"method_name": "write.cast_to_json_serializable", "method_params": "Any", "method_startline": "171", "method_endline": "179", "method_complexity": {"method_NLOC": "7", "method_CCN": "4", "method_NToken": "45", "method_nesting_level": "2"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "155,156", "deleted_lines": "155,156", "method_info": {"method_name": "is_excluded", "method_params": "str", "method_startline": "155", "method_endline": "156", "method_complexity": {"method_NLOC": "2", "method_CCN": "3", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "143,144", "deleted_lines": null, "method_info": {"method_name": "filter_excluded_keys", "method_params": "str,str,str,str,str", "method_startline": "143", "method_endline": "144", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "33", "method_nesting_level": "0"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "171,175,178,179,180,181,182,183,184", "deleted_lines": null, "method_info": {"method_name": "write", "method_params": "self,str,str,str,str,int", "method_startline": "170", "method_endline": "186", "method_complexity": {"method_NLOC": "8", "method_CCN": "2", "method_NToken": "92", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 8, "file_old_name": "tests\\test_logger.py", "file_new_name": "tests\\test_logger.py", "file_complexity": {"file_NLOC": "124", "file_CCN": "24", "file_NToken": "797"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "156,157,158,159,160,161,162,163,164", "deleted_lines": null, "method_info": {"method_name": "test_exclude_keys", "method_params": "tmp_path,read_log,_format", "method_startline": "156", "method_endline": "164", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "62", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "51,52", "deleted_lines": null, "method_info": {"method_name": "empty", "method_params": "self", "method_startline": "51", "method_endline": "52", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "14", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90", "deleted_lines": "74,86,87,88,89", "method_info": {"method_name": "read_log.read_fn", "method_params": "_format", "method_startline": "60", "method_endline": "90", "method_complexity": {"method_NLOC": "28", "method_CCN": "14", "method_NToken": "238", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "54,55", "deleted_lines": null, "method_info": {"method_name": "__repr__", "method_params": "self", "method_startline": "54", "method_endline": "55", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "8", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "131,143", "deleted_lines": null, "method_info": {"method_name": "test_make_output", "method_params": "tmp_path,read_log,_format", "method_startline": "131", "method_endline": "144", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "50", "method_nesting_level": "0"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92", "deleted_lines": "74,86,87,88,89", "method_info": {"method_name": "read_log", "method_params": "tmp_path,capsys", "method_startline": "59", "method_endline": "92", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "11", "method_nesting_level": "0"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90", "deleted_lines": "74,86,87,88,89", "method_info": {"method_name": "test_make_output", "method_params": "tmp_path,_format", "method_startline": "74", "method_endline": "90", "method_complexity": {"method_NLOC": "10", "method_CCN": "4", "method_NToken": "62", "method_nesting_level": "0"}}}, "hunk_7": {"Ismethod": 1, "added_lines": "46,47,48", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,str,Sequence", "method_startline": "46", "method_endline": "48", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "23", "method_nesting_level": "1"}}}}}}}}