{"BR": {"BR_id": "513", "BR_author": "fhieber", "BRopenT": "2018-08-23T13:54:05Z", "BRcloseT": "2018-08-24T17:43:56Z", "BR_text": {"BRsummary": "No error thrown when training with source factor files but no validation source factor files given", "BRdescription": "\n Sockeye does not throw in the beginning of training when using plain training data + source factor files but without providing a corresponding source factor file for the validation data.\n It will then crash at the first checkpoint with a cryptic error message:\n <denchmark-code>[INFO:sockeye.training] Checkpoint [1]\tTrain-perplexity=928.900834\n infer_shape error. Arguments:\n   source: (10, 10, 1)\n   target: (10, 10)\n   target_label: (10, 10)\n [ERROR:__main__] Uncaught exception\n Traceback (most recent call last):\n   File \"/Users/fhieber/miniconda3/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\n     \"__main__\", mod_spec)\n   File \"/Users/fhieber/miniconda3/lib/python3.6/runpy.py\", line 85, in _run_code\n     exec(code, run_globals)\n   File \"/Users/fhieber/workspace/nmt/src/Sockeye/sockeye/train.py\", line 881, in <module>\n     main()\n   File \"/Users/fhieber/workspace/nmt/src/Sockeye/sockeye/train.py\", line 756, in main\n     train(args)\n   File \"/Users/fhieber/workspace/nmt/src/Sockeye/sockeye/train.py\", line 877, in train\n     existing_parameters=args.params)\n   File \"/Users/fhieber/workspace/nmt/src/Sockeye/sockeye/training.py\", line 573, in fit\n     self._evaluate(validation_iter, metric_val)\n   File \"/Users/fhieber/workspace/nmt/src/Sockeye/sockeye/training.py\", line 711, in _evaluate\n     self.model.evaluate(val_iter, val_metric)\n   File \"/Users/fhieber/workspace/nmt/src/Sockeye/sockeye/training.py\", line 240, in evaluate\n     self.module.forward(eval_batch, is_train=False)\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/module/bucketing_module.py\", line 456, in forward\n     self._curr_module.forward(data_batch, is_train=is_train)\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/module/module.py\", line 610, in forward\n     self.reshape(new_dshape, new_lshape)\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/module/module.py\", line 471, in reshape\n     self._exec_group.reshape(self._data_shapes, self._label_shapes)\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/module/executor_group.py\", line 382, in reshape\n     self.bind_exec(data_shapes, label_shapes, reshape=True)\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/module/executor_group.py\", line 358, in bind_exec\n     allow_up_sizing=True, **dict(data_shapes_i + label_shapes_i))\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/executor.py\", line 402, in reshape\n     arg_shapes, _, aux_shapes = self._symbol.infer_shape(**kwargs)\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/symbol/symbol.py\", line 990, in infer_shape\n     res = self._infer_shape_impl(False, *args, **kwargs)\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/symbol/symbol.py\", line 1120, in _infer_shape_impl\n     ctypes.byref(complete)))\n   File \"/Users/fhieber/miniconda3/lib/python3.6/site-packages/mxnet/base.py\", line 149, in check_call\n     raise MXNetError(py_str(_LIB.MXGetLastError()))\n mxnet.base.MXNetError: Error in operator source_embed_factor_split: [15:36:18] src/operator/./slice_channel-inl.h:208: Check failed: dshape[real_axis] % param_.num_outputs == 0U (1 vs. 0) You are trying to split the 2-th axis of input tensor with shape [10,10,1] into num_outputs=2 evenly sized chunks, but this is not possible because 2 does not evenly divide 1\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "fhieber", "commentT": "2018-08-24T10:33:55Z", "comment_text": "\n \t\tIt looks like <denchmark-link:https://github.com/awslabs/sockeye/blob/3b8865e0952033c5a0a5ac0065bda8465ec9d258/sockeye/train.py#L282>the check is there, but is indented incorrectly</denchmark-link>\n .\n \t\t"}}}, "commit": {"commit_id": "0da9ab09a21d51e9300602a7e2827ba9eaeab219", "commit_author": "Matt Post", "commitT": "2018-08-24 19:43:53+02:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "13,14,15,16", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "sockeye\\__init__.py", "file_new_name": "sockeye\\__init__.py", "file_complexity": {"file_NLOC": "1", "file_CCN": "0", "file_NToken": "3"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "14", "deleted_lines": "14"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "sockeye\\train.py", "file_new_name": "sockeye\\train.py", "file_complexity": {"file_NLOC": "740", "file_CCN": "62", "file_NToken": "4527"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "282,283,284,325,326,327,328", "deleted_lines": "282,283,284"}}}}}}