{"BR": {"BR_id": "2113", "BR_author": "ildoonet", "BRopenT": "2020-08-24T09:33:38Z", "BRcloseT": "2020-08-30T04:18:02Z", "BR_text": {"BRsummary": "Why MovingAverage num_steps takes 'string'?", "BRdescription": "\n System information\n \n OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\n TensorFlow version and how it was installed (source or binary): TF 2.3.0, binary\n TensorFlow-Addons version and how it was installed (source or binary): 0.11.0\n Python version: 3.6.8\n Is GPU used? (yes/no): yes\n \n Describe the bug\n MovingAverage type error seems to be weird.\n <denchmark-code>type of argument \"num_updates\" must be one of (str, NoneType); got tensorflow.python.distribute.values.MirroredVariable instead\n </denchmark-code>\n \n Optional[str] is wrong : <denchmark-link:https://github.com/tensorflow/addons/blob/v0.10.0/tensorflow_addons/optimizers/moving_average.py#L50>https://github.com/tensorflow/addons/blob/v0.10.0/tensorflow_addons/optimizers/moving_average.py#L50</denchmark-link>\n \n Code to reproduce the issue\n <denchmark-code>optimizer = tfa.optimizers.SGDW(\n             learning_rate=FLAGS.lr, weight_decay=FLAGS.weight_decay, momentum=0.9, nesterov=True)\n         optimizer = tfa.optimizers.MovingAverage(optimizer, average_decay=0.9999, num_updates=optimizer.iterations)\n </denchmark-code>\n \n Other info / logs\n Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ildoonet", "commentT": "2020-08-24T09:51:37Z", "comment_text": "\n \t\tYeah that's a bug. It should either be a int or a tf.Varaible with correct dtype. Thanks for reporting. Can you please add a PR with the correction?\n \t\t"}}}, "commit": {"commit_id": "dc3aa062fc4b5c4b37b530fa6f468a025a6106a9", "commit_author": "Rushabh Vasani", "commitT": "2020-08-29 21:18:02-07:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tensorflow_addons\\optimizers\\moving_average.py", "file_new_name": "tensorflow_addons\\optimizers\\moving_average.py", "file_complexity": {"file_NLOC": "145", "file_CCN": "20", "file_NToken": "755"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "50", "deleted_lines": "50", "method_info": {"method_name": "__init__", "method_params": "self,Optimizer,bool,FloatTensorLike,None,int,bool,str,kwargs", "method_startline": "45", "method_endline": "54", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "55", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "50", "deleted_lines": "50", "method_info": {"method_name": "__init__", "method_params": "self,Optimizer,bool,FloatTensorLike,None,int,None,int,bool,str,kwargs", "method_startline": "45", "method_endline": "54", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tensorflow_addons\\optimizers\\tests\\moving_average_test.py", "file_new_name": "tensorflow_addons\\optimizers\\tests\\moving_average_test.py", "file_complexity": {"file_NLOC": "178", "file_CCN": "17", "file_NToken": "2040"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "78,79,80,81", "deleted_lines": null, "method_info": {"method_name": "test_num_updates_invalid", "method_params": "", "method_startline": "78", "method_endline": "81", "method_complexity": {"method_NLOC": "4", "method_CCN": "2", "method_NToken": "40", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "72,73,74", "deleted_lines": null, "method_info": {"method_name": "test_num_updates_valid", "method_params": "", "method_startline": "72", "method_endline": "74", "method_complexity": {"method_NLOC": "3", "method_CCN": "2", "method_NToken": "26", "method_nesting_level": "0"}}}}}}}}