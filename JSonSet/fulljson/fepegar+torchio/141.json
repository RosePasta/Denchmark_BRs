{"BR": {"BR_id": "141", "BR_author": "sibajigaj", "BRopenT": "2020-05-04T20:09:45Z", "BRcloseT": "2020-05-05T11:42:27Z", "BR_text": {"BRsummary": "issue with affine transform", "BRdescription": "\n Hi,\n Thanks for the nice augmentation tool. I am trying to apply on our dataset where the image size is 160 X 384 X 384 and voxel spacing is .7 X .36 X.36 mm. The error is coming for affine transform. The error is as follows:\n Traceback (most recent call last):\n   File \"test3.py\", line 50, in <module>\n     transformed=transform(sample)\n   File \"~/software/virtual/pytorch/lib64/python3.6/site-packages/torchio/transforms/transform.py\", line 34, in __call__\n     sample = self.apply_transform(sample)\n   File \"~/software/virtual/pytorch/lib64/python3.6/site-packages/torchio/transforms/augmentation/composition.py\", line 28, in apply_transform\n     return self.transform(sample)\n   File \"~/software/virtual/pytorch/lib64/python3.6/site-packages/torchvision/transforms/transforms.py\", line 61, in __call__\n     img = t(img)\n   File \"~/software/virtual/pytorch/lib64/python3.6/site-packages/torchio/transforms/augmentation/random_transform.py\", line 33, in __call__\n     return super().__call__(sample)\n   File \"~/software/virtual/pytorch/lib64/python3.6/site-packages/torchio/transforms/transform.py\", line 34, in __call__\n     sample = self.apply_transform(sample)\n   File \"~/software/virtual/pytorch/lib64/python3.6/site-packages/torchio/transforms/augmentation/spatial/random_affine.py\", line 105, in apply_transform\n     interpolation,\n   File \"~/software/virtual/pytorch/lib64/python3.6/site-packages/torchio/transforms/augmentation/spatial/random_affine.py\", line 167, in apply_affine_transform\n     default_value = get_borders_mean(image, filter_otsu=True)\n   File \"~/software/virtual/pytorch/lib64/python3.6/site-packages/torchio/transforms/augmentation/spatial/random_affine.py\", line 195, in get_borders_mean\n     array[:, :, -1],\n ValueError: could not broadcast input array from shape (384,160) into shape (384). \n The affine transform is working for the given MRI image dataset  in TorchIO tutorial.ipynb tutorial. Also it is working if I pass default_pad_value='minimum' in the RandomAffine function. What could be possible processing, I need to do before doing affine transform ?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "sibajigaj", "commentT": "2020-05-04T23:01:24Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/sibajigaj>@sibajigaj</denchmark-link>\n ,\n What version of TorchIO are you using?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "sibajigaj", "commentT": "2020-05-05T00:48:04Z", "comment_text": "\n \t\tVersion: 0.16.4\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "sibajigaj", "commentT": "2020-05-05T10:14:31Z", "comment_text": "\n \t\tCould you please share the code to reproduce this and, if possible, an image? You can send it to <denchmark-link:mailto:fernando.perezgarcia.17@ucl.ac.uk>fernando.perezgarcia.17@ucl.ac.uk</denchmark-link>\n , if you like.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "sibajigaj", "commentT": "2020-05-05T11:21:48Z", "comment_text": "\n \t\tOk I just reproduced it. I'll fix that in a moment.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "sibajigaj", "commentT": "2020-05-05T11:42:55Z", "comment_text": "\n \t\tFixed in . Thanks for reporting, <denchmark-link:https://github.com/sibajigaj>@sibajigaj</denchmark-link>\n .\n \t\t"}}}, "commit": {"commit_id": "f92d71f494341b9650777ff51e5d20feb43b5620", "commit_author": "Fernando", "commitT": "2020-05-05 12:41:35+01:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "0.0", "commit_Nprams": "0.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "torchio\\transforms\\augmentation\\spatial\\random_affine.py", "file_new_name": "torchio\\transforms\\augmentation\\spatial\\random_affine.py", "file_complexity": {"file_NLOC": "191", "file_CCN": "15", "file_NToken": "975"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "186,188,189,190,191,192,193,194,195,196,198,199,200,204,208", "deleted_lines": "187,188,189,190,191,192,193,194,195,196,197,199,200,201,205,209", "method_info": {"method_name": "get_borders_mean", "method_params": "image,filter_otsu", "method_startline": "185", "method_endline": "209", "method_complexity": {"method_NLOC": "24", "method_CCN": "4", "method_NToken": "180", "method_nesting_level": "0"}}}}}}}}