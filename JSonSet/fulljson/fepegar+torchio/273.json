{"BR": {"BR_id": "273", "BR_author": "DerpyCoder", "BRopenT": "2020-08-18T05:45:57Z", "BRcloseT": "2020-08-18T17:37:32Z", "BR_text": {"BRsummary": "Inconsistent shapes of images", "BRdescription": "\n \ud83d\udc1bBug\n The shapes of the images of CT scans vary from images\n To reproduce\n Versions above 0.17.15 will have a different output if reading in .mhd or dicom folders\n print(torchio.__version__)\n subject = torchio.Subject(\n     CT = torchio.Image(path = \"something here\", type=torchio.INTENSITY),\n )\n print(subject.shape)\n '''\n 0.17.10\n (1, 512, 512, 345)\n '''\n \n '''\n 0.17.18\n (345, 1, 512, 512)\n '''\n \n '''\n 0.17.14\n (1, 512, 512, 345)\n '''\n \n '''\n 0.17.15\n (1, 512, 512, 345)\n '''\n \n '''\n 0.17.17\n (345, 1, 512, 512)\n '''\n Expected behavior\n I expected the format in Channel x X x Y x Z but versions above 0.17.15 seem to follow a different format\n Not sure if this is a bug or a feature\n TorchIO version\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "DerpyCoder", "commentT": "2020-08-18T15:20:35Z", "comment_text": "\n \t\tHi, <denchmark-link:https://github.com/DerpyCoder>@DerpyCoder</denchmark-link>\n . Thanks for reporting.\n Recent support for 4D images is probably causing this behavior. I don't know how your images are stored. Can you share some examples?\n You can change the way 4D images are read with the channels_last keyword argument of Image. By the way, you can now use ScalarImage and forget about type.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "DerpyCoder", "commentT": "2020-08-18T16:02:36Z", "comment_text": "\n \t\tI directly pass the path to the image (mhd) or folder (dicom) in the path keyword argument.\n The dataset I am using to test this are the LUNA16 and the LIDC-IDRI dataset\n The dicom images are stored in a folder like\n 01.dcm\n 02.dcm\n 03.dcm\n The mhd files are in the same folder as their respective raw files\n Are these images counted as 4D images though since they only contain a channel\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "DerpyCoder", "commentT": "2020-08-18T17:38:23Z", "comment_text": "\n \t\tChanges in <denchmark-link:https://github.com/fepegar/torchio/commit/349d771ac58dc84afaa72fb39270472a95d857f5>349d771</denchmark-link>\n  should have fixed this. Now, DICOM images are read with channels first by default so your results should be consistent in . Feel free to reopen if they're not.\n \t\t"}}}, "commit": {"commit_id": "349d771ac58dc84afaa72fb39270472a95d857f5", "commit_author": "Fernando", "commitT": "2020-08-18 18:33:40+01:00", "commit_complexity": {"commit_NLOC": "0.5882352941176471", "commit_CCN": "0.47058823529411764", "commit_Nprams": "0.7058823529411765"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\data\\sampler\\test_label_sampler.py", "file_new_name": "tests\\data\\sampler\\test_label_sampler.py", "file_complexity": {"file_NLOC": "22", "file_CCN": "3", "file_NToken": "238"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "17", "deleted_lines": "17", "method_info": {"method_name": "test_label_probabilities", "method_params": "self", "method_startline": "16", "method_endline": "26", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "161", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tests\\data\\sampler\\test_weighted_sampler.py", "file_new_name": "tests\\data\\sampler\\test_weighted_sampler.py", "file_complexity": {"file_NLOC": "29", "file_CCN": "3", "file_NToken": "246"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "19", "deleted_lines": "19", "method_info": {"method_name": "get_sample", "method_params": "self,image_shape", "method_startline": "16", "method_endline": "25", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "80", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "11", "deleted_lines": "11", "method_info": {"method_name": "test_weighted_sampler", "method_params": "self", "method_startline": "10", "method_endline": "14", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 7, "file_old_name": "tests\\data\\test_image.py", "file_new_name": "tests\\data\\test_image.py", "file_complexity": {"file_NLOC": "133", "file_CCN": "28", "file_NToken": "1329"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "61", "deleted_lines": "61", "method_info": {"method_name": "test_wrong_scalar_image_type", "method_params": "self", "method_startline": "60", "method_endline": "63", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "39", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "56", "deleted_lines": "56", "method_info": {"method_name": "test_label_map_type", "method_params": "self", "method_startline": "55", "method_endline": "58", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "39", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "66", "deleted_lines": "66", "method_info": {"method_name": "test_wrong_label_map_type", "method_params": "self", "method_startline": "65", "method_endline": "68", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "39", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "51", "deleted_lines": "51", "method_info": {"method_name": "test_scalar_image_type", "method_params": "self", "method_startline": "50", "method_endline": "53", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "39", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "45", "deleted_lines": "45", "method_info": {"method_name": "test_crop_does_not_create_wrong_path", "method_params": "self", "method_startline": "44", "method_endline": "48", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "77", "deleted_lines": "77", "method_info": {"method_name": "test_crop_label_map_type", "method_params": "self", "method_startline": "76", "method_endline": "80", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "71", "deleted_lines": "71", "method_info": {"method_name": "test_crop_scalar_image_type", "method_params": "self", "method_startline": "70", "method_endline": "74", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "61", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tests\\transforms\\test_transforms.py", "file_new_name": "tests\\transforms\\test_transforms.py", "file_complexity": {"file_NLOC": "145", "file_CCN": "27", "file_NToken": "1261"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "117", "deleted_lines": "117", "method_info": {"method_name": "test_transforms_sample_4d", "method_params": "self", "method_startline": "115", "method_endline": "135", "method_complexity": {"method_NLOC": "21", "method_CCN": "3", "method_NToken": "139", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "96", "deleted_lines": "96", "method_info": {"method_name": "test_transforms_nib", "method_params": "self", "method_startline": "95", "method_endline": "102", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "83", "method_nesting_level": "1"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tests\\utils.py", "file_new_name": "tests\\utils.py", "file_complexity": {"file_NLOC": "139", "file_CCN": "15", "file_NToken": "959"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "69", "deleted_lines": "69", "method_info": {"method_name": "make_4d", "method_params": "self,sample", "method_startline": "69", "method_endline": "73", "method_complexity": {"method_NLOC": "5", "method_CCN": "2", "method_NToken": "48", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "69", "deleted_lines": "69", "method_info": {"method_name": "make_multichannel", "method_params": "self,sample", "method_startline": "69", "method_endline": "73", "method_complexity": {"method_NLOC": "5", "method_CCN": "2", "method_NToken": "48", "method_nesting_level": "1"}}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 7, "file_old_name": "torchio\\data\\image.py", "file_new_name": "torchio\\data\\image.py", "file_complexity": {"file_NLOC": "480", "file_CCN": "81", "file_NToken": "2158"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "189", "method_info": {"method_name": "__copy__", "method_params": "self", "method_startline": "183", "method_endline": "194", "method_complexity": {"method_NLOC": "12", "method_CCN": "3", "method_NToken": "69", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "364,365,366,367,368,369", "deleted_lines": null, "method_info": {"method_name": "parse_tensor_shape", "method_params": "self,Tensor,int", "method_startline": "364", "method_endline": "369", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": null, "deleted_lines": "356,357", "method_info": {"method_name": "parse_tensor_shape", "method_params": "self,Tensor", "method_startline": "356", "method_endline": "357", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "358,359", "deleted_lines": "351,356,357", "method_info": {"method_name": "parse_tensor", "method_params": "self,TypeData", "method_startline": "351", "method_endline": "362", "method_complexity": {"method_NLOC": "12", "method_CCN": "7", "method_NToken": "99", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": null, "deleted_lines": "480", "method_info": {"method_name": "crop", "method_params": "self,TypeTripletInt,TypeTripletInt", "method_startline": "468", "method_endline": "485", "method_complexity": {"method_NLOC": "18", "method_CCN": "3", "method_NToken": "143", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "489,490,491,492,493,494,495", "deleted_lines": null, "method_info": {"method_name": "guess_channels_last", "method_params": "self,Path", "method_startline": "489", "method_endline": "495", "method_complexity": {"method_NLOC": "6", "method_CCN": "3", "method_NToken": "46", "method_nesting_level": "1"}}}, "hunk_6": {"Ismethod": 1, "added_lines": "395,396,397,398,399,407,408,409,410,411", "deleted_lines": "382,390", "method_info": {"method_name": "load", "method_params": "self", "method_startline": "382", "method_endline": "439", "method_complexity": {"method_NLOC": "49", "method_CCN": "10", "method_NToken": "241", "method_nesting_level": "1"}}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "torchio\\transforms\\transform.py", "file_new_name": "torchio\\transforms\\transform.py", "file_complexity": {"file_NLOC": "287", "file_CCN": "43", "file_NToken": "1352"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "293", "deleted_lines": "293", "method_info": {"method_name": "_get_subject_from_tensor", "method_params": "self,Tensor", "method_startline": "292", "method_endline": "294", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}}}}}}