{"BR": {"BR_id": "1527", "BR_author": "felix-schneider", "BRopenT": "2019-12-19T13:58:17Z", "BRcloseT": "2019-12-19T16:56:21Z", "BR_text": {"BRsummary": "Multihead attention without bias still tries to initalize the bias", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n If you create a MultiheadAttention with bias=False, you get the following:\n <denchmark-code>Traceback (most recent call last):\n File \"xxx/fairseq/fairseq/modules/multihead_attention.py\", line 56, in __init__\n     self.reset_parameters()\n   File \"xxx/fairseq/fairseq/modules/multihead_attention.py\", line 82, in reset_parameters\n     nn.init.constant_(self.out_proj.bias, 0.)\n   File \"xxx/torch/nn/init.py\", line 120, in constant_\n     return _no_grad_fill_(tensor, val)\n   File \"xxx/torch/nn/init.py\", line 24, in _no_grad_fill_\n     return tensor.fill_(val)\n AttributeError: 'NoneType' object has no attribute 'fill_'\n </denchmark-code>\n \n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n from fairseq.modules import MultiheadAttention\n a = MultiheadAttention(1, 1, bias=False)\n <denchmark-h:h3>Environment</denchmark-h>\n \n \n fairseq Version: master\n PyTorch Version: 1.3.1\n OS: Linux\n How you installed fairseq: source\n Build command you used: pip install -e .\n Python version: 3.7.4\n CUDA/cuDNN version: 10.1\n GPU models and configuration: N/A\n \n \t"}, "comments": {}}, "commit": {"commit_id": "58ec8c0f28250419ea10dded02ceee9b74626e24", "commit_author": "Myle Ott", "commitT": "2019-12-19 08:56:14-08:00", "commit_complexity": {"commit_NLOC": "0.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "fairseq\\modules\\multihead_attention.py", "file_new_name": "fairseq\\modules\\multihead_attention.py", "file_complexity": {"file_NLOC": "271", "file_CCN": "24", "file_NToken": "2454"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "82,83", "deleted_lines": "82", "method_info": {"method_name": "reset_parameters", "method_params": "self", "method_startline": "69", "method_endline": "87", "method_complexity": {"method_NLOC": "16", "method_CCN": "5", "method_NToken": "190", "method_nesting_level": "1"}}}}}}}}