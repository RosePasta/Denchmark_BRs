{"BR": {"BR_id": "614", "BR_author": "jean-louis67", "BRopenT": "2020-11-16T06:29:27Z", "BRcloseT": "2020-11-26T23:54:50Z", "BR_text": {"BRsummary": "Indexer: Restore missing files when they are found again", "BRdescription": "\n The server hosting my photoprism instance has been restarted. It turns out that the local disk of the partition containing Originals was not mounted.\n After restarting photopism, the total number of photos decreased very quickly (7800 \u2192 5500 approximately), kind of de-indexing I suppose. I stopped photoprism as soon as I noticed it.\n So I mounted the disk and restarted photoprism.\n I launched an indexing, but it fails quite quickly and I still cannot find the missing photos:\n <denchmark-link:https://user-images.githubusercontent.com/65403912/99219478-0af4c080-27dd-11eb-9278-4e99012433a3.png></denchmark-link>\n \n Thank you in advance for your assistance!\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "jean-louis67", "commentT": "2020-11-16T06:44:30Z", "comment_text": "\n \t\tCan you pull the latest image? Thought it might be a good idea to configure volumes in our Dockerfile as some users forget to mount storage, but had similar issues with our demo. Second build seems OK.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:03:42Z", "comment_text": "\n \t\tThank you very much for your (super) fast response!\n There are no more errors, but I still only see 5500 photos\n <denchmark-link:https://user-images.githubusercontent.com/65403912/99221715-65901b80-27e1-11eb-8400-1739b710c82d.png></denchmark-link>\n \n Maybe we have to wait a bit.\n For example, the indexing process did find many archived photos. But none appear for the moment in the application\n Or maybe I have to force indexing (but how?) Because 1mn30 seems an ultra short time for more than 8000 photos\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:18:51Z", "comment_text": "\n \t\tThey are also not shown in archive?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:28:05Z", "comment_text": "\n \t\tComplete reindex might help.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:29:02Z", "comment_text": "\n \t\tYes, I will do that. But is it possible to launch it as a command line?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:29:22Z", "comment_text": "\n \t\tindex -a\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:33:10Z", "comment_text": "\n \t\tThank you very much.\n I think it takes about ten hours. I'll keep you informed.\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:42:32Z", "comment_text": "\n \t\tAre you using MySQL instead of MariaDB?\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:54:48Z", "comment_text": "\n \t\tYes\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "jean-louis67", "commentT": "2020-11-16T07:58:15Z", "comment_text": "\n \t\tSee <denchmark-link:https://github.com/photoprism/photoprism/issues/599>#599</denchmark-link>\n \n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "jean-louis67", "commentT": "2020-11-16T08:01:43Z", "comment_text": "\n \t\tWhat the failed query does is setting the photo quality to -1 if there is no primary JPEG file for displaying it in search results. With our latest release, the query is working on MySQL 8 and the photo count is reduced accordingly.\n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "jean-louis67", "commentT": "2020-11-16T11:14:28Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/jean-louis67>@jean-louis67</denchmark-link>\n  Do you see your missing photos in the \u201cLibrary > Hidden\u201d section?\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "jean-louis67", "commentT": "2020-11-16T13:16:48Z", "comment_text": "\n \t\tThank you Alexis four your interest.\n  ended as follow:\n <denchmark-link:https://user-images.githubusercontent.com/65403912/99255464-4199fd80-2814-11eb-9082-b03778e6a480.png></denchmark-link>\n \n I still only have 5572 photos.\n If I look at the directory /photoprism/Originals/2020/11, I found 47 photos:\n <denchmark-link:https://user-images.githubusercontent.com/65403912/99255769-b2d9b080-2814-11eb-8c26-6c0cf6565c3f.png></denchmark-link>\n \n But in the application, the corresponding folder is considered as empty:\n <denchmark-link:https://user-images.githubusercontent.com/65403912/99256106-2976ae00-2815-11eb-873c-cf8423c88886.png></denchmark-link>\n \n Last info, _select count(*) from photos__returns 7940\n I think I'm going to let it all rest a bit ...\n \t\t"}, "comments_13": {"comment_id": 14, "comment_author": "jean-louis67", "commentT": "2020-11-16T13:43:22Z", "comment_text": "\n \t\tMight those be duplicates? Were they archived? Are they fully standards compliant? There is an issue in our Exif library that could cause files not to get indexed, probably when they contain unexpected metadata: <denchmark-link:https://github.com/photoprism/photoprism/issues/600>#600</denchmark-link>\n \n \t\t"}, "comments_14": {"comment_id": 15, "comment_author": "jean-louis67", "commentT": "2020-11-17T10:37:07Z", "comment_text": "\n \t\tI think I'm having the same issue. When upgrading PP to the latest version (was running one from 1-2 months ago) I got a problem with the folder of photos mounted to originals, the permissions didn't allow PP to access the folder. This seems to have caused all photos the be marked as \"Archived\", and skipped during re-index (using photoprism index -a) and no way to get them back.\n <denchmark-code>INFO[2020-11-17T10:28:00Z] index: skipped archived main jpg file 2018/Vinter/DSC03185.JPG\n </denchmark-code>\n \n These files doesn't show up anywhere (Photos->Archive is empty, Library->Originals show the folders but empty).\n I'm sure a DB wipe would solve it, but let me know if you want to troubleshoot it <denchmark-link:https://github.com/lastzero>@lastzero</denchmark-link>\n \n \t\t"}, "comments_15": {"comment_id": 16, "comment_author": "jean-louis67", "commentT": "2020-11-17T11:05:01Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/oscar-b>@oscar-b</denchmark-link>\n  Thanks! Your hint might help finding the issue. Files get flagged as missing when they are gone. When no files are left, a photo gets flagged as deleted / archived. We have to handle that case different than a manual delete, so that we can un-delete when files can be found again. Also, photos may have been manually archived and then their files physically deleted. In that case, they should NOT be un-deleted automatically.\n \t\t"}, "comments_16": {"comment_id": 17, "comment_author": "jean-louis67", "commentT": "2020-11-20T16:43:24Z", "comment_text": "\n \t\tHopefully just fixed this in <denchmark-link:https://github.com/photoprism/photoprism/issues/568>#568</denchmark-link>\n \n \t\t"}, "comments_17": {"comment_id": 18, "comment_author": "jean-louis67", "commentT": "2020-11-20T18:02:07Z", "comment_text": "\n \t\t\n Hopefully just fixed this in #568\n \n Will test it later tonight, is there a new Docker build yet?\n \t\t"}, "comments_18": {"comment_id": 19, "comment_author": "jean-louis67", "commentT": "2020-11-20T19:51:10Z", "comment_text": "\n \t\tYes, although there seems to be an issue with our Raspberry Pi build.\n \t\t"}, "comments_19": {"comment_id": 20, "comment_author": "jean-louis67", "commentT": "2020-11-20T21:22:55Z", "comment_text": "\n \t\t\n Yes, although there seems to be an issue with our Raspberry Pi build.\n \n <denchmark-code>I have no name!@d04144422291:/photoprism$ photoprism version\n 201120-a45aca5d-Linux-x86_64\n </denchmark-code>\n \n Running photoprism index -a doesn't resolve my library, still getting:\n <denchmark-code>INFO[2020-11-20T21:20:22Z] index: skipped archived main jpg file 2018/Vinter/DSC03171.JPG\n INFO[2020-11-20T21:20:22Z] index: skipped archived main jpg file 2018/Vinter/DSC03170.JPG\n INFO[2020-11-20T21:20:22Z] index: skipped archived main jpg file 2018/Vinter/DSC03172.JPG\n </denchmark-code>\n \n But not sure if the fix you pushed is supposed to being able to fix this after the fact, or just making sure the initial state doesn't happen?\n \t\t"}, "comments_20": {"comment_id": 21, "comment_author": "jean-louis67", "commentT": "2020-11-21T16:09:09Z", "comment_text": "\n \t\tHello\n Thank you very much to each participant of this issue for your efforts and explanations.\n I just redone an index -a, but that didn't make the missing photos reappear.\n That said, it's been a while since I wanted to thoroughly review my way of working with PhotoPrism, which involved a reinitialization of the database. This is what I am doing, and therefore this problem is not blocking me. I will now be careful that the files are accessible before launching or relaunching PhotoPrism.\n \t\t"}, "comments_21": {"comment_id": 22, "comment_author": "jean-louis67", "commentT": "2020-11-21T16:42:13Z", "comment_text": "\n \t\tNew image not yet available, just implemented batch approve... now looking at other bugs.\n \t\t"}, "comments_22": {"comment_id": 23, "comment_author": "jean-louis67", "commentT": "2020-11-21T17:47:46Z", "comment_text": "\n \t\tJust started a new Docker build for testing. Available soon.\n \t\t"}, "comments_23": {"comment_id": 24, "comment_author": "jean-louis67", "commentT": "2020-11-21T20:59:32Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lastzero>@lastzero</denchmark-link>\n  The  looked the same (), but afterwards the files are visible under Photos->Archive, which they weren't before! So if that's the expected behavior in this case, it looks fine to me!\n It would be nice if it displayed a counter in the menu next to Archive.\n It wasn't completely obvious how to un-archive, since that wasn't possible to do in list mode (?) which I was using thinking it would be easiest to select multiple photos in that mode.\n I got a crash when running index one more time after unarchiving all files, but another index run after that seems to chug along. Interested in that one off crash?\n <denchmark-code>\n I have no name!@25a1110be815:/photoprism$ photoprism index -a\n INFO[2020-11-21T20:55:58Z] indexing photos in /photoprism/originals\n INFO[2020-11-21T20:55:58Z] classify: loading nasnet\n INFO[2020-11-21T20:56:08Z] classify: loading labels from labels.txt\n INFO[2020-11-21T20:56:08Z] index: no .ppignore file found\n fatal error: concurrent map read and map write\n \n goroutine 6 [running]:\n runtime.throw(0x10d0c48, 0x21)\n \t/usr/local/go/src/runtime/panic.go:1116 +0x72 fp=0xc013ed2f98 sp=0xc013ed2f68 pc=0x442712\n runtime.mapaccess2(0xf86d40, 0xc01467e210, 0xc013ed300e, 0x3, 0xc013f55ea8)\n \t/usr/local/go/src/runtime/map.go:469 +0x25b fp=0xc013ed2fd8 sp=0xc013ed2f98 pc=0x41b71b\n github.com/dsoprea/go-exif/v3.(*TagIndex).Get(0xc00027b0f0, 0xc0143a4c00, 0xc013ed011b, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/tags.go:252 +0xe5 fp=0xc013ed3030 sp=0xc013ed2fd8 pc=0xb09e65\n github.com/dsoprea/go-exif/v3.(*IfdEnumerate).tagPostParse(0xc013ed3698, 0xc0146f0630, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/ifd_enumerate.go:327 +0xb8 fp=0xc013ed31c0 sp=0xc013ed3030 pc=0xaffed8\n github.com/dsoprea/go-exif/v3.(*IfdEnumerate).parseIfd(0xc013ed3698, 0xc0143a4c00, 0xc0141893b0, 0x0, 0x0, 0x0, 0x0, 0xc0146ed000, 0x6, 0x8, ...)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/ifd_enumerate.go:445 +0x3fe fp=0xc013ed3360 sp=0xc013ed31c0 pc=0xb00d3e\n github.com/dsoprea/go-exif/v3.(*IfdEnumerate).Collect(0xc013ed3698, 0xc000000008, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/ifd_enumerate.go:1342 +0xb29 fp=0xc013ed3630 sp=0xc013ed3360 pc=0xb074a9\n github.com/dsoprea/go-exif/v3.Collect(0xc0000aa600, 0xc00027b0f0, 0xc013acc006, 0xb170, 0xb170, 0x1269660, 0x225e450, 0x8, 0x0, 0x0, ...)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/exif.go:230 +0x26c fp=0xc013ed36f0 sp=0xc013ed3630 pc=0xafe3cc\n github.com/photoprism/photoprism/internal/meta.(*Data).Exif(0xc0139747d0, 0xc01391b600, 0x3f, 0x109f980, 0x3, 0x0, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/meta/exif.go:78 +0x2f3 fp=0xc013ed3b58 sp=0xc013ed36f0 pc=0xb72973\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).MetaData.func1()\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/metadata.go:18 +0xba fp=0xc013ed3cc8 sp=0xc013ed3b58 pc=0xba5c3a\n sync.(*Once).doSlow(0xc0139749f0, 0xc013ed3d28)\n \t/usr/local/go/src/sync/once.go:66 +0xec fp=0xc013ed3d18 sp=0xc013ed3cc8 pc=0x48256c\n sync.(*Once).Do(...)\n \t/usr/local/go/src/sync/once.go:57\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).MetaData(0xc013974700, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/metadata.go:14 +0xbd fp=0xc013ed3d48 sp=0xc013ed3d18 pc=0xb9db3d\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).Orientation(...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:894\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).decodeDimensions(0xc013974700, 0x0, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:821 +0x17c fp=0xc013ed4838 sp=0xc013ed3d48 pc=0xb9bc3c\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).Width(0xc013974700, 0x9)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:845 +0x68 fp=0xc013ed4890 sp=0xc013ed4838 pc=0xb9c008\n github.com/photoprism/photoprism/internal/photoprism.(*Index).MediaFile(0xc013a7ccf0, 0xc013974700, 0x0, 0x0, 0x20a0101, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_mediafile.go:280 +0x13e5 fp=0xc013edb678 sp=0xc013ed4890 pc=0xb8abc5\n github.com/photoprism/photoprism/internal/photoprism.IndexMain(0xc013ecbe70, 0xc013a7ccf0, 0x0, 0x0, 0x101, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_related.go:57 +0x152 fp=0xc013edb960 sp=0xc013edb678 pc=0xb934f2\n github.com/photoprism/photoprism/internal/photoprism.IndexRelated(0xc000011de8, 0x1, 0x1, 0xc013974700, 0xc013a7ccf0, 0x0, 0x0, 0x5c0101, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_related.go:76 +0x11f fp=0xc013edbe70 sp=0xc013edb960 pc=0xb946df\n github.com/photoprism/photoprism/internal/photoprism.IndexWorker(0xc000040d80)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_worker.go:12 +0x115 fp=0xc013edbfb0 sp=0xc013edbe70 pc=0xb95375\n github.com/photoprism/photoprism/internal/photoprism.(*Index).Start.func2(0xc000040d80, 0xc0177eb1d0)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index.go:96 +0x2b fp=0xc013edbfd0 sp=0xc013edbfb0 pc=0xba464b\n runtime.goexit()\n \t/usr/local/go/src/runtime/asm_amd64.s:1374 +0x1 fp=0xc013edbfd8 sp=0xc013edbfd0 pc=0x478241\n created by github.com/photoprism/photoprism/internal/photoprism.(*Index).Start\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index.go:95 +0x265\n \n goroutine 1 [chan send]:\n github.com/photoprism/photoprism/internal/photoprism.(*Index).Start.func5(0xc0134b1140, 0x3f, 0xc013955d70, 0xc01349f020, 0x50d525)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index.go:200 +0xb3a\n github.com/karrick/godirwalk.walk(0xc0134b1140, 0x3f, 0xc013955d70, 0xc0145b9630, 0x3f, 0x0)\n \t/go/pkg/mod/github.com/karrick/godirwalk@v1.16.1/walk.go:277 +0x69\n github.com/karrick/godirwalk.walk(0xc0134b0b40, 0x32, 0xc013c3e8d0, 0xc0145b9630, 0x32, 0x0)\n \t/go/pkg/mod/github.com/karrick/godirwalk@v1.16.1/walk.go:338 +0x47b\n github.com/karrick/godirwalk.walk(0xc01384af40, 0x1a, 0xc013955830, 0xc0145b9630, 0x1a, 0xc0191c5460)\n \t/go/pkg/mod/github.com/karrick/godirwalk@v1.16.1/walk.go:338 +0x47b\n github.com/karrick/godirwalk.walk(0xc01a5a5ee0, 0x15, 0xc013c3e240, 0xc0145b9630, 0x0, 0x0)\n \t/go/pkg/mod/github.com/karrick/godirwalk@v1.16.1/walk.go:338 +0x47b\n github.com/karrick/godirwalk.Walk(0xc01a5a5ee0, 0x15, 0xc01349f630, 0x9, 0xc01349f5e8)\n \t/go/pkg/mod/github.com/karrick/godirwalk@v1.16.1/walk.go:258 +0x246\n github.com/photoprism/photoprism/internal/photoprism.(*Index).Start(0xc013a7ccf0, 0x0, 0x0, 0x101, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index.go:118 +0x605\n github.com/photoprism/photoprism/internal/commands.indexAction(0xc0135202c0, 0x0, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/commands/index.go:68 +0x329\n github.com/urfave/cli.HandleAction(0xf4f7c0, 0x11229c0, 0xc0135202c0, 0xc0135202c0, 0x0)\n \t/go/pkg/mod/github.com/urfave/cli@v1.22.5/app.go:524 +0xfd\n github.com/urfave/cli.Command.Run(0x10a3a96, 0x5, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10d6d59, 0x27, 0x0, ...)\n \t/go/pkg/mod/github.com/urfave/cli@v1.22.5/command.go:173 +0x58e\n github.com/urfave/cli.(*App).Run(0xc013534000, 0xc00009e060, 0x3, 0x3, 0x0, 0x0)\n \t/go/pkg/mod/github.com/urfave/cli@v1.22.5/app.go:277 +0x7e8\n main.main()\n \t/go/src/github.com/photoprism/photoprism/cmd/photoprism/photoprism.go:71 +0x529\n \n goroutine 19 [select]:\n github.com/melihmucuk/geocache.NewCache.func1(0xc00026bdb0, 0xc0002c7780)\n \t/go/pkg/mod/github.com/melihmucuk/geocache@v0.0.0-20160621165317-521b336a001c/cache.go:82 +0xbd\n created by github.com/melihmucuk/geocache.NewCache\n \t/go/pkg/mod/github.com/melihmucuk/geocache@v0.0.0-20160621165317-521b336a001c/cache.go:80 +0xf3\n \n goroutine 53 [chan receive]:\n github.com/photoprism/photoprism/internal/config.(*Config).initPro.func1(0xc01a5c8050, 0xc0135096c0)\n \t/go/src/github.com/photoprism/photoprism/internal/config/config.go:311 +0x31\n created by github.com/photoprism/photoprism/internal/config.(*Config).initPro\n \t/go/src/github.com/photoprism/photoprism/internal/config/config.go:308 +0x165\n \n goroutine 26 [select]:\n github.com/go-sql-driver/mysql.(*mysqlConn).startWatcher.func1(0xc013f02480, 0xc013ef4240, 0xc0002c4240)\n \t/go/pkg/mod/github.com/go-sql-driver/mysql@v1.5.0/connection.go:621 +0xcd\n created by github.com/go-sql-driver/mysql.(*mysqlConn).startWatcher\n \t/go/pkg/mod/github.com/go-sql-driver/mysql@v1.5.0/connection.go:618 +0xbe\n \n goroutine 59 [select]:\n database/sql.(*DB).connectionOpener(0xc01a5f1d40, 0x1261480, 0xc01a5a8100)\n \t/usr/local/go/src/database/sql/sql.go:1126 +0xf5\n created by database/sql.OpenDB\n \t/usr/local/go/src/database/sql/sql.go:740 +0x12a\n \n goroutine 63 [select]:\n github.com/go-sql-driver/mysql.(*mysqlConn).startWatcher.func1(0xc000348c60, 0xc01a5aa5a0, 0xc01a5965a0)\n \t/go/pkg/mod/github.com/go-sql-driver/mysql@v1.5.0/connection.go:621 +0xcd\n created by github.com/go-sql-driver/mysql.(*mysqlConn).startWatcher\n \t/go/pkg/mod/github.com/go-sql-driver/mysql@v1.5.0/connection.go:618 +0xbe\n \n goroutine 65 [chan receive]:\n github.com/photoprism/photoprism/internal/entity.SaveErrorMessages()\n \t/go/src/github.com/photoprism/photoprism/internal/entity/error.go:28 +0x1af\n created by github.com/photoprism/photoprism/internal/config.(*Config).InitDb\n \t/go/src/github.com/photoprism/photoprism/internal/config/db.go:114 +0x92\n \n goroutine 7 [runnable]:\n github.com/dsoprea/go-exif/v3.(*TagIndex).Add(0xc00027b0f0, 0xc014776e80, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/tags.go:226 +0x1da\n github.com/dsoprea/go-exif/v3.LoadStandardTags(0xc00027b0f0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/tags.go:401 +0x5de\n github.com/dsoprea/go-exif/v3.(*TagIndex).Get(0xc00027b0f0, 0xc0000acba0, 0xc01790010e, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/tags.go:241 +0x1aa\n github.com/dsoprea/go-exif/v3.(*IfdEnumerate).parseTag(0xc013ee3698, 0xc0000acba0, 0x0, 0xc013c3fe30, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/ifd_enumerate.go:249 +0x3a5\n github.com/dsoprea/go-exif/v3.(*IfdEnumerate).parseIfd(0xc013ee3698, 0xc0000acba0, 0xc013c3fe30, 0x0, 0x0, 0x0, 0x0, 0x225e450, 0x0, 0x0, ...)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/ifd_enumerate.go:434 +0x25e\n github.com/dsoprea/go-exif/v3.(*IfdEnumerate).Collect(0xc013ee3698, 0xc000000008, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/ifd_enumerate.go:1342 +0xb29\n github.com/dsoprea/go-exif/v3.Collect(0xc0000aa600, 0xc00027b0f0, 0xc014062006, 0xadd6, 0xadd6, 0x1269660, 0x225e450, 0x8, 0x0, 0x0, ...)\n \t/go/pkg/mod/github.com/dsoprea/go-exif/v3@v3.0.0-20200807075213-089aa48c91e6/exif.go:230 +0x26c\n github.com/photoprism/photoprism/internal/meta.(*Data).Exif(0xc013c7ced0, 0xc0134b0d80, 0x3f, 0x109f980, 0x3, 0x0, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/meta/exif.go:78 +0x2f3\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).MetaData.func1()\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/metadata.go:18 +0xba\n sync.(*Once).doSlow(0xc013c7d0f0, 0xc013ee3d28)\n \t/usr/local/go/src/sync/once.go:66 +0xec\n sync.(*Once).Do(...)\n \t/usr/local/go/src/sync/once.go:57\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).MetaData(0xc013c7ce00, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/metadata.go:14 +0xbd\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).Orientation(...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:894\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).decodeDimensions(0xc013c7ce00, 0x0, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:821 +0x17c\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).Width(0xc013c7ce00, 0x9)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:845 +0x68\n github.com/photoprism/photoprism/internal/photoprism.(*Index).MediaFile(0xc013a7ccf0, 0xc013c7ce00, 0x0, 0x0, 0x20a0101, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_mediafile.go:280 +0x13e5\n github.com/photoprism/photoprism/internal/photoprism.IndexMain(0xc013ec7e70, 0xc013a7ccf0, 0x0, 0x0, 0x101, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_related.go:57 +0x152\n github.com/photoprism/photoprism/internal/photoprism.IndexRelated(0xc013c28a10, 0x1, 0x1, 0xc013c7ce00, 0xc013a7ccf0, 0x0, 0x0, 0x101, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_related.go:76 +0x11f\n github.com/photoprism/photoprism/internal/photoprism.IndexWorker(0xc000040d80)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_worker.go:12 +0x115\n github.com/photoprism/photoprism/internal/photoprism.(*Index).Start.func2(0xc000040d80, 0xc0177eb1d0)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index.go:96 +0x2b\n created by github.com/photoprism/photoprism/internal/photoprism.(*Index).Start\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index.go:95 +0x265\n \n goroutine 8 [runnable]:\n github.com/dsoprea/go-jpeg-image-structure.(*JpegSplitter).handleSegment(0xc01394ff40, 0x0, 0x10af4d1, 0x9, 0x0, 0xc0280e2000, 0x21c3de4, 0x22c25c5, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-jpeg-image-structure@v0.0.0-20200807080200-98ca71ef1508/splitter.go:403 +0xca\n github.com/dsoprea/go-jpeg-image-structure.(*JpegSplitter).processScanData(0xc01394ff40, 0xc0280e2000, 0x22b7386, 0x22c25c5, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-jpeg-image-structure@v0.0.0-20200807080200-98ca71ef1508/splitter.go:116 +0x1b4\n github.com/dsoprea/go-jpeg-image-structure.(*JpegSplitter).readSegment(0xc01394ff40, 0xc0280e2000, 0x22b7386, 0x22c25c5, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-jpeg-image-structure@v0.0.0-20200807080200-98ca71ef1508/splitter.go:158 +0x1152\n github.com/dsoprea/go-jpeg-image-structure.(*JpegSplitter).Split(0xc01394ff40, 0xc0280e2000, 0x22b7386, 0x22c25c5, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/pkg/mod/github.com/dsoprea/go-jpeg-image-structure@v0.0.0-20200807080200-98ca71ef1508/splitter.go:315 +0x109\n bufio.(*Scanner).Scan(0xc01400f3e0, 0xc013d8b7e0)\n \t/usr/local/go/src/bufio/scan.go:146 +0x64e\n github.com/dsoprea/go-jpeg-image-structure.(*JpegMediaParser).Parse(0xc01400f54f, 0x1257b00, 0xc013d9e520, 0x22c25c5, 0x0, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-jpeg-image-structure@v0.0.0-20200807080200-98ca71ef1508/media_parser.go:45 +0x1f1\n github.com/dsoprea/go-jpeg-image-structure.(*JpegMediaParser).ParseFile(0xc01400f54f, 0xc0134b1000, 0x3f, 0x0, 0x0, 0x0, 0x0)\n \t/go/pkg/mod/github.com/dsoprea/go-jpeg-image-structure@v0.0.0-20200807080200-98ca71ef1508/media_parser.go:78 +0x193\n github.com/photoprism/photoprism/internal/meta.RawExif(0xc0134b1000, 0x3f, 0x109f980, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/meta/exif_parser.go:33 +0xdec\n github.com/photoprism/photoprism/internal/meta.(*Data).Exif(0xc013c7d5d0, 0xc0134b1000, 0x3f, 0x109f980, 0x3, 0x0, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/meta/exif.go:54 +0xc7\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).MetaData.func1()\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/metadata.go:18 +0xba\n sync.(*Once).doSlow(0xc013c7d7f0, 0xc01400fd28)\n \t/usr/local/go/src/sync/once.go:66 +0xec\n sync.(*Once).Do(...)\n \t/usr/local/go/src/sync/once.go:57\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).MetaData(0xc013c7d500, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/metadata.go:14 +0xbd\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).Orientation(...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:894\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).decodeDimensions(0xc013c7d500, 0x0, 0x0)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:821 +0x17c\n github.com/photoprism/photoprism/internal/photoprism.(*MediaFile).Width(0xc013c7d500, 0x9)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/mediafile.go:845 +0x68\n github.com/photoprism/photoprism/internal/photoprism.(*Index).MediaFile(0xc013a7ccf0, 0xc013c7d500, 0x0, 0x0, 0x20a0101, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_mediafile.go:280 +0x13e5\n github.com/photoprism/photoprism/internal/photoprism.IndexMain(0xc013ecbe70, 0xc013a7ccf0, 0x0, 0x0, 0x101, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_related.go:57 +0x152\n github.com/photoprism/photoprism/internal/photoprism.IndexRelated(0xc013c28bd8, 0x1, 0x1, 0xc013c7d500, 0xc013a7ccf0, 0x0, 0x0, 0x101, 0x0, 0x0, ...)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_related.go:76 +0x11f\n github.com/photoprism/photoprism/internal/photoprism.IndexWorker(0xc000040d80)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index_worker.go:12 +0x115\n github.com/photoprism/photoprism/internal/photoprism.(*Index).Start.func2(0xc000040d80, 0xc0177eb1d0)\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index.go:96 +0x2b\n created by github.com/photoprism/photoprism/internal/photoprism.(*Index).Start\n \t/go/src/github.com/photoprism/photoprism/internal/photoprism/index.go:95 +0x265\n \n </denchmark-code>\n \n \t\t"}, "comments_24": {"comment_id": 25, "comment_author": "jean-louis67", "commentT": "2020-11-21T21:08:37Z", "comment_text": "\n \t\tThis error looks like this other one: <denchmark-link:https://github.com/photoprism/photoprism/issues/600#issuecomment-727545399>#600 (comment)</denchmark-link>\n \n \t\t"}, "comments_25": {"comment_id": 26, "comment_author": "jean-louis67", "commentT": "2020-11-21T22:31:12Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/oscar-b>@oscar-b</denchmark-link>\n  I'm going to have a look at the fatal error now.\n \t\t"}, "comments_26": {"comment_id": 27, "comment_author": "jean-louis67", "commentT": "2020-11-26T23:54:50Z", "comment_text": "\n \t\tClosing this since no negative test reports came in.\n \t\t"}}}, "commit": {"commit_id": "59a806c68528f554e4d1adab3ddf16a5e0ff3037", "commit_author": "Michael Mayer", "commitT": "2020-11-21 23:28:03+01:00", "commit_complexity": {"commit_NLOC": "0.75", "commit_CCN": "0.75", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "internal\\entity\\photo.go", "file_new_name": "internal\\entity\\photo.go", "file_complexity": {"file_NLOC": "731", "file_CCN": "223", "file_NToken": "5887"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "895,896,897,898,899,900,901", "deleted_lines": null, "method_info": {"method_name": "AllFiles", "method_params": "", "method_startline": "895", "method_endline": "901", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "52", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "911", "deleted_lines": null, "method_info": {"method_name": "Delete", "method_params": "bool", "method_startline": "904", "method_endline": "912", "method_complexity": {"method_NLOC": "7", "method_CCN": "2", "method_NToken": "65", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "internal\\photoprism\\index_mediafile.go", "file_new_name": "internal\\photoprism\\index_mediafile.go", "file_complexity": {"file_NLOC": "671", "file_CCN": "180", "file_NToken": "4890"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "52", "deleted_lines": "52", "method_info": {"method_name": "Success", "method_params": "", "method_startline": "51", "method_endline": "53", "method_complexity": {"method_NLOC": "3", "method_CCN": "5", "method_NToken": "43", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "254,731", "deleted_lines": "250,727", "method_info": {"method_name": "MediaFile", "method_params": "MediaFile,IndexOptions,string", "method_startline": "71", "method_endline": "807", "method_complexity": {"method_NLOC": "561", "method_CCN": "155", "method_NToken": "4302", "method_nesting_level": "0"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "67,68,69", "deleted_lines": null, "method_info": {"method_name": "Archived", "method_params": "", "method_startline": "67", "method_endline": "69", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "internal\\photoprism\\purge.go", "file_new_name": "internal\\photoprism\\purge.go", "file_complexity": {"file_NLOC": "152", "file_CCN": "36", "file_NToken": "889"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "101,110,163,164,165,166,167", "deleted_lines": "101,110", "method_info": {"method_name": "Start", "method_params": "PurgeOptions", "method_startline": "34", "method_endline": "195", "method_complexity": {"method_NLOC": "120", "method_CCN": "32", "method_NToken": "772", "method_nesting_level": "0"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "internal\\query\\files.go", "file_new_name": "internal\\query\\files.go", "file_complexity": {"file_NLOC": "103", "file_CCN": "26", "file_NToken": "857"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "133", "deleted_lines": "133", "method_info": {"method_name": "IndexedFiles", "method_params": "", "method_startline": "110", "method_endline": "142", "method_complexity": {"method_NLOC": "23", "method_CCN": "5", "method_NToken": "158", "method_nesting_level": "0"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "internal\\query\\photo.go", "file_new_name": "internal\\query\\photo.go", "file_complexity": {"file_NLOC": "91", "file_CCN": "6", "file_NToken": "624"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "77", "deleted_lines": "77", "method_info": {"method_name": "PhotosMissing", "method_params": "int,int", "method_startline": "73", "method_endline": "84", "method_complexity": {"method_NLOC": "11", "method_CCN": "1", "method_NToken": "81", "method_nesting_level": "0"}}}}}}}}