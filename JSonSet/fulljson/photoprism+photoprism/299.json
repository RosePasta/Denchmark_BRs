{"BR": {"BR_id": "299", "BR_author": "ravetam", "BRopenT": "2020-05-10T15:27:12Z", "BRcloseT": "2020-05-11T12:29:33Z", "BR_text": {"BRsummary": "Lost thumbnail after reindexed", "BRdescription": "\n First of all, this is an awesome tool, I have been using it for the past week to organize and geotag all my photos from a recent trip. One issue I encountered twice is that photoprism were not able to reverse lookup certain GPS location which causes the image to be tagged with \"Unknown\" location. So what i did is slightly modify those images GPS data with exiftool.\n Once re-indexed and since the image hash has now changed and thumbnail are named using the image's hash, Photoprism no longer finds the thumbnail.\n ERROR photo: thumbnail not cached\n However, a few smaller thumbnails are generated which i assumed are being used for labeling.\n \n \u251c\u2500\u2500 69f05da9b6a8113125dce0e5ffb9c5f6a5132f47_224x224_center.jpg\n \u251c\u2500\u2500 69f05da9b6a8113125dce0e5ffb9c5f6a5132f47_224x224_left.jpg\n \u251c\u2500\u2500 69f05da9b6a8113125dce0e5ffb9c5f6a5132f47_224x224_right.jpg\n \u2514\u2500\u2500 69f05da9b6a8113125dce0e5ffb9c5f6a5132f47_3x3_resize.png\n \n Maybe this can be fixed my renaming and moving the existing thumbnails to its new location. This will reduce a lot of orphaned thumbnails.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ravetam", "commentT": "2020-05-10T17:56:50Z", "comment_text": "\n \t\tWell observed, this is because we disabled on-demand thumbnail rendering as users with no thumbs at all were running out of memory, see <denchmark-link:https://github.com/photoprism/photoprism/issues/294>#294</denchmark-link>\n .\n In your case, on demand rendering probably wouldn't hurt as it's just a couple of photos. Your existing thumbs can not be found as the sha1 hash changed and that's the cache key.\n Either set PHOTOPRISM_THUMB_UNCACHED: \"true\" in docker-compose.yml or render missing thumbs:\n <denchmark-code>docker-compose exec photoprism photoprism thumbs\n </denchmark-code>\n \n We should automatically re-render those thumbs in the future and maybe delete the old ones to save storage.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ravetam", "commentT": "2020-05-10T18:14:33Z", "comment_text": "\n \t\tMy change should automatically trigger resampling when files were updated in the index. It does not clean-up the cache directory to remove old thumbs, that's an optimization we'll take care of later.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "ravetam", "commentT": "2020-05-10T18:15:09Z", "comment_text": "\n \t\tNew Docker build is available within the next hour. You're welcome to test!\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "ravetam", "commentT": "2020-05-11T03:14:10Z", "comment_text": "\n \t\tthanks for the quick response! i will test it tonight and post my result\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "ravetam", "commentT": "2020-05-11T12:29:33Z", "comment_text": "\n \t\tTested and confirm issue is fixed, new thumbnails are being generated now.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "ravetam", "commentT": "2020-05-11T12:33:35Z", "comment_text": "\n \t\tExcellent, thank you! :)\n \t\t"}}}, "commit": {"commit_id": "561323d544fb23ddfeae451bba957a7f69bb907c", "commit_author": "Michael Mayer", "commitT": "2020-05-10 20:10:17+02:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "internal\\photoprism\\index_worker.go", "file_new_name": "internal\\photoprism\\index_worker.go", "file_complexity": {"file_NLOC": "55", "file_CCN": "17", "file_NToken": "435"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "40,59", "deleted_lines": "40,59", "method_info": {"method_name": "IndexWorker", "method_params": "IndexJob", "method_startline": "15", "method_endline": "68", "method_complexity": {"method_NLOC": "44", "method_CCN": "17", "method_NToken": "414", "method_nesting_level": "0"}}}}}}}}