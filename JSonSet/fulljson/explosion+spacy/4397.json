{"BR": {"BR_id": "4397", "BR_author": "zrlaida", "BRopenT": "2019-10-08T07:48:16Z", "BRcloseT": "2019-10-08T10:07:03Z", "BR_text": {"BRsummary": "PhraseMatcher does not execute callback function on matches", "BRdescription": "\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n In the example from the documentation <denchmark-link:https://spacy.io/api/phrasematcher>https://spacy.io/api/phrasematcher</denchmark-link>\n \n the callback function is not executed:\n <denchmark-code>import spacy\n \n nlp = spacy.load(\"en_core_web_sm\")\n \n def on_match(matcher, doc, id, matches):\n       print('Matched!', matches)\n \n matcher = spacy.matcher.PhraseMatcher(nlp.vocab)\n matcher.add(\"OBAMA\", on_match, nlp(\"Barack Obama\"))\n matcher.add(\"HEALTH\", on_match, nlp(\"health care reform\"),\n                                   nlp(\"healthcare reform\"))\n doc = nlp(\"Barack Obama urges Congress to find courage to defend his healthcare reforms\")\n matches = matcher(doc)\n \n for match in matches:\n     print(\"Match: \", match, nlp.vocab.strings[match[0]])\n </denchmark-code>\n \n And another example:\n <denchmark-code>import spacy\n \n def on_match(matcher, doc, id, matches):\n     print('Callback executes on matches!', matches)\n \n nlp = spacy.load(\"en_core_web_sm\")\n matcher = spacy.matcher.PhraseMatcher(nlp.vocab)\n matcher.add(\"OBAMA\", on_match, nlp(\"Barack Obama\"))\n matcher.add(\"HEALTH\", on_match, nlp(\"health care reform\"), nlp(\"healthcare reform\"))\n doc = nlp(\"Barack Obama urges Congress to find courage to defend his healthcare reform\")\n print(\"Start matching. Print in on_match should come after this.\")\n matches = matcher(doc)\n for match in matches:\n     print(\"Match: \", match, nlp.vocab.strings[match[0]])\n </denchmark-code>\n \n <denchmark-h:h2>My Environment</denchmark-h>\n \n \n Operating System: MacOS 10.13.3\n Python Version Used: 3.7.0\n spaCy Version Used: 2.2.1\n Environment Information:\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "zrlaida", "commentT": "2019-10-08T07:56:32Z", "comment_text": "\n \t\tThanks for the report! This is a bug we should have caught before releasing 2.2. I'll fix it and update the test suite so similar issues are detected better in the future.\n (You can always edit the issue instead of opening a new one, it's no problem!)\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "zrlaida", "commentT": "2019-11-07T10:54:32Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "14841d0aa63ccc48605757e5121cbb4170e7c7b2", "commit_author": "adrianeboyd", "commitT": "2019-10-08 12:07:02+02:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\matcher\\phrasematcher.pyx", "file_new_name": "spacy\\matcher\\phrasematcher.pyx", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "228", "deleted_lines": "228"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\matcher\\test_matcher_api.py", "file_new_name": "spacy\\tests\\matcher\\test_matcher_api.py", "file_complexity": {"file_NLOC": "345", "file_CCN": "38", "file_NToken": "3068"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "424,425,426,427,428,429,430,431", "deleted_lines": null, "method_info": {"method_name": "test_matcher_callback", "method_params": "en_vocab", "method_startline": "424", "method_endline": "431", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "73", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\matcher\\test_phrase_matcher.py", "file_new_name": "spacy\\tests\\matcher\\test_phrase_matcher.py", "file_complexity": {"file_NLOC": "187", "file_CCN": "14", "file_NToken": "1711"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "221,222,223,224,225,226,227,228", "deleted_lines": null, "method_info": {"method_name": "test_phrase_matcher_callback", "method_params": "en_vocab", "method_startline": "221", "method_endline": "228", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "78", "method_nesting_level": "0"}}}}}}}}