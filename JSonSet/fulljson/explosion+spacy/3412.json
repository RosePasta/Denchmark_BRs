{"BR": {"BR_id": "3412", "BR_author": "sarim-zafar", "BRopenT": "2019-03-15T20:05:59Z", "BRcloseT": "2019-10-21T10:04:47Z", "BR_text": {"BRsummary": "most_similar() not working", "BRdescription": "\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n import spacy\n nlp = spacy.load('en_core_web_lg')\n nlp.vocab.vectors.most_similar(nlp('cats').vector.reshape(1,300))\n returns following\n (array([], dtype=uint64), array([0], dtype=int32), array([nan], dtype=float32))\n While computing the results i get the following warning\n /anaconda3/envs/deep/lib/python3.6/site-packages/ipykernel_launcher.py:1: RuntimeWarning: divide by zero encountered in true_divide \"\"\"Entry point for launching an IPython kernel. /anaconda3/envs/deep/lib/python3.6/site-packages/ipykernel_launcher.py:1: RuntimeWarning: invalid value encountered in true_divide \"\"\"Entry point for launching an IPython kernel. /anaconda3/envs/deep/lib/python3.6/site-packages/numpy/core/_methods.py:28: RuntimeWarning: invalid value encountered in reduce return umr_maximum(a, axis, None, out, keepdims, initial)\n <denchmark-h:h2>Info about spaCy and Enviroment</denchmark-h>\n \n \n spaCy version: 2.1.0a13\n Platform: Darwin-18.2.0-x86_64-i386-64bit\n Python version: 3.6.8\n Models: en_core_web_lg, xx_ent_wiki_sm, xx\n Environment Information: Anaconda\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "sarim-zafar", "commentT": "2019-03-17T19:11:24Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/ines>@ines</denchmark-link>\n , any idea what I should do fix it?. Is there any version you recommend I roll back to in which this feature works?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "sarim-zafar", "commentT": "2019-03-20T20:36:35Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/emiguevara>@emiguevara</denchmark-link>\n  but i am not using a GPU, its a plain MacBook\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "sarim-zafar", "commentT": "2019-03-23T19:56:49Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ines>@ines</denchmark-link>\n  any kind of response would be appreciated\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "sarim-zafar", "commentT": "2019-04-08T18:54:44Z", "comment_text": "\n \t\tThe problem seems to be with the nlp.vocab.vectors.data. The first row is all zeros, so normalizing the vectors for cosine distance does a divide by zero.\n <denchmark-code>In [1]: import spacy                                                                                                \n \n In [2]: nlp = spacy.load('en_core_web_lg')                                                                          \n \n In [3]: nlp.vocab.vectors.data                                                                                      \n Out[3]: \n array([[ 0.       ,  0.       ,  0.       , ...,  0.       ,  0.       ,\n          0.       ],\n        [ 0.012001 ,  0.20751  , -0.12578  , ...,  0.13871  , -0.36049  ,\n         -0.035    ],\n        [-0.082752 ,  0.67204  , -0.14987  , ..., -0.1918   , -0.37846  ,\n         -0.06589  ],\n        ...,\n        [ 0.42247  , -0.28522  , -0.38661  , ...,  0.27521  ,  0.23623  ,\n         -0.72113  ],\n        [ 0.47918  , -0.32734  , -0.23593  , ..., -0.19494  , -0.065226 ,\n         -0.36282  ],\n        [-0.63354  , -0.1503   , -0.36161  , ...,  0.26216  , -0.12094  ,\n          0.0038262]], dtype=float32)\n </denchmark-code>\n \n I think it might be the OOV vector?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "sarim-zafar", "commentT": "2019-04-13T22:53:03Z", "comment_text": "\n \t\tJust a side note:\n It works fine with en_core_web_md model\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "sarim-zafar", "commentT": "2019-11-20T10:54:46Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "d5d55312b2c5184ec96f8f073eab1b045b441fe4", "commit_author": "Sofie Van Landeghem", "commitT": "2019-10-21 12:04:46+02:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\regression\\test_issue3001-3500.py", "file_new_name": "spacy\\tests\\regression\\test_issue3001-3500.py", "file_complexity": {"file_NLOC": "268", "file_CCN": "22", "file_NToken": "2093"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "297,298,299,300,301", "deleted_lines": null, "method_info": {"method_name": "test_issue3412", "method_params": "", "method_startline": "297", "method_endline": "301", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "94", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\vectors.pyx", "file_new_name": "spacy\\vectors.pyx", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "324,325,326,333,334,335", "deleted_lines": "324,331"}}}}}}