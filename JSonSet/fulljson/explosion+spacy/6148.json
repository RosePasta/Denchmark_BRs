{"BR": {"BR_id": "6148", "BR_author": "delzac", "BRopenT": "2020-09-25T12:15:42Z", "BRcloseT": "2020-10-31T11:18:48Z", "BR_text": {"BRsummary": "Matcher.remove crashes if {\"OP\": \"!\"} token is in any pattern of any rule", "BRdescription": "\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n <denchmark-code>nlp = en_core_web_sm.load()\n matcher = Matcher(nlp.vocab)\n \n offending_pattern = [{'OP': '!'}, ]\n matcher.add('test-rule', [offending_pattern ])\n matcher.add('random-rule', [[{\"LOWER\": \"hi\"}]])\n assert 'random-rule' in matcher\n matcher.remove('random-rule')  # crashes here: \"Process finished with exit code -1073741819 (0xC0000005)\"\n assert 'random-rule' not in matcher\n \n </denchmark-code>\n \n When {\"OP\": \"!\"} is inside any pattern, removing any rules will result in program crashing \"Process finished with exit code -1073741819 (0xC0000005)\"\n <denchmark-h:h2>Your Environment</denchmark-h>\n \n \n Operating System: Windows 10\n Python Version Used: Python 3.6\n spaCy Version Used: Spacy v2.3.2\n Environment Information: nil\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "delzac", "commentT": "2020-09-28T11:15:07Z", "comment_text": "\n \t\tHi, I can replicate this and we will look into it.\n \t\t"}}}, "commit": {"commit_id": "45c9a688285081cd69faa0627d9bcaf1f5e799a1", "commit_author": "Adriane Boyd", "commitT": "2020-10-31 12:18:48+01:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\matcher\\matcher.pxd", "file_new_name": "spacy\\matcher\\matcher.pxd", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "29", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\matcher\\matcher.pyx", "file_new_name": "spacy\\matcher\\matcher.pyx", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "561,600,601,602,603,606,613", "deleted_lines": "561,600,601,604,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\matcher\\test_matcher_api.py", "file_new_name": "spacy\\tests\\matcher\\test_matcher_api.py", "file_complexity": {"file_NLOC": "397", "file_CCN": "42", "file_NToken": "3534"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "484,485,486,487,488,489,490,491,492,493", "deleted_lines": null, "method_info": {"method_name": "test_matcher_remove_zero_operator", "method_params": "en_vocab", "method_startline": "484", "method_endline": "493", "method_complexity": {"method_NLOC": "10", "method_CCN": "1", "method_NToken": "78", "method_nesting_level": "0"}}}}}}}}