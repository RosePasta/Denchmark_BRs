{"BR": {"BR_id": "6755", "BR_author": "nj-vs-vh", "BRopenT": "2021-01-18T12:28:31Z", "BRcloseT": "2021-01-21T15:18:47Z", "BR_text": {"BRsummary": "Misleading error when getting empty span's `text` attribute", "BRdescription": "\n Slicing empty span from Doc works without errors (e.g. doc[:0] or doc[3:3]), but attempt to use text attribute of a resulting empty span throws IndexError: [E201] Span index out of range. However, text_with_ws, attribute works fine, so it'll do as a workaround for my usage, but that seems like a very unintuitive behaviour.\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n import spacy\n \n nlp = spacy.load('en')\n doc = nlp('something')\n print(doc[:0].text_with_ws)  # prints empty string, as expected\n print(doc[:0].text)  # throws IndexError: [E201] Span index out of range\n <denchmark-h:h2>Your Environment</denchmark-h>\n \n \n spaCy version: 2.3.5\n Platform: Linux-5.8.0-38-generic-x86_64-with-glibc2.29\n Python version: 3.8.5\n Models: en\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "nj-vs-vh", "commentT": "2021-01-20T11:11:36Z", "comment_text": "\n \t\tThanks for the report and minimal code snippet! Always appreciated :-)\n This looks to be a small bug in the implementation of : it tries to remove the last space of the last token before returning the result, but this gives an  when the span is empty, because there is no last token. Should be fixed by PR <denchmark-link:https://github.com/explosion/spaCy/pull/6772>#6772</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "5ace559201c714ab89b3092b87d791e16973f31d", "commit_author": "Sofie Van Landeghem", "commitT": "2021-01-21 23:18:46+08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "1.0"}, "changed_files": {"file_0": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "spacy\\tests\\regression\\test_issue6755.py", "file_complexity": {"file_NLOC": "6", "file_CCN": "1", "file_NToken": "35"}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\tokens\\span.pyx", "file_new_name": "spacy\\tokens\\span.pyx", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "503", "deleted_lines": "503"}}}}}}