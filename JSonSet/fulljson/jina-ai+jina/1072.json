{"BR": {"BR_id": "1072", "BR_author": "nan-wang", "BRopenT": "2020-10-13T02:31:29Z", "BRcloseT": "2020-10-15T12:04:29Z", "BR_text": {"BRsummary": "`queryset` passed from the `flow.search` API is not parsed properly", "BRdescription": "\n Describe the bug\n In the following codes, lookups will be kept as a google.protobuf.struct_pb2.Struct which can't be further evaluated in the apply_all function\n <denchmark-code>        qs = jina_pb2.QueryLang(name='FilterQL', priority=100)\n         qs.parameters['lookups'] = {'tags__label': 'label1'}\n         query_flow.search(docs[:1], queryset=qs, output_fn=validate_only_label2, callback_on_body=True)\n </denchmark-code>\n \n reference:\n <denchmark-link:https://github.com/jina-ai/jina/blob/master/jina/drivers/__init__.py#L86>https://github.com/jina-ai/jina/blob/master/jina/drivers/__init__.py#L86</denchmark-link>\n \n <denchmark-link:https://github.com/jina-ai/jina/blob/master/jina/drivers/querylang/filter.py#L43>https://github.com/jina-ai/jina/blob/master/jina/drivers/querylang/filter.py#L43</denchmark-link>\n \n Describe how you solve it\n <denchmark-h:hr></denchmark-h>\n \n Environment\n Screenshots\n \t"}, "comments": {}}, "commit": {"commit_id": "067e8e46fb82d4d40f5a412758f0a1fd32ad101c", "commit_author": "Nan Wang", "commitT": "2020-10-15 14:04:28+02:00", "commit_complexity": {"commit_NLOC": "0.3448275862068966", "commit_CCN": "0.9655172413793104", "commit_Nprams": "0.9310344827586207"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "jina\\drivers\\__init__.py", "file_new_name": "jina\\drivers\\__init__.py", "file_complexity": {"file_NLOC": "258", "file_CCN": "79", "file_NToken": "1593"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "87,88", "deleted_lines": "86", "method_info": {"method_name": "_get_parameter", "method_params": "self,str,Any", "method_startline": "82", "method_endline": "89", "method_complexity": {"method_NLOC": "8", "method_CCN": "8", "method_NToken": "94", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "jina\\drivers\\querylang\\filter.py", "file_new_name": "jina\\drivers\\querylang\\filter.py", "file_complexity": {"file_NLOC": "40", "file_CCN": "6", "file_NToken": "161"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "37", "deleted_lines": "37", "method_info": {"method_name": "__init__", "method_params": "self,str,args,kwargs", "method_startline": "30", "method_endline": "37", "method_complexity": {"method_NLOC": "8", "method_CCN": "1", "method_NToken": "38", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "41,44", "deleted_lines": "43", "method_info": {"method_name": "_apply_all", "method_params": "self,args,kwargs", "method_startline": "39", "method_endline": "49", "method_complexity": {"method_NLOC": "9", "method_CCN": "5", "method_NToken": "76", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "tests\\integration\\issues\\github_1072\\__init__.py", "file_new_name": "tests\\integration\\issues\\github_1072\\__init__.py", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}}, "file_3": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tests\\integration\\issues\\github_1072\\test_queryset.py", "file_complexity": {"file_NLOC": "33", "file_CCN": "5", "file_NToken": "264"}}}}}