{"BR": {"BR_id": "1555", "BR_author": "typhoonzero", "BRopenT": "2019-12-27T08:47:36Z", "BRcloseT": "2019-12-27T22:33:39Z", "BR_text": {"BRsummary": "New sqlflow models may not pass attribute validation", "BRdescription": "\n If we develop a new Keras model under the models repo and try using it in SQLFlow, if the model arguments are not listed in model_parameters.go, the train SQL will report errors like:\n <denchmark-code>---------------------------------------------------------------------------\n _MultiThreadedRendezvous                  Traceback (most recent call last)\n <ipython-input-3-cae0cd58c2ab> in <module>\n ----> 1 get_ipython().run_cell_magic('sqlflow', '', 'SELECT * FROM iris.train \\nTO TRAIN sqflow_models.LSTMBasedTimeSeriesModel \\nWITH\\n  model.n_in = 4,\\n  model.stack_units=[50, 50],\\n  model.n_out = 1\\nLABEL class\\nINTO sqlflow_models.my_lstmts_model;\\n')\n \n /miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/IPython/core/interactiveshell.py in run_cell_magic(self, magic_name, line, cell)\n    2350             with self.builtin_trap:\n    2351                 args = (magic_arg_s, cell)\n -> 2352                 result = fn(*args, **kwargs)\n    2353             return result\n    2354 \n \n </miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/decorator.py:decorator-gen-126> in execute(self, line, cell)\n \n /miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/IPython/core/magic.py in <lambda>(f, *a, **k)\n     185     # but it's overkill for just that one bit of state.\n     186     def magic_deco(arg):\n --> 187         call = lambda f, *a, **k: f(*a, **k)\n     188 \n     189         if callable(arg):\n \n /miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/sqlflow/magic.py in execute(self, line, cell)\n      43 \n      44         \"\"\"\n ---> 45         return self.client.execute('\\n'.join([line, cell]))\n      46 \n      47 def load_ipython_extension(ipython):\n \n /miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/sqlflow/client.py in execute(self, operation)\n     111             # NOTE: raise exception to interrupt notebook execution. Or\n     112             # the notebook will continue execute the next block.\n --> 113             raise e\n     114         except EnvExpanderError as e:\n     115             raise e\n \n /miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/sqlflow/client.py in execute(self, operation)\n     107         try:\n     108             stream_response = self._stub.Run(self.sql_request(operation), timeout=DEFAULT_TIMEOUT)\n --> 109             return self.display(stream_response)\n     110         except grpc.RpcError as e:\n     111             # NOTE: raise exception to interrupt notebook execution. Or\n \n /miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/sqlflow/client.py in display(cls, stream_response)\n     121         while True:\n     122             try:\n --> 123                 first = next(stream_response)\n     124             except StopIteration:\n     125                 break\n \n /miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/grpc/_channel.py in __next__(self)\n     414 \n     415     def __next__(self):\n --> 416         return self._next()\n     417 \n     418     def _next(self):\n \n /miniconda/envs/sqlflow-dev/lib/python3.6/site-packages/grpc/_channel.py in _next(self)\n     701                     raise StopIteration()\n     702                 elif self._state.code is not None:\n --> 703                     raise self\n     704 \n     705 \n \n _MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:\n   status = StatusCode.UNKNOWN\n   details = \"unsupported attribute model.n_in\"\n   debug_error_string = \"{\"created\":\"@1577434767.807456700\",\"description\":\"Error received from peer ipv4:127.0.0.1:50051\",\"file\":\"src/core/lib/surface/call.cc\",\"file_line\":1056,\"grpc_message\":\"unsupported attribute model.n_in\",\"grpc_status\":2}\"\n >\n </denchmark-code>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "9407c4bc819fc8b249a8d30e72cad0729e644955", "commit_author": "Wu Yi", "commitT": "2019-12-27 14:33:39-08:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "cmd\\repl\\repl_test.go", "file_new_name": "cmd\\repl\\repl_test.go", "file_complexity": {"file_NLOC": "278", "file_CCN": "27", "file_NToken": "2425"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "148", "deleted_lines": "148", "method_info": {"method_name": "TestComplete", "method_params": "T", "method_startline": "131", "method_endline": "210", "method_complexity": {"method_NLOC": "64", "method_CCN": "1", "method_NToken": "764", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "doc\\model_parameter.md", "file_new_name": "doc\\model_parameter.md", "file_complexity": {"file_NLOC": "None", "file_CCN": "None", "file_NToken": "None"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "200,201,202,203,204", "deleted_lines": null}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pkg\\sql\\codegen\\attribute\\attribute_test.go", "file_new_name": "pkg\\sql\\codegen\\attribute\\attribute_test.go", "file_complexity": {"file_NLOC": "80", "file_CCN": "6", "file_NToken": "695"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "46", "deleted_lines": "46", "method_info": {"method_name": "TestPremadeModelParamsDocs", "method_params": "T", "method_startline": "43", "method_endline": "58", "method_complexity": {"method_NLOC": "13", "method_CCN": "1", "method_NToken": "151", "method_nesting_level": "0"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "pkg\\sql\\codegen\\attribute\\model_parameters.go", "file_new_name": "pkg\\sql\\codegen\\attribute\\model_parameters.go", "file_complexity": {"file_NLOC": "206", "file_CCN": "0", "file_NToken": "768"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174"}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "pkg\\sql\\codegen\\tensorflow\\codegen.go", "file_new_name": "pkg\\sql\\codegen\\tensorflow\\codegen.go", "file_complexity": {"file_NLOC": "391", "file_CCN": "84", "file_NToken": "2728"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "55", "deleted_lines": null}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\extract_docstring.py", "file_new_name": "python\\extract_docstring.py", "file_complexity": {"file_NLOC": "44", "file_CCN": "4", "file_NToken": "295"}, "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "87,88,89,90,91"}}}}}}