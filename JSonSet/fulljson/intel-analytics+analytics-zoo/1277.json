{"BR": {"BR_id": "1277", "BR_author": "shane-huang", "BRopenT": "2019-04-12T10:03:53Z", "BRcloseT": "2019-04-16T06:42:07Z", "BR_text": {"BRsummary": "Keras-style API model load/save issue for resume training", "BRdescription": "\n \n \n Neither of save or saveModel work with Net.load\n \n model.save + Net.load will lead to NullPointerException from bigdl.utils.serializer.ModuleLoader. The error message does not make any sense to the user.\n save a model usingmodel.saveModel and then load model using Net.load, then call model.fit will lead to an error says \"'ZooKerasLayer' object has no attribute 'fit'\"\n \n \n \n We should add test case and example for resume training as it's a very common request from customers.  Also, model save and saveModel has no clear documents and user don't know which they should use. It easily cause confusion. We may just keep one of them.\n \n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "shane-huang", "commentT": "2019-04-12T10:05:04Z", "comment_text": "\n \t\trelated to issue <denchmark-link:https://github.com/intel-analytics/analytics-zoo/issues/1004>#1004</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "shane-huang", "commentT": "2019-04-15T05:19:55Z", "comment_text": "\n \t\tAny example code for reproducing this?\n I tried with the following snippet, and it works fine:\n <denchmark-code>  input = ZLayer.Input(shape=(5,))\n         output = ZLayer.Dense(10)(input)\n         zmodel = ZModel(input, output, name=\"graph1\")\n         tmp_path = \"/tmp/aaa\" \n         # zmodel.saveModel(tmp_path, None, True)\n         model_reloaded = Net.load(tmp_path)\n </denchmark-code>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "shane-huang", "commentT": "2019-04-15T06:39:35Z", "comment_text": "\n \t\tProbably Net.load in Python doesn't gives an instance of KerasNet and thus can't call fit?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "shane-huang", "commentT": "2019-04-15T07:07:16Z", "comment_text": "\n \t\tEmmm... Just checked that Net.load returns a KerasNet and should have fit method...\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "shane-huang", "commentT": "2019-04-16T06:42:07Z", "comment_text": "\n \t\tfixed.\n \t\t"}}}, "commit": {"commit_id": "90984c46e8b24ce8dfd4848c9316324b94960baf", "commit_author": "li,zhichao", "commitT": "2019-04-16 14:40:12+08:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.8307692307692308"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "pyzoo\\test\\zoo\\pipeline\\api\\keras\\test_net.py", "file_new_name": "pyzoo\\test\\zoo\\pipeline\\api\\keras\\test_net.py", "file_complexity": {"file_NLOC": "108", "file_CCN": "10", "file_NToken": "1073"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "76,77,78,79,80,81,82,83,84,85,86,87", "deleted_lines": null, "method_info": {"method_name": "test_save_load_Sequential", "method_params": "self", "method_startline": "76", "method_endline": "87", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "111", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "63,70,71,72,73,74", "deleted_lines": null, "method_info": {"method_name": "test_save_load_Model", "method_params": "self", "method_startline": "63", "method_endline": "74", "method_complexity": {"method_NLOC": "12", "method_CCN": "1", "method_NToken": "124", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "56,57,58,59,60,61", "deleted_lines": "59", "method_info": {"method_name": "test_deprecated_save", "method_params": "self", "method_startline": "56", "method_endline": "61", "method_complexity": {"method_NLOC": "6", "method_CCN": "1", "method_NToken": "59", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "89,90,91,92,93,94,95", "deleted_lines": null, "method_info": {"method_name": "test_load", "method_params": "self", "method_startline": "89", "method_endline": "97", "method_complexity": {"method_NLOC": "9", "method_CCN": "1", "method_NToken": "88", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "pyzoo\\zoo\\pipeline\\api\\keras\\engine\\topology.py", "file_new_name": "pyzoo\\zoo\\pipeline\\api\\keras\\engine\\topology.py", "file_complexity": {"file_NLOC": "271", "file_CCN": "65", "file_NToken": "1783"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "33,34,35,36,37,38,39,40,41,42,43,44,45", "deleted_lines": null, "method_info": {"method_name": "saveModel", "method_params": "self,modelPath,weightPath,over_write", "method_startline": "33", "method_endline": "45", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "37", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "30,31", "deleted_lines": null, "method_info": {"method_name": "save", "method_params": "self,path,over_write", "method_startline": "30", "method_endline": "31", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "16", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "pyzoo\\zoo\\pipeline\\api\\net.py", "file_new_name": "pyzoo\\zoo\\pipeline\\api\\net.py", "file_complexity": {"file_NLOC": "767", "file_CCN": "154", "file_NToken": "5841"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "155,156,157", "deleted_lines": null, "method_info": {"method_name": "from_jvalue", "method_params": "jvalue,bigdl_type", "method_startline": "155", "method_endline": "157", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "31", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "184", "deleted_lines": null, "method_info": {"method_name": "load", "method_params": "model_path,weight_path,bigdl_type", "method_startline": "172", "method_endline": "184", "method_complexity": {"method_NLOC": "3", "method_CCN": "1", "method_NToken": "35", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136", "deleted_lines": null, "method_info": {"method_name": "get_python_class", "method_params": "self", "method_startline": "121", "method_endline": "136", "method_complexity": {"method_NLOC": "10", "method_CCN": "2", "method_NToken": "98", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "138,139,140,141,142,143,144", "deleted_lines": "138", "method_info": {"method_name": "_get_py_name", "method_params": "self,jclass_name", "method_startline": "138", "method_endline": "144", "method_complexity": {"method_NLOC": "7", "method_CCN": "3", "method_NToken": "33", "method_nesting_level": "1"}}}, "hunk_4": {"Ismethod": 1, "added_lines": "146,147,148,149", "deleted_lines": null, "method_info": {"method_name": "_load_ppackage_by_jpackage", "method_params": "self,jpackage_name", "method_startline": "146", "method_endline": "149", "method_complexity": {"method_NLOC": "4", "method_CCN": "2", "method_NToken": "27", "method_nesting_level": "1"}}}, "hunk_5": {"Ismethod": 1, "added_lines": "115,116,117,118,119", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,jvalue,bigdl_type", "method_startline": "115", "method_endline": "119", "method_complexity": {"method_NLOC": "5", "method_CCN": "1", "method_NToken": "28", "method_nesting_level": "1"}}}}}}}}