{"BR": {"BR_id": "306", "BR_author": "ethiy", "BRopenT": "2019-01-16T19:41:12Z", "BRcloseT": "2019-03-03T02:03:10Z", "BR_text": {"BRsummary": "Padding size problem", "BRdescription": "\n I was trying the Scattering2D on my data and it did not work. I had this error message:\n \n RuntimeError: The filters are not compatible for multiplication!\n \n While debugging, I found out that the padding does not work well with some input shapes. Here is a minimal example:\n import torch\n r = torch.randn(1, 1, 45, 45)\n \n from kymatio import Scattering2D\n scatterer = Scattering2D(J=3, shape=tuple(r.size()[2:]))\n \n from kymatio.scattering2d.backend import fft\n print(scatterer.Phi[0].size()) # size -> torch.Size([56, 56, 2])\n print(fft(scatterer.pad(r), 'C2C').size()) # this is the 'U_0_c' size -> torch.Size([1, 1, 61, 61, 2])\n print(scatterer.forward(r))\n I have tried other matrix shapes and it seems that the U_0_c size, in axis d=2,3, is equal to the size of Phi[0], in axis d-2, plus the rest of the Euclidian division of the original size, in axis d-2, on 2^J. This causes the later uncatched exception.\n Was this unintended? or was it the contrary (which implies that I have to choose a good J value)?\n If it is the last case, how to choose J when I have no guaranty over the input sizes?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ethiy", "commentT": "2019-01-16T19:47:55Z", "comment_text": "\n \t\tThanks for pointing this out. My bad. The padding process has some issues for a subset of input size.\n Duplicate of <denchmark-link:https://github.com/kymatio/kymatio/issues/284>#284</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "5f0a67ce3c2d01a2da19b18f2f0834bb31c35182", "commit_author": "Edouard Oyallon", "commitT": "2019-03-02 21:03:10-05:00", "commit_complexity": {"commit_NLOC": "1.0", "commit_CCN": "1.0", "commit_Nprams": "0.8666666666666667"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "kymatio\\scattering2d\\backend\\backend_skcuda.py", "file_new_name": "kymatio\\scattering2d\\backend\\backend_skcuda.py", "file_complexity": {"file_NLOC": "187", "file_CCN": "35", "file_NToken": "1074"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "49,50,51,52,53,54,55,56,57", "deleted_lines": "49,50,51,52,53,54,55,56", "method_info": {"method_name": "__call__", "method_params": "self,input", "method_startline": "49", "method_endline": "57", "method_complexity": {"method_NLOC": "9", "method_CCN": "2", "method_NToken": "116", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "41,47,49", "deleted_lines": "41,47,49", "method_info": {"method_name": "__init__", "method_params": "self,pad_size,pre_pad", "method_startline": "34", "method_endline": "49", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "51,52", "deleted_lines": "51,52", "method_info": {"method_name": "build", "method_params": "self", "method_startline": "51", "method_endline": "52", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "15", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "54,55,56,57,58", "deleted_lines": "54,55,56", "method_info": {"method_name": "__call__", "method_params": "self,x", "method_startline": "54", "method_endline": "59", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "46", "method_nesting_level": "1"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "kymatio\\scattering2d\\backend\\backend_torch.py", "file_new_name": "kymatio\\scattering2d\\backend\\backend_torch.py", "file_complexity": {"file_NLOC": "106", "file_CCN": "22", "file_NToken": "815"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "21,27,29", "deleted_lines": "21,27,29", "method_info": {"method_name": "__init__", "method_params": "self,pad_size,pre_pad", "method_startline": "14", "method_endline": "29", "method_complexity": {"method_NLOC": "4", "method_CCN": "1", "method_NToken": "27", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "31,32", "deleted_lines": "31,32", "method_info": {"method_name": "build", "method_params": "self", "method_startline": "31", "method_endline": "32", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "15", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "34,35,36,37,38", "deleted_lines": "34,35,36", "method_info": {"method_name": "__call__", "method_params": "self,x", "method_startline": "34", "method_endline": "39", "method_complexity": {"method_NLOC": "6", "method_CCN": "2", "method_NToken": "46", "method_nesting_level": "1"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "29,30,31,32,33,34,35,36,37", "deleted_lines": "29,30,31,32,33,34,35,36", "method_info": {"method_name": "__call__", "method_params": "self,input", "method_startline": "29", "method_endline": "37", "method_complexity": {"method_NLOC": "9", "method_CCN": "2", "method_NToken": "116", "method_nesting_level": "1"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "kymatio\\scattering2d\\scattering2d.py", "file_new_name": "kymatio\\scattering2d\\scattering2d.py", "file_complexity": {"file_NLOC": "175", "file_CCN": "27", "file_NToken": "995"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "101,102,103", "deleted_lines": "101,104", "method_info": {"method_name": "build", "method_params": "self", "method_startline": "98", "method_endline": "108", "method_complexity": {"method_NLOC": "9", "method_CCN": "2", "method_NToken": "119", "method_nesting_level": "1"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "kymatio\\scattering2d\\tests\\test_scattering2d.py", "file_new_name": "kymatio\\scattering2d\\tests\\test_scattering2d.py", "file_complexity": {"file_NLOC": "235", "file_CCN": "54", "file_NToken": "2261"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315", "deleted_lines": null, "method_info": {"method_name": "test_input_size_agnostic", "method_params": "", "method_startline": "297", "method_endline": "315", "method_complexity": {"method_NLOC": "15", "method_CCN": "5", "method_NToken": "138", "method_nesting_level": "0"}}}}}}}}