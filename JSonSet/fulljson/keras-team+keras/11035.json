{"BR": {"BR_id": "11035", "BR_author": "Giszy", "BRopenT": "2018-08-30T11:02:33Z", "BRcloseT": "2018-11-26T21:01:21Z", "BR_text": {"BRsummary": "batch_dot() behavior inconsistent between different backends", "BRdescription": "\n The following code worked well using the backend of tensorflow.\n import numpy as np\n np.random.seed=0\n a=np.random.uniform(0,100,[2,4,3])\n b=np.random.uniform(0,100,[2,3,5])\n import keras\n k=keras.backend\n ka=k.variable(a)\n kb=k.variable(b)\n kc=k.batch_dot(ka, kb, (2,1))\n k.eval(kc)\n But it returned incorrect result using the backend of cntk: kc.shape=[2,4,2,5].\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "Giszy", "commentT": "2018-09-03T20:37:46Z", "comment_text": "\n \t\tSee <denchmark-link:https://github.com/keras-team/keras/pull/11059>#11059</denchmark-link>\n . There is an edge case missing, which is why its closed. Will be fixing it soon.\n \t\t"}}}, "commit": {"commit_id": "9148325b9ca9edf94aaebd453b3cf86dba2ef99a", "commit_author": "Fariz Rahman", "commitT": "2018-10-26 11:44:43+09:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "keras\\backend\\cntk_backend.py", "file_new_name": "keras\\backend\\cntk_backend.py", "file_complexity": {"file_NLOC": "2034", "file_CCN": "528", "file_NToken": "14765"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,595,596,598,599,600,601,602,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708", "deleted_lines": "574,576,577,583,584,585,586,587,588,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609", "method_info": {"method_name": "batch_dot", "method_params": "x,y,axes", "method_startline": "569", "method_endline": "708", "method_complexity": {"method_NLOC": "101", "method_CCN": "31", "method_NToken": "682", "method_nesting_level": "0"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "1235,1236,1237", "deleted_lines": null, "method_info": {"method_name": "stack", "method_params": "x,axis", "method_startline": "1235", "method_endline": "1237", "method_complexity": {"method_NLOC": "3", "method_CCN": "2", "method_NToken": "30", "method_nesting_level": "0"}}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "keras\\backend\\tensorflow_backend.py", "file_new_name": "keras\\backend\\tensorflow_backend.py", "file_complexity": {"file_NLOC": "1887", "file_CCN": "403", "file_NToken": "13677"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1093,1102,1116,1117,1118,1119,1120,1121,1122,1123,1142,1147,1148,1149,1150,1151,1152,1153,1154,1155,1156,1157,1158,1159,1160,1161,1162,1163,1164,1165,1166,1167,1168,1169,1170,1172,1173,1175,1176,1177,1178,1179,1184,1185,1186,1187,1188,1189,1190,1191,1192,1193,1194,1195,1196,1197,1198,1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210,1211,1212,1213,1214,1215,1216,1217,1218,1219,1220,1221,1222,1223,1224,1225,1226,1227,1228,1229,1230,1231,1232,1233,1234,1235,1236,1237,1238,1239,1240", "deleted_lines": "1093,1102,1103,1135,1141,1142,1143,1145,1146,1151,1152,1153,1154,1155,1156,1157,1158,1159,1160,1161,1162,1163,1164,1165,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175,1176,1177,1178,1179,1180", "method_info": {"method_name": "batch_dot", "method_params": "x,y,axes", "method_startline": "1089", "method_endline": "1240", "method_complexity": {"method_NLOC": "71", "method_CCN": "22", "method_NToken": "546", "method_nesting_level": "0"}}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "keras\\backend\\theano_backend.py", "file_new_name": "keras\\backend\\theano_backend.py", "file_complexity": {"file_NLOC": "1883", "file_CCN": "421", "file_NToken": "14520"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "468,469,470,471,479,480,481,482,483", "deleted_lines": "468,476,477,478,479,480,481,482,483", "method_info": {"method_name": "batch_dot", "method_params": "x,y,axes", "method_startline": "426", "method_endline": "500", "method_complexity": {"method_NLOC": "34", "method_CCN": "16", "method_NToken": "272", "method_nesting_level": "0"}}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "tests\\keras\\backend\\backend_test.py", "file_new_name": "tests\\keras\\backend\\backend_test.py", "file_complexity": {"file_NLOC": "1650", "file_CCN": "213", "file_NToken": "18477"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "235,236,237,238,239,240,241,242,243,244", "deleted_lines": null, "method_info": {"method_name": "test_linear_operations", "method_params": "self", "method_startline": "221", "method_endline": "249", "method_complexity": {"method_NLOC": "27", "method_CCN": "2", "method_NToken": "392", "method_nesting_level": "1"}}}, "hunk_1": {"Ismethod": 1, "added_lines": "262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309", "deleted_lines": "261,262,263,264,265", "method_info": {"method_name": "test_batch_dot_shape", "method_params": "self", "method_startline": "261", "method_endline": "309", "method_complexity": {"method_NLOC": "31", "method_CCN": "4", "method_NToken": "377", "method_nesting_level": "1"}}}, "hunk_2": {"Ismethod": 1, "added_lines": "275,276", "deleted_lines": null, "method_info": {"method_name": "test_batch_dot_shape.batch_shape", "method_params": "shape", "method_startline": "275", "method_endline": "276", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "16", "method_nesting_level": "2"}}}, "hunk_3": {"Ismethod": 1, "added_lines": "278,279", "deleted_lines": null, "method_info": {"method_name": "test_batch_dot_shape.random", "method_params": "shape", "method_startline": "278", "method_endline": "279", "method_complexity": {"method_NLOC": "2", "method_CCN": "1", "method_NToken": "17", "method_nesting_level": "2"}}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\keras\\backend\\reference_operations.py", "file_new_name": "tests\\keras\\backend\\reference_operations.py", "file_complexity": {"file_NLOC": "485", "file_CCN": "184", "file_NToken": "4777"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "517,518,519,521,522,523,524,526,527,528,529,530,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566", "deleted_lines": "518,520,521,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551", "method_info": {"method_name": "batch_dot", "method_params": "x,y,axes", "method_startline": "516", "method_endline": "566", "method_complexity": {"method_NLOC": "40", "method_CCN": "16", "method_NToken": "350", "method_nesting_level": "0"}}}}}}}}