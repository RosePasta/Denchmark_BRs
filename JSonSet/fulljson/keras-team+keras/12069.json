{"BR": {"BR_id": "12069", "BR_author": "psinger", "BRopenT": "2019-01-18T10:18:29Z", "BRcloseT": "2019-01-21T21:37:29Z", "BR_text": {"BRsummary": "Callback warning error", "BRdescription": "\n I receive the following error when using fit_generator with callbacks in Keras:\n <denchmark-code>/opt/conda/lib/python3.6/site-packages/Keras-2.2.4-py3.6.egg/keras/callbacks.py in _call_batch_hook(self, mode, hook, batch, logs)\n      93                 'Method (%s) is slow compared '\n      94                 'to the batch update (%f). Check your callbacks.', hook_name,\n ---> 95                 delta_t_median)\n      96         if hook == 'begin':\n      97             self._t_enter_batch = time.time()\n \n TypeError: integer argument expected, got float\n \n </denchmark-code>\n \n Apparently it happens with some combination of warnings package and Keras packages, or something else. Any idea for a quick workaround that does not involve removing callbacks?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "psinger", "commentT": "2019-01-18T18:13:06Z", "comment_text": "\n \t\tThis is because the formatting is a bit too strict on the types. It's an easy fix. Contribution welcome. Thanks for the report!\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "psinger", "commentT": "2019-01-21T18:17:24Z", "comment_text": "\n \t\tHi Gabriel,\n I'd like to work on this.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "psinger", "commentT": "2019-01-21T21:37:29Z", "comment_text": "\n \t\tSolved by <denchmark-link:https://github.com/keras-team/keras/pull/12098>#12098</denchmark-link>\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "psinger", "commentT": "2019-02-19T05:51:00Z", "comment_text": "\n \t\tHello,\n I have the same problem at Kaggle when implementing cyclical learning rate using the Callback Class.  And it is very strange for me, because the code works only with VGG16. But with wother networks I get the message:\n <denchmark-h:h2>Epoch 1/10\n 2/91 [..............................] - ETA: 29:56 - loss: 0.9238 - acc: 0.4500</denchmark-h>\n \n TypeError                                 Traceback (most recent call last)\n  in ()\n 26                               validation_steps = len(val_list) // batch_size + 1,\n 27                               callbacks=[clr],\n ---> 28                               verbose=1)\n /opt/conda/lib/python3.6/site-packages/Keras-2.2.4-py3.6.egg/keras/legacy/interfaces.py in wrapper(*args, **kwargs)\n 89                 warnings.warn('Update your ' + object_name + ' call to the ' +\n 90                               'Keras 2 API: ' + signature, stacklevel=2)\n ---> 91             return func(*args, **kwargs)\n 92         wrapper._original_function = func\n 93         return wrapper\n /opt/conda/lib/python3.6/site-packages/Keras-2.2.4-py3.6.egg/keras/engine/training.py in fit_generator(self, generator, steps_per_epoch, epochs, verbose, callbacks, validation_data, validation_steps, class_weight, max_queue_size, workers, use_multiprocessing, shuffle, initial_epoch)\n 1434             use_multiprocessing=use_multiprocessing,\n 1435             shuffle=shuffle,\n -> 1436             initial_epoch=initial_epoch)\n 1437\n 1438     @interfaces.legacy_generator_methods_support\n /opt/conda/lib/python3.6/site-packages/Keras-2.2.4-py3.6.egg/keras/engine/training_generator.py in fit_generator(model, generator, steps_per_epoch, epochs, verbose, callbacks, validation_data, validation_steps, class_weight, max_queue_size, workers, use_multiprocessing, shuffle, initial_epoch)\n 217                     batch_logs[l] = o\n 218\n --> 219                 callbacks._call_batch_hook('train', 'end', batch_index, batch_logs)\n 220\n 221                 batch_index += 1\n /opt/conda/lib/python3.6/site-packages/Keras-2.2.4-py3.6.egg/keras/callbacks.py in _call_batch_hook(self, mode, hook, batch, logs)\n 93                 'Method (%s) is slow compared '\n 94                 'to the batch update (%f). Check your callbacks.', hook_name,\n ---> 95                 delta_t_median)\n 96         if hook == 'begin':\n 97             self._t_enter_batch = time.time()\n TypeError: integer argument expected, got float\n Please help me to solve this problem.\n Best\n \t\t"}}}, "commit": {"commit_id": "1400e7b355366a35eb35250c1e6191d4deb21a85", "commit_author": "Luigi Giugliano", "commitT": "2019-01-21 22:37:05+01:00", "commit_complexity": {"commit_NLOC": "None", "commit_CCN": "None", "commit_Nprams": "None"}, "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "keras\\callbacks.py", "file_new_name": "keras\\callbacks.py", "file_complexity": {"file_NLOC": "1161", "file_CCN": "260", "file_NToken": "6298"}, "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "94,95,96", "deleted_lines": "94,95", "method_info": {"method_name": "_call_batch_hook", "method_params": "self,mode,hook,batch,logs", "method_startline": "70", "method_endline": "98", "method_complexity": {"method_NLOC": "24", "method_CCN": "10", "method_NToken": "192", "method_nesting_level": "1"}}}}}}}}