{"BR": {"BR_id": "1271", "BR_author": "danohu", "BRopenT": "2017-08-17T15:06:51Z", "BRcloseT": "2017-08-17T18:14:23Z", "BR_text": {"BRsummary": "spacy.load fails on python &lt; 3.6 (v2)", "BRdescription": "\n spacy.load fails with python 3.5:\n <denchmark-code>In [2]: en = spacy.load('en')\n ---------------------------------------------------------------------------\n AttributeError                            Traceback (most recent call last)\n <ipython-input-2-a732401aeb32> in <module>()\n ----> 1 en = spacy.load('en')\n \n /src/spaCy/spacy/__init__.py in load(name, **overrides)\n      11 def load(name, **overrides):\n      12     name = resolve_load_name(name, **overrides)\n ---> 13     return util.load_model(name, **overrides)\n      14\n      15\n \n /src/spaCy/spacy/util.py in load_model(name, **overrides)\n     101     if isinstance(name, basestring_):\n     102         if name in set([d.name for d in data_path.iterdir()]): # in data dir / shortcut\n --> 103             return load_model_from_link(name, **overrides)\n     104         if is_package(name): # installed as package\n     105             return load_model_from_package(name, **overrides)\n \n /src/spaCy/spacy/util.py in load_model_from_link(name, **overrides)\n     114     \"\"\"Load a model from a shortcut link, or directory in spaCy data path.\"\"\"\n     115     init_file = get_data_path() / name / '__init__.py'\n --> 116     spec = importlib.util.spec_from_file_location(name, init_file)\n     117     try:\n     118         cls = importlib.util.module_from_spec(spec)\n \n /usr/lib/python3.5/importlib/_bootstrap_external.py in spec_from_file_location(name, location, loader, submodule_search_locations)\n \n AttributeError: 'PosixPath' object has no attribute 'endswith'\n \n </denchmark-code>\n \n I believe this is because the loader is relying on importlib.util.spec_from_file_location accepting a pathlib.Path arugument, which is <denchmark-link:https://docs.python.org/3/library/importlib.html#importlib.util.spec_from_file_location>only supported from python 3.6</denchmark-link>\n .\n This change fixes the problem; I've not looked to see if similar issues occur elsewhere:\n <denchmark-code>diff --git a/spacy/util.py b/spacy/util.py\n index ccb81fbe..d83fe341 100644\n --- a/spacy/util.py\n +++ b/spacy/util.py\n @@ -113,7 +113,7 @@ def load_model(name, **overrides):\n  def load_model_from_link(name, **overrides):\n      \"\"\"Load a model from a shortcut link, or directory in spaCy data path.\"\"\"\n      init_file = get_data_path() / name / '__init__.py'\n -    spec = importlib.util.spec_from_file_location(name, init_file)\n +    spec = importlib.util.spec_from_file_location(name, str(init_file))\n      try:\n          cls = importlib.util.module_from_spec(spec)\n      except AttributeError:\n \n </denchmark-code>\n \n <denchmark-h:h2>Your Environment</denchmark-h>\n \n <denchmark-h:h2>Info about spaCy</denchmark-h>\n \n \n Platform: Linux-4.10.0-32-generic-x86_64-with-Ubuntu-17.04-zesty\n Python version: 3.5.3\n Models: en, xx\n spaCy version: 2.0.0a9\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "danohu", "commentT": "2018-05-08T18:27:21Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "ebf5a3ce599be517414b136a2b91b8895e32c1d8", "commit_author": "Dan OHuiginn", "commitT": "2017-08-17 15:15:47+00:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\util.py", "file_new_name": "spacy\\util.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "116", "deleted_lines": "116", "method_info": {"method_name": "load_model_from_link", "method_params": "name,overrides", "method_startline": "113", "method_endline": "124"}}}}}}}