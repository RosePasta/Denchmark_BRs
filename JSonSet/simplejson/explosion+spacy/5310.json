{"BR": {"BR_id": "5310", "BR_author": "jsekamane", "BRopenT": "2020-04-15T10:57:55Z", "BRcloseT": "2020-04-29T11:04:36Z", "BR_text": {"BRsummary": "Bug in `is_new_osx()` \u2013 specifically returning the current minor version of macOS / Mac OS X", "BRdescription": "\n Orginal function:\n \n \n \n spaCy/setup.py\n \n \n         Lines 15 to 27\n       in\n       3d2c308\n \n \n \n \n \n \n  def is_new_osx(): \n \n \n \n  \"\"\"Check whether we're on OSX >= 10.10\"\"\" \n \n \n \n  name = distutils.util.get_platform() \n \n \n \n  if sys.platform != \"darwin\": \n \n \n \n  return False \n \n \n \n  elif name.startswith(\"macosx-10\"): \n \n \n \n  minor_version = int(name.split(\"-\")[1].split(\".\")[1]) \n \n \n \n  if minor_version >= 7: \n \n \n \n  return True \n \n \n \n  else: \n \n \n \n  return False \n \n \n \n  else: \n \n \n \n  return False \n \n \n \n \n \n Tests on macOS Catalina version 10.15.4 (19E287):\n $ python3\n >> import sys\n >> sys.platform\n 'darwin'\n \n >> import distutils.util\n >> distutils.util.get_platform()\n 'macosx-10.6-intel'\n \n >> import platform\n >> platform.platform()\n 'Darwin-19.4.0-x86_64-i386-64bit'\n \n >> platform.mac_ver()\n ('10.15.4', ('', '', ''), 'x86_64')\n A closer look at the <denchmark-link:https://docs.python.org/3/library/sysconfig.html#sysconfig.get_platform>documentation</denchmark-link>\n  of  shows that Mac OS X can return:\n \n macosx-10.6-ppc\n macosx-10.4-ppc64\n macosx-10.3-i386\n macosx-10.4-fat\n \n So clearly minor_version will never equal or exceed 7 in the original function.\n Proposed function:\n import sys\n import platform\n def is_new_osx():\n     \"\"\"Check whether we're on OSX >= 10.10\"\"\"\n     if sys.platform != 'darwin':\n         return False\n     else:\n         minor_version = int(platform.mac_ver()[0].split('.')[1])\n         if minor_version >= 7:\n             return True\n         else:\n             return False\n There is also a mismatch between the comment saying  and the code saying . Perhaps <denchmark-link:https://github.com/honnibal>@honnibal</denchmark-link>\n  knows the rational for this?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "jsekamane", "commentT": "2020-04-15T11:16:42Z", "comment_text": "\n \t\tNote that  behaves differently in Python3 and Python2.7: <denchmark-link:https://stackoverflow.com/a/27204111/1053612>https://stackoverflow.com/a/27204111/1053612</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "jsekamane", "commentT": "2020-04-29T09:27:07Z", "comment_text": "\n \t\tThanks so much for the detailed report, <denchmark-link:https://github.com/jsekamane>@jsekamane</denchmark-link>\n  !\n I created a PR here: <denchmark-link:https://github.com/explosion/spaCy/pull/5376>#5376</denchmark-link>\n  - could you please review?\n I changed your proposed solution a bit, as it wasn't checking on the \"10\" bit anymore, so I think it would be returning True for e.g. \"9.8\" ?\n I also think that the comment should have read OSX >= 10.7 instead of 10.10. Also requested a review from Matt to get his 2 cents on the issue.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "jsekamane", "commentT": "2020-04-29T11:04:35Z", "comment_text": "\n \t\tPR <denchmark-link:https://github.com/explosion/spaCy/pull/5376>#5376</denchmark-link>\n  has been merged so tentavily closing this - let me know if you do run into issues though, <denchmark-link:https://github.com/jsekamane>@jsekamane</denchmark-link>\n  . This will be live from spacy 3.0 onwards.\n \t\t"}}}, "commit": {"commit_id": "1bf2082ac48ab02300177c8a630e2fa5e74b7b7d", "commit_author": "Sofie Van Landeghem", "commitT": "2020-04-29 12:51:49+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "setup.py", "file_new_name": "setup.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "77,81,82,83,88", "deleted_lines": "76,80,81,86,87", "method_info": {"method_name": "is_new_osx", "method_params": "", "method_startline": "76", "method_endline": "88"}}}}}}}