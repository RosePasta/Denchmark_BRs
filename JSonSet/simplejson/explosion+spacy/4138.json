{"BR": {"BR_id": "4138", "BR_author": "avramandrei", "BRopenT": "2019-08-17T14:52:46Z", "BRcloseT": "2019-08-18T11:55:42Z", "BR_text": {"BRsummary": "Displacy no support for utf-8", "BRdescription": "\n I get the following error when I try to use displacy to evaluate a Romanian corpus with entities.\n <denchmark-code>Traceback (most recent call last):\n   File \"C:\\Users\\avramus\\AppData\\Local\\Programs\\Python\\Python36\\lib\\runpy.py\", line 193, in _run_module_as_main\n     \"__main__\", mod_spec)\n   File \"C:\\Users\\avramus\\AppData\\Local\\Programs\\Python\\Python36\\lib\\runpy.py\", line 85, in _run_code\n     exec(code, run_globals)\n   File \"C:\\Users\\avramus\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\spacy\\__main__.py\", line 35, in <module>\n     plac.call(commands[command], sys.argv[1:])\n   File \"C:\\Users\\avramus\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\plac_core.py\", line 328, in call\n     cmd, result = parser.consume(arglist)\n   File \"C:\\Users\\avramus\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\plac_core.py\", line 207, in consume\n     return cmd, self.func(*(args + varargs + extraopts), **kwargs)\n   File \"C:\\Users\\avramus\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\spacy\\cli\\evaluate.py\", line 77, in evaluate\n     ents=render_ents,\n   File \"C:\\Users\\avramus\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\spacy\\cli\\evaluate.py\", line 89, in render_parses\n     file_.write(html)\n   File \"C:\\Users\\avramus\\AppData\\Local\\Programs\\Python\\Python36\\lib\\encodings\\cp1252.py\", line 19, in encode\n     return codecs.charmap_encode(input,self.errors,encoding_table)[0]\n UnicodeEncodeError: 'charmap' codec can't encode character '\\u0103' in position 469: character maps to <undefined>\n </denchmark-code>\n \n It looks like you don't open the html files for the entities and parses in UTF-8. I modified the code to open them in UTF-8 and it worked.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "avramandrei", "commentT": "2019-08-18T11:52:18Z", "comment_text": "\n \t\tJust to confirm: What code / command did you run here? It looks like the error actually occurred in cli.evaluate, not in displacy directly? And that's also where the file is opened incorrectly?\n Edit: Looks like the problem is in cli.evaluate, so I'm just fixing that.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "avramandrei", "commentT": "2019-09-17T12:42:51Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "89f2b872661951e053594607dd3b7d1b57d1d402", "commit_author": "Ines Montani", "commitT": "2019-08-18 13:55:34+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\cli\\evaluate.py", "file_new_name": "spacy\\cli\\evaluate.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "88,94", "deleted_lines": "88,94", "method_info": {"method_name": "render_parses", "method_params": "docs,output_path,model_name,limit,deps,ents", "method_startline": "84", "method_endline": "95"}}}}}}}