{"BR": {"BR_id": "42", "BR_author": "bamos", "BRopenT": "2015-10-29T12:53:58Z", "BRcloseT": "2016-02-17T19:05:02Z", "BR_text": {"BRsummary": "Architecture issues with Torch.load", "BRdescription": "\n From <denchmark-link:https://github.com/ananghudaya>@ananghudaya</denchmark-link>\n  in <denchmark-link:https://github.com/cmusatyalab/openface/issues/26>#26</denchmark-link>\n :\n <denchmark-code>th> net = torch.load('./models/openface/nn4.v1.t7')\n ...e/ananghudaya/torch/install/share/lua/5.1/torch/File.lua:289: table index is nil\n stack traceback:\n     ...e/ananghudaya/torch/install/share/lua/5.1/torch/File.lua:289: in function 'readObject'\n     ...e/ananghudaya/torch/install/share/lua/5.1/torch/File.lua:272: in function 'readObject'\n     ...e/ananghudaya/torch/install/share/lua/5.1/torch/File.lua:311: in function 'load'\n     [string \"net = torch.load('./models/openface/nn4.v1.t7')\"]:1: in main chunk\n     [C]: in function 'xpcall'\n     ...e/ananghudaya/torch/install/share/lua/5.1/trepl/init.lua:648: in function 'repl'\n     ...daya/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:185: in main chunk\n     [C]: at 0x0804d6d0  \n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "bamos", "commentT": "2015-10-29T13:24:31Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ananghudaya>@ananghudaya</denchmark-link>\n  - <denchmark-link:https://github.com/teradeep/demo-apps/issues/4>https://github.com/teradeep/demo-apps/issues/4</denchmark-link>\n  indicates this is an architecture issue, which is a problem with  I wasn't aware of, but is clearly in the documentation at <denchmark-link:https://github.com/torch/torch7/blob/master/doc/serialization.md>https://github.com/torch/torch7/blob/master/doc/serialization.md</denchmark-link>\n . I saved the binary model in x86_64 and I think it's only compatible with x86_64. Are you using 32-bit x86 or ARM?\n I've saved the model in ASCII format. Can you download and  it from <denchmark-link:http://openface-models.storage.cmusatyalab.org/nn4.v1.ascii.t7.xz>here</denchmark-link>\n .\n <denchmark-code>$ md5sum nn4.v1.ascii.t7\n 735723e2c9cc4eefc00a7df34c9a4d3b  nn4.v1.ascii.t7\n </denchmark-code>\n \n Try loading it with:\n <denchmark-code>$ th\n th> require 'nn'\n th> require 'dpnn'\n th> net = torch.load('nn4.v1.ascii.t7', 'ascii')\n </denchmark-code>\n \n If this works, I think you'll just need to replace  with  in the Python demos and make add  to   in <denchmark-link:https://github.com/cmusatyalab/openface/blob/master/openface/openface_server.lua>https://github.com/cmusatyalab/openface/blob/master/openface/openface_server.lua</denchmark-link>\n .\n \n  Even though the ascii model is larger, I'll use it in place of the binary one everywhere to avoid issues like this. Thanks for the useful info and for helping me improve the project. I'll make the changes over the next few days.\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "bamos", "commentT": "2015-10-30T06:49:06Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n \n Still no luck in getting it right. I've downloaded and verified the ASCII model. Here is the output:\n <denchmark-code>th> net = torch.load('nn4.v1.ascii.t7', 'ascii')\n cannot open <nn4.v1.ascii.t7> in mode r  at /home/ananghudaya/torch/pkg/torch/lib/TH/THDiskFile.c:484\n stack traceback:\n     [C]: at 0xb720afc0\n     [C]: in function 'DiskFile'\n     ...e/ananghudaya/torch/install/share/lua/5.1/torch/File.lua:309: in function 'load'\n     [string \"net = torch.load('nn4.v1.ascii.t7', 'ascii')\"]:1: in main chunk\n     [C]: in function 'xpcall'\n     ...e/ananghudaya/torch/install/share/lua/5.1/trepl/init.lua:648: in function 'repl'\n     ...daya/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:185: in main chunk\n     [C]: at 0x0804d6d0  \n </denchmark-code>\n \n I'm using a 32-bit machine.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "bamos", "commentT": "2015-10-30T14:15:22Z", "comment_text": "\n \t\tHi Anang, this error looks like Torch can't find the file.\n Did you unxz it and check the md5sum?\n -Brandon.\n \n Anang Hudaya Muhamad Amin :: 2015-10-30 02:49 Fri:\n \n Thanks @bamos\n Still no luck in getting it right. Here is the output:\n th> net = torch.load('nn4.v1.ascii.t7', 'ascii') cannot open <nn4.v1.ascii.t7> in mode r  at /home/ananghudaya/torch/pkg/torch/lib/TH/THDiskFile.c:484 stack traceback: [C]: at 0xb720afc0 [C]: in function 'DiskFile' ...e/ananghudaya/torch/install/share/lua/5.1/torch/File.lua:309: in function 'load' [string \"net = torch.load('nn4.v1.ascii.t7', 'ascii')\"]:1: in main chunk [C]: in function 'xpcall' ...e/ananghudaya/torch/install/share/lua/5.1/trepl/init.lua:648: in function 'repl' ...daya/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:185: in main chunk [C]: at 0x0804d6d0\n I'm using a 32-bit machine.\n \n Reply to this email directly or view it on GitHub:\n #42 (comment)\n \n \n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "bamos", "commentT": "2015-11-03T03:57:55Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n ,\n Yes I did. the md5 checksum is similar, and I have placed the file in the same folder as the other models.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "bamos", "commentT": "2015-11-03T18:47:36Z", "comment_text": "\n \t\tPlease double check the path to the model.\n The error message you're getting is the same error message I get for incorrect paths.\n <denchmark-code>th> model = torch.load('/tmp/does-not-exist.t7')\n cannot open </tmp/does-not-exist.t7> in mode r  at /home/bamos/torch/pkg/torch/lib/TH/THDiskFile.c:484\n stack traceback:\n     [C]: at 0x7f4389ef2a90\n     [C]: in function 'DiskFile'\n     /home/bamos/torch/install/share/lua/5.1/torch/File.lua:292: in function 'load'\n     [string \"model = torch.load('/tmp/does-not-exist.t7')\"]:1: in main chunk\n     [C]: in function 'xpcall'\n     /home/bamos/torch/install/share/lua/5.1/trepl/init.lua:648: in function 'repl'\n     ...amos/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:185: in main chunk\n     [C]: at 0x00406670\n </denchmark-code>\n \n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "bamos", "commentT": "2015-11-04T21:07:56Z", "comment_text": "\n \t\tThe ascii model loads in about 30-45 seconds for me and the x86 binary model loads in a few seconds. I'll add a fallback mechanism when we transition to a Lua server in <denchmark-link:https://github.com/cmusatyalab/openface/issues/4>#4</denchmark-link>\n  instead of a Lua subprocess so only non 64-bit x86 users will have the 30 second penalty, and it will only be for the first time they start the server, not every time they try to run a new Python program using OpenFace.\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "bamos", "commentT": "2015-11-17T14:20:59Z", "comment_text": "\n \t\ti faced the same problem that torch cant load nn4.v1.ascii.t7. i downloaded nn4.v1.ascii.t7 and checked md5. as <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n  sayed it caused by incorrect path,but i tried absolutely path.it still showed that\n cannot open <nn4.v1.ascii.t7> in mode r at /tmp/luarocks_torch-scm-1../torch7/lib/TH/THDiskFile.c :484\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "bamos", "commentT": "2015-11-17T19:40:14Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/snowlord>@snowlord</denchmark-link>\n  - strange! Can you (or <denchmark-link:https://github.com/ananghudaya>@ananghudaya</denchmark-link>\n ) try saving a small file in binary format, then loading it? Then doing the same with an ASCII-formatted file?\n <denchmark-code>/tmp$ th\n th> t = torch.Tensor(10)\n th> torch.save('test-binary.t7', t)\n th> t2 = torch.load('test-binary.t7')\n th> torch.save('test-ascii.t7', t, 'ascii')\n th> t3 = torch.load('test-ascii.t7', 'ascii')\n th> t:eq(t2):all()\n true\n th> t:eq(t3):all()\n true\n </denchmark-code>\n \n If this works, can you then try doing it in a different directory that's not your current working directory?\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "bamos", "commentT": "2015-11-24T08:42:49Z", "comment_text": "\n \t\thi,<denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n ,i changed on the 64-bit x86,i have checked md5 of model file.it showed different problem.\n <denchmark-code>th> torch.load('./models/openface/nn4.v1.t7')\n /usr/local/share/lua/5.1/torch/File.lua:294: unknown object\n stack traceback:\n     [C]: in function 'error'\n     /usr/local/share/lua/5.1/torch/File.lua:294: in function 'readObject'\n     /usr/local/share/lua/5.1/torch/File.lua:240: in function 'readObject'\n     /usr/local/share/lua/5.1/torch/File.lua:288: in function 'readObject'\n     /usr/local/share/lua/5.1/torch/File.lua:272: in function 'readObject'\n     /usr/local/share/lua/5.1/torch/File.lua:288: in function 'readObject'\n     /usr/local/share/lua/5.1/torch/File.lua:288: in function 'readObject'\n     /usr/local/share/lua/5.1/torch/File.lua:272: in function 'readObject'\n     /usr/local/share/lua/5.1/torch/File.lua:319: in function 'load'\n     [string \"_RESULT={torch.load('./models/openface/nn4.v1...\"]:1: in main chunk\n     [C]: in function 'xpcall'\n     /usr/local/share/lua/5.1/trepl/init.lua:650: in function 'repl'\n     /usr/local/lib/luarocks/rocks/trepl/scm-1/bin/th:199: in main chunk\n     [C]: at 0x00406260  \n </denchmark-code>\n \n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "bamos", "commentT": "2015-11-24T08:59:35Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/snowlord>@snowlord</denchmark-link>\n  - interesting you're seeing that on 64-bit x86. Somebody in this thread on the torch mailing list got a similar  error and said it was an architecture issue: <denchmark-link:https://groups.google.com/forum/#!msg/torch7/zNNdXATZxlA/z5A2HocVCgAJ>https://groups.google.com/forum/#!msg/torch7/zNNdXATZxlA/z5A2HocVCgAJ</denchmark-link>\n \n Does the ascii model work on your 64-bit x86 machine?\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "bamos", "commentT": "2015-12-06T14:29:55Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n  ,\n I got the same problem:\n <denchmark-code>celeb-classifier.nn4.v1.pkl  cifar10-test.t7  cifar10torchsmall.zip  cifar10-train.t7  nn2.def.lua  nn4.def.lua  nn4.v1.ascii.t7  nn4.v1.t7\n -bash-4.1# th                                                                                                                              \n th> require 'nn'\n {..........}\n                                                                       [0.0143s]\n th> require 'dpnn'                                                             \n true                                                                           \n                                                                       [0.0113s]\n th> net = torch.load('nn4.v1.t7')                               \n /usr/local/share/lua/5.1/torch/File.lua:241: Failed to load function from bytecode: (binary): cannot load incompatible bytecode\n stack traceback:\n         [C]: in function 'error'\n         /usr/local/share/lua/5.1/torch/File.lua:241: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:294: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:278: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:294: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:294: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:278: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:325: in function 'load'\n         [string \"net = torch.load('nn4.v1.t7')\"]:1: in main chunk\n         [C]: in function 'xpcall'\n         /usr/local/share/lua/5.1/trepl/init.lua:668: in function 'repl'\n         /usr/local/lib/luarocks/rocks/trepl/scm-1/bin/th:199: in main chunk\n         [C]: at 0x004051e0\n                                                                       [0.0005s]\n th> net = torch.load('nn4.v1.ascii.t7', 'ascii')\n /usr/local/share/lua/5.1/torch/File.lua:241: Failed to load function from bytecode: (binary): cannot load incompatible bytecode\n stack traceback:\n         [C]: in function 'error'\n         /usr/local/share/lua/5.1/torch/File.lua:241: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:294: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:278: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:294: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:294: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:278: in function 'readObject'\n         /usr/local/share/lua/5.1/torch/File.lua:325: in function 'load'\n         [string \"net = torch.load('nn4.v1.ascii.t7', 'ascii')\"]:1: in main chunk\n         [C]: in function 'xpcall'\n         /usr/local/share/lua/5.1/trepl/init.lua:668: in function 'repl'\n         /usr/local/lib/luarocks/rocks/trepl/scm-1/bin/th:199: in main chunk\n         [C]: at 0x004051e0\n                                                                       [0.0053s]\n th> net = torch.load('cifar10-train.t7')\n                                                                       [0.0134s]\n th>\n </denchmark-code>\n \n As you can see I had tried to load the model that you provided at this link:\n <denchmark-link:https://groups.google.com/forum/#!msg/torch7/zNNdXATZxlA/z5A2HocVCgAJ>https://groups.google.com/forum/#!msg/torch7/zNNdXATZxlA/z5A2HocVCgAJ</denchmark-link>\n \n everything loads just fine.\n net = torch.load('cifar10-train.t7')\n when I tried to load the nn4.v1.t7 with no susses:\n net = torch.load('nn4.v1.t7')\n net = torch.load('nn4.v1.ascii.t7', 'ascii')\n I had done a md5sum test:\n <denchmark-code>md5sum models/{dlib/*.dat,openface/*.{pkl,t7}}\n 73fde5e05226548677a050913eed4e04  models/dlib/shape_predictor_68_face_landmarks.dat\n c0675d57dc976df601b085f4af67ecb9  models/openface/celeb-classifier.nn4.v1.pkl\n 735723e2c9cc4eefc00a7df34c9a4d3b  models/openface/nn4.v1.ascii.t7\n a59a5ec1938370cd401b257619848960  models/openface/nn4.v1.t7\n </denchmark-code>\n \n I'm on x86_64 GNU/Linux.\n What seems to be the problem?\n Ilya\n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "bamos", "commentT": "2015-12-06T15:00:28Z", "comment_text": "\n \t\tIt seems to be a problem of the  lua and luajit versions:\n -bash-4.1# lua -v\n Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio\n -bash-4.1# luajit -v\n LuaJIT 2.0.4 -- Copyright (C) 2005-2015 Mike Pall. <denchmark-link:http://luajit.org/>http://luajit.org/</denchmark-link>\n \n I use these versions. Which version the model was complied with?\n Ilya\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "bamos", "commentT": "2015-12-06T20:30:21Z", "comment_text": "\n \t\t I use these versions. Which version the model was complied with?\n lua: Not installed on my system\n luajit: 2.1.0-alpha (from Torch)\n \t\t"}, "comments_13": {"comment_id": 14, "comment_author": "bamos", "commentT": "2015-12-07T07:54:00Z", "comment_text": "\n \t\tI had installed LuaJIT 2.1.0-beta1.\n now the command got no errors!!!\n net = torch.load('nn4.v1.t7')\n download from:\n <denchmark-link:https://github.com/torch/luajit-rocks>https://github.com/torch/luajit-rocks</denchmark-link>\n \n make sure to add this option to the cmake \"-DWITH_LUAJIT21=ON\" !!!!!!!!!!!!!\n git clone <denchmark-link:https://github.com/torch/luajit-rocks.git>https://github.com/torch/luajit-rocks.git</denchmark-link>\n \n cd luajit-rocks\n mkdir build\n cd build\n cmake .. -DWITH_LUAJIT21=ON\n \t\t"}, "comments_14": {"comment_id": 15, "comment_author": "bamos", "commentT": "2015-12-20T10:04:29Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n  ,\n I try to play with ARM 32 bit platform, and change the torch load model to\n net = torch.load('nn4.v1.ascii.t7', 'ascii')\n A strange thing is when I run the compare demo script I got following error message:\n Error getting result from Torch subprocess.\n Line read:\n Exception:\n could not convert string to float:\n <denchmark-h:h1></denchmark-h>\n \n stdout:\n <denchmark-h:h1></denchmark-h>\n \n stderr:\n I  tried to run the same code in X86_64 platform it's all OK since ascii version should be platform independent. Could you give some hint about this issue I had on ARM 32 bit platform? Thanks.\n \t\t"}, "comments_15": {"comment_id": 16, "comment_author": "bamos", "commentT": "2015-12-20T23:10:07Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/lijian8>@lijian8</denchmark-link>\n ,\n \n stdout:\n \n stderr:\n \n Are these both empty? I would expect more content.\n \n I tried to run the same code in X86_64 platform it's all OK since\n ascii version should be platform indepedant. Could you give some\n hint about this issue I had on ARM 32 bit platform? Thanks.\n \n I don't have any experience executing on 32-bit ARM.\n Maybe the Torch community will be able to help if we can\n find a more informative error message.\n -Brandon.\n \t\t"}, "comments_16": {"comment_id": 17, "comment_author": "bamos", "commentT": "2015-12-21T23:42:07Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n ,\n Yes these are empty. I'll try to run sunprocess directly on torch to see if I can catch up something.\n \t\t"}, "comments_17": {"comment_id": 18, "comment_author": "bamos", "commentT": "2016-01-21T21:05:50Z", "comment_text": "\n \t\tI had a very similar issue on Jetson TK1 board, here is a solution from another project that might help:\n <denchmark-code>git clone https://github.com/mvitez/torch7.git mvittorch7\n cd mvittorch7\n luarocks make rocks/torch-scm-1.rockspec\n </denchmark-code>\n \n <denchmark-code>diff --git a/eval.lua b/eval.lua\n index 1814180..8cad5ba 100644\n --- a/eval.lua\n +++ b/eval.lua\n @@ -65,8 +65,21 @@ end\n  -------------------------------------------------------------------------------\n  -- Load the model checkpoint to evaluate\n  -------------------------------------------------------------------------------\n +local function load(filename)\n +   local mode = 'binary'\n +   local referenced = true\n +   local file = torch.DiskFile(filename, 'r')\n +   file[mode](file)\n +   file:referenced(referenced)\n +   file:longSize(8)\n +   file:littleEndianEncoding()\n +   local object = file:readObject()\n +   file:close()\n +   return object\n +end\n +\n  assert(string.len(opt.model) > 0, 'must provide a model')\n -local checkpoint = torch.load(opt.model)\n +local checkpoint = load(opt.model)\n  -- override and collect parameters\n  if string.len(opt.input_h5) == 0 then opt.input_h5 = checkpoint.opt.input_h5 end\n  if string.len(opt.input_json) == 0 then opt.input_json = checkpoint.opt.input_json end\n </denchmark-code>\n \n \t\t"}, "comments_18": {"comment_id": 19, "comment_author": "bamos", "commentT": "2016-02-02T01:41:16Z", "comment_text": "\n \t\tI had the same issue. It was fixed by the comment from SyRenity:\n git clone <denchmark-link:https://github.com/mvitez/torch7.git>https://github.com/mvitez/torch7.git</denchmark-link>\n  mvittorch7\n cd mvittorch7\n luarocks make rocks/torch-scm-1.rockspec\n \t\t"}, "comments_19": {"comment_id": 20, "comment_author": "bamos", "commentT": "2016-02-02T01:48:46Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/jacklanchantin>@jacklanchantin</denchmark-link>\n  glad it helped :)\n \t\t"}, "comments_20": {"comment_id": 21, "comment_author": "bamos", "commentT": "2016-02-05T17:35:29Z", "comment_text": "\n \t\tFor information, <denchmark-link:https://github.com/torch/torch7/pull/476>torch/torch7#476</denchmark-link>\n  was merged into master some time ago, so all the changes in <denchmark-link:https://github.com/mvitez>@mvitez</denchmark-link>\n  branch were integrated to torch.\n \t\t"}, "comments_21": {"comment_id": 22, "comment_author": "bamos", "commentT": "2016-02-10T08:46:54Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n  <denchmark-link:https://github.com/SyRenity>@SyRenity</denchmark-link>\n  <denchmark-link:https://github.com/jacklanchantin>@jacklanchantin</denchmark-link>\n , this issue should be fixed with instruction from <denchmark-link:https://github.com/SyRenity>@SyRenity</denchmark-link>\n  .\n \t\t"}, "comments_22": {"comment_id": 23, "comment_author": "bamos", "commentT": "2016-02-17T19:05:02Z", "comment_text": "\n \t\tGreat info, thanks all!\n \t\t"}, "comments_23": {"comment_id": 24, "comment_author": "bamos", "commentT": "2016-03-18T14:55:44Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/SyRenity>@SyRenity</denchmark-link>\n  i am also working on TK1 but still get error when I load the binary model for openface. As mentioned before this issue should be fixed. Do you have any clue about my errors. Thanks:\n net = torch.load('/home/ubuntu/Downloads/face/openface/models/openface/nn4.small2.v1.t7')\n /home/ubuntu/torch/install/share/lua/5.1/torch/File.lua:370: table index is nil\n stack traceback:\n /home/ubuntu/torch/install/share/lua/5.1/torch/File.lua:370: in function 'readObject'\n /home/ubuntu/torch/install/share/lua/5.1/nn/Module.lua:158: in function 'read'\n /home/ubuntu/torch/install/share/lua/5.1/torch/File.lua:351: in function 'readObject'\n /home/ubuntu/torch/install/share/lua/5.1/torch/File.lua:409: in function 'load'\n [string \"net = torch.load('/home/ubuntu/Downloads/face...\"]:1: in main chunk\n [C]: in function 'xpcall'\n /home/ubuntu/torch/install/share/lua/5.1/trepl/init.lua:669: in function 'repl'\n ...untu/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:199: in main chunk\n [C]: at 0x0000cff9\n \t\t"}, "comments_24": {"comment_id": 25, "comment_author": "bamos", "commentT": "2016-03-18T15:18:23Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/ChrisYang>@ChrisYang</denchmark-link>\n  - can you try using our ascii model from <denchmark-link:http://openface-models.storage.cmusatyalab.org/nn4.small2.v1.ascii.t7.xz>http://openface-models.storage.cmusatyalab.org/nn4.small2.v1.ascii.t7.xz</denchmark-link>\n ? Unxz it and then use  mode in .\n \t\t"}, "comments_25": {"comment_id": 26, "comment_author": "bamos", "commentT": "2016-03-19T02:54:38Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n  thanks for your prompt reply.\n Though I haven't found your ascii file, I managed to save a ascii version on a x86 machine and now I can load it from TK1.\n However I face some new issues. It runs ok using cpu mode but very slowly on TK1. When I tried to call net:forward in cuda mode i got cuda runtime error 'too many resources requested for launch at xxx'. Do you have any clue how to solve this?\n \t\t"}, "comments_26": {"comment_id": 27, "comment_author": "bamos", "commentT": "2016-06-03T09:25:56Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/shimen>@shimen</denchmark-link>\n  Hi, I have the same problem as you, \"File.lua failed to load function from bytecode binary string: not a precompiled chunk\", and I also updated my luajit version to be 2.1 beta, but it still failed, I don't what to do now? Could anyone help? Thanks.\n \t\t"}, "comments_27": {"comment_id": 28, "comment_author": "bamos", "commentT": "2016-06-05T11:01:48Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/apeterswu>@apeterswu</denchmark-link>\n  Hi, I'm not sure what is the problem. Since openFace version 0.2 I do not have to use this command.\n \t\t"}, "comments_28": {"comment_id": 29, "comment_author": "bamos", "commentT": "2016-07-10T12:35:46Z", "comment_text": "\n \t\tSubject: openface\n root@tegra-ubuntu:~/openface/openface# ./demos/compare.py images/examples/{lennon_,clapton_}\n /home/ubuntu/torch/install/bin/luajit: /home/ubuntu/torch/install/share/lua/5.1/torch/File.lua:370: table index is nil\n stack traceback:\n /home/ubuntu/torch/install/share/lua/5.1/torch/File.lua:370: in function 'readObject'\n /home/ubuntu/torch/install/share/lua/5.1/nn/Module.lua:158: in function 'read'\n /home/ubuntu/torch/install/share/lua/5.1/torch/File.lua:351: in function 'readObject'\n /home/ubuntu/torch/install/share/lua/5.1/torch/File.lua:409: in function 'load'\n ...lib/python2.7/dist-packages/openface/openface_server.lua:46: in main chunk\n [C]: in function 'dofile'\n ...untu/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:145: in main chunk\n [C]: at 0x0000cff9\n Traceback (most recent call last):\n File \"./demos/compare.py\", line 101, in \n d = getRep(img1) - getRep(img2)\n File \"./demos/compare.py\", line 92, in getRep\n rep = net.forward(alignedFace)\n File \"/usr/local/lib/python2.7/dist-packages/openface/torch_neural_net.py\", line 156, in forward\n rep = self.forwardPath(t)\n File \"/usr/local/lib/python2.7/dist-packages/openface/torch_neural_net.py\", line 113, in forwardPath\n \"\"\".format(self.cmd, self.p.stdout.read()))\n Exception:\n OpenFace: openface_server.lua subprocess has died.\n \n Is the Torch command th on your PATH? Check with which th.\n If th is on your PATH, try running ./util/profile-network.lua\n to see if Torch can correctly load and run the network.\n \n If this gives illegal instruction errors, see the section on\n this in our FAQ at http://cmusatyalab.github.io/openface/faq/\n In Docker, use a Bash login shell or source\n /root/torch/install/bin/torch-activate for the Torch environment.\n \n \n See this GitHub issue if you are running on a non-64-bit machine:\n #42\n \n Please post further issues to our mailing list at\n https://groups.google.com/forum/#!forum/cmu-openface\n Diagnostic information:\n cmd: ['/usr/bin/env', 'th', '/usr/local/lib/python2.7/dist-packages/openface/openface_server.lua', '-model', '/home/ubuntu/openface/openface/demos/../models/openface/nn4.small2.v1.t7', '-imgDim', '96']\n stdout:\n \n is anyone encountered such a problem?\n my email is <denchmark-link:mailto:329410527@qq.com>329410527@qq.com</denchmark-link>\n \n Thank you very much.\n \t\t"}, "comments_29": {"comment_id": 30, "comment_author": "bamos", "commentT": "2016-07-14T17:44:59Z", "comment_text": "\n \t\t<denchmark-link:http://openface-models.storage.cmusatyalab.org/nn4.small2.v1.ascii.t7.xz>ASCII model for nn4.small2.v1</denchmark-link>\n \n \t\t"}, "comments_30": {"comment_id": 31, "comment_author": "bamos", "commentT": "2016-07-19T11:13:54Z", "comment_text": "\n \t\tSome users following this issue may also be interested in helping improve dlib and its face detector's speed on ARM by adding NEON instructions. Contact <denchmark-link:https://github.com/davisking>@davisking</denchmark-link>\n  if interested. <denchmark-link:https://github.com/cmusatyalab/openface/issues/157#issuecomment-233599719>Here</denchmark-link>\n  is his comment from another thread:\n \n NEON instructions are similar enough in overall structure that you should\n be able to implement alternative versions of the simd classes in dlib (e.g.\n https://github.com/davisking/dlib/blob/master/dlib/simd/simd8f.h).  All the\n simd usage is through these classes, so if there were NEON versions of them\n then things would be much faster on ARM.  I've had this on my todo list for\n a long time but haven't gotten around to it yet.  You should give it a go :)\n \n \t\t"}, "comments_31": {"comment_id": 32, "comment_author": "bamos", "commentT": "2016-08-02T18:13:06Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n  do you know of anyone successfully getting <denchmark-link:http://cmusatyalab.github.io/openface/demo-2-comparison/>this</denchmark-link>\n  to work on a raspberry pi? As it is driving me crazy. I have got <denchmark-link:https://github.com/cmusatyalab/openface/issues/42#issuecomment-152177965>this</denchmark-link>\n  working. (it takes 18 seconds?!). I change this <denchmark-link:https://github.com/cmusatyalab/openface/blob/master/demos/compare.py#L46>line</denchmark-link>\n  to the  file and then try run again but I get a  error. Any ideas?\n \t\t"}, "comments_32": {"comment_id": 33, "comment_author": "bamos", "commentT": "2016-08-23T13:37:39Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/maxisme>@maxisme</denchmark-link>\n  : I got it solved. Refer <denchmark-link:https://github.com/cmusatyalab/openface/issues/169>issue</denchmark-link>\n \n \t\t"}, "comments_33": {"comment_id": 34, "comment_author": "bamos", "commentT": "2016-11-02T13:00:33Z", "comment_text": "\n \t\tHey <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n ,\n I've been trying to use the Docker container in Ubuntu 14.04 on 64 bit x86 architecture. I have switched to the ascii model and I'm getting the same error as weiqifa0 above. I'm not quite sure where to go from here other than performing a fresh by hand install of Openface, which I want to avoid. Any suggestions would be great!\n Exception in thread frame_process_thread_0:\n Traceback (most recent call last):\n File \"/usr/lib/python2.7/threading.py\", line 810, in __bootstrap_inner\n self.run()\n File \"/usr/lib/python2.7/threading.py\", line 763, in run\n self.__target(_self.__args, *_self.__kwargs)\n File \"/host/system/SurveillanceSystem.py\", line 534, in process_frame\n predictions, alignedFace =  self.recogniser.make_prediction(personimg,face_bb)\n File \"/host/system/FaceRecogniser.py\", line 111, in make_prediction\n persondict = self.recognize_face(alignedFace)\n File \"/host/system/FaceRecogniser.py\", line 121, in recognize_face\n if self.getRep(img) is None:\n File \"/host/system/FaceRecogniser.py\", line 145, in getRep\n rep = self.net.forward(alignedFace) # Gets embedding - 128 measurements\n File \"/usr/local/lib/python2.7/dist-packages/openface/torch_neural_net.py\", line 156, in forward\n rep = self.forwardPath(t)\n File \"/usr/local/lib/python2.7/dist-packages/openface/torch_neural_net.py\", line 113, in forwardPath\n \"\"\".format(self.cmd, self.p.stdout.read()))\n Exception:\n OpenFace: openface_server.lua subprocess has died.\n \n Is the Torch command th on your PATH? Check with which th.\n If th is on your PATH, try running ./util/profile-network.lua\n to see if Torch can correctly load and run the network.\n \n If this gives illegal instruction errors, see the section on\n this in our FAQ at http://cmusatyalab.github.io/openface/faq/\n In Docker, use a Bash login shell or source\n /root/torch/install/bin/torch-activate for the Torch environment.\n \n \n See this GitHub issue if you are running on a non-64-bit machine:\n #42\n Please post further issues to our mailing list at\n https://groups.google.com/forum/#!forum/cmu-openface\n \n Diagnostic information:\n cmd: ['/usr/bin/env', 'th', '/usr/local/lib/python2.7/dist-packages/openface/openface_server.lua', '-model', '/host/system/../models/openface/nn4.small2.v1.ascii.t7', '-imgDim', '96']\n <denchmark-h:h1></denchmark-h>\n \n \t\t"}, "comments_34": {"comment_id": 35, "comment_author": "bamos", "commentT": "2016-11-02T13:26:45Z", "comment_text": "\n \t\tDon't worry just tested with Docker in a Ubuntu VM and worked perfectly :) not sure what the issue was.\n \t\t"}, "comments_35": {"comment_id": 36, "comment_author": "bamos", "commentT": "2017-04-02T13:54:52Z", "comment_text": "\n \t\they <denchmark-link:https://github.com/bamos>@bamos</denchmark-link>\n ,\n as you have said to save the model in ascii format i have saved it and i have tried these commands they are perfectly working\n $ th\n th> require 'nn'\n th> require 'dpnn'\n th> net = torch.load('nn4.v1.ascii.t7', 'ascii')\n but again when i try this `command ./demos/classifier.py infer ./generated-embeddings/classifier.pkl your_test_image.jpg\n this is the error i am getting\n /home/pi/torch/install/share/lua/5.1/torch/File.lua:375: unknown object\n stack traceback:\n [C]: in function 'error'\n /home/pi/torch/install/share/lua/5.1/torch/File.lua:375: in function 'readObject'\n /home/pi/torch/install/share/lua/5.1/torch/File.lua:409: in function 'load'\n <denchmark-code>./batch-represent/main.lua:33: in main chunk\n [C]: in function 'dofile'\n ...e/pi/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:150: in main chunk\n [C]: at 0x00014fa8\n </denchmark-code>\n \n \t\t"}, "comments_36": {"comment_id": 37, "comment_author": "bamos", "commentT": "2017-05-02T17:14:03Z", "comment_text": "\n \t\tHad the same issue on ubuntu 16.04 | torch7. The ascii loading method worked with the provided ascii model download link. Just had to modify the ./batch-represent/opt.lua and main.lua file that the model gets loaded from in the example on the openface website for testing classification. However trying to run the ./demo/compare.py example that uses the openface python api suffers the same error. It seems if the torch_neural_net.py file's cmd could accept an ascii option it might be a way to curtail it?\n self.cmd = ['/usr/bin/env', 'th', os.path.join(myDir, 'openface_server.lua'), '-model', model, '-imgDim', str(imgDim)]\n --  update\n I also modified the torch_neural_net.py and openface_server.lua to include the ascii argument and it indeed works as well.\n \t\t"}, "comments_37": {"comment_id": 38, "comment_author": "bamos", "commentT": "2019-05-21T17:09:33Z", "comment_text": "\n \t\tis it CNN\n \t\t"}, "comments_38": {"comment_id": 39, "comment_author": "bamos", "commentT": "2019-05-21T17:10:26Z", "comment_text": "\n \t\treal time and web based...\n \t\t"}}}, "commit": {"commit_id": "5adf826d9d9b9c275bba62e5b5c350e142781ab8", "commit_author": "Brandon Amos", "commitT": "2015-11-04 16:05:33-05:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\setup.md", "file_new_name": "docs\\setup.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "13,14,15", "deleted_lines": null}}}}}}