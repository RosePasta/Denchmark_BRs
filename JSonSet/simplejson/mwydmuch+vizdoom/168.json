{"BR": {"BR_id": "168", "BR_author": "pengsun", "BRopenT": "2017-01-15T06:09:22Z", "BRcloseT": "2017-01-15T17:52:41Z", "BR_text": {"BRsummary": "The GameVariable DEATHCOUNT seems not work; FRAG doesn't decrease on death.", "BRdescription": "\n Hi,\n This can be reproduced by the following lua code. From the printed information one can find that\n \n #Deaths is always 0 even when frag decreases.\n frag doesn't decrease on death.\n \n require \"vizdoom\"\n require \"torch\"\n require \"sys\"\n \n local vizdoomPath = '/xxx/torch/install/lib/lua/5.1/vizdoom'\n local isShow = true\n local actrep = 4\n local maxSteps = 250*1000*1000\n \n -- Create DoomGame instance. It will run the game and communicate with you.\n local game = vizdoom.DoomGame()\n \n game:setViZDoomPath(paths.concat(vizdoomPath, 'vizdoom'))\n game:loadConfig(paths.concat(vizdoomPath, \"scenarios/multi_duel.cfg\"))\n game:setDoomMap(\"map01\") -- Limited deathmatch.\n \n -- Start multiplayer game only with your AI (with options that will be used in the competition, details in cig_host example).\n game:addGameArgs(\"-host 1 -deathmatch +timelimit 1.0 \"..\n                  \"+sv_forcerespawn 1 +sv_noautoaim 1 \"..\n                  \"+sv_respawnprotect 1 +sv_spawnfarthest 1\")\n \n game:addGameArgs(\"+name WhoAmI +colorset 0\")\n \n --game:setMode(vizdoom.Mode.SPECTATOR);\n game:setMode(vizdoom.Mode.PLAYER);\n \n game:setWindowVisible(isShow)\n \n game:init();\n \n -- Three example sample actions\n local actions = {\n     [1] = torch.IntTensor({1,0,0}),\n     [2] = torch.IntTensor({0,1,0}),\n     [3] = torch.IntTensor({0,0,1})\n }\n \n -- Play with this many bots\n local bots = 1\n \n -- Run this many episodes\n local epSteps = math.ceil(2100/actrep)\n local episodes = math.ceil(maxSteps/epSteps)\n \n -- To be used by the main game loop\n local state, reward\n \n for i = 1, episodes do\n \n     print(\"Episode #\"..i)\n     game:sendGameCommand(\"removebots\")\n     for i = 1, bots do\n         game:sendGameCommand(\"addbot\")\n     end\n \n     -- Play until the game (episode) is over.\n     while not game:isEpisodeFinished() do\n         sys.sleep(0.1)\n \n         if game:isPlayerDead() then\n             -- Respawn immediately after death, new state will be available.\n             game:respawnPlayer()\n         end\n \n         --require'mobdebug'.start()\n         -- Analyze the state\n         state = game:getState()\n \n         -- Make a random action\n         local action = actions[torch.random(#actions)]\n         reward = game:makeAction(action, actrep)\n \n         local str = (\"Episodes %d, Frags: %d, #Deaths: %d, #players %d\\n\"):format(\n             i,\n             game:getGameVariable(vizdoom.GameVariable.FRAGCOUNT),\n             game:getGameVariable(vizdoom.GameVariable.DEATHCOUNT),\n             game:getGameVariable(vizdoom.GameVariable.PLAYER_COUNT)\n         )\n \n         print(str)\n     end\n \n     print(\"Episode finished.\")\n     print(\"************************\")\n \n     game:newEpisode()\n end\n \n game:close()\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "pengsun", "commentT": "2017-01-15T17:52:41Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/pengsun>@pengsun</denchmark-link>\n !\n I've fixed DEATHCOUNT. But FRAGCOUNT by default only decrease on suicide, if you want it to decrease on every death add  to gameArgs.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "pengsun", "commentT": "2017-01-16T08:12:31Z", "comment_text": "\n \t\tAh, I see...my apology... Thanks for responding and fixing:)\n \t\t"}}}, "commit": {"commit_id": "1596bf251bfc0130effdaaedc62da19e7ccfb698", "commit_author": "Marqt", "commitT": "2017-01-15 18:45:09+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\lib\\ViZDoomController.cpp", "file_new_name": "src\\lib\\ViZDoomController.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1151,1154,1155,1156,1157", "deleted_lines": "1151,1154,1155,1156,1157", "method_info": {"method_name": "vizdoom::DoomController::createDoomArgs", "method_params": "", "method_startline": "1076", "method_endline": "1267"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\vizdoom\\src\\viz_game.cpp", "file_new_name": "src\\vizdoom\\src\\viz_game.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "198,199", "deleted_lines": "213", "method_info": {"method_name": "VIZ_GameStateTic", "method_params": "", "method_startline": "173", "method_endline": "265"}}}}}}}