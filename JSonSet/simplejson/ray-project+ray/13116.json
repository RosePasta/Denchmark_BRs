{"BR": {"BR_id": "13116", "BR_author": "sivarajendranaidu", "BRopenT": "2020-12-30T07:03:52Z", "BRcloseT": "2020-12-31T22:25:39Z", "BR_text": {"BRsummary": "[kubernetes] Issue in running the ray job in K8S ray cluster", "BRdescription": "\n I had created a ray cluster with head and worker pods.\n <denchmark-code>$ kubectl get all -n ray\n NAME                              READY   STATUS    RESTARTS   AGE\n pod/ray-head-5b84d6c989-b546n     1/1     Running   0          8m37s\n pod/ray-worker-6df9f4bdfd-wmhbb   1/1     Running   0          8m37s\n \n NAME               TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                                          AGE\n service/ray-head   ClusterIP   10.111.163.153   <none>        6379/TCP,6380/TCP,6381/TCP,12345/TCP,12346/TCP   9m5s\n \n NAME                         READY   UP-TO-DATE   AVAILABLE   AGE\n deployment.apps/ray-head     1/1     1            1           9m5s\n deployment.apps/ray-worker   1/1     1            1           9m5s\n \n NAME                                    DESIRED   CURRENT   READY   AGE\n replicaset.apps/ray-head-5b84d6c989     1         1         1       8m37s\n replicaset.apps/ray-worker-6df9f4bdfd   1         1         1       8m37s\n </denchmark-code>\n \n I had created a job as per documentation\n kubectl create -f ray/doc/kubernetes/ray-job.yaml \n Trying to run the Job [provided in https://github.com/ray-project/ray/blob/master/doc/kubernetes/ray-job.yaml] Job is running into error\n <denchmark-code>$ kubectl get all -n ray\n NAME                              READY   STATUS    RESTARTS   AGE\n pod/ray-head-5b84d6c989-b546n     1/1     Running   0          10m\n pod/ray-test-job-rz88m-jwh4r      0/1     Error     0          113s\n pod/ray-test-job-rz88m-kpmgf      0/1     Error     0          3s\n pod/ray-worker-6df9f4bdfd-wmhbb   1/1     Running   0          10m\n \n NAME               TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                                          AGE\n service/ray-head   ClusterIP   10.111.163.153   <none>        6379/TCP,6380/TCP,6381/TCP,12345/TCP,12346/TCP   10m\n \n NAME                         READY   UP-TO-DATE   AVAILABLE   AGE\n deployment.apps/ray-head     1/1     1            1           10m\n deployment.apps/ray-worker   1/1     1            1           10m\n \n NAME                                    DESIRED   CURRENT   READY   AGE\n replicaset.apps/ray-head-5b84d6c989     1         1         1       10m\n replicaset.apps/ray-worker-6df9f4bdfd   1         1         1       10m\n \n NAME                           COMPLETIONS   DURATION   AGE\n job.batch/ray-test-job-rz88m   0/1           113s       113s\n </denchmark-code>\n \n Checking the logs\n <denchmark-code>$ kubectl -n ray logs  pod/ray-test-job-rz88m-jwh4r\n --2020-12-29 08:11:12--  https://raw.githubusercontent.com/ray-project/ray/master/doc/kubernetes/example.py\n Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.192.133, 151.101.128.133, 151.101.64.133, ...\n Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.192.133|:443... connected.\n HTTP request sent, awaiting response... 200 OK\n Length: 1498 (1.5K) [text/plain]\n example.py: Permission denied\n \n Cannot write to \u2018example.py\u2019 (Success).\n </denchmark-code>\n \n With reference to comments in the current I pointed to <denchmark-link:https://raw.githubusercontent.com/ray-project/ray/fe7db72c40bb4871ec3f8222b60be9139a788804/doc/kubernetes/example.py>https://raw.githubusercontent.com/ray-project/ray/fe7db72c40bb4871ec3f8222b60be9139a788804/doc/kubernetes/example.py</denchmark-link>\n  instead of master\n <denchmark-code>$ kubectl  -n ray logs ray-test-job-ccpb6-9xtg9\n --2020-12-29 08:28:51--  https://raw.githubusercontent.com/ray-project/ray/fe7db72c40bb4871ec3f8222b60be9139a788804/doc/kubernetes/example.py\n Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.128.133, 151.101.64.133, ...\n Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\n HTTP request sent, awaiting response... 200 OK\n Length: 1365 (1.3K) [text/plain]\n example.py: Permission denied\n \n Cannot write to \u2018example.py\u2019 (Success).\n </denchmark-code>\n \n Please provide your insights on the my issue.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "sivarajendranaidu", "commentT": "2020-12-31T01:07:05Z", "comment_text": "\n \t\tThanks for posting this bug.\n I've addressed the problem in the above pull request.\n While we wait for the pull request to be merged, you can try running the examples again with the updated configs --\n New cluster config:  <denchmark-link:https://github.com/DmitriGekhtman/ray/blob/dmitri/k8s-job-doc-fix/doc/kubernetes/ray-cluster.yaml>https://github.com/DmitriGekhtman/ray/blob/dmitri/k8s-job-doc-fix/doc/kubernetes/ray-cluster.yaml</denchmark-link>\n \n New job config: <denchmark-link:https://github.com/DmitriGekhtman/ray/blob/dmitri/k8s-job-doc-fix/doc/kubernetes/ray-job.yaml>https://github.com/DmitriGekhtman/ray/blob/dmitri/k8s-job-doc-fix/doc/kubernetes/ray-job.yaml</denchmark-link>\n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "sivarajendranaidu", "commentT": "2021-01-03T14:48:38Z", "comment_text": "\n \t\tThanks a lot current fix in master worked\n \t\t"}}}, "commit": {"commit_id": "4ca64549e2dc70a33cc638bfc372ad4f128ff6eb", "commit_author": "Dmitri Gekhtman", "commitT": "2020-12-31 16:25:38-06:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "doc\\kubernetes\\ray-cluster.yaml", "file_new_name": "doc\\kubernetes\\ray-cluster.yaml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "62,63,123,124", "deleted_lines": "62,63,123,124"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "doc\\kubernetes\\ray-job.yaml", "file_new_name": "doc\\kubernetes\\ray-job.yaml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "14,15,18", "deleted_lines": "14,15,18"}}}}}}