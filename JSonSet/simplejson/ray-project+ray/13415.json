{"BR": {"BR_id": "13415", "BR_author": "edoakes", "BRopenT": "2021-01-13T20:16:49Z", "BRcloseT": "2021-01-14T20:41:54Z", "BR_text": {"BRsummary": "ray.get_runtime_context().get() fails on a driver", "BRdescription": "\n <denchmark-h:h3>What is the problem?</denchmark-h>\n \n ray.get_runtime_context().get() errors when running on a driver. This should still return the useful context information (e.g., current node ID) or at the very least have a better error message.\n import ray\n ray.init()\n \n print(ray.get_runtime_context().get())\n <denchmark-code>2021-01-13 14:15:29,011 INFO services.py:1169 -- View the Ray dashboard at http://127.0.0.1:8266\n Traceback (most recent call last):\n   File \"test.py\", line 4, in <module>\n     print(ray.get_runtime_context().get())\n   File \"/Users/eoakes/code/ray/python/ray/runtime_context.py\", line 26, in get\n     \"task_id\": self.task_id,\n   File \"/Users/eoakes/code/ray/python/ray/runtime_context.py\", line 92, in task_id\n     assert self.worker.mode == ray.worker.WORKER_MODE, (\n AssertionError: This method is only available when the process is a                 worker. Current mode: 0\n </denchmark-code>\n \n If the code snippet cannot be run by itself, the issue will be closed with \"needs-repro-script\".\n \n  I have verified my script runs in a clean environment and reproduces the issue.\n  I have verified the issue also occurs with the latest wheels.\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "edoakes", "commentT": "2021-01-13T20:17:39Z", "comment_text": "\n \t\tAh I think this should be a simple fix. I will take a look at it later.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "edoakes", "commentT": "2021-01-13T20:33:49Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/rkooo567>@rkooo567</denchmark-link>\n  yeah it ended up being really simple so I just made a quick PR to fix, PTAL when you have a chance.\n \t\t"}}}, "commit": {"commit_id": "7ba87b8abe53c41293a30e6ffbec919476bc6462", "commit_author": "Edward Oakes", "commitT": "2021-01-14 14:41:53-06:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\runtime_context.py", "file_new_name": "python\\ray\\runtime_context.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "15,17,18,27,28,29,30,31,32,33", "deleted_lines": "15,17,18,26,27,28,29,30,31,32", "method_info": {"method_name": "get", "method_params": "self", "method_startline": "14", "method_endline": "33"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "python\\ray\\tests\\test_runtime_context.py", "file_new_name": "python\\ray\\tests\\test_runtime_context.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "87,88,89,90,91,92", "deleted_lines": null, "method_info": {"method_name": "test_get_context_dict.task", "method_params": "node_id,job_id", "method_startline": "87", "method_endline": "92"}}, "hunk_1": {"Ismethod": 1, "added_lines": "67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94", "deleted_lines": null, "method_info": {"method_name": "test_get_context_dict", "method_params": "ray_start_regular", "method_startline": "67", "method_endline": "94"}}, "hunk_2": {"Ismethod": 1, "added_lines": "76,77,78,79,80,81", "deleted_lines": null, "method_info": {"method_name": "test_get_context_dict.check", "method_params": "self,node_id,job_id", "method_startline": "76", "method_endline": "81"}}}}}}}