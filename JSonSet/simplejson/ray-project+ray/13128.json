{"BR": {"BR_id": "13128", "BR_author": "alanwguo", "BRopenT": "2020-12-31T00:05:17Z", "BRcloseT": "2021-01-08T01:17:01Z", "BR_text": {"BRsummary": "In ray 1.1.0, \"pull_before_run\" must be True when using docker", "BRdescription": "\n <denchmark-h:h3>What is the problem?</denchmark-h>\n \n There seems to be a new \"docker inspect\" step in ray 1.1.0 which fails if pull_before_run isn't set to True.\n Ray version and other system information (Python version, TensorFlow version, OS):\n python: 3.7\n ray: 1.1.0\n OS: mac\n <denchmark-h:h3>Reproduction (REQUIRED)</denchmark-h>\n \n Take the AWS example-full cluster config but set docker.pull_before_run to false.\n Try to start a cluster.\n You should see this error:\n <denchmark-code>  New status: update-failed\n   !!!\n   SSH command failed. ssh -tt -i /Users/aguo/.ssh/ray-autoscaler_4_us-west-2.pem -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ExitOnForwardFailure=yes -o ServerAliveInterval=5 -o ServerAliveCountMax=3 -o ControlMaster=auto -o ControlPath=/tmp/ray_ssh_d5ab97da4d/736697fe05/%C -o ControlPersist=10s -o ConnectTimeout=120s ubuntu@54.214.124.193 bash --login -c -i 'true && source ~/.bashrc && export OMP_NUM_THREADS=1 PYTHONWARNINGS=ignore && (docker inspect -f '\"'\"'{{json .Config.Env}}'\"'\"' rayproject/ray-ml:latest-gpu)'\n   !!!\n \n   Failed to setup head node.\n </denchmark-code>\n \n \n  I have verified my script runs in a clean environment and reproduces the issue.\n  I have verified the issue also occurs with the latest wheels.\n \n \t"}, "comments": {}}, "commit": {"commit_id": "4aef3d68360226bfaf3fa2fa8e425f4ef91873cb", "commit_author": "Ian Rodney", "commitT": "2021-01-07 17:17:00-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\autoscaler\\_private\\command_runner.py", "file_new_name": "python\\ray\\autoscaler\\_private\\command_runner.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "768,769,770,774,776,777,779,780,781,795,802,811,812", "deleted_lines": "768,769,770,774,777,791,798,807,808", "method_info": {"method_name": "run_init", "method_params": "self,as_head,file_mounts,sync_run_yet", "method_startline": "763", "method_endline": "837"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\ray\\tests\\test_autoscaler.py", "file_new_name": "python\\ray\\tests\\test_autoscaler.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972", "deleted_lines": null, "method_info": {"method_name": "testDockerImageExistsBeforeInspect", "method_params": "self", "method_startline": "1938", "method_endline": "1972"}}}}}}}