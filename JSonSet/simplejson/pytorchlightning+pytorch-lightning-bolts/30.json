{"BR": {"BR_id": "30", "BR_author": "tshrjn", "BRopenT": "2020-05-28T02:09:54Z", "BRcloseT": "2020-06-15T18:53:53Z", "BR_text": {"BRsummary": "Using gpus gives error for BasicGAN", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n Demo code below:\n import argparse\n from pytorch_lightning import Trainer\n from pl_bolts.models.gans import BasicGAN\n \n trainer = Trainer()\n model = BasicGAN()\n \n parser = argparse.ArgumentParser(description='demo')\n parser = trainer.add_argparse_args(parser)\n args = parser.parse_args()\n \n trainer = Trainer.from_argparse_args(args)\n trainer.fit(model)\n Running with GPUs from cli like: python demo.py --gpus 1 gives the following error:\n   File \"/home/tushar/anaconda3/envs/aer/lib/python3.6/site-packages/pl_bolts/models/gans/basic/basic_gan_pl_module.py\", line 105, in discriminator_step\n     d_loss = self.discriminator_loss(x)\n   File \"/home/tushar/anaconda3/envs/aer/lib/python3.6/site-packages/pl_bolts/models/gans/basic/basic_gan_pl_module.py\", line 97, in discriminator_loss\n     self.discriminator(self.generated_imgs.detach()), fake)\n   File \"/home/tushar/anaconda3/envs/aer/lib/python3.6/site-packages/pl_bolts/models/gans/basic/basic_gan_pl_module.py\", line 57, in adversarial_loss\n     return F.binary_cross_entropy(y_hat, y)\n   File \"/home/tushar/anaconda3/envs/aer/lib/python3.6/site-packages/torch/nn/functional.py\", line 2077, in binary_cross_entropy\n     input, target, weight, reduction_enum)\n RuntimeError: Expected object of device type cuda but got device type cpu for argument #2 'target' in call to _thnn_binary_cross_entropy_forward\n Looks like the labels [y] are not being sent to GPU/(to_device()).\n <denchmark-h:h3>Environment</denchmark-h>\n \n * CUDA:\n         - GPU:\n                 - GeForce RTX 2080 Ti\n         - available:         True\n         - version:           10.1\n * Packages:\n         - numpy:             1.18.1\n         - pyTorch_debug:     False\n         - pyTorch_version:   1.4.0\n         - pytorch-lightning: 0.7.5\n         - tensorboard:       2.2.0\n         - tqdm:              4.45.0\n * System:\n         - OS:                Linux\n         - architecture:\n                 - 64bit\n                 -\n         - processor:         x86_64\n         - python:            3.6.7\n         - version:           #75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "tshrjn", "commentT": "2020-05-28T02:10:33Z", "comment_text": "\n \t\tHi! thanks for your contribution!, great first issue!\n \t\t"}}}, "commit": {"commit_id": "4642b32a21f6aa1a59ddb7a075873137d2405477", "commit_author": "Fr\u00e9d\u00e9ric Branchaud-Charron", "commitT": "2020-06-15 14:53:52-04:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\source\\index.rst", "file_new_name": "docs\\source\\index.rst", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "75", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\source\\readme.md", "file_new_name": "docs\\source\\readme.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "4", "deleted_lines": null}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pl_bolts\\losses\\self_supervised_learning.py", "file_new_name": "pl_bolts\\losses\\self_supervised_learning.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "97,98,99,100", "deleted_lines": "97,98,99,100", "method_info": {"method_name": "forward", "method_params": "self,anchor_representations,positive_representations,mask_mat", "method_startline": "94", "method_endline": "180"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pl_bolts\\metrics\\aggregation.py", "file_new_name": "pl_bolts\\metrics\\aggregation.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": null, "deleted_lines": "18,19", "method_info": {"method_name": "accuracy", "method_params": "preds,labels", "method_startline": "9", "method_endline": "19"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pl_bolts\\models\\gans\\basic\\basic_gan_module.py", "file_new_name": "pl_bolts\\models\\gans\\basic\\basic_gan_module.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "96", "deleted_lines": "96", "method_info": {"method_name": "discriminator_loss", "method_params": "self,x", "method_startline": "87", "method_endline": "103"}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "pl_bolts\\models\\self_supervised\\resnets.py", "file_new_name": "pl_bolts\\models\\self_supervised\\resnets.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "115,438,439,441,443", "deleted_lines": "437,438,440,442"}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pl_bolts\\utils\\ssl_utils.py", "file_new_name": "pl_bolts\\utils\\ssl_utils.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "17", "deleted_lines": "17", "method_info": {"method_name": "torchvision_ssl_encoder", "method_params": "name,pretrained,return_all_feature_maps", "method_startline": "13", "method_endline": "17"}}}}}}}