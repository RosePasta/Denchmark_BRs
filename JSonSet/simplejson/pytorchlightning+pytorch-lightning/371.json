{"BR": {"BR_id": "371", "BR_author": "hvy", "BRopenT": "2019-10-15T07:50:40Z", "BRcloseT": "2019-10-18T08:18:06Z", "BR_text": {"BRsummary": "Number of batches is off-by-one during training", "BRdescription": "\n Describe the bug\n The number of mini batches iterated over during an epoch seems to be off-by-one during training when passing a train_percent_check < 1.0. More specifically, it trains for one additional iteration.\n The operator in this line should probably be changed from  to .\n <denchmark-link:https://github.com/williamFalcon/pytorch-lightning/blob/master/pytorch_lightning/trainer/trainer.py#L1130>https://github.com/williamFalcon/pytorch-lightning/blob/master/pytorch_lightning/trainer/trainer.py#L1130</denchmark-link>\n \n Evaluation by the way seems correct as seen in the following code.\n <denchmark-link:https://github.com/williamFalcon/pytorch-lightning/blob/master/pytorch_lightning/trainer/trainer.py#L614>https://github.com/williamFalcon/pytorch-lightning/blob/master/pytorch_lightning/trainer/trainer.py#L614</denchmark-link>\n \n This leads to unexpected behaviors in e.g. EarlyStopping since the log that it's given is the callback log from the training and not the evaluation (the additional iteration overwrites the evaluation log with the training log).\n To Reproduce\n \n Specify some train_percent_check < 1.0 e.g 0.5.\n Fit.\n Notice that it trains for an additional iteration.\n \n Expected behavior\n It should not train for that additional iteration.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "hvy", "commentT": "2019-10-16T13:58:13Z", "comment_text": "\n \t\tare you sure it\u2019s not a rounding error?\n If it is indeed an error, want to take a stab at a PR?\n \t\t"}}}, "commit": {"commit_id": "0fac2d64cf4c6c31d3b21605a272ace01d0c51a2", "commit_author": "Hiroyuki Vincent Yamazaki", "commitT": "2019-10-18 10:18:05+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pytorch_lightning\\trainer\\trainer.py", "file_new_name": "pytorch_lightning\\trainer\\trainer.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1131", "deleted_lines": "1131", "method_info": {"method_name": "run_training_epoch", "method_params": "self", "method_startline": "1114", "method_endline": "1173"}}}}}}}