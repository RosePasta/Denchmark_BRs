{"BR": {"BR_id": "669", "BR_author": "cdjameson", "BRopenT": "2020-05-20T15:18:42Z", "BRcloseT": "2020-05-25T19:47:04Z", "BR_text": {"BRsummary": "cval not behaving correctly when given float value", "BRdescription": "\n According to <denchmark-link:https://imgaug.readthedocs.io/en/latest/source/api_augmenters_geometric.html>the docs</denchmark-link>\n   should accept float values and create new pixels according to the given value:\n \n cval (number ... ) \u2013 The constant value to use when filling in newly created pixels. ... It may be a float value.\n \n However in practice (with imgaug.augmenters.Affine at least) this does not work. It appears that the actual value being returned is int(cval). My particular use case is with float32 images ranging from [0.0, 1.0].\n The issue can be reproduced this way:\n <denchmark-code>import numpy as np\n import matplotlib.pyplot as plt\n import imgaug as ia\n import imgaug.augmenters as iaa\n \n im = np.array(ia.quokka(size=(256,256)),dtype=np.float32)\n im = im/(2**8-1)\n print(\"First pixel = \" + str(im[0,0,:]))\n \n aug = iaa.Affine(scale=0.8,cval=0.4)\n aug_im = aug(image=im)\n print(\"First pixel = \" + str(aug_im[0,0,:]))\n \n plt.imsave('./regular.png',im)\n plt.imsave('./scaled.png',aug_im)\n </denchmark-code>\n \n Output:\n <denchmark-code>First pixel = [0.19215687 0.30588236 0.32156864]\n First pixel = [0. 0. 0.]\n </denchmark-code>\n \n Where this should now be [0.4 0.4 0.4].\n Resulting images:\n <denchmark-link:https://user-images.githubusercontent.com/65251787/82463686-1e6fda80-9a8b-11ea-9548-f18daa8fadf3.png></denchmark-link>\n \n <denchmark-link:https://user-images.githubusercontent.com/65251787/82463697-20399e00-9a8b-11ea-8e3d-869dd97ec31c.png></denchmark-link>\n \n If this can't be fixed please update the documentation, as currently this is not the expected behavior.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "cdjameson", "commentT": "2020-05-25T19:47:49Z", "comment_text": "\n \t\tThis should now be fixed in master. Thanks for reporting the issue!\n \t\t"}}}, "commit": {"commit_id": "014e23111b445c6e1a5aeacedfc792c96493d52f", "commit_author": "Alexander Jung", "commitT": "2020-05-25 21:47:03+02:00", "changed_files": {"file_0": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "changelogs\\master\\fixed\\20200525_fix_affine_cval_float.md"}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "imgaug\\augmenters\\geometric.py", "file_new_name": "imgaug\\augmenters\\geometric.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "173,174,175,212,216", "deleted_lines": "169,170,171,215"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "test\\augmenters\\test_geometric.py", "file_new_name": "test\\augmenters\\test_geometric.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1987,1988,1989,1990,1991,1992", "deleted_lines": null, "method_info": {"method_name": "test_float_cval_on_float_image", "method_params": "self", "method_startline": "1987", "method_endline": "1992"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1994,1995,1996,1997,1998,1999", "deleted_lines": null, "method_info": {"method_name": "test_float_cval_on_int_image", "method_params": "self", "method_startline": "1994", "method_endline": "1999"}}}}}}}