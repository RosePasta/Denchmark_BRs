{"BR": {"BR_id": "143", "BR_author": "un-knight", "BRopenT": "2019-11-12T06:26:11Z", "BRcloseT": "2019-11-15T09:11:00Z", "BR_text": {"BRsummary": "Missing id() op in bytescheduler.torch.optimizer.py", "BRdescription": "\n Describe the bug\n In the bypteps.bytescheduler.torch.optimizer modular, there are missing id() ops for parameter to get parameter memory address before accessing to self._parameter_names, which will cause runtime error:\n <denchmark-code>Traceback (most recent call last):\n   File \"/usr/local/byteps/example/pytorch/benchmark_bytescheduler.py\", line 134, in <module>\n     timeit.timeit(benchmark_step, number=args.num_warmup_batches)\n   File \"/opt/anaconda/lib/python3.7/timeit.py\", line 232, in timeit\n     return Timer(stmt, setup, timer, globals).timeit(number)\n   File \"/opt/anaconda/lib/python3.7/timeit.py\", line 176, in timeit\n     timing = self.inner(it, self.timer)\n   File \"<timeit-src>\", line 6, in inner\n   File \"/usr/local/byteps/example/pytorch/benchmark_bytescheduler.py\", line 115, in benchmark_step\n     output = model(data)\n   File \"/opt/anaconda/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 541, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/opt/anaconda/lib/python3.7/site-packages/torchvision/models/resnet.py\", line 196, in forward\n     x = self.conv1(x)\n   File \"/opt/anaconda/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 533, in __call__\n     result = hook(self, input)\n   File \"/opt/anaconda/lib/python3.7/site-packages/byteps-0.1.0-py3.7-linux-x86_64.egg/byteps/bytescheduler/torch/optimizer.py\", line 206, in pre_forward_hook\n     self._logger.debug(\"{} {} is ready.\".format(self._desc, self._parameter_names[p]))\n RuntimeError: bool value of Tensor with more than one value is ambiguous\n </denchmark-code>\n \n In order to fix this error, you need to replace self._parameter_names[p] with self._parameter_names[id(p)].\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "un-knight", "commentT": "2019-11-13T12:36:52Z", "comment_text": "\n \t\tThank you! Would you create a pull request to the bytescheduler branch?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "un-knight", "commentT": "2019-11-15T09:11:00Z", "comment_text": "\n \t\tThank you for the contribution. Closing this issue for now.\n \t\t"}}}, "commit": {"commit_id": "e4bbd24747470941bb5b76f542d4e8b2a9d02e1a", "commit_author": "Junxian Ye", "commitT": "2019-11-15 17:10:26+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 7, "file_old_name": "byteps\\bytescheduler\\torch\\optimizer.py", "file_new_name": "byteps\\bytescheduler\\torch\\optimizer.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "270,272", "deleted_lines": "270,272", "method_info": {"method_name": "_adam", "method_params": "self,p", "method_startline": "263", "method_endline": "322"}}, "hunk_1": {"Ismethod": 1, "added_lines": "240,242", "deleted_lines": "240,242", "method_info": {"method_name": "_sgd", "method_params": "self,p", "method_startline": "228", "method_endline": "261"}}, "hunk_2": {"Ismethod": 1, "added_lines": "331,333", "deleted_lines": "331,333", "method_info": {"method_name": "_rmsprop", "method_params": "self,p", "method_startline": "324", "method_endline": "373"}}, "hunk_3": {"Ismethod": 1, "added_lines": "203", "deleted_lines": "203", "method_info": {"method_name": "_register_forward_hooks.pre_forward_hook", "method_params": "mod,input", "method_startline": "196", "method_endline": "205"}}, "hunk_4": {"Ismethod": 1, "added_lines": "140,146", "deleted_lines": "140,146", "method_info": {"method_name": "_push_pull_grad_async", "method_params": "self,p", "method_startline": "132", "method_endline": "149"}}, "hunk_5": {"Ismethod": 1, "added_lines": "203", "deleted_lines": "203", "method_info": {"method_name": "_register_forward_hooks", "method_params": "self", "method_startline": "180", "method_endline": "214"}}, "hunk_6": {"Ismethod": 1, "added_lines": "162", "deleted_lines": "162", "method_info": {"method_name": "_poll", "method_params": "self", "method_startline": "151", "method_endline": "178"}}}}}}}