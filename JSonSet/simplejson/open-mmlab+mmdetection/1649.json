{"BR": {"BR_id": "1649", "BR_author": "thomashossler", "BRopenT": "2019-11-08T21:37:49Z", "BRcloseT": "2019-11-25T09:23:56Z", "BR_text": {"BRsummary": "Shuffle=True in build data loader", "BRdescription": "\n Describe the bug\n \n \n When setting shuffle=True inb the non distributed training case, the build_dataloader function crashes. Because of sampler = GroupSampler(dataset, imgs_per_gpu) if shuffle else None, when shuffle=True the sampler is defined and pytorch dataloader cannot have both.\n \n \n more importantly, because of that logic, in non distributed training, the sampler is None and there is no shuffling which means that the training data is fed to the network in a deterministic fashion (which is really bad if the classes are not uniformly distributed in your dataset for example).\n \n \n Reproduction\n \n What command or script did you run?\n \n <denchmark-code>python train.py ../configs/faster_rcnn_r50_fpn_1x.py\n </denchmark-code>\n \n \n Did you make any modifications on the code or config? Did you understand what you have modified?\n In mmdet/apis/train.py, line 203\" in the _non_dist_train function:\n \n <denchmark-code>    data_loaders = [\n         build_dataloader(\n             ds,\n             cfg.data.imgs_per_gpu,\n             cfg.data.workers_per_gpu,\n             cfg.gpus,\n             dist=False,\n             shuffle=True) for ds in dataset\n     ]\n </denchmark-code>\n \n \n What dataset did you use?\n coco2017\n \n Environment\n \n provided docker image\n \n Error traceback\n If applicable, paste the error trackback here.\n <denchmark-code>ValueError: sampler option is mutually exclusive with shuffle\n </denchmark-code>\n \n Bug fix\n I can write the PR asap.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "thomashossler", "commentT": "2019-11-19T16:54:13Z", "comment_text": "\n \t\tany update on that <denchmark-link:https://github.com/ZwwWayne>@ZwwWayne</denchmark-link>\n  ?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "thomashossler", "commentT": "2019-11-20T01:47:11Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/thomashossler>@thomashossler</denchmark-link>\n  Thanks for your advice, this is indeed a bug.\n Could you write a PR to fix that?\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "thomashossler", "commentT": "2019-11-20T08:49:02Z", "comment_text": "\n \t\tsure,  I'll submit it tomorrow\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "thomashossler", "commentT": "2019-11-20T12:39:03Z", "comment_text": "\n \t\tThanks a lot.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "thomashossler", "commentT": "2019-11-20T19:21:25Z", "comment_text": "\n \t\tcool you have the PR reference above. This is my first PR in this repo, I followed the guidelines but lemme know if something is wrong. I think this was the easiest / cleanest way to solve the bug.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "thomashossler", "commentT": "2019-11-25T09:23:56Z", "comment_text": "\n \t\tThanks for the PR.\n This issue is closed, feel free to reopen it if you have further questions.\n \t\t"}}}, "commit": {"commit_id": "db1764b7be713a8e5d1f3a7ef321cc2069f692e5", "commit_author": "Thomas Hossler", "commitT": "2019-11-24 22:00:44+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "mmdet\\datasets\\loader\\build_loader.py", "file_new_name": "mmdet\\datasets\\loader\\build_loader.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "22", "deleted_lines": "23", "method_info": {"method_name": "build_dataloader", "method_params": "dataset,imgs_per_gpu,workers_per_gpu,num_gpus,dist,shuffle,kwargs", "method_startline": "17", "method_endline": "23"}}}}}}}