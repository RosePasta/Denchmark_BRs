{"BR": {"BR_id": "2850", "BR_author": "yustaub", "BRopenT": "2020-05-29T13:01:16Z", "BRcloseT": "2020-05-31T12:17:58Z", "BR_text": {"BRsummary": "error happend when I try multiscale test", "BRdescription": "\n I change the img_scale to img_scale=[(1400, 1000), (1400, 800), (1400,600)] in test_pipeline, my command is CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 ./tools/dist_test.sh configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py ./checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth 8 --eval bbox\n <denchmark-h:h1>error log</denchmark-h>\n \n <denchmark-code>[                                                  ] 0/5000, elapsed: 0s, ETA:Traceback (most recent call last):\n   File \"./tools/test.py\", line 149, in <module>\n     main()\n   File \"./tools/test.py\", line 134, in main\n     args.gpu_collect)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/apis/test.py\", line 114, in multi_gpu_test\n     result = model(return_loss=False, rescale=True, **data)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 447, in forward\n     output = self.module(*inputs[0], **kwargs[0])\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/fp16/decorators.py\", line 51, in new_func\n     return old_func(*args, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 151, in forward\n     return self.forward_test(img, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 136, in forward_test\n     return self.aug_test(imgs, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/two_stage.py\", line 204, in aug_test\n     x, proposal_list, img_metas, rescale=rescale)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/standard_roi_head.py\", line 265, in aug_test\n     self.test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/test_mixins.py\", line 99, in aug_test_bboxes\n     aug_bboxes, aug_scores, img_metas, rcnn_test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/post_processing/merge_augs.py\", line 65, in merge_aug_bboxes\n     bboxes = torch.stack(recovered_bboxes).mean(dim=0)\n RuntimeError: stack expects a non-empty TensorList\n Traceback (most recent call last):\n   File \"./tools/test.py\", line 149, in <module>\n     main()\n   File \"./tools/test.py\", line 134, in main\n     args.gpu_collect)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/apis/test.py\", line 114, in multi_gpu_test\n     result = model(return_loss=False, rescale=True, **data)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 447, in forward\n     output = self.module(*inputs[0], **kwargs[0])\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/fp16/decorators.py\", line 51, in new_func\n     return old_func(*args, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 151, in forward\n     return self.forward_test(img, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 136, in forward_test\n     return self.aug_test(imgs, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/two_stage.py\", line 204, in aug_test\n     x, proposal_list, img_metas, rescale=rescale)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/standard_roi_head.py\", line 265, in aug_test\n     self.test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/test_mixins.py\", line 99, in aug_test_bboxes\n     aug_bboxes, aug_scores, img_metas, rcnn_test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/post_processing/merge_augs.py\", line 65, in merge_aug_bboxes\n     bboxes = torch.stack(recovered_bboxes).mean(dim=0)\n RuntimeError: stack expects a non-empty TensorList\n Traceback (most recent call last):\n   File \"./tools/test.py\", line 149, in <module>\n     main()\n   File \"./tools/test.py\", line 134, in main\n     args.gpu_collect)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/apis/test.py\", line 114, in multi_gpu_test\n     result = model(return_loss=False, rescale=True, **data)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 447, in forward\n     output = self.module(*inputs[0], **kwargs[0])\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/fp16/decorators.py\", line 51, in new_func\n     return old_func(*args, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 151, in forward\n     return self.forward_test(img, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 136, in forward_test\n     return self.aug_test(imgs, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/two_stage.py\", line 204, in aug_test\n     x, proposal_list, img_metas, rescale=rescale)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/standard_roi_head.py\", line 265, in aug_test\n     self.test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/test_mixins.py\", line 99, in aug_test_bboxes\n     aug_bboxes, aug_scores, img_metas, rcnn_test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/post_processing/merge_augs.py\", line 65, in merge_aug_bboxes\n     bboxes = torch.stack(recovered_bboxes).mean(dim=0)\n RuntimeError: stack expects a non-empty TensorList\n Traceback (most recent call last):\n   File \"./tools/test.py\", line 149, in <module>\n     main()\n   File \"./tools/test.py\", line 134, in main\n     args.gpu_collect)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/apis/test.py\", line 114, in multi_gpu_test\n     result = model(return_loss=False, rescale=True, **data)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 447, in forward\n     output = self.module(*inputs[0], **kwargs[0])\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/fp16/decorators.py\", line 51, in new_func\n     return old_func(*args, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 151, in forward\n     return self.forward_test(img, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 136, in forward_test\n     return self.aug_test(imgs, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/two_stage.py\", line 204, in aug_test\n     x, proposal_list, img_metas, rescale=rescale)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/standard_roi_head.py\", line 265, in aug_test\n     self.test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/test_mixins.py\", line 99, in aug_test_bboxes\n     aug_bboxes, aug_scores, img_metas, rcnn_test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/post_processing/merge_augs.py\", line 65, in merge_aug_bboxes\n     bboxes = torch.stack(recovered_bboxes).mean(dim=0)\n RuntimeError: stack expects a non-empty TensorList\n Traceback (most recent call last):\n   File \"./tools/test.py\", line 149, in <module>\n     main()\n   File \"./tools/test.py\", line 134, in main\n     args.gpu_collect)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/apis/test.py\", line 114, in multi_gpu_test\n     result = model(return_loss=False, rescale=True, **data)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 447, in forward\n     output = self.module(*inputs[0], **kwargs[0])\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/fp16/decorators.py\", line 51, in new_func\n     return old_func(*args, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 151, in forward\n     return self.forward_test(img, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 136, in forward_test\n     return self.aug_test(imgs, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/two_stage.py\", line 204, in aug_test\n     x, proposal_list, img_metas, rescale=rescale)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/standard_roi_head.py\", line 265, in aug_test\n     self.test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/test_mixins.py\", line 99, in aug_test_bboxes\n     aug_bboxes, aug_scores, img_metas, rcnn_test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/post_processing/merge_augs.py\", line 65, in merge_aug_bboxes\n     bboxes = torch.stack(recovered_bboxes).mean(dim=0)\n RuntimeError: stack expects a non-empty TensorList\n Traceback (most recent call last):\n   File \"./tools/test.py\", line 149, in <module>\n     main()\n   File \"./tools/test.py\", line 134, in main\n     args.gpu_collect)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/apis/test.py\", line 114, in multi_gpu_test\n     result = model(return_loss=False, rescale=True, **data)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 447, in forward\n     output = self.module(*inputs[0], **kwargs[0])\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/fp16/decorators.py\", line 51, in new_func\n     return old_func(*args, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 151, in forward\n     return self.forward_test(img, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 136, in forward_test\n     return self.aug_test(imgs, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/two_stage.py\", line 204, in aug_test\n     x, proposal_list, img_metas, rescale=rescale)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/standard_roi_head.py\", line 265, in aug_test\n     self.test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/test_mixins.py\", line 99, in aug_test_bboxes\n     aug_bboxes, aug_scores, img_metas, rcnn_test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/post_processing/merge_augs.py\", line 65, in merge_aug_bboxes\n     bboxes = torch.stack(recovered_bboxes).mean(dim=0)\n RuntimeError: stack expects a non-empty TensorList\n Traceback (most recent call last):\n   File \"./tools/test.py\", line 149, in <module>\n     main()\n   File \"./tools/test.py\", line 134, in main\n     args.gpu_collect)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/apis/test.py\", line 114, in multi_gpu_test\n     result = model(return_loss=False, rescale=True, **data)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 447, in forward\n     output = self.module(*inputs[0], **kwargs[0])\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/fp16/decorators.py\", line 51, in new_func\n     return old_func(*args, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 151, in forward\n     return self.forward_test(img, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 136, in forward_test\n     return self.aug_test(imgs, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/two_stage.py\", line 204, in aug_test\n     x, proposal_list, img_metas, rescale=rescale)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/standard_roi_head.py\", line 265, in aug_test\n     self.test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/test_mixins.py\", line 99, in aug_test_bboxes\n     aug_bboxes, aug_scores, img_metas, rcnn_test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/post_processing/merge_augs.py\", line 65, in merge_aug_bboxes\n     bboxes = torch.stack(recovered_bboxes).mean(dim=0)\n RuntimeError: stack expects a non-empty TensorList\n Traceback (most recent call last):\n   File \"./tools/test.py\", line 149, in <module>\n     main()\n   File \"./tools/test.py\", line 134, in main\n     args.gpu_collect)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/apis/test.py\", line 114, in multi_gpu_test\n     result = model(return_loss=False, rescale=True, **data)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 447, in forward\n     output = self.module(*inputs[0], **kwargs[0])\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\n     result = self.forward(*input, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/fp16/decorators.py\", line 51, in new_func\n     return old_func(*args, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 151, in forward\n     return self.forward_test(img, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/base.py\", line 136, in forward_test\n     return self.aug_test(imgs, img_metas, **kwargs)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/detectors/two_stage.py\", line 204, in aug_test\n     x, proposal_list, img_metas, rescale=rescale)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/standard_roi_head.py\", line 265, in aug_test\n     self.test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/models/roi_heads/test_mixins.py\", line 99, in aug_test_bboxes\n     aug_bboxes, aug_scores, img_metas, rcnn_test_cfg)\n   File \"/home/joseph/ml_test/mmdetection/mmdet/core/post_processing/merge_augs.py\", line 65, in merge_aug_bboxes\n     bboxes = torch.stack(recovered_bboxes).mean(dim=0)\n RuntimeError: stack expects a non-empty TensorList\n Traceback (most recent call last):\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\n     \"__main__\", mod_spec)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/runpy.py\", line 85, in _run_code\n     exec(code, run_globals)\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/distributed/launch.py\", line 263, in <module>\n     main()\n   File \"/home/joseph/anaconda3/envs/open-mmlab/lib/python3.6/site-packages/torch/distributed/launch.py\", line 259, in main\n     cmd=cmd)\n subprocess.CalledProcessError: Command '['/home/joseph/anaconda3/envs/open-mmlab/bin/python', '-u', './tools/test.py', '--local_rank=7', 'configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py', './checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth', '--launcher', 'pytorch', '--eval', 'bbox']' returned non-zero exit status 1.\n </denchmark-code>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "55a4023cc13997edb89384227305bfe1683fd859", "commit_author": "Wenwei Zhang", "commitT": "2020-05-31 20:17:57+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "mmdet\\core\\bbox\\transforms.py", "file_new_name": "mmdet\\core\\bbox\\transforms.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "37,38", "deleted_lines": "37,38", "method_info": {"method_name": "bbox_mapping_back", "method_params": "bboxes,img_shape,scale_factor,flip", "method_startline": "34", "method_endline": "38"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "mmdet\\models\\detectors\\base.py", "file_new_name": "mmdet\\models\\detectors\\base.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "48", "deleted_lines": "48", "method_info": {"method_name": "extract_feats", "method_params": "self,imgs", "method_startline": "46", "method_endline": "48"}}}}}}}