{"BR": {"BR_id": "11657", "BR_author": "edlanglois", "BRopenT": "2018-11-16T23:22:24Z", "BRcloseT": "2018-12-09T14:28:29Z", "BR_text": {"BRsummary": "Scikit Learn wrapper predict() inappropriately squashes size-1 batch dimension", "BRdescription": "\n Please make sure that the boxes below are checked before you submit your issue.\n If your issue is an , please ask your question on <denchmark-link:http://stackoverflow.com/questions/tagged/keras>StackOverflow</denchmark-link>\n  or <denchmark-link:https://keras-slack-autojoin.herokuapp.com/>on the Keras Slack channel</denchmark-link>\n  instead of opening a GitHub issue.\n Thank you!\n \n \n  Check that you are up-to-date with the master branch of Keras. You can update with:\n pip install git+git://github.com/keras-team/keras.git --upgrade --no-deps\n Using Keras version 2.2.4\n \n \n  Check that your version of TensorFlow is up-to-date. The installation instructions can be found here.\n Using Tensorflow version 1.12.0\n \n \n  Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).\n \n \n If predict() is called on input with shape (1, num_features), then the output is a 0-dimensional array instead of a 1-dimensional array with 1 element.\n import keras\n import keras.wrappers.scikit_learn\n import numpy as np\n import sklearn.linear_model\n import sklearn.metrics\n \n def build_net():\n     model = keras.models.Sequential([keras.layers.Dense(units=1, input_dim=2)])\n     model.compile(loss=keras.losses.mean_squared_error, optimizer=\"sgd\")\n     return model\n \n regressor = keras.wrappers.scikit_learn.KerasRegressor(build_fn=build_net)\n # Works with the sklearn regressors\n # regressor = sklearn.linear_model.LinearRegression()\n X = np.zeros((1, 2))\n Y = np.zeros((1,))\n regressor.fit(X, Y)\n Y_pred = regressor.predict(X)\n print(Y_pred.shape)  # Is (), should be (1,)\n # As a result, this fails with an exception\n # TypeError: Singleton array array(0., dtype=float32) cannot be considered a valid collection.\n print(sklearn.metrics.mean_squared_error(y_true=Y, y_pred=Y_pred))\n \t"}, "comments": {}}, "commit": {"commit_id": "c05ef1fd95a6024155ab59656fef8dac5a45c335", "commit_author": "Eric Langlois", "commitT": "2018-12-09 15:28:28+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "keras\\wrappers\\scikit_learn.py", "file_new_name": "keras\\wrappers\\scikit_learn.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "323", "deleted_lines": "323", "method_info": {"method_name": "predict", "method_params": "self,x,kwargs", "method_startline": "308", "method_endline": "323"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tests\\keras\\wrappers\\scikit_learn_test.py", "file_new_name": "tests\\keras\\wrappers\\scikit_learn_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "174,175", "deleted_lines": null, "method_info": {"method_name": "test_regression_predict_shape_correct_num_test_1", "method_params": "", "method_startline": "174", "method_endline": "175"}}, "hunk_1": {"Ismethod": 1, "added_lines": "170,171", "deleted_lines": null, "method_info": {"method_name": "test_regression_predict_shape_correct_num_test_0", "method_params": "", "method_startline": "170", "method_endline": "171"}}, "hunk_2": {"Ismethod": 1, "added_lines": "178,179,180,181,182,183,184,185", "deleted_lines": null, "method_info": {"method_name": "assert_regression_predict_shape_correct", "method_params": "num_test", "method_startline": "178", "method_endline": "185"}}}}}}}