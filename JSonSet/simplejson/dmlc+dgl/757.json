{"BR": {"BR_id": "757", "BR_author": "sharifza", "BRopenT": "2019-08-11T16:16:49Z", "BRcloseT": "2019-08-20T19:54:37Z", "BR_text": {"BRsummary": "Number of batches as a function of number of entities [RGCN]", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Potential Bug</denchmark-h>\n \n I might be missing out something but to me this line looks a bit strange:\n \n \n \n dgl/examples/pytorch/rgcn/utils.py\n \n \n          Line 169\n       in\n       17b60e1\n \n \n \n \n \n \n  n_batch = (num_entity + batch_size - 1) // batch_size \n \n \n \n \n \n It seems like number of batches is computed by dividing number of entities (nodes) to batch size.\n Shouldn't that be (test_size + batch_size - 1) // batch_size  instead ?\n <denchmark-h:h2>Expected behavior</denchmark-h>\n \n Instead of\n \n \n \n dgl/examples/pytorch/rgcn/utils.py\n \n \n          Line 198\n       in\n       17b60e1\n \n \n \n \n \n \n  ranks_s = perturb_and_get_rank(embedding, w, o, r, s, num_entity, eval_bz) \n \n \n \n \n \n and\n \n \n \n dgl/examples/pytorch/rgcn/utils.py\n \n \n          Line 200\n       in\n       17b60e1\n \n \n \n \n \n \n  ranks_o = perturb_and_get_rank(embedding, w, s, r, o, num_entity, eval_bz) \n \n \n \n \n \n we should have\n ranks_s = perturb_and_get_rank(embedding, w, o, r, s, test_triplets.shape[0], eval_bz)\n and\n ranks_o = perturb_and_get_rank(embedding, w, s, r, o, test_triplets.shape[0], eval_bz)\n I can do a pull request if someone confirms this...\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "sharifza", "commentT": "2019-08-15T18:35:28Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/sharifza>@sharifza</denchmark-link>\n  I think you are right. It should not be number of entities. It should be number of triplets in the test.\n Please open a PR.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "sharifza", "commentT": "2019-08-19T20:48:31Z", "comment_text": "\n \t\tThanks for looking at it @ylfdq1118, please take a look at the PR.\n \t\t"}}}, "commit": {"commit_id": "77c58289a7b72b83b8c409b0a8b994239bca230d", "commit_author": "Sahand", "commitT": "2019-08-20 15:54:03-04:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "examples\\pytorch\\rgcn\\link_predict.py", "file_new_name": "examples\\pytorch\\rgcn\\link_predict.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "185,210", "deleted_lines": "185,210", "method_info": {"method_name": "main", "method_params": "args", "method_startline": "82", "method_endline": "211"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "examples\\pytorch\\rgcn\\utils.py", "file_new_name": "examples\\pytorch\\rgcn\\utils.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "190,196,199,201", "deleted_lines": "190,198,200", "method_info": {"method_name": "evaluate", "method_params": "test_graph,model,test_triplets,hits,eval_bz", "method_startline": "190", "method_endline": "212"}}, "hunk_1": {"Ismethod": 1, "added_lines": "166,169,174", "deleted_lines": "166,169,174", "method_info": {"method_name": "perturb_and_get_rank", "method_params": "embedding,w,a,r,b,num_entity,batch_size", "method_startline": "166", "method_endline": "186"}}, "hunk_2": {"Ismethod": 1, "added_lines": "190,196,199,201", "deleted_lines": "190,198,200", "method_info": {"method_name": "evaluate", "method_params": "test_graph,model,test_triplets,num_entity,hits,eval_bz", "method_startline": "190", "method_endline": "211"}}, "hunk_3": {"Ismethod": 1, "added_lines": "166,169,174", "deleted_lines": "166,169,174", "method_info": {"method_name": "perturb_and_get_rank", "method_params": "embedding,w,a,r,b,test_size,batch_size", "method_startline": "166", "method_endline": "186"}}}}}}}