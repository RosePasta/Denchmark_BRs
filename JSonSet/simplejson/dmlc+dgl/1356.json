{"BR": {"BR_id": "1356", "BR_author": "zheng-da", "BRopenT": "2020-03-13T06:20:44Z", "BRcloseT": "2020-03-22T08:33:16Z", "BR_text": {"BRsummary": "weird behavior of edge_ids", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n The behavior of edge_ids is different with or without calling is_multigraph before it. If is_multigraph is called before, edge_ids returns a tensor. If not, it returns a tuple of tensors.\n import numpy as np\n import dgl\n from dgl.graph_index import from_scipy_sparse_matrix\n from scipy import sparse as spsp\n \n def create_large_graph_index(num_nodes):\n     row = np.random.choice(num_nodes, num_nodes * 10)\n     col = np.random.choice(num_nodes, num_nodes * 10)\n     spm = spsp.coo_matrix((np.ones(len(row)), (row, col)))\n     return from_scipy_sparse_matrix(spm, True)\n \n g = dgl.DGLGraph(create_large_graph_index(1000), readonly=True)\n src, dst = g.all_edges(form='uv', order='eid')\n #print('multigraph:', g.is_multigraph)\n orig_eid = g.edge_ids([0, 1, 2, 3], [2, 5, 7, 8])\n print(orig_eid)\n <denchmark-h:h2>To Reproduce</denchmark-h>\n \n Steps to reproduce the behavior:\n \n \n \n \n \n <denchmark-h:h2>Expected behavior</denchmark-h>\n \n <denchmark-h:h2>Environment</denchmark-h>\n \n \n DGL Version (e.g., 1.0):\n Backend Library & Version (e.g., PyTorch 0.4.1, MXNet/Gluon 1.3):\n OS (e.g., Linux):\n How you installed DGL (conda, pip, source):\n Build command you used (if compiling from source):\n Python version:\n CUDA/cuDNN version (if applicable):\n GPU models and configuration (e.g. V100):\n Any other relevant information:\n \n <denchmark-h:h2>Additional context</denchmark-h>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "zheng-da", "commentT": "2020-03-13T06:23:57Z", "comment_text": "\n \t\tThis is intended: if it is a simple graph we return a single tensor of edge IDs.  Otherwise it will return a triplet of source, destination, and edge IDs.  If you want consistent behaviors, set force_multi to True.\n Or maybe you want to have force_multi to be True as default?\n \t\t"}}}, "commit": {"commit_id": "10253a5c0764f8f9c767ae00fbb362ff3cb21e0f", "commit_author": "Da Zheng", "commitT": "2020-03-22 00:30:27-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "python\\dgl\\graph.py", "file_new_name": "python\\dgl\\graph.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1808,1816,1817,1818,1819,1831", "deleted_lines": "1808,1827", "method_info": {"method_name": "from_scipy_sparse_matrix", "method_params": "self,spmat,multigraph", "method_startline": "1808", "method_endline": "1834"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1808,1816,1817,1818,1819", "deleted_lines": "1808,1827", "method_info": {"method_name": "from_scipy_sparse_matrix", "method_params": "self,spmat", "method_startline": "1808", "method_endline": "1830"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "python\\dgl\\graph_index.py", "file_new_name": "python\\dgl\\graph_index.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1142,1148,1149,1150,1162,1164", "deleted_lines": "1142,1159", "method_info": {"method_name": "from_scipy_sparse_matrix", "method_params": "adj,multigraph,readonly", "method_startline": "1142", "method_endline": "1165"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1142,1148,1149,1150", "deleted_lines": "1142,1159", "method_info": {"method_name": "from_scipy_sparse_matrix", "method_params": "adj,readonly", "method_startline": "1142", "method_endline": "1161"}}, "hunk_2": {"Ismethod": 1, "added_lines": "1305", "deleted_lines": "1301", "method_info": {"method_name": "create_graph_index", "method_params": "graph_data,multigraph,readonly", "method_startline": "1277", "method_endline": "1313"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\compute\\test_transform.py", "file_new_name": "tests\\compute\\test_transform.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "205,206", "deleted_lines": "205", "method_info": {"method_name": "create_large_graph_index", "method_params": "num_nodes", "method_startline": "201", "method_endline": "206"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\graph_index\\test_subgraph.py", "file_new_name": "tests\\graph_index\\test_subgraph.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "95,96", "deleted_lines": "95", "method_info": {"method_name": "create_large_graph_index", "method_params": "num_nodes", "method_startline": "91", "method_endline": "96"}}}}}}}