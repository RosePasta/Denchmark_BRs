{"BR": {"BR_id": "306", "BR_author": "kl2792", "BRopenT": "2018-08-11T21:53:16Z", "BRcloseT": "2018-08-13T12:08:04Z", "BR_text": {"BRsummary": "Accuracy computation for seq2seq model", "BRdescription": "\n <denchmark-code>0/10(t): 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1000/1000 [02:30<00:00,  6.75it/s, running_loss=0.0338, running_acc=0.326, loss=0.689, loss_std=1.17, acc=35.9, acc_std=0]\n 0/10(v): 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 20/20 [00:01<00:00, 19.90it/s, val_loss=0.0341, val_loss_std=0.0122, val_acc=42, val_acc_std=0]\n 1/10(t): 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1000/1000 [02:30<00:00,  6.76it/s, running_loss=0.00997, running_acc=0.327, loss=0.019, loss_std=0.0166, acc=41.8, acc_std=0]\n 1/10(v): 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 20/20 [00:01<00:00, 19.98it/s, val_loss=0.0126, val_loss_std=0.00798, val_acc=42.1, val_acc_std=0]\n 2/10(t): 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1000/1000 [02:30<00:00,  6.75it/s, running_loss=0.00493, running_acc=0.328, loss=0.00837, loss_std=0.00938, acc=41.8, acc_std=0]\n 2/10(v): 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 20/20 [00:01<00:00, 19.89it/s, val_loss=0.00783, val_loss_std=0.00716, val_acc=42.2, val_acc_std=0]\n 3/10(t):  45%|\u2588\u2588\u2588\u2588\u258c     | 454/1000 [01:08<01:21,  6.73it/s, running_loss=0.00458, running_acc=0.316]\n </denchmark-code>\n \n Are the accuracies correct? (running_acc=.326, acc=35.9?)\n I may be misunderstanding something, but shouldn't running_acc and acc be the same at the end of each epoch?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "kl2792", "commentT": "2018-08-11T22:04:09Z", "comment_text": "\n \t\tThat looks ok! Running_acc is a 50 batch average (by default) and so will be slightly different to acc which is an average over the whole epoch. Hope that helps :)\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "kl2792", "commentT": "2018-08-11T22:05:48Z", "comment_text": "\n \t\tThat helps a lot!\n P. S. Thanks for creating such a great library!\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "kl2792", "commentT": "2018-08-11T22:09:21Z", "comment_text": "\n \t\tSorry, I actually have another question on the same subject -- do you know why acc_std=0 for both train & validation?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "kl2792", "commentT": "2018-08-11T23:05:38Z", "comment_text": "\n \t\tThe standard deviation can be 0 if the variance we compute is negative, which can happen when the accuracies for each batch are very similar. This is due to precision errors casting from pytorch float tensors to python floats.\n If your running accuracies you see throughout the epoch are all around 0.32 then this might be what's happening.\n Looking closer I think the acc value should also be between 0 and 1, although I'll have to check. Could you post the shape of your network output? It might be as simple as the mean metric count not being updated correctly.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "kl2792", "commentT": "2018-08-11T23:55:34Z", "comment_text": "\n \t\tAh, I see -- thanks for the explanation, <denchmark-link:https://github.com/MattPainter01>@MattPainter01</denchmark-link>\n  ! I implemented a seq2seq model, so network output is (batch_size, max_length, num_tokens) due to padding, while y_true shape is (batch_size, max_length).\n I was also wondering -- would it be possible for accuracy to have an ignore_index option like nn.CrossEntropyLoss? The 0 index is a placeholder index for me and it'd be nice to exclude it from accuracy computations. Happy to put in a PR for it if someone could give me a pointer to what code I'd need to edit.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "kl2792", "commentT": "2018-08-12T09:56:15Z", "comment_text": "\n \t\tSeems like the categorical accuracy isn\u2019t handling those outputs correctly, which it definitely should, I\u2019ll take a look on Monday :) I\u2019ll also open an issue for the ignore index option\n \t\t"}}}, "commit": {"commit_id": "96896c6de970d7a4f98d62e27e0f0f084df228c8", "commit_author": "Matt Painter", "commitT": "2018-08-13 13:08:03+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "14", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 7, "file_old_name": "tests\\metrics\\test_aggregators.py", "file_new_name": "tests\\metrics\\test_aggregators.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "25", "deleted_lines": null, "method_info": {"method_name": "test_train", "method_params": "self", "method_startline": "24", "method_endline": "30"}}, "hunk_1": {"Ismethod": 1, "added_lines": "50,51,52,53,54,55,56,57,58,59,60", "deleted_lines": null, "method_info": {"method_name": "setUpMoreDims", "method_params": "self", "method_startline": "50", "method_endline": "60"}}, "hunk_2": {"Ismethod": 1, "added_lines": "33", "deleted_lines": null, "method_info": {"method_name": "test_validate", "method_params": "self", "method_startline": "32", "method_endline": "38"}}, "hunk_3": {"Ismethod": 1, "added_lines": "41", "deleted_lines": null, "method_info": {"method_name": "test_precision_error", "method_params": "self", "method_startline": "40", "method_endline": "48"}}, "hunk_4": {"Ismethod": 1, "added_lines": "93", "deleted_lines": null, "method_info": {"method_name": "test_validate_dict", "method_params": "self", "method_startline": "92", "method_endline": "98"}}, "hunk_5": {"Ismethod": 1, "added_lines": "62,63,64,65,66,67", "deleted_lines": null, "method_info": {"method_name": "test_more_dims", "method_params": "self", "method_startline": "62", "method_endline": "67"}}, "hunk_6": {"Ismethod": 1, "added_lines": "85", "deleted_lines": null, "method_info": {"method_name": "test_train_dict", "method_params": "self", "method_startline": "84", "method_endline": "90"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "torchbearer\\metrics\\aggregators.py", "file_new_name": "torchbearer\\metrics\\aggregators.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "125", "deleted_lines": "125", "method_info": {"method_name": "process", "method_params": "self,args", "method_startline": "115", "method_endline": "125"}}}}}}}