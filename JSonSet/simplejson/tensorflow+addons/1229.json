{"BR": {"BR_id": "1229", "BR_author": "lotest", "BRopenT": "2020-03-06T03:17:02Z", "BRcloseT": "2020-03-08T16:39:21Z", "BR_text": {"BRsummary": "RSquare TypeError: tf__update_state() got an unexpected keyword argument 'sample_weight'", "BRdescription": "\n System information\n \n OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  ubuntu 18.04\n TensorFlow version and how it was installed (source or binary): 2.1.0  binary (conda)\n TensorFlow-Addons version and how it was installed (source or binary): 0.8.3 binary(pip)\n Python version:  3.7.6\n Is GPU used? (yes/no): yes\n \n Describe the bug\n The code goes wrong when I add \"tfa.metrics.RSquare(dtype=tf.float32)\" to model metrics.\n The exception is  \"TypeError: tf__update_state() got an unexpected keyword argument 'sample_weight'\"\n And I don't see \"sample_weight\" parameter , what been added shown in <denchmark-link:https://github.com/tensorflow/addons/pull/564>#564</denchmark-link>\n  , of update_state() function in class RSquare in addons version 0.8.3.\n Are there something wrong with my installed tensorflow and addons package?\n Code to reproduce the issue\n Usage in my code:\n model.compile(\n         loss='mse',\n         optimizer=optimizer,\n         metrics=['mae', 'mse', tfa.metrics.RSquare(dtype=tf.float32)]\n     )\n Other info / logs\n Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "lotest", "commentT": "2020-03-06T10:18:52Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lotest>@lotest</denchmark-link>\n  <denchmark-link:https://github.com/tensorflow/addons/pull/564>#564</denchmark-link>\n  was not merged, that's why you don't see  being available. The problem here is that some of the metrics in TFA do not take a  argument because they don't use it. It's a problem though because Keras will automatically pass sample weights when the user declare them.  A good fix would be to add  in all metrics and enforce that the argument is present. And if the tensor is not used during the computation, then just raise a warning.\n This is linked to <denchmark-link:https://github.com/tensorflow/addons/issues/992>#992</denchmark-link>\n  , we lack some unified tests. This will become easier once we switch to pytest for testing.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "lotest", "commentT": "2020-03-06T22:45:00Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/gabrieldemarmiesse>@gabrieldemarmiesse</denchmark-link>\n   will take a look at it\n \t\t"}}}, "commit": {"commit_id": "934184f3d54531b19f1bfc9331f45664d7ff0e72", "commit_author": "Gabriel de Marmiesse", "commitT": "2020-03-08 12:39:20-04:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tensorflow_addons\\metrics\\BUILD", "file_new_name": "tensorflow_addons\\metrics\\BUILD", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "93,94,95,96,97,98,99,100,101,102,103,104", "deleted_lines": null}}}, "file_1": {"file_change_type": "ADD", "file_Nmethod": 0, "file_old_name": "None", "file_new_name": "tensorflow_addons\\metrics\\metrics_test.py"}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tensorflow_addons\\metrics\\multilabel_confusion_matrix.py", "file_new_name": "tensorflow_addons\\metrics\\multilabel_confusion_matrix.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "109,110,111,112,113,114,115,116", "deleted_lines": "107", "method_info": {"method_name": "update_state", "method_params": "self,y_true,y_pred", "method_startline": "107", "method_endline": "131"}}, "hunk_1": {"Ismethod": 1, "added_lines": "109,110,111,112,113,114,115,116", "deleted_lines": null, "method_info": {"method_name": "update_state", "method_params": "self,y_true,y_pred,sample_weight", "method_startline": "109", "method_endline": "140"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "tensorflow_addons\\metrics\\r_square.py", "file_new_name": "tensorflow_addons\\metrics\\r_square.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "58,59,60,61,62", "deleted_lines": "56", "method_info": {"method_name": "update_state", "method_params": "self,y_true,y_pred", "method_startline": "56", "method_endline": "62"}}, "hunk_1": {"Ismethod": 1, "added_lines": "58,59,60,61,62,63,64", "deleted_lines": null, "method_info": {"method_name": "update_state", "method_params": "self,y_true,y_pred,sample_weight", "method_startline": "58", "method_endline": "70"}}}}}}}