{"BR": {"BR_id": "1699", "BR_author": "RobertLucian", "BRopenT": "2020-12-15T22:56:47Z", "BRcloseT": "2020-12-29T17:23:57Z", "BR_text": {"BRsummary": "Model names with same prefix breaks API deployment", "BRdescription": "\n <denchmark-h:h3>Version</denchmark-h>\n \n >= 0.23\n <denchmark-h:h3>Description</denchmark-h>\n \n When an API with a spec like in the following example gets deployed, the API breaks:\n - name: multi-model-classifier\n   kind: RealtimeAPI\n   predictor:\n     type: onnx\n     path: predictor.py\n     models:\n       paths:\n         - name: shufflenet\n           model_path: ...\n         - name: shufflenet-something\n           model_path: ...\n The reason is that in the cron.py script, we make extensive use of glob.glob(<model_directory> + \"*/**\", recursive=True), which will lead to inter-model path \"bleeding\".\n <denchmark-h:h3>Suggested solution</denchmark-h>\n \n Replace all glob.glob(<model_directory> + \"*/**\", recursive=True) with glob.glob(os.path.join(<model_directory>, \"**\"), recursive=True) instead. There might be some gotchas here and there.\n \t"}, "comments": {}}, "commit": {"commit_id": "b80329c9c6a9fe20a3b0130b3a4cc522a1862a0a", "commit_author": "Robert Lucian Chiriac", "commitT": "2020-12-29 19:23:56+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "pkg\\cortex\\serve\\cortex_internal\\lib\\api\\predictor.py", "file_new_name": "pkg\\cortex\\serve\\cortex_internal\\lib\\api\\predictor.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "554", "deleted_lines": "554"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pkg\\cortex\\serve\\cortex_internal\\lib\\model\\cron.py", "file_new_name": "pkg\\cortex\\serve\\cortex_internal\\lib\\model\\cron.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1585,1586,1587,1605,1606,1607", "deleted_lines": "1577,1595", "method_info": {"method_name": "_make_local_models_available", "method_params": "self", "method_startline": "1574", "method_endline": "1619"}}}}}}}