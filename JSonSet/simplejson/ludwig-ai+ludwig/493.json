{"BR": {"BR_id": "493", "BR_author": "BeWe11", "BRopenT": "2019-08-14T17:47:52Z", "BRcloseT": "2019-08-26T04:03:20Z", "BR_text": {"BRsummary": "Example for BERT encoder uses wrong type and crashes", "BRdescription": "\n The documentation for the BERT encoder gives this example of how to set up an encoder using BERT:\n <denchmark-code>name: sequence_csv_column_name\n type: sequence\n encoder: bert\n config_path: <path_to_bert_config.json>\n checkpoint_path: <path_to_bert_model.ckpt>\n do_lower_case: True\n preprocessing:\n     tokenizer: bert\n     vocab_file: <path_to_bert_vocab.txt>\n     padding_symbol: '[PAD]'\n     unknown_symbol: '[UNK]'\n reduce_output: True\n </denchmark-code>\n \n However, by setting , training crashes because sequence encoders do not pass the  parameter when creating a vocabulary:\n <denchmark-link:https://github.com/uber/ludwig/blob/71ca2189bcee7a2667c428aeb1bf738697cbe83d/ludwig/features/sequence_feature.py#L76-L80>https://github.com/uber/ludwig/blob/71ca2189bcee7a2667c428aeb1bf738697cbe83d/ludwig/features/sequence_feature.py#L76-L80</denchmark-link>\n \n Compare this to the creation of vocabularies for text encoders:\n <denchmark-link:https://github.com/uber/ludwig/blob/71ca2189bcee7a2667c428aeb1bf738697cbe83d/ludwig/features/text_feature.py#L81-L89>https://github.com/uber/ludwig/blob/71ca2189bcee7a2667c428aeb1bf738697cbe83d/ludwig/features/text_feature.py#L81-L89</denchmark-link>\n \n So, either the example should be updated to use type: text, or the sequence encoder class should be updated to pass the vocab_file parameter to the vocabulary creation.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "BeWe11", "commentT": "2019-08-14T19:06:46Z", "comment_text": "\n \t\tWill look into it. The fact that the sequence feature doesn't pass the vocabulary file is a regression most likely.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "BeWe11", "commentT": "2019-08-18T20:26:57Z", "comment_text": "\n \t\tIs this on master or when using the package?\n I don't see any issues with using the following config:\n python -m ludwig.experiment --data_csv test_dataset.csv --model_definition \"{input_features: [{name: sequence_1, type: sequence, encoder: bert, config_path: /Users/dudin/Downloads/uncased_L-12_H-768_A-12/bert_config.json, checkpoint_path: /Users/dudin/Downloads/uncased_L-12_H-768_A-12/bert_model.ckpt}], output_features: [{name: category_1, type: category}], training: {epochs: 3, learning_rate: 0.001}, preprocessing: {tokenizer: bert, vocab_file: /Users/dudin/Downloads/uncased_L-12_H-768_A-12/vocab.txt}}\"\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "BeWe11", "commentT": "2019-08-19T13:44:26Z", "comment_text": "\n \t\tI've used the pip package <denchmark-link:https://github.com/ydudin3>@ydudin3</denchmark-link>\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "BeWe11", "commentT": "2019-08-19T16:41:17Z", "comment_text": "\n \t\tWould you mind giving it a shot using current master, I believe it should work?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "BeWe11", "commentT": "2019-08-26T04:04:08Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/BeWe11>@BeWe11</denchmark-link>\n  I pushed a commit that should have solved the issue, can you please confirm?\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "BeWe11", "commentT": "2019-09-03T09:40:47Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/w4nderlust>@w4nderlust</denchmark-link>\n  Sorry for the delay, I can confirm that the issue has been resolved.\n \t\t"}}}, "commit": {"commit_id": "c71088de8fd7827391fe931e9102fb0d2a738ba7", "commit_author": "piero", "commitT": "2019-08-25 21:03:09-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "ludwig\\features\\sequence_feature.py", "file_new_name": "ludwig\\features\\sequence_feature.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "79,80,81,82", "deleted_lines": "79", "method_info": {"method_name": "get_feature_meta", "method_params": "column,preprocessing_parameters", "method_startline": "75", "method_endline": "94"}}}}}}}