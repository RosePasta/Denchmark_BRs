{"BR": {"BR_id": "989", "BR_author": "CrafterKolyan", "BRopenT": "2020-11-06T10:28:18Z", "BRcloseT": "2020-12-05T12:33:19Z", "BR_text": {"BRsummary": "Warning in torch.lr_scheduler", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug Report</denchmark-h>\n \n On catalyst training with scheduler a warning shows.\n <denchmark-code>OS: Windows\n Python 3.7.8\n catalyst==20.10.1\n torch==1.6.0\n </denchmark-code>\n \n <denchmark-h:h3>How To Reproduce</denchmark-h>\n \n <denchmark-code>import torch\n from torch import nn\n import torch.nn.functional as F\n from torch.utils.data import TensorDataset, DataLoader\n from catalyst import dl\n \n X = torch.randn(1000, 10)\n y = torch.rand(X.shape[0])\n model = nn.Linear(X.shape[1], 1)\n optimizer = torch.optim.Adam(model.parameters())\n scheduler = torch.optim.lr_scheduler.ExponentialLR(optimizer, gamma=0.9)\n \n dataset = TensorDataset(X, y)\n \n loaders = {\n     'train': DataLoader(dataset, batch_size=32, shuffle=True),\n     'valid': DataLoader(dataset, batch_size=32)\n }\n \n class CustomRunner(dl.SupervisedRunner):\n     def _handle_batch(self, batch):\n         # model train/valid step\n         y_pred = self.model(batch['features']).view(-1)\n \n         loss = F.mse_loss(y_pred, batch['targets'])\n         self.batch_metrics.update(\n             {\"loss\": loss}\n         )\n \n runner = CustomRunner()\n \n runner.train(\n     model=model,\n     loaders=loaders,\n     optimizer=optimizer,\n     scheduler=scheduler,\n     num_epochs=20\n )\n </denchmark-code>\n \n <denchmark-h:h4>Screenshots</denchmark-h>\n \n <denchmark-link:https://user-images.githubusercontent.com/9883873/98355950-eb6ad480-2033-11eb-9396-b6a81f9dada9.png></denchmark-link>\n \n <denchmark-h:h3>Expected behavior</denchmark-h>\n \n No warnings\n PS\n \n  I know, that I could join Catalyst slack (#__questions channel) for issue discussion.\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "CrafterKolyan", "commentT": "2020-11-08T17:59:04Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/catalyst-team/catalyst/pull/980>#980</denchmark-link>\n  has chances to fix this problem\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "CrafterKolyan", "commentT": "2020-12-05T12:33:19Z", "comment_text": "\n \t\tShould be fixed now\n \t\t"}}}, "commit": {"commit_id": "92ec6f9f8790d0176fbafbf711d5a541b5c09e60", "commit_author": "Andrey Kulagin", "commitT": "2020-12-04 20:02:41+03:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "CHANGELOG.md", "file_new_name": "CHANGELOG.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "17,18,19,20,21", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "catalyst\\callbacks\\scheduler.py", "file_new_name": "catalyst\\callbacks\\scheduler.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "182,183,184,185,186,187,188,189,190,191,192,193", "deleted_lines": null, "method_info": {"method_name": "step_batch", "method_params": "self", "method_startline": "182", "method_endline": "193"}}, "hunk_1": {"Ismethod": 1, "added_lines": "196,202,205,206,207", "deleted_lines": null, "method_info": {"method_name": "step_epoch", "method_params": "self", "method_startline": "195", "method_endline": "207"}}, "hunk_2": {"Ismethod": 1, "added_lines": "132,133,134,135,136", "deleted_lines": "132,134,136", "method_info": {"method_name": "_update_lr_and_momentum_in_metrics_dict", "method_params": "self,dict,float", "method_startline": "132", "method_endline": "136"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "catalyst\\utils\\__init__.py", "file_new_name": "catalyst\\utils\\__init__.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "92", "deleted_lines": null}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "catalyst\\utils\\torch.py", "file_new_name": "catalyst\\utils\\torch.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "127,128", "deleted_lines": null, "method_info": {"method_name": "get_optimizer_momentum_list", "method_params": "Optimizer", "method_startline": "127", "method_endline": "128"}}}}}}}