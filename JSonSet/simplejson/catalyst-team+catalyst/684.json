{"BR": {"BR_id": "684", "BR_author": "CrafterKolyan", "BRopenT": "2020-03-03T09:35:54Z", "BRcloseT": "2020-03-21T15:38:10Z", "BR_text": {"BRsummary": "SupervisedWandbRunner logs wrong number of epochs to WandB", "BRdescription": "\n Describe the bug\n Catalyst 20.02.4\n WandbRunner is logging wrong number of epochs to WandB\n To Reproduce\n Steps to reproduce the behavior:\n <denchmark-code>from catalyst import dl\n import torch\n import torch.nn as nn\n import torch.optim as optim\n from torch.utils.data import DataLoader, TensorDataset\n \n class Projector(nn.Module):\n     def __init__(self, input_size):\n         super().__init__()\n         self.linear = nn.Linear(input_size, 1)\n         \n     def forward(self, X):\n         return self.linear(X).squeeze(-1)\n \n X = torch.rand(16, 10)\n y = torch.rand(X.shape[0])\n model = Projector(X.shape[1])\n dataset = TensorDataset(X, y)\n loader = DataLoader(dataset, batch_size=8)\n runner = dl.SupervisedWandbRunner()\n \n runner.train(\n     model=model,\n     loaders={\n         \"train\": loader,\n         \"valid\": loader\n     },\n     criterion=nn.MSELoss(),\n     optimizer=optim.Adam(model.parameters()),\n     logdir=\"log_xxx_000\",\n     monitoring_params={\n         \"project\": \"wandb_wrong_epochs\"\n     },\n     num_epochs=10\n )\n </denchmark-code>\n \n Expected behavior\n In WandB I see two plots with MSELoss with exactly 10 epochs\n Actual behaviour\n In WandB I see two plots with MSELoss with 20 epochs (but each has exactly 10 dots)\n \n Look on number of steps. It has 20 steps. But should have 10.\n <denchmark-link:https://user-images.githubusercontent.com/9883873/75762200-564c6900-5d4b-11ea-87e3-20ef0e840725.png></denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "CrafterKolyan", "commentT": "2020-05-02T14:50:27Z", "comment_text": "\n \t\tThis issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n \t\t"}}}, "commit": {"commit_id": "f41b380dd9dcd6d065f79178c66d0b9c9a22c530", "commit_author": "Nikolay Korolev", "commitT": "2020-03-21 18:38:07+03:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "catalyst\\contrib\\dl\\runner\\wandb.py", "file_new_name": "catalyst\\contrib\\dl\\runner\\wandb.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "164,165,166,167,168", "deleted_lines": null, "method_info": {"method_name": "run_experiment", "method_params": "self,Experiment", "method_startline": "163", "method_endline": "171"}}, "hunk_1": {"Ismethod": 1, "added_lines": "156,157,158,159,161", "deleted_lines": "151,161", "method_info": {"method_name": "_run_epoch", "method_params": "self,str,int", "method_startline": "146", "method_endline": "161"}}, "hunk_2": {"Ismethod": 1, "added_lines": "23,24,25", "deleted_lines": "23,42", "method_info": {"method_name": "_log_metrics", "method_params": "Dict,str,str", "method_startline": "23", "method_endline": "42"}}, "hunk_3": {"Ismethod": 1, "added_lines": "23,24", "deleted_lines": "23", "method_info": {"method_name": "_log_metrics", "method_params": "Dict,str,str,bool", "method_startline": "23", "method_endline": "24"}}, "hunk_4": {"Ismethod": 1, "added_lines": "140,141,142,143", "deleted_lines": "138", "method_info": {"method_name": "_run_batch", "method_params": "self,batch", "method_startline": "134", "method_endline": "144"}}}}}}}