{"BR": {"BR_id": "666", "BR_author": "gabinguo", "BRopenT": "2020-12-08T16:53:51Z", "BRcloseT": "2021-01-22T09:24:49Z", "BR_text": {"BRsummary": "DensePassageRetriever update embeddings out of memory issue", "BRdescription": "\n Describe the bug\n The code I run:\n <denchmark-code>from haystack.document_store.elasticsearch import ElasticsearchDocumentStore\n from haystack.retriever.dense import DensePassageRetriever\n \n document_store = ElasticsearchDocumentStore(host=\"localhost\", username=\"\", password=\"\", index=\"wikipedia\", embedding_dim=768)\n retriever = DensePassageRetriever(document_store=document_store,\n         query_embedding_model=\"facebook/dpr-question_encoder-single-nq-base\",\n         passage_embedding_model=\"facebook/dpr-ctx_encoder-single-nq-base\",\n         max_seq_len_query=64,\n         max_seq_len_passage=256,\n         batch_size=16,\n         embed_title=True,\n         use_fast_tokenizers=True,\n         use_gpu=True)\n document_store.update_embeddings(retriever)\n </denchmark-code>\n \n I have indexed the whole Wikipedia dump in Elasticsearch already, and then I wanted to save the word embeddings in the ES as well...  I run the code above.  In the beginning, it was fine and output some normal ES loggings like this:\n <denchmark-link:https://user-images.githubusercontent.com/27879119/101514173-48ccab00-397d-11eb-9091-a3d96b9e30d0.png></denchmark-link>\n \n Till it failed when it exceeded the memory size...\n Error message\n The process has been killed automatically when it exceeds the memory size. Seems like it didn't process it in batches...\n ** Question **\n Could I index a large dump like this in batches without exceeding the memory..?\n System:\n \n OS: Linux (48GB of ram)\n GPU/CPU: GPU (GTX 1080Ti)\n Haystack version (commit or version number):  0.5.0\n DocumentStore: ES\n Reader: Not there yet...\n Retriever: DPR\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "gabinguo", "commentT": "2020-12-08T18:23:43Z", "comment_text": "\n \t\tHey <denchmark-link:https://github.com/gabinguo>@gabinguo</denchmark-link>\n ,\n Thanks for reporting this. It is a known limitation (see <denchmark-link:https://github.com/deepset-ai/haystack/issues/601>#601</denchmark-link>\n ) and we will introduce a batch mode for  soon. As a temporary workaround (that we also use internally) you can create the embeddings first in batches, attach them to the document and then call write_documents(). See a rough sketch here: <denchmark-link:https://github.com/deepset-ai/haystack/issues/601#issuecomment-729469535>#601 (comment)</denchmark-link>\n \n Let me know if you have further questions on this workaround. Otherwise, I will keep you updated and ping you here once we implemented the batch_mode ...\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "gabinguo", "commentT": "2020-12-08T18:30:52Z", "comment_text": "\n \t\tTwo side notes:\n \n Do you split your Wikipedia articles into smaller chunks? If not, you will have problems creating meaningful embeddings with DPR.\n If you want to skip the creation of embeddings yourself, you could also consider using the wiki dataset from the DPR authors that already include their precomputed embeddings (facebookresearch/DPR@3d99998).\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "gabinguo", "commentT": "2020-12-08T18:41:18Z", "comment_text": "\n \t\t\n Hey @gabinguo,\n Thanks for reporting this. It is a known limitation (see #601) and we will introduce a batch mode for update_embeddings soon. As a temporary workaround (that we also use internally) you can create the embeddings first in batches, attach them to the document and then call write_documents(). See a rough sketch here: #601 (comment)\n Let me know if you have further questions on this workaround. Otherwise, I will keep you updated and ping you here once we implemented the batch_mode ...\n \n \n Two side notes:\n \n Do you split your Wikipedia articles into smaller chunks? If not, you will have problems creating meaningful embeddings with DPR.\n If you want to skip the creation of embeddings yourself, you could also consider using the wiki dataset from the DPR authors that already include their precomputed embeddings (facebookresearch/DPR@3d99998).\n \n \n Thanks for replying : )\n Ok nice, that would be a do-able solution for now. And can't wait for the updated update_embeddings function  : )\n As for the side notes,\n \n Yea, I did split them into small chunks (paragraph-level indexing).\n Thanks for mentioning this dataset. But I need to run some benchmarks with some defined datasets : \\\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "gabinguo", "commentT": "2021-01-14T16:40:43Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/gabinguo>@gabinguo</denchmark-link>\n , the PR <denchmark-link:https://github.com/deepset-ai/haystack/pull/733>#733</denchmark-link>\n  should significantly reduce memory consumption by introducing a buffer. Could you try this out and let us know if it helps?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "gabinguo", "commentT": "2021-01-19T18:15:47Z", "comment_text": "\n \t\t\n Hi @gabinguo, the PR #733 should significantly reduce memory consumption by introducing a buffer. Could you try this out and let us know if it helps?\n \n Thanks a lot for your great work. I will test on this and post the result when possible.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "gabinguo", "commentT": "2021-01-22T09:24:49Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/gabinguo>@gabinguo</denchmark-link>\n , this should now be resolved with <denchmark-link:https://github.com/deepset-ai/haystack/pull/733>#733</denchmark-link>\n . Please feel free to reopen this thread if you still face any issues.\n \t\t"}}}, "commit": {"commit_id": "337376c81ddad4a742a4590c086756983cce7ece", "commit_author": "Tanay Soni", "commitT": "2021-01-21 16:00:08+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 13, "file_old_name": "haystack\\document_store\\elasticsearch.py", "file_new_name": "haystack\\document_store\\elasticsearch.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "389,390,391,392,393", "deleted_lines": "390,391,392,393", "method_info": {"method_name": "get_all_documents", "method_params": "self,None,str,None,None", "method_startline": "389", "method_endline": "393"}}, "hunk_1": {"Ismethod": 1, "added_lines": "424,425,426,427,428,437,438,439,440,442,443,444,449", "deleted_lines": "424,447,449", "method_info": {"method_name": "get_all_documents_in_index", "method_params": "self,str,str,None", "method_startline": "424", "method_endline": "449"}}, "hunk_2": {"Ismethod": 1, "added_lines": "442,443", "deleted_lines": null, "method_info": {"method_name": "get_all_labels", "method_params": "self,None,str,None,int", "method_startline": "442", "method_endline": "443"}}, "hunk_3": {"Ismethod": 1, "added_lines": "310,311", "deleted_lines": "310,311", "method_info": {"method_name": "write_labels", "method_params": "self,None,None", "method_startline": "310", "method_endline": "311"}}, "hunk_4": {"Ismethod": 1, "added_lines": "453,454,455,456,457", "deleted_lines": null, "method_info": {"method_name": "_get_all_documents_in_index", "method_params": "self,str,str,None,int", "method_startline": "453", "method_endline": "457"}}, "hunk_5": {"Ismethod": 1, "added_lines": "389,390,391,392,393", "deleted_lines": "390,391,392,393", "method_info": {"method_name": "get_all_documents", "method_params": "self,None,str,None,None,int", "method_startline": "388", "method_endline": "393"}}, "hunk_6": {"Ismethod": 1, "added_lines": "236", "deleted_lines": "235,236", "method_info": {"method_name": "write_documents", "method_params": "self,None,None", "method_startline": "235", "method_endline": "236"}}, "hunk_7": {"Ismethod": 1, "added_lines": "720", "deleted_lines": "686,691,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720", "method_info": {"method_name": "update_embeddings", "method_params": "self,BaseRetriever,None", "method_startline": "686", "method_endline": "720"}}, "hunk_8": {"Ismethod": 1, "added_lines": "236,237", "deleted_lines": "236", "method_info": {"method_name": "write_documents", "method_params": "self,None,int", "method_startline": "236", "method_endline": "237"}}, "hunk_9": {"Ismethod": 1, "added_lines": "720,725,727,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758", "deleted_lines": "720", "method_info": {"method_name": "update_embeddings", "method_params": "self,BaseRetriever,None,int", "method_startline": "720", "method_endline": "758"}}, "hunk_10": {"Ismethod": 1, "added_lines": "415,416,417,418,419,420,421,422", "deleted_lines": "415,420", "method_info": {"method_name": "get_all_labels", "method_params": "self,None,str,None", "method_startline": "415", "method_endline": "422"}}, "hunk_11": {"Ismethod": 1, "added_lines": "411,412,413,414,415,416", "deleted_lines": "411,413,415", "method_info": {"method_name": "get_all_documents_generator", "method_params": "self,None,str,None,None,int", "method_startline": "411", "method_endline": "416"}}, "hunk_12": {"Ismethod": 1, "added_lines": "310,311", "deleted_lines": "310,311", "method_info": {"method_name": "write_labels", "method_params": "self,None,int", "method_startline": "310", "method_endline": "311"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 10, "file_old_name": "haystack\\document_store\\faiss.py", "file_new_name": "haystack\\document_store\\faiss.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "160,167,175,179,180,184,185,187,188,189,190,191,192,194,195,196,197,198,199,200,201,202,203", "deleted_lines": "161,177,179,183,184,186,187,188,189,190,191,192,193,194,195,196,197,198,200,201,202,203", "method_info": {"method_name": "update_embeddings", "method_params": "self,BaseRetriever,None,int", "method_startline": "160", "method_endline": "203"}}, "hunk_1": {"Ismethod": 1, "added_lines": "119,138,139,141,146", "deleted_lines": "114,139,140,142,147", "method_info": {"method_name": "write_documents", "method_params": "self,None", "method_startline": "114", "method_endline": "154"}}, "hunk_2": {"Ismethod": 1, "added_lines": "206,207,208,209,210", "deleted_lines": "206,207,208,209", "method_info": {"method_name": "get_all_documents", "method_params": "self,None,str,None,None,int", "method_startline": "205", "method_endline": "210"}}, "hunk_3": {"Ismethod": 1, "added_lines": null, "deleted_lines": "37", "method_info": {"method_name": "__init__", "method_params": "self,str,int,int,str,None,bool,bool,str,str,kwargs", "method_startline": "34", "method_endline": "45"}}, "hunk_4": {"Ismethod": 1, "added_lines": "249,250", "deleted_lines": null, "method_info": {"method_name": "get_documents_by_id", "method_params": "self,None,int", "method_startline": "249", "method_endline": "250"}}, "hunk_5": {"Ismethod": 1, "added_lines": "218,219,220,221,222,223", "deleted_lines": "220,223", "method_info": {"method_name": "get_all_documents_generator", "method_params": "self,None,str,None,None,int", "method_startline": "218", "method_endline": "223"}}, "hunk_6": {"Ismethod": 1, "added_lines": "206,207,208,209", "deleted_lines": "206,207,208,209", "method_info": {"method_name": "get_all_documents", "method_params": "self,None,str,None,None", "method_startline": "205", "method_endline": "209"}}, "hunk_7": {"Ismethod": 1, "added_lines": "167,175,179,180,184,185,187,188,189,190,191,192,194,195,196,197,198,199,200,201,202,203", "deleted_lines": "161,177,179,183,184,186,187,188,189,190,191,192,193,194,195,196,197,198,200,201,202,203", "method_info": {"method_name": "update_embeddings", "method_params": "self,BaseRetriever,None", "method_startline": "161", "method_endline": "203"}}, "hunk_8": {"Ismethod": 1, "added_lines": "110,111", "deleted_lines": null, "method_info": {"method_name": "write_documents", "method_params": "self,None,int", "method_startline": "110", "method_endline": "111"}}, "hunk_9": {"Ismethod": 1, "added_lines": null, "deleted_lines": "312", "method_info": {"method_name": "load", "method_params": "cls,str,str,int", "method_startline": "308", "method_endline": "312"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "haystack\\document_store\\memory.py", "file_new_name": "haystack\\document_store\\memory.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "196,197,198,199,200,201", "deleted_lines": null, "method_info": {"method_name": "get_all_documents_generator", "method_params": "self,None,str,None,None,int", "method_startline": "196", "method_endline": "201"}}, "hunk_1": {"Ismethod": 1, "added_lines": "186,187,188,189,190", "deleted_lines": "186,187,188,189", "method_info": {"method_name": "get_all_documents", "method_params": "self,None,str,None,None,int", "method_startline": "185", "method_endline": "190"}}, "hunk_2": {"Ismethod": 1, "added_lines": "186,187,188,189", "deleted_lines": "186,187,188,189", "method_info": {"method_name": "get_all_documents", "method_params": "self,None,str,None,None", "method_startline": "185", "method_endline": "189"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 18, "file_old_name": "haystack\\document_store\\sql.py", "file_new_name": "haystack\\document_store\\sql.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "291,297,300", "deleted_lines": "278,286", "method_info": {"method_name": "update_vector_ids", "method_params": "self,str,None", "method_startline": "278", "method_endline": "301"}}, "hunk_1": {"Ismethod": 1, "added_lines": "146,147,148,149,150,151", "deleted_lines": "146,147,148,151", "method_info": {"method_name": "get_all_documents_generator", "method_params": "self,None,str,None,None,int", "method_startline": "146", "method_endline": "151"}}, "hunk_2": {"Ismethod": 1, "added_lines": "144,145,146,147,148", "deleted_lines": "145,146,147,148", "method_info": {"method_name": "get_all_documents", "method_params": "self,None,str,None,None", "method_startline": "144", "method_endline": "148"}}, "hunk_3": {"Ismethod": 1, "added_lines": "291,297,300", "deleted_lines": null, "method_info": {"method_name": "update_vector_ids", "method_params": "self,str,None,int", "method_startline": "291", "method_endline": "315"}}, "hunk_4": {"Ismethod": 1, "added_lines": "222,223", "deleted_lines": null, "method_info": {"method_name": "write_documents", "method_params": "self,None,int", "method_startline": "222", "method_endline": "223"}}, "hunk_5": {"Ismethod": 1, "added_lines": "432,433,434,435,436,437,438,439", "deleted_lines": null, "method_info": {"method_name": "_column_windows.int_for_range", "method_params": "start_id,end_id", "method_startline": "432", "method_endline": "439"}}, "hunk_6": {"Ismethod": 1, "added_lines": "461,462,463,464,465,466,467,468", "deleted_lines": null, "method_info": {"method_name": "_windowed_query", "method_params": "self,q,column,windowsize", "method_startline": "461", "method_endline": "468"}}, "hunk_7": {"Ismethod": 1, "added_lines": null, "deleted_lines": "396,397,398,399,400,401,402", "method_info": {"method_name": "chunked_iterable", "method_params": "self,iterable,size", "method_startline": "396", "method_endline": "402"}}, "hunk_8": {"Ismethod": 1, "added_lines": "199,200,201,202,203,204,205,206,207,208,209", "deleted_lines": "199", "method_info": {"method_name": "_get_documents_meta", "method_params": "self,documents_map", "method_startline": "199", "method_endline": "209"}}, "hunk_9": {"Ismethod": 1, "added_lines": "106,111,113", "deleted_lines": "113,118", "method_info": {"method_name": "get_documents_by_id", "method_params": "self,None,int", "method_startline": "106", "method_endline": "119"}}, "hunk_10": {"Ismethod": 1, "added_lines": "121,126,128", "deleted_lines": "128,133,135", "method_info": {"method_name": "get_documents_by_vector_ids", "method_params": "self,None,int", "method_startline": "121", "method_endline": "135"}}, "hunk_11": {"Ismethod": 1, "added_lines": "138,139,140,141", "deleted_lines": null, "method_info": {"method_name": "get_all_documents", "method_params": "self,None,str,None,None", "method_startline": "137", "method_endline": "141"}}, "hunk_12": {"Ismethod": 1, "added_lines": "317,318,319,320,321,322,323", "deleted_lines": null, "method_info": {"method_name": "reset_vector_ids", "method_params": "self,None", "method_startline": "317", "method_endline": "323"}}, "hunk_13": {"Ismethod": 1, "added_lines": "422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459", "deleted_lines": null, "method_info": {"method_name": "_column_windows", "method_params": "self,session,column,windowsize", "method_startline": "422", "method_endline": "459"}}, "hunk_14": {"Ismethod": 1, "added_lines": null, "deleted_lines": "76", "method_info": {"method_name": "__init__", "method_params": "self,str,str,str,bool,int", "method_startline": "70", "method_endline": "76"}}, "hunk_15": {"Ismethod": 1, "added_lines": "222,223,224,228,235,249,250,252", "deleted_lines": "212,216,236,237,239", "method_info": {"method_name": "write_documents", "method_params": "self,None", "method_startline": "212", "method_endline": "254"}}, "hunk_16": {"Ismethod": 1, "added_lines": "128,138,139,140,141", "deleted_lines": "128,133,135", "method_info": {"method_name": "get_documents_by_vector_ids", "method_params": "self,None", "method_startline": "128", "method_endline": "142"}}, "hunk_17": {"Ismethod": 1, "added_lines": "113,121,126", "deleted_lines": "113,118,120", "method_info": {"method_name": "get_documents_by_id", "method_params": "self,None", "method_startline": "113", "method_endline": "126"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "haystack\\utils.py", "file_new_name": "haystack\\utils.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "119,120,121,122,123,124,125,126,127", "deleted_lines": null, "method_info": {"method_name": "get_batches_from_generator", "method_params": "iterable,n", "method_startline": "119", "method_endline": "127"}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "test\\conftest.py", "file_new_name": "test\\conftest.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "261,262,263", "deleted_lines": "261", "method_info": {"method_name": "get_document_store", "method_params": "document_store_type,embedding_field", "method_startline": "247", "method_endline": "269"}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "test\\test_db.py", "file_new_name": "test\\test_db.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217", "deleted_lines": null, "method_info": {"method_name": "test_update_embeddings", "method_params": "document_store,retriever", "method_startline": "187", "method_endline": "217"}}, "hunk_1": {"Ismethod": 1, "added_lines": "89,90,91,92,93,94,95,96,97,98,99", "deleted_lines": null, "method_info": {"method_name": "test_get_all_documents_generator", "method_params": "document_store", "method_startline": "89", "method_endline": "99"}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "test\\test_dpr_retriever.py", "file_new_name": "test\\test_dpr_retriever.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "21,22,26,30,31,35,36,40,41,51,52,53,54,55,56,57,58,59,60,61", "deleted_lines": "21,28,32,36,43,46,47,49,50,51,52,53,54", "method_info": {"method_name": "test_dpr_retrieval", "method_params": "document_store,retriever,return_embedding", "method_startline": "16", "method_endline": "78"}}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 9, "file_old_name": "test\\test_eval.py", "file_new_name": "test\\test_eval.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "102,103,104,105,106,107,110,111,112,123,124,125", "deleted_lines": "101,102,103,104,112,113,114,115,118,124,125,126,127", "method_info": {"method_name": "test_eval_finder", "method_params": "BaseDocumentStore,reader,retriever", "method_startline": "98", "method_endline": "130"}}, "hunk_1": {"Ismethod": 1, "added_lines": "9,11,12,13,14,15,16,18,19,22,27,28,29,30,31,32,33,34,35,36,37,38,39,42", "deleted_lines": "9,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42", "method_info": {"method_name": "test_add_eval_data", "method_params": "document_store", "method_startline": "9", "method_endline": "42"}}, "hunk_2": {"Ismethod": 1, "added_lines": "52,53,54,55,56,57,59,60,61,62,63,64", "deleted_lines": "50,51,52,53,54,55,56,59,60,65,66,67,68", "method_info": {"method_name": "test_eval_reader", "method_params": "reader,BaseDocumentStore", "method_startline": "50", "method_endline": "68"}}, "hunk_3": {"Ismethod": 1, "added_lines": "52,53,54,55,56,57,59,60,61,62,63,64,77,78,79,80,81,82", "deleted_lines": "46,47,48,49,50,51,52,53,54,55,56,59,60,65,66,67,68,69,70,71,72,75,76,77,78,79,80,81,82", "method_info": {"method_name": "test_add_eval_data_batchwise", "method_params": "document_store", "method_startline": "46", "method_endline": "82"}}, "hunk_4": {"Ismethod": 1, "added_lines": "171,172,173,174,175,176,177", "deleted_lines": "167,169,170,171,179,182,183,184,185,186,187,191,192,193,205,206,207,208,209", "method_info": {"method_name": "test_eval_data_splitting", "method_params": "document_store", "method_startline": "167", "method_endline": "211"}}, "hunk_5": {"Ismethod": 1, "added_lines": "77,78,79,80,81,82,85,86,87", "deleted_lines": "75,76,77,78,79,80,81,82,89,90,91", "method_info": {"method_name": "test_eval_elastic_retriever", "method_params": "BaseDocumentStore,open_domain,retriever", "method_startline": "75", "method_endline": "91"}}, "hunk_6": {"Ismethod": 1, "added_lines": "9,11,12,13,14,15,16,18,19,22,27,28,29,30,31,32,33,34,35,36,37,38,39,42,43,44,45", "deleted_lines": "9,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,44,45", "method_info": {"method_name": "test_add_eval_data", "method_params": "document_store,batch_size", "method_startline": "9", "method_endline": "45"}}, "hunk_7": {"Ismethod": 1, "added_lines": "159,160,171,172,173,174,175,176,177", "deleted_lines": "162,163,164,167,169,170,171,179", "method_info": {"method_name": "test_eval_data_split_passage", "method_params": "document_store", "method_startline": "159", "method_endline": "179"}}, "hunk_8": {"Ismethod": 1, "added_lines": "134,143,146,147,148,149,150,151,152,153", "deleted_lines": "137,138,139,140,143,154,155", "method_info": {"method_name": "test_eval_data_split_word", "method_params": "document_store", "method_startline": "134", "method_endline": "155"}}}}, "file_9": {"file_change_type": "MODIFY", "file_Nmethod": 6, "file_old_name": "test\\test_faiss.py", "file_new_name": "test\\test_faiss.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "53", "deleted_lines": null, "method_info": {"method_name": "test_faiss_write_docs", "method_params": "document_store,index_buffer_size,batch_size", "method_startline": "45", "method_endline": "61"}}, "hunk_1": {"Ismethod": 1, "added_lines": "68,72,74,77,80,82", "deleted_lines": "77,78,79", "method_info": {"method_name": "test_faiss_update_docs", "method_params": "document_store,retriever,batch_size", "method_startline": "68", "method_endline": "82"}}, "hunk_2": {"Ismethod": 1, "added_lines": "170,171,172", "deleted_lines": null, "method_info": {"method_name": "test_faiss_passing_index_from_outside", "method_params": "", "method_startline": "154", "method_endline": "172"}}, "hunk_3": {"Ismethod": 1, "added_lines": "96", "deleted_lines": "85,86,87,88,92,96,99,101,102,103,104", "method_info": {"method_name": "test_faiss_update_docs", "method_params": "document_store,index_buffer_size,retriever", "method_startline": "85", "method_endline": "104"}}, "hunk_4": {"Ismethod": 1, "added_lines": null, "deleted_lines": "22,23,24,25,26,27,28,29,30,31,32,33,34", "method_info": {"method_name": "check_data_correctness", "method_params": "documents_indexed,documents_inserted", "method_startline": "22", "method_endline": "34"}}, "hunk_5": {"Ismethod": 1, "added_lines": "96", "deleted_lines": "87,88,92,96", "method_info": {"method_name": "test_faiss_update_with_empty_store", "method_params": "document_store,retriever", "method_startline": "87", "method_endline": "96"}}}}}}}