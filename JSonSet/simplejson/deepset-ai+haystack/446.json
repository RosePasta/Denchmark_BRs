{"BR": {"BR_id": "446", "BR_author": "sophgit", "BRopenT": "2020-09-29T11:31:08Z", "BRcloseT": "2020-10-13T15:12:25Z", "BR_text": {"BRsummary": "Unable to install latest haystack version on Windows", "BRdescription": "\n Describe the bug:\n I can't install the latest haystack version on Windows and therefore can't use haystack properly. Tried using pip install farm-haystack==0.4.0 and pip install git+<denchmark-link:https://github.com/deepset-ai/haystack.git>https://github.com/deepset-ai/haystack.git</denchmark-link>\n . I suspect it has something to do with faiss-cpu not being compatible with Windows. Is there a way to use haystack anyways? Thanks :)\n Error message:\n AttributeError: 'MSVCCompiler' object has no attribute 'compiler'\n ----------------------------------------\n ERROR: Failed building wheel for faiss-cpu\n Running setup.py clean for faiss-cpu\n Failed to build faiss-cpu\n Installing collected packages: faiss-cpu, farm-haystack\n Running setup.py install for faiss-cpu ... error\n ERROR: Command errored out with exit status 1\n System:\n \n OS: Windows\n Haystack version (commit or version number): 0.4.0\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "sophgit", "commentT": "2020-09-29T12:30:46Z", "comment_text": "\n \t\tFacebook officially support Conda packages on MacOS and Linux (refer <denchmark-link:https://github.com/facebookresearch/faiss/issues/170>thread</denchmark-link>\n ). So in order to use it on Windows, you have to build package by yourself (refer build <denchmark-link:https://github.com/bitsun/faiss/blob/master/INSTALL_cmake.md>instructions</denchmark-link>\n ) or use linux docker image.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "sophgit", "commentT": "2020-09-29T15:37:13Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/sophgit>@sophgit</denchmark-link>\n , FAISS is currently a required dependency for installing Haystack. In the next weeks, we plan to make it optional, so Haystack can be used on Windows(except the ).\n Meanwhile, you could try out the <denchmark-link:https://github.com/deepset-ai/haystack#resources>tutorials</denchmark-link>\n  on Google Colab.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "sophgit", "commentT": "2020-10-10T21:31:33Z", "comment_text": "\n \t\tRan into this too. Would be lovely if you could add a little note in <denchmark-link:https://haystack.deepset.ai/en/docs/get_startedmd>here</denchmark-link>\n  right next to the flag notice and probably <denchmark-link:https://haystack.deepset.ai/en/docs/tutorial1md>here</denchmark-link>\n  would also be good.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "sophgit", "commentT": "2020-10-10T21:33:16Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lalitpagaria>@lalitpagaria</denchmark-link>\n  Is there a quick and dirty way to remove the faiss-dependency ourselves?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "sophgit", "commentT": "2020-10-10T23:27:20Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/sophgit>@sophgit</denchmark-link>\n  I managed installing the pip package by using the source and modifying one line inside the requirements.txt file.\n I just commented out faiss-cpu since I won't be using it for now (I hope).\n Assuming the haystack source is inside a folder called \u00b4haystack\u00b4 then this following command works (after source modification):\n \u00b4 pip install haystack -f <denchmark-link:https://download.pytorch.org/whl/torch_stable.html%C2%B4>https://download.pytorch.org/whl/torch_stable.html\u00b4</denchmark-link>\n \n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "sophgit", "commentT": "2020-10-10T23:55:36Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lalitpagaria>@lalitpagaria</denchmark-link>\n  furthermore  is not supported on Windows either and <denchmark-link:https://github.com/MagicStack/uvloop/issues/14>probably won't be too soon</denchmark-link>\n \n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "sophgit", "commentT": "2020-10-11T11:48:29Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/Zenahr>@Zenahr</denchmark-link>\n  I am afraid it is not easy to compile on Window. Faiss team posed this -\n <denchmark-code>Currently Faiss compiles only on Linux and Mac.\n \n Porting to Windows requires:\n \n prepare a makefile or Visual project file [using gnu make on windows is also OK]\n converting some system-level calls like random, gettimeofday and pthread_create to their Windows equivalents (or use a glue library that does this) [not necessary, pthread_t is used only in Ondisk, which will not be supported anyways]\n the code assumes that long = int64_t at quite some places, when long is 32 bit on Windows [FIXED]\n fix the SSE includes (the SSE intrinsics are Intel standard)\n find a usable BLAS implementation\n optional: port the GPU version and the Python interface.\n find a continuous integration that works with windows\n If you are interested in undertaking this, please contact us!\n </denchmark-code>\n \n I think if you are not using  then as <denchmark-link:https://github.com/tanaysoni>@tanaysoni</denchmark-link>\n  mentioned, making  optional or removing from requirement.txt will help. If you do need it then integrating <denchmark-link:https://github.com/milvus-io/milvus>Mivus</denchmark-link>\n  with  would solve this.\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "sophgit", "commentT": "2020-10-11T19:31:13Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lalitpagaria>@lalitpagaria</denchmark-link>\n  Yeah that's basically what I wanted to say. Maybe we could have a branch  where these things are accounted for and i.e. some dependencies commented out from the requirements.txt file so that it's straight-forward to work with haystack on Windows machines.\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "sophgit", "commentT": "2020-10-12T15:09:10Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/Zenahr>@Zenahr</denchmark-link>\n   and <denchmark-link:https://github.com/sophgit>@sophgit</denchmark-link>\n   I raised PR. Can you please test changes on windows platform by running -\n <denchmark-code>pip install git+https://github.com/lalitpagaria/haystack.git@fix_windows_installation\n </denchmark-code>\n \n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "sophgit", "commentT": "2020-11-05T16:47:49Z", "comment_text": "\n \t\tGood news! Now Faiss (CPU) supports Windows.\n <denchmark-link:https://github.com/facebookresearch/faiss/releases/tag/v1.6.4>https://github.com/facebookresearch/faiss/releases/tag/v1.6.4</denchmark-link>\n  (Official release on Conda)\n <denchmark-link:https://pypi.org/project/faiss-cpu/#files>https://pypi.org/project/faiss-cpu/#files</denchmark-link>\n  (community supported release on pypi)\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "sophgit", "commentT": "2020-11-05T16:59:20Z", "comment_text": "\n \t\tNice! We should do some benchmarking to verify performance and then upgrade. Yesterday I had some issues with the PyPI installation, but this got fixed already (<denchmark-link:https://github.com/kyamagu/faiss-wheels/issues/26>kyamagu/faiss-wheels#26</denchmark-link>\n )\n \t\t"}}}, "commit": {"commit_id": "12c4dd7b4b54a6ecd9a3d0f024ca87f94c8987e9", "commit_author": "Lalit Pagaria", "commitT": "2020-10-13 17:12:24+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "haystack\\document_store\\faiss.py", "file_new_name": "haystack\\document_store\\faiss.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "2,12,13,14,15,16,19", "deleted_lines": "5,7"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "requirements.txt", "file_new_name": "requirements.txt", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "18,20", "deleted_lines": "7,19,21"}}}}}}