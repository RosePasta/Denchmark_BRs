{"BR": {"BR_id": "244", "BR_author": "anetschka", "BRopenT": "2020-07-17T15:22:46Z", "BRcloseT": "2020-07-20T08:57:59Z", "BR_text": {"BRsummary": "Error in adding sentence embeddings to existing index", "BRdescription": "\n Description\n I am trying to use haystack with a sentence embedding model from the sentence-transformers library. Calling indexer.update_embeddings(embedding_retriever) results in an AttributeError.\n Error message\n line 318, in update_embeddings\n \"doc\": {self.embedding_field: emb.tolist()},\n AttributeError: 'list' object has no attribute 'tolist'\n So something does not work in the handling of the embeddings given by the model.\n System:\n \n Haystack version (commit or version number): cloned yesterday\n DocumentStore: ElasticsearchDocumentStore(host=\"localhost\", username=\"\", password=\"\", index=\"document\", embedding_field=\"embedding\", embedding_dim=768)\n Retriever: EmbeddingRetriever(indexer, model_format='sentence_transformers', embedding_model='distiluse-base-multilingual-cased')\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "anetschka", "commentT": "2020-07-17T15:43:20Z", "comment_text": "\n \t\tThanks for reporting <denchmark-link:https://github.com/anetschka>@anetschka</denchmark-link>\n  ! I am able to reproduce this and already found the bug. While the  returns a List[ndarray], the  returns List[List[float]]. I will add a fix for this\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "anetschka", "commentT": "2020-07-17T15:47:42Z", "comment_text": "\n \t\tPrima! Allerbesten Dank!\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "anetschka", "commentT": "2020-07-17T17:31:59Z", "comment_text": "\n \t\tShould be fixed with <denchmark-link:https://github.com/deepset-ai/haystack/pull/245>#245</denchmark-link>\n . Can you please try to pull & install from latest master?\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "anetschka", "commentT": "2020-07-20T08:57:59Z", "comment_text": "\n \t\tI confirm that the bug is fixed, closing the ticket,\n \t\t"}}}, "commit": {"commit_id": "355be293b6ee17f4305aef66bffbf2ba052db327", "commit_author": "Malte Pietsch", "commitT": "2020-07-17 19:03:31+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "haystack\\database\\elasticsearch.py", "file_new_name": "haystack\\database\\elasticsearch.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "240", "deleted_lines": "239", "method_info": {"method_name": "query_by_embedding", "method_params": "self,None,int,None", "method_startline": "238", "method_endline": "242"}}, "hunk_1": {"Ismethod": 1, "added_lines": "240", "deleted_lines": "239", "method_info": {"method_name": "query_by_embedding", "method_params": "self,array,None,int,None", "method_startline": "239", "method_endline": "243"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "haystack\\retriever\\dense.py", "file_new_name": "haystack\\retriever\\dense.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "249,262,263,267,268,269", "deleted_lines": "249,262,263,267,268", "method_info": {"method_name": "embed", "method_params": "self", "method_startline": "249", "method_endline": "270"}}}}}}}