{"BR": {"BR_id": "227", "BR_author": "tdwalton", "BRopenT": "2019-10-08T22:06:39Z", "BRcloseT": "2019-10-09T10:04:34Z", "BR_text": {"BRsummary": "[BUG] Pwnagotchi service fails to start if plugins encounter an error.", "BRdescription": "\n Describe the bug\n Failure in a plugin causes pwnagotchi service to go into a restart loop. Discovered because the wpa-sec plugin couldn't find a /root/handshakes folder on booting a new pwnagotchi, and fixed by creating said folder, but I suspect other plugin failures would exhibit similar behavior.\n To Reproduce\n Steps to reproduce the behavior:\n \n Boot pwnagotchi with v1.0.0RC1 release image\n edit /etc/pwnagotchi/config.yml to enable wpa-sec plugin\n sudo systemctl restart pwnagotchi\n \n Expected behavior\n Pwnagotchi service would restart and run with new config options.\n Environment:\n Pwnagotchi v1.0.0rc1\n Systemd logs:\n <denchmark-code>Jul 10 02:13:49 Stripe systemd[1]: Started pwnagotchi Deep Reinforcement Learning instrumenting bettercap for WiFI pwning..\n Jul 10 02:13:49 Stripe pwnagotchi-launcher[3033]: usb0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n Jul 10 02:13:53 Stripe pwnagotchi-launcher[3033]: [2019-07-10 02:13:53,824] [INFO] grid plugin loaded.\n Jul 10 02:13:53 Stripe pwnagotchi-launcher[3033]: [2019-07-10 02:13:53,837] [WARNING] WPA_SEC: No upload-file found.\n Jul 10 02:13:53 Stripe pwnagotchi-launcher[3033]: [2019-07-10 02:13:53,920] [WARNING] ui.fps is 0, the display will only update for major changes\n Jul 10 02:13:53 Stripe pwnagotchi-launcher[3033]: [2019-07-10 02:13:53,924] [INFO] initializing waveshare v2 display\n Jul 10 02:13:57 Stripe pwnagotchi-launcher[3033]: [2019-07-10 02:13:57,706] [INFO] ui available at http://192.168.7.2:8080/\n Jul 10 02:13:57 Stripe pwnagotchi-launcher[3033]: [2019-07-10 02:13:57,761] [INFO] Stripe@16a1dc55dc194907a5bf42e21345d268dff7bbbf2d968c151f28db0de0f9e8\n Jul 10 02:13:57 Stripe pwnagotchi-launcher[3033]: [2019-07-10 02:13:57,767] [INFO] entering manual mode ...\n Jul 10 02:13:58 Stripe pwnagotchi-launcher[3033]: [2019-07-10 02:13:58,727] [INFO] the last session lasted 51 minutes, 32 seconds (0 completed epochs, t\n Jul 10 02:14:01 Stripe pwnagotchi-launcher[3033]: Traceback (most recent call last):\n Jul 10 02:14:01 Stripe pwnagotchi-launcher[3033]:   File \"/usr/local/bin/pwnagotchi\", line 69, in <module>\n Jul 10 02:14:01 Stripe pwnagotchi-launcher[3033]:     plugins.on('internet_available', agent)\n Jul 10 02:14:01 Stripe pwnagotchi-launcher[3033]:   File \"/usr/local/lib/python3.7/dist-packages/pwnagotchi/plugins/__init__.py\", line 19, in on\n Jul 10 02:14:01 Stripe pwnagotchi-launcher[3033]:     plugin.__dict__[cb_name](*args, **kwargs)\n Jul 10 02:14:01 Stripe pwnagotchi-launcher[3033]:   File \"/usr/local/lib/python3.7/dist-packages/pwnagotchi/plugins/default/wpa-sec.py\", line 66, in on_\n Jul 10 02:14:01 Stripe pwnagotchi-launcher[3033]:     handshake_filenames = os.listdir(handshake_dir)\n Jul 10 02:14:01 Stripe pwnagotchi-launcher[3033]: FileNotFoundError: [Errno 2] No such file or directory: '/root/handshakes'\n Jul 10 02:14:02 Stripe systemd[1]: pwnagotchi.service: Main process exited, code=exited, status=1/FAILURE\n Jul 10 02:14:02 Stripe systemd[1]: pwnagotchi.service: Failed with result 'exit-code'.\n Jul 10 02:14:32 Stripe systemd[1]: pwnagotchi.service: Service RestartSec=30s expired, scheduling restart.\n </denchmark-code>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "d4d8c39205202f0864af38f22200b1ad3a5bdfc7", "commit_author": "Simone Margaritelli", "commitT": "2019-10-09 12:04:28+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "pwnagotchi\\agent.py", "file_new_name": "pwnagotchi\\agent.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "41,42", "deleted_lines": null, "method_info": {"method_name": "__init__", "method_params": "self,view,config,keypair", "method_startline": "21", "method_endline": "42"}}}}}}}