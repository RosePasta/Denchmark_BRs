{"BR": {"BR_id": "411", "BR_author": "TKassis", "BRopenT": "2019-07-03T17:36:27Z", "BRcloseT": "2019-07-08T04:36:36Z", "BR_text": {"BRsummary": "Image feature HDF5 file is not normalized and contains negative values", "BRdescription": "\n Describe the bug\n The hdf5 created using the image input feature seems not to be normalized and has negative values. For my training, I'm using 24-bit RGB .jpg images.\n Please provide code, yaml definition file and a sample of data in order to entirely reproduce the issue.\n I have attached all the required files.\n <denchmark-link:https://github.com/uber/ludwig/files/3356180/experiment_run_1.zip>experiment_run_1.zip</denchmark-link>\n \n Expected behavior\n I've been looking at the hdf5 file created and there are a lot of negative values. Shouldn't these be all normalized positive values between 0.00-1.00?\n <denchmark-link:https://user-images.githubusercontent.com/9168908/60612606-015ceb00-9d97-11e9-8fe9-643fb39145e7.png></denchmark-link>\n \n Environment (please complete the following information):\n \n OS: Windows 10\n Python version 3.6\n Ludwig version 0.1.2\n \n Additional context\n I'm using ResNet 50 as the encoder.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "TKassis", "commentT": "2019-07-03T18:11:06Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/TKassis>@TKassis</denchmark-link>\n  Could you please paste the model definition here? I couldn't find it in your zip file. Thanks\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "TKassis", "commentT": "2019-07-03T18:21:50Z", "comment_text": "\n \t\t\n @TKassis Could you please paste the model definition here? I couldn't find it in your zip file. Thanks\n \n Apologies, I thought I had included it. Here you go:\n `input_features:\n -\n name: image_path\n type: image\n encoder: resnet\n resnet_size: 50\n dropout: true\n preprocessing:\n resize_method: crop_or_pad\n height: 224\n width: 224\n output_features:\n -\n name: label\n type: category\n training:\n batch_size: 32\n learning_rate: 0.0001\n optimizer: {type: sgd}\n dropout_rate: 0.5\n epochs: 100\n `\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "TKassis", "commentT": "2019-07-03T18:54:47Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/TKassis>@TKassis</denchmark-link>\n  investigating it, but no, the values in the hdf5 are not supposed to be normalized and positive, we store them as int8, now I believe the problem is the fact that they are saves as int8 rather than uint8, but will figure out and keep you posted.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "TKassis", "commentT": "2019-07-08T04:39:22Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/TKassis>@TKassis</denchmark-link>\n  I solved the issue with <denchmark-link:https://github.com/uber/ludwig/commit/669d288b678799992d722d45802c58ec1cbf08c4>this commit</denchmark-link>\n , while with this <denchmark-link:https://github.com/uber/ludwig/commit/05e1b62148a2bb8511e28d28828d63cac9f0d517>other commit</denchmark-link>\n  I added two options for pixel normalization and pixel standardization. Now by default pixel normalization (i.e. multiplying by 1/255) is performed.\n Let me know if this works for you.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "TKassis", "commentT": "2019-07-08T12:52:31Z", "comment_text": "\n \t\t\n @TKassis I solved the issue with this commit, while with this other commit I added two options for pixel normalization and pixel standardization. Now by default pixel normalization (i.e. multiplying by 1/255) is performed.\n Let me know if this works for you.\n \n Thank you, That fixed it. I can confirm it is now working as expected.\n \t\t"}}}, "commit": {"commit_id": "669d288b678799992d722d45802c58ec1cbf08c4", "commit_author": "Piero Molino", "commitT": "2019-07-07 21:06:45-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "ludwig\\features\\image_feature.py", "file_new_name": "ludwig\\features\\image_feature.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "102,210", "deleted_lines": "102,210"}}}}}}