{"BR": {"BR_id": "2210", "BR_author": "winnietsang", "BRopenT": "2019-07-31T18:14:35Z", "BRcloseT": "2019-08-07T18:09:41Z", "BR_text": {"BRsummary": "The rank for \"depth\" input of OneHot operator is unclear", "BRdescription": "\n In the doc(<denchmark-link:https://github.com/onnx/onnx/blob/master/docs/Operators.md#onehot>https://github.com/onnx/onnx/blob/master/docs/Operators.md#onehot</denchmark-link>\n ), the \"depth\" input for OneHot operator is declare as a scalar, but in the unit tests the value for \"depth\" is a 1D tensor. And in the def.cc(<denchmark-link:https://github.com/onnx/onnx/blob/master/onnx/defs/tensor/defs.cc>https://github.com/onnx/onnx/blob/master/onnx/defs/tensor/defs.cc</denchmark-link>\n ), I find code that verify the \"depth\" input need to be a single-element vector.\n May someone please clarify what is the rank for depth, if it is a scalar, the rank is 0. But if it is a 1D tensor with one element then it is rank 1.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "winnietsang", "commentT": "2019-07-31T23:23:19Z", "comment_text": "\n \t\tThe spec says depth is a scalar so it should be a scalar.\n You are right the tests and current shape inference is misleading. I will update both to reflect the spec.\n However since right now shape inference allows 1D tensors of length 1 ... disallowing this without op version change will potentially break any existing models... In light of this I will keep the current check too.\n \t\t"}}}, "commit": {"commit_id": "2dc273c7ad1357c74c584597859ce9a22608b807", "commit_author": "Ashwini Khade", "commitT": "2019-08-06 20:57:14-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\Changelog.md", "file_new_name": "docs\\Changelog.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "8710", "deleted_lines": "8710"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\Operators.md", "file_new_name": "docs\\Operators.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "9032,9097", "deleted_lines": "9032,9097"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "docs\\TestCoverage.md", "file_new_name": "docs\\TestCoverage.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "4921", "deleted_lines": "4921"}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "onnx\\backend\\test\\case\\node\\onehot.py", "file_new_name": "onnx\\backend\\test\\case\\node\\onehot.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "40", "deleted_lines": "40", "method_info": {"method_name": "export_without_axis", "method_params": "", "method_startline": "30", "method_endline": "44"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "onnx\\backend\\test\\data\\node\\test_onehot_with_axis\\model.onnx", "file_new_name": "onnx\\backend\\test\\data\\node\\test_onehot_with_axis\\model.onnx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "1,24", "deleted_lines": "1,24"}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "onnx\\backend\\test\\data\\node\\test_onehot_without_axis\\model.onnx", "file_new_name": "onnx\\backend\\test\\data\\node\\test_onehot_without_axis\\model.onnx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": null}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "onnx\\backend\\test\\data\\node\\test_onehot_without_axis\\test_data_set_0\\input_1.pb", "file_new_name": "onnx\\backend\\test\\data\\node\\test_onehot_without_axis\\test_data_set_0\\input_1.pb", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": null}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "onnx\\defs\\tensor\\defs.cc", "file_new_name": "onnx\\defs\\tensor\\defs.cc", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "1734,1735,1770,1771,1772,1773,1774,1775,1778,1779,1781,1782", "deleted_lines": "1734,1735,1770,1773,1774,1776"}}}, "file_8": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "onnx\\test\\shape_inference_test.py", "file_new_name": "onnx\\test\\shape_inference_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1616", "deleted_lines": "1616", "method_info": {"method_name": "test_onehot_without_axis", "method_params": "self", "method_startline": "1613", "method_endline": "1620"}}}}}}}