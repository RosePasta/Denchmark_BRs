{"BR": {"BR_id": "1875", "BR_author": "Echo9573", "BRopenT": "2020-02-20T03:33:57Z", "BRcloseT": "2020-02-24T04:55:56Z", "BR_text": {"BRsummary": "Incorrect model evaluation results in xgboost", "BRdescription": "\n During xgboost  model training, when setting the validation set, the evaluation result of the validation set is the same as the training set.\n The reproducing procedure is shown as follows:\n %%sqlflow\n SELECT * FROM boston.train\n TO TRAIN xgboost.gbtree\n WITH\n     objective=\"reg:squarederror\",\n     train.num_boost_round = 20,\n     validation.select = \"select * from boston.test;\"\n LABEL medv\n INTO sqlflow_models.my_xgb_regression_model;\n \n The output message:\n <denchmark-code>[0]\ttrain-rmse:17.1167\tvalidate-rmse:17.1167\n \n [1]\ttrain-rmse:12.3003\tvalidate-rmse:12.3003\n \n [2]\ttrain-rmse:8.95505\tvalidate-rmse:8.95505\n \n [3]\ttrain-rmse:6.57081\tvalidate-rmse:6.57081\n \n [4]\ttrain-rmse:4.8891\tvalidate-rmse:4.8891\n \n [5]\ttrain-rmse:3.69686\tvalidate-rmse:3.69686\n \n [6]\ttrain-rmse:2.88164\tvalidate-rmse:2.88164\n \n [7]\ttrain-rmse:2.30785\tvalidate-rmse:2.30785\n \n [8]\ttrain-rmse:1.92918\tvalidate-rmse:1.92918\n \n [9]\ttrain-rmse:1.62107\tvalidate-rmse:1.62107\n \n [10]\ttrain-rmse:1.42948\tvalidate-rmse:1.42948\n \n [11]\ttrain-rmse:1.30048\tvalidate-rmse:1.30048\n \n [12]\ttrain-rmse:1.19441\tvalidate-rmse:1.19441\n \n [13]\ttrain-rmse:1.09655\tvalidate-rmse:1.09655\n \n [14]\ttrain-rmse:1.03565\tvalidate-rmse:1.03565\n \n [15]\ttrain-rmse:0.981582\tvalidate-rmse:0.981582\n \n [16]\ttrain-rmse:0.932085\tvalidate-rmse:0.932085\n \n [17]\ttrain-rmse:0.867206\tvalidate-rmse:0.867206\n \n [18]\ttrain-rmse:0.840945\tvalidate-rmse:0.840945\n \n [19]\ttrain-rmse:0.799894\tvalidate-rmse:0.799894\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "Echo9573", "commentT": "2020-02-23T05:13:23Z", "comment_text": "\n \t\tThanks for your reporting, it's a bug for the XGBoost validation, <denchmark-link:https://github.com/sql-machine-learning/sqlflow/pull/1891>#1891</denchmark-link>\n  would fix it and add some convergence test.\n \t\t"}}}, "commit": {"commit_id": "6bd06fde943349b60a62b0de9c09ec655675b22d", "commit_author": "Yan Xu", "commitT": "2020-02-24 12:55:55+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 40, "file_old_name": "cmd\\sqlflowserver\\main_test.go", "file_new_name": "cmd\\sqlflowserver\\main_test.go", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "393,400", "deleted_lines": "387,394", "method_info": {"method_name": "CaseXgboostEvalMetric", "method_params": "T", "method_startline": "387", "method_endline": "404"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1353,1360", "deleted_lines": "1374", "method_info": {"method_name": "CasePredictXGBoostRegression", "method_params": "T", "method_startline": "1347", "method_endline": "1377"}}, "hunk_2": {"Ismethod": 1, "added_lines": "884,891,902", "deleted_lines": "878,885,896", "method_info": {"method_name": "CaseTrainOptimizer", "method_params": "T", "method_startline": "876", "method_endline": "904"}}, "hunk_3": {"Ismethod": 1, "added_lines": "677", "deleted_lines": null, "method_info": {"method_name": "CaseSelect", "method_params": "T", "method_startline": "674", "method_endline": "704"}}, "hunk_4": {"Ismethod": 1, "added_lines": "1144", "deleted_lines": "1138", "method_info": {"method_name": "CaseTrainALPS", "method_params": "T", "method_startline": "1117", "method_endline": "1148"}}, "hunk_5": {"Ismethod": 1, "added_lines": "373,381", "deleted_lines": "367,375", "method_info": {"method_name": "CaseXgboostFeatureDerivation", "method_params": "T", "method_startline": "365", "method_endline": "385"}}, "hunk_6": {"Ismethod": 1, "added_lines": "1396,1403", "deleted_lines": "1381,1403", "method_info": {"method_name": "CaseTrainDistributedPAI", "method_params": "T", "method_startline": "1379", "method_endline": "1408"}}, "hunk_7": {"Ismethod": 1, "added_lines": "1189", "deleted_lines": "1183", "method_info": {"method_name": "CaseTrainALPSFeatureMap", "method_params": "T", "method_startline": "1179", "method_endline": "1193"}}, "hunk_8": {"Ismethod": 1, "added_lines": "854,861,872", "deleted_lines": "848,855,866", "method_info": {"method_name": "CaseTrainFeatureDerivation", "method_params": "T", "method_startline": "846", "method_endline": "874"}}, "hunk_9": {"Ismethod": 1, "added_lines": "810,826,840", "deleted_lines": "804,820,834", "method_info": {"method_name": "CaseTrainSQLWithMetrics", "method_params": "T", "method_startline": "798", "method_endline": "844"}}, "hunk_10": {"Ismethod": 1, "added_lines": "1013", "deleted_lines": "1007", "method_info": {"method_name": "CaseTrainTextClassificationCustomLSTM", "method_params": "T", "method_startline": "1004", "method_endline": "1017"}}, "hunk_11": {"Ismethod": 1, "added_lines": "415", "deleted_lines": "409", "method_info": {"method_name": "CaseTrainTextClassificationIR", "method_params": "T", "method_startline": "406", "method_endline": "419"}}, "hunk_12": {"Ismethod": 1, "added_lines": "1059,1064", "deleted_lines": "1058", "method_info": {"method_name": "CaseTrainAdaNetAndExplain", "method_params": "T", "method_startline": "1055", "method_endline": "1066"}}, "hunk_13": {"Ismethod": 1, "added_lines": "1079", "deleted_lines": "1073", "method_info": {"method_name": "CaseTrainDeepWideModelOptimizer", "method_params": "T", "method_startline": "1068", "method_endline": "1083"}}, "hunk_14": {"Ismethod": 1, "added_lines": "1339,1344", "deleted_lines": "1317,1322,1331,1338", "method_info": {"method_name": "CaseTrainAndExplainXGBoostModel", "method_params": "T", "method_startline": "1304", "method_endline": "1345"}}, "hunk_15": {"Ismethod": 1, "added_lines": "914,922,928,949", "deleted_lines": "908,916,922,943", "method_info": {"method_name": "CaseTrainCustomModel", "method_params": "T", "method_startline": "906", "method_endline": "953"}}, "hunk_16": {"Ismethod": 1, "added_lines": "637", "deleted_lines": "671", "method_info": {"method_name": "CaseShowDatabases", "method_params": "T", "method_startline": "634", "method_endline": "672"}}, "hunk_17": {"Ismethod": 1, "added_lines": "1548,1555,1568,1575,1591,1601,1616,1626", "deleted_lines": "1546,1553,1569,1579,1594,1604,1622,1629", "method_info": {"method_name": "CaseTrainDenseCol", "method_params": "T", "method_startline": "1537", "method_endline": "1630"}}, "hunk_18": {"Ismethod": 1, "added_lines": "1033", "deleted_lines": "1027", "method_info": {"method_name": "CaseTrainSQLWithHyperParams", "method_params": "T", "method_startline": "1019", "method_endline": "1037"}}, "hunk_19": {"Ismethod": 1, "added_lines": "1229,1238,1245", "deleted_lines": "1223,1232,1239", "method_info": {"method_name": "CaseTrainRegression", "method_params": "T", "method_startline": "1220", "method_endline": "1262"}}, "hunk_20": {"Ismethod": 1, "added_lines": "1172", "deleted_lines": "1166", "method_info": {"method_name": "CaseTrainALPSRemoteModel", "method_params": "T", "method_startline": "1151", "method_endline": "1176"}}, "hunk_21": {"Ismethod": 1, "added_lines": "1216", "deleted_lines": "1210", "method_info": {"method_name": "CaseSQLByPassLeftJoin", "method_params": "T", "method_startline": "1196", "method_endline": "1217"}}, "hunk_22": {"Ismethod": 1, "added_lines": "965,972,978", "deleted_lines": "959,966,972", "method_info": {"method_name": "CaseTrainWithCommaSeparatedLabel", "method_params": "T", "method_startline": "955", "method_endline": "987"}}, "hunk_23": {"Ismethod": 1, "added_lines": "1110", "deleted_lines": "1104", "method_info": {"method_name": "CaseSparseFeature", "method_params": "T", "method_startline": "1101", "method_endline": "1114"}}, "hunk_24": {"Ismethod": 1, "added_lines": "1425,1434", "deleted_lines": "1412,1431", "method_info": {"method_name": "CaseTrainPAIKMeans", "method_params": "T", "method_startline": "1410", "method_endline": "1438"}}, "hunk_25": {"Ismethod": 1, "added_lines": "1095", "deleted_lines": "1089", "method_info": {"method_name": "CaseTrainCustomModelWithHyperParams", "method_params": "T", "method_startline": "1086", "method_endline": "1099"}}, "hunk_26": {"Ismethod": 1, "added_lines": "1513,1521,1531", "deleted_lines": "1509,1526,1533", "method_info": {"method_name": "CaseTrainXGBoostOnPAI", "method_params": "T", "method_startline": "1502", "method_endline": "1535"}}, "hunk_27": {"Ismethod": 1, "added_lines": "1486,1496", "deleted_lines": "1491,1499", "method_info": {"method_name": "CaseTrainDNNAndExplain", "method_params": "T", "method_startline": "1479", "method_endline": "1500"}}, "hunk_28": {"Ismethod": 1, "added_lines": "180,183,200,201,202,205", "deleted_lines": "199", "method_info": {"method_name": "ParseResponse", "method_params": "SQLFlow_RunClient", "method_startline": "180", "method_endline": "206"}}, "hunk_29": {"Ismethod": 1, "added_lines": "180,183,200", "deleted_lines": "178,199", "method_info": {"method_name": "ParseRow", "method_params": "SQLFlow_RunClient", "method_startline": "178", "method_endline": "200"}}, "hunk_30": {"Ismethod": 1, "added_lines": "720,729,736", "deleted_lines": "714,723,730", "method_info": {"method_name": "CaseTrainSQL", "method_params": "T", "method_startline": "706", "method_endline": "753"}}, "hunk_31": {"Ismethod": 1, "added_lines": "1644,1651,1660", "deleted_lines": "1638", "method_info": {"method_name": "CaseTrainXGBoostOnAlisa", "method_params": "T", "method_startline": "1632", "method_endline": "1663"}}, "hunk_32": {"Ismethod": 1, "added_lines": "792", "deleted_lines": null, "method_info": {"method_name": "CaseTrainLinearClassifier", "method_params": "T", "method_startline": "788", "method_endline": "796"}}, "hunk_33": {"Ismethod": 1, "added_lines": "1279,1283,1284,1285,1286,1287,1288,1289,1290,1291,1292,1293,1294,1295,1296,1297,1298,1299", "deleted_lines": "1270,1274", "method_info": {"method_name": "CaseTrainXGBoostRegression", "method_params": "T", "method_startline": "1265", "method_endline": "1300"}}, "hunk_34": {"Ismethod": 1, "added_lines": "998", "deleted_lines": "992", "method_info": {"method_name": "CaseTrainTextClassification", "method_params": "T", "method_startline": "989", "method_endline": "1002"}}, "hunk_35": {"Ismethod": 1, "added_lines": "769,777,781", "deleted_lines": "763,771,775,786", "method_info": {"method_name": "CaseTrainBoostedTreesEstimatorAndExplain", "method_params": "T", "method_startline": "755", "method_endline": "786"}}, "hunk_36": {"Ismethod": 1, "added_lines": "1453,1462,1473", "deleted_lines": "1440,1451,1464,1474", "method_info": {"method_name": "CaseTrainPAIRandomForests", "method_params": "T", "method_startline": "1440", "method_endline": "1477"}}, "hunk_37": {"Ismethod": 1, "added_lines": "1049", "deleted_lines": "1043,1053", "method_info": {"method_name": "CaseTrainDeepWideModel", "method_params": "T", "method_startline": "1039", "method_endline": "1053"}}, "hunk_38": {"Ismethod": 1, "added_lines": "97,100,109,111,112", "deleted_lines": "98,107,109,110", "method_info": {"method_name": "connectAndRunSQL", "method_params": "string", "method_startline": "97", "method_endline": "113"}}, "hunk_39": {"Ismethod": 1, "added_lines": "430", "deleted_lines": "424", "method_info": {"method_name": "CaseTrainTextClassificationFeatureDerivation", "method_params": "T", "method_startline": "421", "method_endline": "434"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "python\\sqlflow_submitter\\xgboost\\train.py", "file_new_name": "python\\sqlflow_submitter\\xgboost\\train.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "75", "deleted_lines": "75"}}}}}}