{"BR": {"BR_id": "804", "BR_author": "joshgreifer", "BRopenT": "2020-07-21T11:28:17Z", "BRcloseT": "2020-09-09T17:05:09Z", "BR_text": {"BRsummary": "cuda tensor parameter fail to convert to numpy in InternalTorchIRGraph", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1eDescribe the bug</denchmark-h>\n \n \n If the input parameter type to a traced model is tensor.cuda(),  ct.convert fails with the below error\n Torch\n \n <denchmark-h:h2>Trace</denchmark-h>\n \n <denchmark-code>  File \"/home/josh/anaconda3/lib/python3.7/site-packages/coremltools/converters/mil/frontend/torch/internal_graph.py\", line 180, in __init__\n     value = param.detach().numpy()\n TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.\n \n </denchmark-code>\n \n Note, possible fix:\n replace\n    value = param.detach().numpy()\n with\n    value = param.cpu().detach().numpy()\n <denchmark-h:h2>System environment (please complete the following information):</denchmark-h>\n \n \n coremltools version:  4.0b1\n OS: Linux\n How you install python: anaconda\n python version: 3.7.6\n \n <denchmark-h:h2>Additional context</denchmark-h>\n \n Add any other context about the problem here.\n \t"}, "comments": {}}, "commit": {"commit_id": "e9e566691dbdd858581a0602c1c2d74549718b67", "commit_author": "ranrubin", "commitT": "2020-09-09 10:05:08-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "coremltools\\converters\\mil\\frontend\\torch\\internal_graph.py", "file_new_name": "coremltools\\converters\\mil\\frontend\\torch\\internal_graph.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "249", "deleted_lines": "249"}}}}}}