{"BR": {"BR_id": "586", "BR_author": "festlv", "BRopenT": "2017-02-18T22:53:13Z", "BRcloseT": "2017-02-22T19:48:59Z", "BR_text": {"BRsummary": "Caffe converter silently fails on (some) non-supported layer types", "BRdescription": "\n I have been trying out caffe converter example on a custom caffe model.\n The prediction vector of the imported model was all zeroes. During debugging of this issue I found out that tiny-dnn network was correctly constructed, but loading weights had silently stopped after encountering BatchNorm layer- it can't be mapped to tiny-dnn layer type for weight loading.\n I'd suggest at least changing this line to throw an error in this case, so that unsupported layer types trigger obvious error:\n <denchmark-link:https://github.com/tiny-dnn/tiny-dnn/blob/master/tiny_dnn/io/caffe/layer_factory.h#L146>https://github.com/tiny-dnn/tiny-dnn/blob/master/tiny_dnn/io/caffe/layer_factory.h#L146</denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "festlv", "commentT": "2017-02-18T23:45:20Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/festlv>@festlv</denchmark-link>\n  Thanks for reporting this bug! please submit a PR with the pach\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "festlv", "commentT": "2017-02-18T23:56:15Z", "comment_text": "\n \t\tAnd also covering missing layer in tiny if you need :)\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "festlv", "commentT": "2017-02-19T09:15:24Z", "comment_text": "\n \t\tSubmitted a PR.\n I do need this missing layer, but I don't know enough about internals of tiny-dnn, caffe and even how exactly batchnorm works, so I won't be able to add it.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "festlv", "commentT": "2017-02-22T19:48:59Z", "comment_text": "\n \t\tThe core of this issue has been fixed in <denchmark-link:https://github.com/tiny-dnn/tiny-dnn/pull/587>#587</denchmark-link>\n .\n The missing BatchNorm support is in <denchmark-link:https://github.com/tiny-dnn/tiny-dnn/pull/595>#595</denchmark-link>\n .\n I have the following suggestions regarding caffe converter:\n \n List supported layer types in documentation (https://github.com/tiny-dnn/tiny-dnn/blob/master/tiny_dnn/io/caffe/layer_factory_impl.h#L857).\n Make the inference in general more robust (maybe a debug mode with assertions). I have been able to proceed through inference although the weights were not loaded for any layers.\n \n \t\t"}}}, "commit": {"commit_id": "b26eb9df09a510af537b93e7ab12b463c9796f09", "commit_author": "Reinis Veips", "commitT": "2017-02-19 11:02:23+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tiny_dnn\\io\\caffe\\layer_factory.h", "file_new_name": "tiny_dnn\\io\\caffe\\layer_factory.h", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "146,147,148,149,150,151", "deleted_lines": "146", "method_info": {"method_name": "tiny_dnn::reload_weight_from_caffe_net", "method_params": "layer,net", "method_startline": "122", "method_endline": "156"}}}}}}}