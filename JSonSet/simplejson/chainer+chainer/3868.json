{"BR": {"BR_id": "3868", "BR_author": "niboshi", "BRopenT": "2017-11-14T08:04:27Z", "BRcloseT": "2017-12-14T05:00:01Z", "BR_text": {"BRsummary": "VariableNode's dtype mismatch if Variable.data is manually assigned", "BRdescription": "\n If Variable.data is assigned manually, node.dtype and node.data.dtype can indicate different values.\n This has caused \"Dtype of data and grad mismatch\" error in gradient_check.check_double_backward.\n <denchmark-h:h3>Code</denchmark-h>\n \n <denchmark-code>import chainer\n import numpy\n from chainer import functions as F\n \n x = chainer.Variable(numpy.array([3, 2], dtype=numpy.float32))\n y = F.sin(x)\n x.data = numpy.array([4, 2], dtype=numpy.float64)\n \n print(x.node.dtype)\n print(x.node.data.dtype)\n </denchmark-code>\n \n <denchmark-h:h3>Output</denchmark-h>\n \n <denchmark-code>float64                                             \n float32\n </denchmark-code>\n \n Current master: <denchmark-link:https://github.com/chainer/chainer/commit/5683281c854fd2e47b68a3461b8e3e7e3c69f227>5683281</denchmark-link>\n \n \t"}, "comments": {}}, "commit": {"commit_id": "d97c8eb9d4feb3199520c51e0360269ed12c6d5f", "commit_author": "Yuya Unno", "commitT": "2017-12-14 14:00:35+09:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 5, "file_old_name": "chainer\\variable.py", "file_new_name": "chainer\\variable.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "617", "deleted_lines": null, "method_info": {"method_name": "array", "method_params": "self,d", "method_startline": "615", "method_endline": "617"}}, "hunk_1": {"Ismethod": 1, "added_lines": "263", "deleted_lines": "263", "method_info": {"method_name": "data", "method_params": "self,d", "method_startline": "261", "method_endline": "263"}}, "hunk_2": {"Ismethod": 1, "added_lines": "386", "deleted_lines": "386", "method_info": {"method_name": "_set_data_type", "method_params": "self,d", "method_startline": "386", "method_endline": "392"}}, "hunk_3": {"Ismethod": 1, "added_lines": "171", "deleted_lines": "171", "method_info": {"method_name": "__init__", "method_params": "self,variable,name,kwargs", "method_startline": "160", "method_endline": "171"}}, "hunk_4": {"Ismethod": 1, "added_lines": "386,394,395,396", "deleted_lines": "386", "method_info": {"method_name": "_update_data_info", "method_params": "self,d", "method_startline": "386", "method_endline": "396"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tests\\chainer_tests\\test_variable.py", "file_new_name": "tests\\chainer_tests\\test_variable.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "727,728,729,730,731,732,733,734,735,736,737,738", "deleted_lines": null, "method_info": {"method_name": "test_variable_data_assign", "method_params": "self", "method_startline": "727", "method_endline": "738"}}}}}}}