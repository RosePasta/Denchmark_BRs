{"BR": {"BR_id": "437", "BR_author": "agilebean", "BRopenT": "2018-06-21T14:05:26Z", "BRcloseT": "2018-06-23T18:13:09Z", "BR_text": {"BRsummary": "convert.py doesn't work with OriginalHighRes trainer", "BRdescription": "\n <denchmark-h:h2>Expected behavior</denchmark-h>\n \n Training with OriginalHighRes plugin module works like other trainer plugins\n <denchmark-h:h2>Actual behavior</denchmark-h>\n \n Training with OriginalHighRes plugin module throws the error:\n TypeError: join() argument must be str or bytes, not 'PosixPath' with the following\n stack trace:\n <denchmark-code>Using TensorFlow backend.\n Output Directory: /home/agilebean/faceswap/output\n Input Directory: /home/agilebean/faceswap/input_images\n Loading Extract from Extract_Align plugin...\n Using json serializer\n Alignments filepath: /home/agilebean/faceswap/input_images/alignments.json\n Aligned directory not specified. All faces listed in the alignments file will be converted\n Loading Model from Model_OriginalHighRes plugin...\n Traceback (most recent call last):\n   File \"faceswap.py\", line 36, in <module>\n     ARGUMENTS.func(ARGUMENTS)\n   File \"/home/agilebean/faceswap/lib/cli.py\", line 81, in execute_script\n     process.process()\n   File \"/home/agilebean/faceswap/scripts/convert.py\", line 42, in process\n     model = self.load_model()\n   File \"/home/agilebean/faceswap/scripts/convert.py\", line 70, in load_model\n     if not model.load(self.args.swap_model):\n   File \"/home/agilebean/faceswap/plugins/Model_OriginalHighRes/Model.py\", line 134, in load\n     state_dir = os.path.join(self.model_dir, 'state_{version_str}_{ENCODER.value}.json'.format(**globals()))\n   File \"/usr/lib/python3.5/posixpath.py\", line 89, in join\n     genericpath._check_arg_types('join', a, *p)\n   File \"/usr/lib/python3.5/genericpath.py\", line 143, in _check_arg_types\n     (funcname, s.__class__.__name__)) from None\n TypeError: join() argument must be str or bytes, not 'PosixPath'\n </denchmark-code>\n \n <denchmark-h:h2>Steps to reproduce</denchmark-h>\n \n TRAINER=OriginalHighRes\n python3 faceswap.py train -A  $INPUT_FACE_DIR -B  $STYLE_FACE_DIR -it $NUM_ITERATIONS -t $TRAINER\n I tested with all other methods, OriginalHighRes is the only method that doesn't work.\n <denchmark-h:h2>Other relevant information</denchmark-h>\n \n \n Operating system and version: Ubuntu 16.04 LTS\n Python version: 3.5\n Faceswap version:\n Faceswap method: GPU\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "agilebean", "commentT": "2018-06-21T14:09:04Z", "comment_text": "\n \t\tI testing it under win10\n python=3.5\n GPU\n also is TyperError :\u3002\u3002\u3002\u3002\uff0cnot \u2018Winpath\u2019\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "agilebean", "commentT": "2018-06-22T09:07:39Z", "comment_text": "\n \t\tShould be fixed in latest commit <denchmark-link:https://github.com/deepfakes/faceswap/pull/442>#442</denchmark-link>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "agilebean", "commentT": "2018-06-22T16:40:36Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/torzdf>@torzdf</denchmark-link>\n  can you re-open this issue?\n Tried latest commit, the PosixPath problem seems to be fixed, but now convert.py throws a JSON error.\n Strack trace:\n <denchmark-code>Using TensorFlow backend.\n Output Directory: /home/agilebean/faceswap/output\n Input Directory: /home/agilebean/faceswap/input_images\n Loading Extract from Extract_Align plugin...\n Using json serializer\n Alignments filepath: /home/agilebean/faceswap/input_images/alignments.json\n Aligned directory not specified. All faces listed in the alignments file will be converted\n Loading Model from Model_OriginalHighRes plugin...\n Traceback (most recent call last):\n   File \"faceswap.py\", line 36, in <module>\n     ARGUMENTS.func(ARGUMENTS)\n   File \"/home/agilebean/faceswap/lib/cli.py\", line 81, in execute_script\n     process.process()\n   File \"/home/agilebean/faceswap/scripts/convert.py\", line 42, in process\n     model = self.load_model()\n   File \"/home/agilebean/faceswap/scripts/convert.py\", line 70, in load_model\n     if not model.load(self.args.swap_model):\n   File \"/home/agilebean/faceswap/plugins/Model_OriginalHighRes/Model.py\", line 125, in load\n     state = ser.unmarshal(fp.read())\n   File \"/home/agilebean/faceswap/lib/Serializer.py\", line 54, in unmarshal\n     return json.loads(input_string)\n   File \"/usr/lib/python3.5/json/__init__.py\", line 312, in loads\n     s.__class__.__name__))\n TypeError: the JSON object must be str, not 'bytes'\n </denchmark-code>\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "agilebean", "commentT": "2018-06-23T12:07:14Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/agilebean>@agilebean</denchmark-link>\n  shall be fixed in the next merge today. Thanks for providing the valuable feedback thus I could further deploy models without these issues.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "agilebean", "commentT": "2018-06-23T18:13:09Z", "comment_text": "\n \t\tmerged <denchmark-link:https://github.com/deepfakes/faceswap/pull/443>#443</denchmark-link>\n \n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "agilebean", "commentT": "2018-06-26T12:16:52Z", "comment_text": "\n \t\tIt works - wonderful!\n It definitely renders better than results than the Original trainer with 10.000 iterations.\n Great job <denchmark-link:https://github.com/andenixa>@andenixa</denchmark-link>\n  !!!\n \t\t"}}}, "commit": {"commit_id": "439b227b0dbfd4c0e699207036262fd4fbb8179c", "commit_author": "Artem Ivanov", "commitT": "2018-06-22 11:07:09+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "plugins\\Model_OriginalHighRes\\Model.py", "file_new_name": "plugins\\Model_OriginalHighRes\\Model.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "114,115,116,120,122,127,128,129,130,131,132,135,136,137,140,141,143,144,145", "deleted_lines": "114,118,124,125,126,129,130,131,135,136,137", "method_info": {"method_name": "load", "method_params": "self,swapped", "method_startline": "114", "method_endline": "145"}}, "hunk_1": {"Ismethod": 1, "added_lines": "270", "deleted_lines": "262", "method_info": {"method_name": "save_weights", "method_params": "self", "method_startline": "258", "method_endline": "291"}}}}}}}