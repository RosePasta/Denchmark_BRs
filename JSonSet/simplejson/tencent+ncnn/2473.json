{"BR": {"BR_id": "2473", "BR_author": "harhar539", "BRopenT": "2020-12-17T07:06:05Z", "BRcloseT": "2020-12-17T08:08:45Z", "BR_text": {"BRsummary": "Eltwise layer change topblob dims if bottom dims != 3", "BRdescription": "\n <denchmark-link:https://user-images.githubusercontent.com/37204312/102453384-14d94000-4077-11eb-8bf6-882dcf624119.png></denchmark-link>\n \n like part of the model struct above,\n POOLING: input (7,7,576,(dims ==3)) -->pooling(global ave pooling)-->output(576,1,1 ())\n Eltwise: input A(576,1,1 (dims == 1))  input B(576,1,1(dims == 1))-->eltwise(PROD)---->output(72,1,8 ())\n <denchmark-link:https://user-images.githubusercontent.com/37204312/102454296-c167f180-4078-11eb-95a1-ea6ffdfbd209.png></denchmark-link>\n \n Because forward func of eltwise create output blob with dims == 3.\n The change of shape of output blob from eltwise layer will cause error in the following layers forwarding.\n This model will not cause error in caffe, since caffe  in \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "harhar539", "commentT": "2020-12-17T08:09:23Z", "comment_text": "\n \t\tThanks for your issue report !\n \t\t"}}}, "commit": {"commit_id": "bd4f1ccb07e04486106cb4ef809175363c9aad39", "commit_author": "nihuini", "commitT": "2020-12-17 16:08:34+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "src\\layer\\arm\\eltwise_arm.cpp", "file_new_name": "src\\layer\\arm\\eltwise_arm.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "887", "deleted_lines": "884,889", "method_info": {"method_name": "ncnn::Eltwise_arm::forward_fp16s", "method_params": "bottom_blobs,top_blobs,opt", "method_startline": "877", "method_endline": "1617"}}, "hunk_1": {"Ismethod": 1, "added_lines": "1629", "deleted_lines": "1627,1632", "method_info": {"method_name": "ncnn::Eltwise_arm::forward_fp16sa", "method_params": "bottom_blobs,top_blobs,opt", "method_startline": "1619", "method_endline": "2213"}}, "hunk_2": {"Ismethod": 1, "added_lines": "2226", "deleted_lines": "2225,2230", "method_info": {"method_name": "ncnn::Eltwise_arm::forward_bf16s", "method_params": "bottom_blobs,top_blobs,opt", "method_startline": "2216", "method_endline": "2982"}}, "hunk_3": {"Ismethod": 1, "added_lines": "60", "deleted_lines": "56,61", "method_info": {"method_name": "ncnn::Eltwise_arm::forward", "method_params": "bottom_blobs,top_blobs,opt", "method_startline": "35", "method_endline": "874"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\layer\\eltwise.cpp", "file_new_name": "src\\layer\\eltwise.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "42", "deleted_lines": "39,43", "method_info": {"method_name": "ncnn::Eltwise::forward", "method_params": "bottom_blobs,top_blobs,opt", "method_startline": "33", "method_endline": "186"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "src\\layer\\vulkan\\eltwise_vulkan.cpp", "file_new_name": "src\\layer\\vulkan\\eltwise_vulkan.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "219", "deleted_lines": "217,221", "method_info": {"method_name": "ncnn::Eltwise_vulkan::forward", "method_params": "bottom_blobs,top_blobs,cmd,opt", "method_startline": "208", "method_endline": "267"}}, "hunk_1": {"Ismethod": 1, "added_lines": "158", "deleted_lines": "155,159", "method_info": {"method_name": "ncnn::Eltwise_vulkan::forward", "method_params": "bottom_blobs,top_blobs,cmd,opt", "method_startline": "147", "method_endline": "206"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\layer\\x86\\eltwise_x86.cpp", "file_new_name": "src\\layer\\x86\\eltwise_x86.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "43", "deleted_lines": "39,44", "method_info": {"method_name": "ncnn::Eltwise_x86::forward", "method_params": "bottom_blobs,top_blobs,opt", "method_startline": "33", "method_endline": "621"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 9, "file_old_name": "tests\\test_eltwise.cpp", "file_new_name": "tests\\test_eltwise.cpp", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262", "deleted_lines": null, "method_info": {"method_name": "test_eltwise_8", "method_params": "", "method_startline": "228", "method_endline": "262"}}, "hunk_1": {"Ismethod": 1, "added_lines": "209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226", "deleted_lines": null, "method_info": {"method_name": "test_eltwise_7", "method_params": "", "method_startline": "209", "method_endline": "226"}}, "hunk_2": {"Ismethod": 1, "added_lines": "191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207", "deleted_lines": null, "method_info": {"method_name": "test_eltwise_6", "method_params": "", "method_startline": "191", "method_endline": "207"}}, "hunk_3": {"Ismethod": 1, "added_lines": "174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189", "deleted_lines": null, "method_info": {"method_name": "test_eltwise_5", "method_params": "", "method_startline": "174", "method_endline": "189"}}, "hunk_4": {"Ismethod": 1, "added_lines": "299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316", "deleted_lines": null, "method_info": {"method_name": "test_eltwise_11", "method_params": "", "method_startline": "299", "method_endline": "316"}}, "hunk_5": {"Ismethod": 1, "added_lines": "281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297", "deleted_lines": null, "method_info": {"method_name": "test_eltwise_10", "method_params": "", "method_startline": "281", "method_endline": "297"}}, "hunk_6": {"Ismethod": 1, "added_lines": "264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279", "deleted_lines": null, "method_info": {"method_name": "test_eltwise_9", "method_params": "", "method_startline": "264", "method_endline": "279"}}, "hunk_7": {"Ismethod": 1, "added_lines": "326,327,328,329,330,331,332,333,334", "deleted_lines": null, "method_info": {"method_name": "main", "method_params": "", "method_startline": "318", "method_endline": "335"}}, "hunk_8": {"Ismethod": 1, "added_lines": "138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172", "deleted_lines": "146", "method_info": {"method_name": "test_eltwise_4", "method_params": "", "method_startline": "138", "method_endline": "172"}}}}}}}