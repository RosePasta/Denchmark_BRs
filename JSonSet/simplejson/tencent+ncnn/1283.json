{"BR": {"BR_id": "1283", "BR_author": "Timen", "BRopenT": "2019-10-02T14:49:04Z", "BRcloseT": "2019-10-23T07:12:41Z", "BR_text": {"BRsummary": "Im2col implementation of 3x3 stride 2 convolution produces incorrect result", "BRdescription": "\n I found that the im2col implementation of the 3x3 conv with stride 2 called here:\n \n \n \n ncnn/src/layer/arm/convolution_arm.cpp\n \n \n          Line 1236\n       in\n       6703286\n \n \n \n \n \n \n  conv_im2col_sgemm_neon(bottom_blob_bordered, top_blob, weight_sgemm_data, bias_data, kernel_w, kernel_h, stride_w, stride_h, opt); \n \n \n \n \n \n Produces 1 incorrect pixel (at index 40) in every output channel when being run on a 14x14x20 input with SAME padding and producing a 7x7x42 output. A quick work around is disabling the im2col and always using conv3x3s2_packed_neon which produces the correct results.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "Timen", "commentT": "2019-10-16T12:16:24Z", "comment_text": "\n \t\tI suggest that add result check in auto pack model.\n Now that convolution could be implemented with multiple approach, we can compare different methods' result.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "Timen", "commentT": "2019-10-23T07:20:25Z", "comment_text": "\n \t\tfixed\n Thanks for your report !\n \t\t"}}}, "commit": {"commit_id": "c4b84262d99d11b2e62661268b862dcecf151634", "commit_author": "nihuini", "commitT": "2019-10-23 15:12:26+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "src\\layer\\arm\\convolution_sgemm.h", "file_new_name": "src\\layer\\arm\\convolution_sgemm.h", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1322,1330,1331,1333,1334,1336,1337,1487,1519", "deleted_lines": "1322,1330,1331,1333,1334,1336,1337,1487,1519", "method_info": {"method_name": "conv_im2col_sgemm_neon", "method_params": "bottom_blob,top_blob,kernel_tm,_bias,kernel_w,kernel_h,stride_w,stride_h,opt", "method_startline": "127", "method_endline": "1532"}}}}}}}