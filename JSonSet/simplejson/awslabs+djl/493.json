{"BR": {"BR_id": "493", "BR_author": "ebamberg", "BRopenT": "2021-01-07T11:34:44Z", "BRcloseT": "2021-01-08T00:21:37Z", "BR_text": {"BRsummary": "gradle-build java-formatter fails on unicode character (api-&gt;ProgressBar) when build run in non utf-8 system", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n gradle build fails on Western-European Windows 10 System runnning gradle from the command line.\n java-formatter in the api project finds \"unclosed character literal\" and throws an exception when formatting ai.djl.training.util.ProgressBar.\n resaon: ai.djl.training.util.ProgressBar line 150 return ' ' a utf-8 unicode character.\n my machine setup\n IsSingleByte      : True\n BodyName          : iso-8859-1\n EncodingName      : Western European (Windows)\n HeaderName        : Windows-1252\n WebName           : Windows-1252\n WindowsCodePage   : 1252\n IsBrowserDisplay  : True\n IsBrowserSave     : True\n IsMailNewsDisplay : True\n IsMailNewsSave    : True\n EncoderFallback   : System.Text.InternalEncoderBestFitFallback\n DecoderFallback   : System.Text.InternalDecoderBestFitFallback\n IsReadOnly        : True\n CodePage          : 1252\n This settings are  common settings from windows machine in western europe\n <denchmark-h:h3>Expected Behavior</denchmark-h>\n \n gradle build successful even on a iso-8859-1 machine.\n <denchmark-h:h3>Error Message</denchmark-h>\n \n Script 'C:\\dev\\src\\awslabs\\djl\\tools\\gradle\\java-formatter.gradle' line: 54\n \n What went wrong:\n Execution failed for task ':api:verifyJava'.\n \n \n com.google.googlejavaformat.java.FormatterException: 150:17: error: unclosed character literal\n \n <denchmark-h:h2>How to Reproduce?</denchmark-h>\n \n gradle build on an non utf-8 machine.\n <denchmark-h:h3>Steps to reproduce</denchmark-h>\n \n (Paste the commands you ran that produced the error.)\n \n cmd\n gradlew clean build\n \n <denchmark-h:h2>What have you tried to solve it?</denchmark-h>\n \n <denchmark-code>private static char getProgressChar() {\n     if (System.getProperty(\"os.name\").startsWith(\"Win\")) {\n         return '=';\n     } else if (System.getProperty(\"os.name\").startsWith(\"Linux\")) {\n         String lang = System.getenv(\"LANG\");\n         if (lang == null || !lang.contains(\"UTF-8\")) {\n             return '=';\n         }\n     }\n     **return '>';**\n }\n </denchmark-code>\n \n I exchanged to special character with a ASCII character. Build runs\n \n I tried to find an option in Google-java-formater to force UtF-8 which is not possible.\n \n <denchmark-h:h2>Environment Info</denchmark-h>\n \n Please run the command ./gradlew debugEnv from the root directory of DJL (if necessary, clone DJL first). It will output information about your system, environment, and installation that can help us debug your issue. Paste the output of the command below:\n ----------- System Properties -----------\n sun.desktop: windows\n awt.toolkit: sun.awt.windows.WToolkit\n java.specification.version: 11\n sun.cpu.isalist: amd64\n sun.jnu.encoding: Cp1252\n java.class.path: C:\\dev\\src\\awslabs\\djl\\integration\\build\\classes\\java\\main;C:\\dev\\src\\awslabs\\djl\\integration\\build\\resources\\main;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\commons-cli\\commons-cli\\1.4\\c51c00206bb913cd8612b24abd9fa98ae89719b1\\commons-cli-1.4.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\org.apache.logging.log4j\\log4j-slf4j-impl\\2.13.3\\7cca27a921a18645139cf651c04b83b1a19cfd76\\log4j-slf4j-impl-2.13.3.jar;C:\\dev\\src\\awslabs\\djl\\basicdataset\\build\\libs\\basicdataset-0.10.0-SNAPSHOT.jar;C:\\dev\\src\\awslabs\\djl\\model-zoo\\build\\libs\\model-zoo-0.10.0-SNAPSHOT.jar;C:\\dev\\src\\awslabs\\djl\\testing\\build\\libs\\testing-0.10.0-SNAPSHOT.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\org.testng\\testng\\7.1.0\\b0bcea778fb2899aeb4014c558babea8833d180a\\testng-7.1.0.jar;C:\\dev\\src\\awslabs\\djl\\mxnet\\mxnet-model-zoo\\build\\libs\\mxnet-model-zoo-0.10.0-SNAPSHOT.jar;C:\\dev\\src\\awslabs\\djl\\mxnet\\mxnet-engine\\build\\libs\\mxnet-engine-0.10.0-SNAPSHOT.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\ai.djl.mxnet\\mxnet-native-auto\\1.7.0-backport\\ee5b368ef94c1fcec4ade4a6edacffb420fefce7\\mxnet-native-auto-1.7.0-backport.jar;C:\\dev\\src\\awslabs\\djl\\api\\build\\libs\\api-0.10.0-SNAPSHOT.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\org.slf4j\\slf4j-api\\1.7.30\\b5a4b6d16ab13e34a88fae84c35cd5d68cac922c\\slf4j-api-1.7.30.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\org.apache.logging.log4j\\log4j-core\\2.13.3\\4e857439fc4fe974d212adaaaa3b118b8b50e3ec\\log4j-core-2.13.3.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\org.apache.logging.log4j\\log4j-api\\2.13.3\\ec1508160b93d274b1add34419b897bae84c6ca9\\log4j-api-2.13.3.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\org.apache.commons\\commons-csv\\1.8\\37ca9a9aa2d4be2599e55506a6d3170dd7a3df4\\commons-csv-1.8.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\com.beust\\jcommander\\1.72\\6375e521c1e11d6563d4f25a07ce124ccf8cd171\\jcommander-1.72.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\com.google.inject\\guice\\4.1.0\\faf9ee8ac09eafd1128091426dd367a8c0085d55\\guice-4.1.0-no_aop.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\org.yaml\\snakeyaml\\1.21\\18775fdda48574784f40b47bf478ab0593f92e4d\\snakeyaml-1.21.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\com.google.code.gson\\gson\\2.8.6\\9180733b7df8542621dc12e21e87557e8c99b8cb\\gson-2.8.6.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\net.java.dev.jna\\jna\\5.3.0\\4654d1da02e4173ba7b64f7166378847db55448a\\jna-5.3.0.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\org.apache.commons\\commons-compress\\1.20\\b8df472b31e1f17c232d2ad78ceb1c84e00c641b\\commons-compress-1.20.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\javax.inject\\javax.inject\\1\\6975da39a7040257bd51d21a231b76c915872d38\\javax.inject-1.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\aopalliance\\aopalliance\\1.0\\235ba8b489512805ac13a8f9ea77a1ca5ebe3e8\\aopalliance-1.0.jar;C:\\Users\\erikb.gradle\\caches\\modules-2\\files-2.1\\com.google.guava\\guava\\19.0\\6ce200f6b23222af3d8abb6b6459e6c44f4bb0e9\\guava-19.0.jar\n java.vm.vendor: Oracle Corporation\n sun.arch.data.model: 64\n user.variant:\n java.vendor.url: <denchmark-link:https://openjdk.java.net/>https://openjdk.java.net/</denchmark-link>\n \n user.timezone: Europe/London\n os.name: Windows 10\n java.vm.specification.version: 11\n sun.java.launcher: SUN_STANDARD\n user.country: GB\n sun.boot.library.path: C:\\dev\\apps\\jdk-11\\bin;C:\\dev\\apps\\jdk-11\\bin\n sun.java.command: ai.djl.integration.util.DebugEnvironment\n jdk.debug: release\n sun.cpu.endian: little\n user.home: C:\\Users\\erikb\n org.gradle.appname: gradlew\n user.language: en\n java.specification.vendor: Oracle Corporation\n java.version.date: 2020-10-20\n java.home: C:\\dev\\apps\\jdk-11\n ai.djl.logging.level: debug\n org.gradle.internal.http.connectionTimeout: 60000\n file.separator: \n java.vm.compressedOopsMode: Zero based\n line.separator:\n java.specification.name: Java Platform API Specification\n java.vm.specification.vendor: Oracle Corporation\n java.awt.graphicsenv: sun.awt.Win32GraphicsEnvironment\n user.script:\n sun.management.compiler: HotSpot 64-Bit Tiered Compilers\n java.runtime.version: 11.0.9+7-LTS\n user.name: erikb\n path.separator: ;\n os.version: 10.0\n java.runtime.name: Java(TM) SE Runtime Environment\n file.encoding: Cp1252\n jnidispatch.path: C:\\Users\\erikb\\AppData\\Local\\Temp\\jna-96776115\\jna10506132894072617231.dll\n java.vm.name: Java HotSpot(TM) 64-Bit Server VM\n java.vendor.version: 18.9\n jna.loaded: true\n java.vendor.url.bug: <denchmark-link:https://bugreport.java.com/bugreport/>https://bugreport.java.com/bugreport/</denchmark-link>\n \n java.io.tmpdir: C:\\Users\\erikb\\AppData\\Local\\Temp\n org.gradle.internal.http.socketTimeout: 120000\n java.version: 11.0.9\n user.dir: C:\\dev\\src\\awslabs\\djl\\integration\n os.arch: amd64\n java.vm.specification.name: Java Virtual Machine Specification\n java.awt.printerjob: sun.awt.windows.WPrinterJob\n sun.os.patch.level:\n java.library.path: C:\\dev\\apps\\jdk-11\\bin;C:\\WINDOWS\\Sun\\Java\\bin;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0;C:\\WINDOWS\\System32\\OpenSSH;C:\\dev\\apps\\jdk-11\\bin;C:\\dev\\apps\\python3;C:\\dev\\apps\\python3\\Scripts;C:\\dev\\apps\\gradle\\bin;C:\\dev\\apps\\maven\\apache-maven-3.6.3\\bin;C:\\dev\\apps\\git;C:\\dev\\apps\\git\\bin;C:\\Users\\erikb\\AppData\\Local\\Microsoft\\WindowsApps;C:\\dev\\apps\\node-v14.15.3-win-x64;;.\n java.vendor: Oracle Corporation\n java.vm.info: mixed mode\n java.vm.version: 11.0.9+7-LTS\n sun.io.unicode.encoding: UnicodeLittle\n library.jansi.path: C:\\Users\\erikb.gradle\\native\\jansi\\1.18\\windows64\n java.class.version: 55.0\n org.gradle.internal.publish.checksums.insecure: true\n --------- Environment Variables ---------\n USERDOMAIN_ROAMINGPROFILE: SILENTBOB\n PROCESSOR_LEVEL: 6\n SESSIONNAME: Console\n ALLUSERSPROFILE: C:\\ProgramData\n PROCESSOR_ARCHITECTURE: AMD64\n PSModulePath: C:\\Program Files\\WindowsPowerShell\\Modules;C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\n SystemDrive: C:\n =ExitCode: 00000000\n DIRNAME: C:\\dev\\src\\awslabs\\djl\n USERNAME: erikb\n CMD_LINE_ARGS: debugEnv\n ProgramFiles(x86): C:\\Program Files (x86)\n FPS_BROWSER_USER_PROFILE_STRING: Default\n APP_HOME: C:\\dev\\src\\awslabs\\djl\n PATHEXT: .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC\n DriverData: C:\\Windows\\System32\\Drivers\\DriverData\n OneDriveConsumer: C:\\Users\\erikb\\OneDrive\n ProgramData: C:\\ProgramData\n ProgramW6432: C:\\Program Files\n HOMEPATH: \\Users\\erikb\n PROCESSOR_IDENTIFIER: Intel64 Family 6 Model 126 Stepping 5, GenuineIntel\n M2_HOME: C:\\dev\\apps\\maven\\apache-maven-3.6.3\n ProgramFiles: C:\\Program Files\n PUBLIC: C:\\Users\\Public\n windir: C:\\WINDOWS\n =::: ::\n _SKIP: 2\n LOCALAPPDATA: C:\\Users\\erikb\\AppData\\Local\n USERDOMAIN: SILENTBOB\n FPS_BROWSER_APP_PROFILE_STRING: Internet Explorer\n LOGONSERVER: \\SILENTBOB\n JAVA_HOME: C:\\dev\\apps\\jdk-11\n PROMPT: $P$G\n OneDrive: C:\\Users\\erikb\\OneDrive\n =C:: C:\\dev\\src\\awslabs\\djl\n APPDATA: C:\\Users\\erikb\\AppData\\Roaming\n DOWNLOAD_URL: \"<denchmark-link:https://raw.githubusercontent.com/gradle/gradle/master/gradle/wrapper/gradle-wrapper.jar>https://raw.githubusercontent.com/gradle/gradle/master/gradle/wrapper/gradle-wrapper.jar</denchmark-link>\n \"\n JAVA_EXE: C:\\dev\\apps\\jdk-11/bin/java.exe\n VBOX_MSI_INSTALL_PATH: C:\\Program Files\\Oracle\\VirtualBox\n CommonProgramFiles: C:\\Program Files\\Common Files\n Path: C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0;C:\\WINDOWS\\System32\\OpenSSH;C:\\dev\\apps\\jdk-11\\bin;C:\\dev\\apps\\python3;C:\\dev\\apps\\python3\\Scripts;C:\\dev\\apps\\gradle\\bin;C:\\dev\\apps\\maven\\apache-maven-3.6.3\\bin;C:\\dev\\apps\\git;C:\\dev\\apps\\git\\bin;C:\\Users\\erikb\\AppData\\Local\\Microsoft\\WindowsApps;C:\\dev\\apps\\node-v14.15.3-win-x64;\n OS: Windows_NT\n NODE_HOME: C:\\dev\\apps\\node-v14.15.3-win-x64\n COMPUTERNAME: SILENTBOB\n PROCESSOR_REVISION: 7e05\n CLASSPATH: C:\\dev\\src\\awslabs\\djl\\gradle\\wrapper\\gradle-wrapper.jar\n CommonProgramW6432: C:\\Program Files\\Common Files\n ComSpec: C:\\WINDOWS\\system32\\cmd.exe\n APP_BASE_NAME: gradlew\n SystemRoot: C:\\WINDOWS\n TEMP: C:\\Users\\erikb\\AppData\\Local\\Temp\n HOMEDRIVE: C:\n USERPROFILE: C:\\Users\\erikb\n TMP: C:\\Users\\erikb\\AppData\\Local\\Temp\n CommonProgramFiles(x86): C:\\Program Files (x86)\\Common Files\n NUMBER_OF_PROCESSORS: 8\n -------------- Directories --------------\n temp directory: C:\\Users\\erikb\\AppData\\Local\\Temp\n Engine cache directory: C:\\Users\\erikb.djl.ai\n ------------------ CUDA -----------------\n GPU Count: 0\n Default Device: cpu()\n ----------------- Engines ---------------\n Default Engine: MXNet\n [DEBUG] - Using cache dir: C:\\Users\\erikb.djl.ai\\mxnet\n MXNet:1.7.0, capabilities: [\n SIGNAL_HANDLER,\n LAPACK,\n BLAS_OPEN,\n OPENMP,\n OPENCV,\n MKLDNN,\n ]\n MXNet Library: C:\\Users\\erikb.djl.ai\\mxnet\\1.7.0-backport-mkl-win-x86_64\\mxnet.dll\n --------------- Hardware --------------\n Available processors (cores): 8\n Byte Order: LITTLE_ENDIAN\n Free memory (bytes): 220673040\n Maximum memory (bytes): 4217372672\n Total memory available to JVM (bytes): 264241152\n Heap committed: 264241152\n Heap nonCommitted: 31326208\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ebamberg", "commentT": "2021-01-07T20:57:12Z", "comment_text": "\n \t\tWe tried to fixed here: <denchmark-link:https://github.com/awslabs/djl/pull/479>#479</denchmark-link>\n , <denchmark-link:https://github.com/frankfliu>@frankfliu</denchmark-link>\n  Should we consider just make it ascii?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ebamberg", "commentT": "2021-01-07T21:29:24Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lanking520>@lanking520</denchmark-link>\n  This is a bug in format-java plugin. I will take a look.\n \t\t"}}}, "commit": {"commit_id": "6e8d3b85bda8aad2896643f55de98cd45873399e", "commit_author": "Frank Liu", "commitT": "2021-01-07 16:21:34-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "tools\\gradle\\java-formatter.gradle", "file_new_name": "tools\\gradle\\java-formatter.gradle", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "52", "deleted_lines": "52"}}}}}}