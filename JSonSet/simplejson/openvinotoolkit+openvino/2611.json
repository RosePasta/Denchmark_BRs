{"BR": {"BR_id": "2611", "BR_author": "NatachaRuchaudDB", "BRopenT": "2020-10-09T15:18:06Z", "BRcloseT": "2020-11-16T10:39:42Z", "BR_text": {"BRsummary": "[ ERROR ] Exception occurred during running replacer \"REPLACEMENT_ID\" (&lt;class 'extensions.front.ChangePlaceholderTypes.ChangePlaceholderTypes'&gt;): Something bad has happened with graph! Data node \"Preprocessor/mul\" has 2 producers", "BRdescription": "\n \n OpenVINO => 2020.4\n Operating System / Platform => Windows 64 Bit\n Problem classification: Model Conversion\n Framework: TensorFlow 1.15\n Model name: ssdlite_mobilenet_v2_coco_2018_05_09\n Object detection tensorflow api: master\n \n <denchmark-h:h5>Detailed description of the problem</denchmark-h>\n \n Hello,\n I retrained the ssdlite_mobilenet_v2_coco_2018_05_09 model with my own data on the last version of object detection tensorflow api and also with older version such as v1.13.0 but I cannot convert the model to Openvino.\n I have the following error:\n [ ERROR ] Exception occurred during running replacer \"REPLACEMENT_ID\" (<class 'extensions.front.ChangePlaceholderTypes.ChangePlaceholderTypes'>): Something bad has happened with graph! Data node \"Preprocessor/mul\" has 2 producers\n I tried many version of object detection tensorflow api, tensorflow and openvino but each time I have the same error...\n However, I succeed to convert the model of ssdlite_mobilenet_v2_coco_2018_05_09 provided by the zoo library.\n Please if you have any suggestion.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "NatachaRuchaudDB", "commentT": "2020-10-12T13:23:09Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/NatachaRuchaudDB>@NatachaRuchaudDB</denchmark-link>\n \n Could you please provide the model optimizer command you are using? Please ensure you are using the configuration file for TensorFlow Object Detection API with , see <denchmark-link:https://docs.openvinotoolkit.org/latest/openvino_docs_MO_DG_prepare_model_convert_model_tf_specific_Convert_Object_Detection_API_Models.html#how_to_convert_a_model>Converting TensorFlow Object Detection API Models</denchmark-link>\n . I also recommend upgrading to the latest OpenVINO 2021.1 release.\n Regards,\n Jesus\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "NatachaRuchaudDB", "commentT": "2020-10-12T17:44:10Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/jgespino>@jgespino</denchmark-link>\n \n The model optimizer command that I use is:\n python mo_tf.py  --input_model ..\\modelTrain\\frozen_inference_graph.pb  --output_dir ..\\modelTrain --transformations_config extensions/front/tf/ssd_support_api_v1.15.json  --tensorflow_object_detection_api_pipeline_config ..\\modelTrain\\pipeline.config\n When I use this command to convert the same model downloaded from the TensorFlow Object Detection API everything is ok. I convert perfectly the tensorflow model to OpenVino.\n It is when I re train this model with the TensorFlow Object Detection API I do not succeed to convert to OpenVino the new trained model which is exactly the same than the one downloaded from the TensorFlow Object Detection API (same topology etc..).\n I already tried many version of the TensorFlow Object Detection API / Tensorflow / OpenVino with no success. I will re try with OpenVino 2021.1 release and I let you know.\n Thank you for your response.\n Best,\n Natacha.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "NatachaRuchaudDB", "commentT": "2020-10-14T13:41:05Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/NatachaRuchaudDB>@NatachaRuchaudDB</denchmark-link>\n  ,\n Looks like you are using the model optimizer correctly, we had a previous report of a similar issue on our Intel Community. User reported the issue being solved by using a TensorFlow branch prior to July 1st. Could you give that a try?\n See discussion here:\n <denchmark-link:https://community.intel.com/t5/Intel-Distribution-of-OpenVINO/TF-ssdv2-to-IRv10-error-quot-Preprocessor-mul-quot-has-2/td-p/1189093>https://community.intel.com/t5/Intel-Distribution-of-OpenVINO/TF-ssdv2-to-IRv10-error-quot-Preprocessor-mul-quot-has-2/td-p/1189093</denchmark-link>\n \n Regards,\n Jesus\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "NatachaRuchaudDB", "commentT": "2020-10-14T14:31:57Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/jgespino>@jgespino</denchmark-link>\n \n Yes, I also trained the model using a prior version to July 1st of TF Obj Det API and even other prior versions (2 years ago). Unfortunately, I get the same error, so it is very strange.\n Best,\n Natacha.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "NatachaRuchaudDB", "commentT": "2020-10-29T16:57:37Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/NatachaRuchaudDB>@NatachaRuchaudDB</denchmark-link>\n \n I apologies for the delay for some reason I missed the notification. Could you provide your TensorFlow model?\n Regards,\n Jesus\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "NatachaRuchaudDB", "commentT": "2020-10-30T14:21:39Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/jgespino>@jgespino</denchmark-link>\n \n No problem. Yes I can share the model. Where do you want that I send the Tensorflow model ?\n Best,\n Natacha.\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "NatachaRuchaudDB", "commentT": "2020-10-30T14:33:52Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/NatachaRuchaudDB>@NatachaRuchaudDB</denchmark-link>\n \n You can share it here or send it to my email if you prefer to share it privately.\n Regards,\n Jesus\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "NatachaRuchaudDB", "commentT": "2020-10-30T15:53:06Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/NatachaRuchaudDB>@NatachaRuchaudDB</denchmark-link>\n \n Thanks for sending over the model, I took a look and it seems there are changes to the order of applying input image normalization and resizing images. The dev team is already looking into this issue, however, I don't have an ETA on fix yet.\n Regards,\n Jesus\n Ref. 37922\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "NatachaRuchaudDB", "commentT": "2020-11-02T08:34:54Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/jgespino>@jgespino</denchmark-link>\n \n Thanks you for having a look. I hope you will find a solution.\n Best,\n Natacha.\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "NatachaRuchaudDB", "commentT": "2020-11-10T17:22:08Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/NatachaRuchaudDB>@NatachaRuchaudDB</denchmark-link>\n  ,\n please, use the MO from the <denchmark-link:https://github.com/openvinotoolkit/openvino/pull/3063>#3063</denchmark-link>\n  and let me know if the solution works for you.\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "NatachaRuchaudDB", "commentT": "2020-11-12T14:38:28Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/lazarevevgeny>@lazarevevgeny</denchmark-link>\n \n Thanks ! I tested. The conversion to OpenVino works but unforthunately not the inferences ... I obtain no detections. The prediction vector is always [-1, 0, 0, 0, ...0, 0]. When I run inferences with Tensorflow I obtain mutliple detections. And when I use OpenVino with models not from the TF API I obtain detections.\n Best,\n Natacha.\n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "NatachaRuchaudDB", "commentT": "2020-11-12T16:05:31Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/NatachaRuchaudDB>@NatachaRuchaudDB</denchmark-link>\n  , could you share the sample image with <denchmark-link:https://github.com/jgespino>@jgespino</denchmark-link>\n  for the model you shared with him?\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "NatachaRuchaudDB", "commentT": "2020-11-12T16:56:03Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/lazarevevgeny>@lazarevevgeny</denchmark-link>\n \n Yes, sure. For the inferences, I use the test images of HollywoodHead database available on <denchmark-link:https://www.di.ens.fr/willow/research/headdetection/>https://www.di.ens.fr/willow/research/headdetection/</denchmark-link>\n \n I hope it answer to your question.\n Best,\n Natacha.\n \t\t"}, "comments_13": {"comment_id": 14, "comment_author": "NatachaRuchaudDB", "commentT": "2020-11-13T08:39:43Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/NatachaRuchaudDB>@NatachaRuchaudDB</denchmark-link>\n  , I did the following using MO and IE from the master branch (commit <denchmark-link:https://github.com/openvinotoolkit/openvino/commit/f4d399f471d93366cf023bde939be73b4c293a93>f4d399f</denchmark-link>\n ):\n \n ./mo.py --input_model frozen_inference_graph.pb --transformation extensions/front/tf/ssd_support_api_v1.15.json --tensorflow_object_detection pipeline.config  --reverse_input_channels\n \n Pay attention to the \"--reverse_input_channels\" in the command line.\n Then I used the object_detection_sample_ssd:\n \n ./object_detection_sample_ssd -m frozen_inference_graph.xml -i casablanca_074268.jpeg\n \n And I see the detections:\n <denchmark-link:https://user-images.githubusercontent.com/30651952/99047191-e3b3ae80-25a4-11eb-86bf-e30a4a5c07b7.png></denchmark-link>\n \n \t\t"}, "comments_14": {"comment_id": 15, "comment_author": "NatachaRuchaudDB", "commentT": "2020-11-16T10:07:39Z", "comment_text": "\n \t\tHello <denchmark-link:https://github.com/lazarevevgeny>@lazarevevgeny</denchmark-link>\n \n Thanks a lot !! It works !!!\n Best,\n Natacha Ruchaud.\n \t\t"}, "comments_15": {"comment_id": 16, "comment_author": "NatachaRuchaudDB", "commentT": "2020-11-16T10:39:42Z", "comment_text": "\n \t\t\n Hello @lazarevevgeny\n Thanks a lot !! It works !!!\n Best,\n Natacha Ruchaud.\n \n Great to hear that! Closing the issue.\n \t\t"}}}, "commit": {"commit_id": "f633f0035c08f0baa4767bb4454a92d875f7ae04", "commit_author": "Evgeny Lazarev", "commitT": "2020-11-11 11:53:10+03:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "model-optimizer\\extensions\\front\\tf\\ObjectDetectionAPI.py", "file_new_name": "model-optimizer\\extensions\\front\\tf\\ObjectDetectionAPI.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504", "deleted_lines": "497,502,504", "method_info": {"method_name": "is_preprocessing_applied_before_resize", "method_params": "self,Node,Node,Node", "method_startline": "489", "method_endline": "504"}}, "hunk_1": {"Ismethod": 1, "added_lines": "514,519,521,541,542,543,546,547,548,549,550,551,552,553,555,556,557,558,559", "deleted_lines": "524,525,526,529,530,531,533", "method_info": {"method_name": "generate_sub_graph", "method_params": "self,Graph,SubgraphMatch", "method_startline": "506", "method_endline": "563"}}}}}}}