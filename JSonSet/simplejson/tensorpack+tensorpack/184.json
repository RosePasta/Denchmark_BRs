{"BR": {"BR_id": "184", "BR_author": "eyaler", "BRopenT": "2017-03-09T16:46:02Z", "BRcloseT": "2017-03-30T05:14:05Z", "BR_text": {"BRsummary": "some image augmentations fail for single channel", "BRdescription": "\n some image augmentations (eg flip, shift rotate) fail when image is single channel. we need to add:\n        if img.ndim == 3 and ret.ndim == 2: ret = ret[:, :, np.newaxis]\n to all image augmentations as it is implemented in resize (perhaps this could be added generically to base)\n i also found a similar code in convert:\n if self.keepdims: if len(transf.shape) is not len(img.shape): transf = transf[..., None]\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "eyaler", "commentT": "2017-03-09T18:26:59Z", "comment_text": "\n \t\tRight. This fix has to be added as long as opencv is involved.\n \t\t"}}}, "commit": {"commit_id": "3397e0bdd24e4da0ed70f4aafd9359835b24bab8", "commit_author": "Yuxin Wu", "commitT": "2017-03-29 22:13:27-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 3, "file_old_name": "tensorpack\\dataflow\\imgaug\\geometry.py", "file_new_name": "tensorpack\\dataflow\\imgaug\\geometry.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "76,77", "deleted_lines": null, "method_info": {"method_name": "_augment", "method_params": "self,img,rot_m", "method_startline": "73", "method_endline": "78"}}, "hunk_1": {"Ismethod": 1, "added_lines": "40,41", "deleted_lines": null, "method_info": {"method_name": "_augment", "method_params": "self,img,shift_m", "method_startline": "37", "method_endline": "42"}}, "hunk_2": {"Ismethod": 1, "added_lines": "106,107", "deleted_lines": null, "method_info": {"method_name": "_augment", "method_params": "self,img,deg", "method_startline": "101", "method_endline": "114"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorpack\\dataflow\\imgaug\\imgproc.py", "file_new_name": "tensorpack\\dataflow\\imgaug\\imgproc.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "155,156,157,158", "deleted_lines": "155,156", "method_info": {"method_name": "_augment", "method_params": "self,img,gamma", "method_startline": "151", "method_endline": "158"}}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tensorpack\\dataflow\\imgaug\\noname.py", "file_new_name": "tensorpack\\dataflow\\imgaug\\noname.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "42,43,44,45,46,47", "deleted_lines": "42,43", "method_info": {"method_name": "_augment", "method_params": "self,img,do", "method_startline": "40", "method_endline": "47"}}}}}}}