{"BR": {"BR_id": "19720", "BR_author": "dibgerge", "BRopenT": "2020-12-28T11:34:03Z", "BRcloseT": "2021-01-01T17:17:01Z", "BR_text": {"BRsummary": "`Distribution` repr fails if cached_property not initialized", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n When defining a Categorical distribution using logit and then trying to display the distribution in the repl, it failed due to KeyError: prob. This error will happen to any distribution which contains cached_properties as part of its arguments declared arg_contraints.\n <denchmark-h:h3>Error Message</denchmark-h>\n \n ~/workplace/incubator-mxnet/python/mxnet/gluon/probability/distributions/distribution.py in __repr__(self)\n     181         if 'symbol' not in mode.__name__:\n     182             for k, _ in self.arg_constraints.items():\n --> 183                 v = self.__dict__[k]\n     184                 if isinstance(v, Number):\n     185                     shape_v = ()\n \n KeyError: 'prob'\n <denchmark-h:h2>To Reproduce</denchmark-h>\n \n from mxnet import np\n from mxnet.gluon.probability import Categorical\n \n a = np.array([1, 2, 3])\n dist = Categorical(1, logit=a)\n \n >>> dist\n \n #KeyError\n <denchmark-h:h2>What have you tried to solve it?</denchmark-h>\n \n Simply calling the undeclared cached_property first solves it. That is:\n a = np.array([1, 2, 3])\n dist = Categorical(1, logit=a)\n dist.prob\n \n >>> dist\n \n # Categorical(prob: size (3,), logit: size (3,), F: mxnet.ndarray, event_dim: 0)\n # ...Works\n <denchmark-h:h2>Environment</denchmark-h>\n \n We recommend using our script for collecting the diagnostic information with the following command\n curl --retry 10 -s https://raw.githubusercontent.com/apache/incubator-mxnet/master/tools/diagnose.py | python3\n \n Environment Information\n ----------Python Info----------\n Version      : 3.7.8\n Compiler     : GCC 7.5.0\n Build        : ('default', 'Nov 17 2020 23:45:15')\n Arch         : ('64bit', '')\n ------------Pip Info-----------\n Version      : 20.3.3\n Directory    : /home/ubuntu/software/anaconda3/envs/deep/lib/python3.7/site-packages/pip\n ----------MXNet Info-----------\n Version      : 2.0.0\n Directory    : /home/ubuntu/workplace/incubator-mxnet/python/mxnet\n Commit hash file \"/home/ubuntu/workplace/incubator-mxnet/python/mxnet/COMMIT_HASH\" not found. Not installed from pre-built package or built from source.\n Library      : ['/home/ubuntu/workplace/incubator-mxnet/python/mxnet/../../build/libmxnet.so']\n Build features:\n \u2714 CUDA\n \u2714 CUDNN\n \u2716 NCCL\n \u2716 TENSORRT\n \u2716 CUTENSOR\n \u2714 CPU_SSE\n \u2714 CPU_SSE2\n \u2714 CPU_SSE3\n \u2714 CPU_SSE4_1\n \u2714 CPU_SSE4_2\n \u2716 CPU_SSE4A\n \u2714 CPU_AVX\n \u2716 CPU_AVX2\n \u2714 OPENMP\n \u2716 SSE\n \u2714 F16C\n \u2716 JEMALLOC\n \u2714 BLAS_OPEN\n \u2716 BLAS_ATLAS\n \u2716 BLAS_MKL\n \u2716 BLAS_APPLE\n \u2714 LAPACK\n \u2714 MKLDNN\n \u2714 OPENCV\n \u2716 DIST_KVSTORE\n \u2714 INT64_TENSOR_SIZE\n \u2714 SIGNAL_HANDLER\n \u2716 DEBUG\n \u2716 TVM_OP\n ----------System Info----------\n Platform     : Linux-5.4.0-1030-aws-x86_64-with-debian-buster-sid\n system       : Linux\n node         : ip-172-31-43-72\n release      : 5.4.0-1030-aws\n version      : #31~18.04.1-Ubuntu SMP Tue Nov 17 10:48:34 UTC 2020\n ----------Hardware Info----------\n machine      : x86_64\n processor    : x86_64\n Architecture:        x86_64\n CPU op-mode(s):      32-bit, 64-bit\n Byte Order:          Little Endian\n CPU(s):              36\n On-line CPU(s) list: 0-35\n Thread(s) per core:  2\n Core(s) per socket:  18\n Socket(s):           1\n NUMA node(s):        1\n Vendor ID:           GenuineIntel\n CPU family:          6\n Model:               85\n Model name:          Intel(R) Xeon(R) Platinum 8124M CPU @ 3.00GHz\n Stepping:            4\n CPU MHz:             1505.072\n BogoMIPS:            5999.99\n Hypervisor vendor:   KVM\n Virtualization type: full\n L1d cache:           32K\n L1i cache:           32K\n L2 cache:            1024K\n L3 cache:            25344K\n NUMA node0 CPU(s):   0-35\n Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon rep_good nopl xtopology nonstop_tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq monitor ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single pti fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm mpx avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves ida arat pku ospke\n ----------Network Test----------\n Setting timeout: 10\n Timing for MXNet: https://github.com/apache/incubator-mxnet, DNS: 0.0019 sec, LOAD: 0.7875 sec.\n Timing for Gluon Tutorial(en): http://gluon.mxnet.io, DNS: 0.0360 sec, LOAD: 0.0374 sec.\n Error open Gluon Tutorial(cn): https://zh.gluon.ai, <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1091)>, DNS finished in 0.008315324783325195 sec.\n Timing for FashionMNIST: https://apache-mxnet.s3-accelerate.dualstack.amazonaws.com/gluon/dataset/fashion-mnist/train-labels-idx1-ubyte.gz, DNS: 0.0127 sec, LOAD: 0.1201 sec.\n Timing for PYPI: https://pypi.python.org/pypi/pip, DNS: 0.0018 sec, LOAD: 0.0826 sec.\n Error open Conda: https://repo.continuum.io/pkgs/free/, HTTP Error 403: Forbidden, DNS finished in 0.0003726482391357422 sec.\n \n \n \t"}, "comments": {}}, "commit": {"commit_id": "c29281302f387ad703af549b1da6555d71341c8a", "commit_author": "Gerges Dib", "commitT": "2021-01-01 23:20:28+08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "python\\mxnet\\gluon\\probability\\distributions\\distribution.py", "file_new_name": "python\\mxnet\\gluon\\probability\\distributions\\distribution.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "182,183,184,185,186,187,188,189,190,192,193,194,195", "deleted_lines": "182,183,184,185,187", "method_info": {"method_name": "__repr__", "method_params": "self", "method_startline": "178", "method_endline": "199"}}}}}}}