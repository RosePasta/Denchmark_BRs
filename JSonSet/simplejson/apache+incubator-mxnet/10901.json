{"BR": {"BR_id": "10901", "BR_author": "marcoabreu", "BRopenT": "2018-05-11T08:51:09Z", "BRcloseT": "2018-05-16T17:29:13Z", "BR_text": {"BRsummary": "Broken test_sparse_operator.test_sparse_mathematical_core with scipy 1.1.0", "BRdescription": "\n Check out the latest master, build it with ci/build.py --platform ubuntu_cpu /work/runtime_functions.sh build_ubuntu_cpu_openblas.\n Run with ci/build.py --platform ubuntu_cpu /work/runtime_functions.sh unittest_ubuntu_python2_cpu.\n Happens on all configurations, no matter whether CPU or GPU etc.\n <denchmark-code>build.py: 2018-05-11 08:49:35,496 Executing: docker run --rm -t --shm-size=500m -v /home/ubuntu/mxnet-apache:/work/mxnet -v /home/ubuntu/mxnet-apache/build:/work/build -u 0:0 mxnet/build.ubuntu_cpu /work/runtime_functions.sh unittest_ubuntu_python2_cpu\n + set +x\n + export PYTHONPATH=./python/\n + PYTHONPATH=./python/\n + export MXNET_STORAGE_FALLBACK_LOG_VERBOSE=0\n + MXNET_STORAGE_FALLBACK_LOG_VERBOSE=0\n + nosetests-2.7 --verbose tests/python/unittest/test_sparse_operator.py:test_sparse_mathematical_core\n [INFO] Setting module np/mx/python random seeds, use MXNET_MODULE_SEED=1188828163 to reproduce.\n test_sparse_operator.test_sparse_mathematical_core ... [INFO] Setting test np/mx/python random seeds, use MXNET_TEST_SEED=1220244381 to reproduce.\n FAIL\n \n ======================================================================\n FAIL: test_sparse_operator.test_sparse_mathematical_core\n ----------------------------------------------------------------------\n Traceback (most recent call last):\n   File \"/usr/local/lib/python2.7/dist-packages/nose/case.py\", line 197, in runTest\n     self.test(*self.arg)\n   File \"/work/mxnet/tests/python/unittest/common.py\", line 157, in test_new\n     orig_test(*args, **kwargs)\n   File \"/work/mxnet/tests/python/unittest/test_sparse_operator.py\", line 1084, in test_sparse_mathematical_core\n     density=density, ograd_density=ograd_density)\n   File \"/work/mxnet/tests/python/unittest/test_sparse_operator.py\", line 1056, in check_mathematical_core\n     density=density, ograd_density=ograd_density)\n   File \"/work/mxnet/tests/python/unittest/test_sparse_operator.py\", line 698, in check_sparse_mathematical_core\n     assert_almost_equal(arr_grad, input_grad, equal_nan=True)\n   File \"/work/mxnet/python/mxnet/test_utils.py\", line 493, in assert_almost_equal\n     raise AssertionError(msg)\n AssertionError:\n Items are not equal:\n Error nan exceeds tolerance rtol=0.000010, atol=0.000000.  Location of maximum error:(0, 0), a=inf, b=-inf\n  a: array([[inf, inf, inf, inf, inf],\n        [inf, inf, inf, inf, inf],\n        [inf, inf, inf, inf, inf],...\n  b: array([[-inf, -inf, -inf, -inf, -inf],\n        [-inf, -inf, -inf, -inf, -inf],\n        [-inf, -inf, -inf, -inf, -inf],...\n -------------------- >> begin captured stdout << ---------------------\n ('pass', 0)\n 0.0, 0.0, False\n \n --------------------- >> end captured stdout << ----------------------\n -------------------- >> begin captured logging << --------------------\n common: INFO: Setting module np/mx/python random seeds, use MXNET_MODULE_SEED=1188828163 to reproduce.\n common: INFO: Setting test np/mx/python random seeds, use MXNET_TEST_SEED=1220244381 to reproduce.\n --------------------- >> end captured logging << ---------------------\n \n ----------------------------------------------------------------------\n Ran 1 test in 0.031s\n \n FAILED (failures=1)\n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "marcoabreu", "commentT": "2018-05-11T08:57:16Z", "comment_text": "\n \t\tThis seems to be related to the scipy version. This test breaks with scipy 1.1.0, but works with 1.0.1.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "marcoabreu", "commentT": "2018-05-11T08:58:18Z", "comment_text": "\n \t\t<denchmark-code>+ set +x\n + export PYTHONPATH=./python/\n + PYTHONPATH=./python/\n + export MXNET_STORAGE_FALLBACK_LOG_VERBOSE=0\n + MXNET_STORAGE_FALLBACK_LOG_VERBOSE=0\n + pip2 install scipy==1.0.1\n Collecting scipy==1.0.1\n   Downloading https://files.pythonhosted.org/packages/9c/0b/5deb712a9ea5bb0a1de837d04ef7625c5f3ee44efe7ed0765ceda681d7f1/scipy-1.0.1-cp27-cp27mu-manylinux1_x86_64.whl (46.7MB)\n     100% |################################| 46.7MB 974kB/s\n Requirement already satisfied: numpy>=1.8.2 in /usr/local/lib/python2.7/dist-packages (from scipy==1.0.1) (1.14.3)\n matplotlib 2.2.2 has requirement python-dateutil>=2.1, but you'll have python-dateutil 1.5 which is incompatible.\n Installing collected packages: scipy\n   Found existing installation: scipy 1.1.0\n     Uninstalling scipy-1.1.0:\n       Successfully uninstalled scipy-1.1.0\n Successfully installed scipy-1.0.1\n + pip3 install scipy==1.0.1\n Collecting scipy==1.0.1\n   Cache entry deserialization failed, entry ignored\n   Downloading https://files.pythonhosted.org/packages/51/3d/494e1a81121c12233cb2f511e31b0dae3944008c81bbfa0218ec2d0038a8/scipy-1.0.1-cp35-cp35m-manylinux1_x86_64.whl (49.6MB)\n     100% |################################| 49.7MB 1.4MB/s\n Requirement already satisfied: numpy>=1.8.2 in /usr/local/lib/python3.5/dist-packages (from scipy==1.0.1) (1.14.3)\n Installing collected packages: scipy\n   Found existing installation: scipy 1.1.0\n     Uninstalling scipy-1.1.0:\n       Successfully uninstalled scipy-1.1.0\n Successfully installed scipy-1.0.1\n + nosetests-2.7 --verbose tests/python/unittest/test_sparse_operator.py:test_sparse_mathematical_core\n [INFO] Setting module np/mx/python random seeds, use MXNET_MODULE_SEED=1319374570 to reproduce.\n test_sparse_operator.test_sparse_mathematical_core ... ok\n \n ----------------------------------------------------------------------\n Ran 1 test in 5.101s\n \n OK\n </denchmark-code>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "marcoabreu", "commentT": "2018-05-11T10:44:38Z", "comment_text": "\n \t\tDo we know the cause of this bug? <denchmark-link:https://github.com/eric-haibin-lin>@eric-haibin-lin</denchmark-link>\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "marcoabreu", "commentT": "2018-05-11T16:29:12Z", "comment_text": "\n \t\tWe saw that in our internal testing and  <denchmark-link:https://github.com/DickJC123>@DickJC123</denchmark-link>\n  made some investigation yesterday. <denchmark-link:https://github.com/DickJC123>@DickJC123</denchmark-link>\n  - could you share your findings?\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "marcoabreu", "commentT": "2018-05-11T16:40:38Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/apache/incubator-mxnet/issues/10896>#10896</denchmark-link>\n \n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "marcoabreu", "commentT": "2018-05-11T16:42:59Z", "comment_text": "\n \t\tI also filed an issue with scipy: <denchmark-link:https://github.com/scipy/scipy/issues/8819>scipy/scipy#8819</denchmark-link>\n \n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "marcoabreu", "commentT": "2018-05-16T17:29:13Z", "comment_text": "\n \t\tFixed by <denchmark-link:https://github.com/apache/incubator-mxnet/pull/10961>#10961</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "645b4c5265726efec86c07f03fd4d3f2afef1449", "commit_author": "Marco de Abreu", "commitT": "2018-05-11 10:31:04-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "ci\\docker\\install\\centos7_python.sh", "file_new_name": "ci\\docker\\install\\centos7_python.sh", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "34,35", "deleted_lines": "34,35"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "ci\\docker\\install\\ubuntu_python.sh", "file_new_name": "ci\\docker\\install\\ubuntu_python.sh", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "32,33", "deleted_lines": "32,33"}}}}}}