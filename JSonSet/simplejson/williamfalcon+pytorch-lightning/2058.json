{"BR": {"BR_id": "2058", "BR_author": "ssakhavi", "BRopenT": "2020-06-03T08:16:37Z", "BRcloseT": "2020-06-23T15:20:45Z", "BR_text": {"BRsummary": "Hydra MLFlow Clash", "BRdescription": "\n <denchmark-h:h2>\ud83d\udc1b Bug</denchmark-h>\n \n When using the MLFlow logger with Hydra, because the parameters passed to the LightningModule is a DictConfig, the condition in the logger/base.py is not met.\n \n \n \n pytorch-lightning/pytorch_lightning/loggers/base.py\n \n \n          Line 177\n       in\n       8211256\n \n \n \n \n \n \n  if isinstance(input_dict, dict): \n \n \n \n \n \n <denchmark-h:h3>To Reproduce</denchmark-h>\n \n Use Hydra and MLFlow together.\n Traceback (most recent call last):\n   File \"/home/siavash/KroniKare/kwae2/kwae_ma/models/pl_train_segmentation_model.py\", line 115, in <module>\n     main()\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/hydra/main.py\", line 24, in decorated_main\n     strict=strict,\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/hydra/_internal/utils.py\", line 174, in run_hydra\n     overrides=args.overrides,\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/hydra/_internal/hydra.py\", line 86, in run\n     job_subdir_key=None,\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/hydra/plugins/common/utils.py\", line 109, in run_job\n     ret.return_value = task_function(task_cfg)\n   File \"/home/siavash/KroniKare/kwae2/kwae_ma/models/pl_train_segmentation_model.py\", line 111, in main\n     trainer.fit(wound_seg_pl)\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 765, in fit\n     self.single_gpu_train(model)\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/pytorch_lightning/trainer/distrib_parts.py\", line 492, in single_gpu_train\n     self.run_pretrain_routine(model)\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 843, in run_pretrain_routine\n     self.logger.log_hyperparams(ref_model.hparams)\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/pytorch_lightning/loggers/base.py\", line 275, in log_hyperparams\n     [logger.log_hyperparams(params) for logger in self._logger_iterable]\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/pytorch_lightning/loggers/base.py\", line 275, in <listcomp>\n     [logger.log_hyperparams(params) for logger in self._logger_iterable]\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py\", line 10, in wrapped_fn\n     return fn(*args, **kwargs)\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/pytorch_lightning/loggers/mlflow.py\", line 105, in log_hyperparams\n     self.experiment.log_param(self.run_id, k, v)\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/mlflow/tracking/client.py\", line 206, in log_param\n     self._tracking_client.log_param(run_id, key, value)\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py\", line 177, in log_param\n     _validate_param_name(key)\n   File \"/home/siavash/anaconda3/envs/kwae-ma/lib/python3.7/site-packages/mlflow/utils/validation.py\", line 120, in _validate_param_name\n     INVALID_PARAMETER_VALUE)\n mlflow.exceptions.MlflowException: Invalid parameter name: ''. Names may be treated as files in certain cases, and must not resolve to other names when treated as such. This name would resolve to '.'\n <denchmark-h:h3>Expected behavior</denchmark-h>\n \n Check whether the instance if dict or DictConfig in the given line.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ssakhavi", "commentT": "2020-06-03T08:17:21Z", "comment_text": "\n \t\tHi! thanks for your contribution!, great first issue!\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ssakhavi", "commentT": "2020-06-03T09:35:01Z", "comment_text": "\n \t\t\n Check whether the instance if dict or DictConfig in the given line.\n \n <denchmark-link:https://github.com/ssakhavi>@ssakhavi</denchmark-link>\n  that sounds reasonable solution, mind sending a PR - fix and its test?\n \t\t"}}}, "commit": {"commit_id": "44385bb582467acaa35cd4da553b2343a7860598", "commit_author": "Siavash Sakhavi", "commitT": "2020-06-23 17:20:44+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "pytorch_lightning\\loggers\\base.py", "file_new_name": "pytorch_lightning\\loggers\\base.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "175,177", "deleted_lines": "177,179", "method_info": {"method_name": "_flatten_dict", "method_params": "str,str", "method_startline": "155", "method_endline": "186"}}, "hunk_1": {"Ismethod": 1, "added_lines": "175,177", "deleted_lines": "177,179", "method_info": {"method_name": "_flatten_dict._dict_generator", "method_params": "input_dict,prefixes", "method_startline": "173", "method_endline": "184"}}}}}}}