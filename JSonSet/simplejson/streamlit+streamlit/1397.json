{"BR": {"BR_id": "1397", "BR_author": "arnaudmiribel", "BRopenT": "2020-04-29T12:24:20Z", "BRcloseT": "2020-05-20T18:29:41Z", "BR_text": {"BRsummary": "Multiselect check for defaults goes wrong if not a list", "BRdescription": "\n <denchmark-h:h1>Summary</denchmark-h>\n \n When using st.multiselect(), there's an error being thrown out if default values are given in a tuple instead of a list. See additional info for a solution. I'm happy to do a PR if you're ok with my point.\n <denchmark-h:h1>Steps to reproduce</denchmark-h>\n \n \n Create an app.py with the following:\n \n import streamlit as st\n INTENSITIES = (\"a\", \"b\", \"c\")\n st.multiselect(\n     label=\"Choose among:\",\n     options=INTENSITIES,\n     default=INTENSITIES,\n )\n \n Now run streamlit run app.py.\n \n <denchmark-h:h2>Expected behavior:</denchmark-h>\n \n The code above should work and print the following:\n <denchmark-link:https://user-images.githubusercontent.com/7164864/80595482-1b05a800-8a25-11ea-8764-20934e347c37.png></denchmark-link>\n \n It does work if given list objects as in:\n st.multiselect(\n     label=\"Choose among:\",\n     options=list(INTENSITIES),\n     default=list(INTENSITIES),\n )\n <denchmark-h:h2>Actual behavior:</denchmark-h>\n \n Error shows:\n StreamlitAPIException: Every Multiselect default value must exist in options\n <denchmark-h:h2>Is this a regression?</denchmark-h>\n \n Not sure about this. Didn't try before.\n <denchmark-h:h1>Debug info</denchmark-h>\n \n \n Streamlit version: 0.58.0\n Python version: Python 3.6.9 :: Anaconda, Inc.\n Using Conda\n OS version: macOS Mojave 10.14.6\n Browser version: Google Chrome 81.0.4044.92\n \n <denchmark-h:h1>Additional info</denchmark-h>\n \n Code responsible seems to <denchmark-link:https://github.com/streamlit/streamlit/blob/e1431cf04523a1e8f2a32eff1e223dae20219087/lib/streamlit/DeltaGenerator.py#L1685>be here</denchmark-link>\n  when casting to list:\n <denchmark-code>if not isinstance(default_values, list):\n                 default_values = [default_values]\n </denchmark-code>\n \n Should rather be:\n <denchmark-code>if not isinstance(default_values, list):\n                 default_values = list(default_values)\n </denchmark-code>\n \n Otherwise, in the tuple case, (\"a\", \"b\", \"c\") is converted to [(\"a\", \"b\", \"c\")] hence the error.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "arnaudmiribel", "commentT": "2020-04-29T17:29:54Z", "comment_text": "\n \t\tHi <denchmark-link:https://github.com/arnaudmiribel>@arnaudmiribel</denchmark-link>\n , thanks for reporting this! It looks like this is a simple oversight/bug, so please create a PR and we'll be happy to review it.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "arnaudmiribel", "commentT": "2020-04-30T08:07:45Z", "comment_text": "\n \t\tThanks <denchmark-link:https://github.com/randyzwitch>@randyzwitch</denchmark-link>\n , PR is submitted here: <denchmark-link:https://github.com/streamlit/streamlit/pull/1401>#1401</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "78511762d15d4d032c0535c4cf406a53bb060072", "commit_author": "Arnaud", "commitT": "2020-05-07 00:52:26-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "lib\\streamlit\\DeltaGenerator.py", "file_new_name": "lib\\streamlit\\DeltaGenerator.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734", "deleted_lines": "1723", "method_info": {"method_name": "_check_and_convert_to_indices", "method_params": "options,default_values", "method_startline": "1719", "method_endline": "1742"}}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "lib\\tests\\streamlit\\multiselect_test.py", "file_new_name": "lib\\tests\\streamlit\\multiselect_test.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "118,119,120,121,122,123,124,125", "deleted_lines": null, "method_info": {"method_name": "test_default_types", "method_params": "self,defaults,expected", "method_startline": "118", "method_endline": "125"}}}}}}}