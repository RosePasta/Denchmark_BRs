{"BR": {"BR_id": "4379", "BR_author": "stellaraccident", "BRopenT": "2021-01-05T15:56:42Z", "BRcloseT": "2021-01-05T20:16:33Z", "BR_text": {"BRsummary": "[macos] MetalDriver link error", "BRdescription": "\n <denchmark-code>2021-01-05T10:44:01.0063290Z Undefined symbols for architecture x86_64:\n 2021-01-05T10:44:01.0323360Z   \"_MTLCopyAllDevices\", referenced from:\n 2021-01-05T10:44:01.0429190Z       iree::hal::metal::MetalDriver::Create(iree::hal::metal::MetalDriverOptions const&) in libiree_hal_metal_metal.a(metal_driver.mm.o)\n 2021-01-05T10:44:01.0531220Z   \"_NSLog\", referenced from:\n 2021-01-05T10:44:01.0633580Z       iree::hal::metal::MetalCaptureManager::StartCapture() in libiree_hal_metal_metal.a(metal_capture_manager.mm.o)\n 2021-01-05T10:44:01.0736390Z       iree::hal::metal::MetalKernelLibrary::Create(id<MTLDevice>, iree::hal::ExecutableCachingMode, iree::hal::ExecutableSpec const&) in libiree_hal_metal_metal.a(metal_kernel_library.mm.o)\n 2021-01-05T10:44:01.0737690Z   \"_OBJC_CLASS_$_MTLCaptureDescriptor\", referenced from:\n 2021-01-05T10:44:01.0739760Z       objc-class-ref in libiree_hal_metal_metal.a(metal_capture_manager.mm.o)\n 2021-01-05T10:44:01.0841460Z   \"_OBJC_CLASS_$_MTLCaptureManager\", referenced from:\n 2021-01-05T10:44:01.0944240Z       objc-class-ref in libiree_hal_metal_metal.a(metal_capture_manager.mm.o)\n 2021-01-05T10:44:01.1046130Z   \"_OBJC_CLASS_$_MTLCompileOptions\", referenced from:\n 2021-01-05T10:44:01.1138210Z       objc-class-ref in libiree_hal_metal_metal.a(metal_kernel_library.mm.o)\n 2021-01-05T10:44:01.1218410Z   \"_OBJC_CLASS_$_MTLSharedEventListener\", referenced from:\n 2021-01-05T10:44:01.1321230Z       objc-class-ref in libiree_hal_metal_metal.a(metal_device.mm.o)\n 2021-01-05T10:44:01.1422950Z   \"_OBJC_CLASS_$_NSString\", referenced from:\n 2021-01-05T10:44:01.1528280Z       objc-class-ref in libiree_hal_metal_metal.a(metal_capture_manager.mm.o)\n 2021-01-05T10:44:01.1632900Z       objc-class-ref in libiree_hal_metal_metal.a(metal_kernel_library.mm.o)\n 2021-01-05T10:44:01.1734720Z ld: symbol(s) not found for architecture x86_64\n 2021-01-05T10:44:01.1837450Z clang: error: linker command failed with exit code 1 (use -v to see invocation)\n </denchmark-code>\n \n A number of other warnings that may or may not be related. E.g.:\n <denchmark-code>2021-01-05T10:43:41.3757910Z /Applications/Xcode_12.2.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX11.0.sdk/System/Library/Frameworks/Metal.framework/Headers/MTLEvent.h:36:12: note: 'MTLSharedEventListener' has been marked as being introduced in macOS 10.14 here, but the deployment target is macOS 10.9.0\n 2021-01-05T10:43:41.3856470Z @interface MTLSharedEventListener : NSObject\n 2021-01-05T10:43:41.3956450Z            ^\n 2021-01-05T10:43:41.4059620Z /Users/runner/work/iree/iree/main_checkout/iree/hal/metal/metal_shared_event.mm:32:19: note: annotate 'MetalSharedEvent' with an availability attribute to silence this \n </denchmark-code>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "stellaraccident", "commentT": "2021-01-05T16:27:54Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/google/iree/pull/4366>#4366</denchmark-link>\n  may help here\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "stellaraccident", "commentT": "2021-01-05T17:10:38Z", "comment_text": "\n \t\tOh, thanks - that looks like it. I manually applied the threading_darwin fix last night. Do you want to land this or me?\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "stellaraccident", "commentT": "2021-01-05T17:17:23Z", "comment_text": "\n \t\t\n Oh, thanks - that looks like it. I manually applied the threading_darwin fix last night. Do you want to land this or me?\n \n Just dropped a comment on the PR. I'm not set up to test builds on macos myself though.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "stellaraccident", "commentT": "2021-01-05T17:24:03Z", "comment_text": "\n \t\t\n \n Oh, thanks - that looks like it. I manually applied the threading_darwin fix last night. Do you want to land this or me?\n \n Just dropped a comment on the PR. I'm not set up to test builds on macos myself though.\n \n We don't have presubmits - just postsubmits atm. So I'm inclined to apply the patch as-is and then iterate.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "stellaraccident", "commentT": "2021-01-05T17:25:12Z", "comment_text": "\n \t\tI can also break out a workflow to trigger manually for things like this. For just the runtime, runs in ~10 minutes.\n \t\t"}}}, "commit": {"commit_id": "eb184f9cc8eb1ed477fd44e7331c169d1d99e591", "commit_author": "Stella Laurenzo", "commitT": "2021-01-05 12:16:22-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "iree\\hal\\drivers\\CMakeLists.txt", "file_new_name": "iree\\hal\\drivers\\CMakeLists.txt", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "31,32,33,34,35,36,37,38,50,51,52", "deleted_lines": null}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "iree\\hal\\metal\\BUILD.bazel", "file_new_name": "iree\\hal\\metal\\BUILD.bazel", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "53,54,55,56", "deleted_lines": "53"}}}}}}