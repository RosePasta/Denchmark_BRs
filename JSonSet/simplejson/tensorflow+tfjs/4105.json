{"BR": {"BR_id": "4105", "BR_author": "ghafran", "BRopenT": "2020-10-21T17:59:46Z", "BRcloseT": "2020-12-22T01:26:06Z", "BR_text": {"BRsummary": "Uncaught (in promise) TypeError: Cannot read property 'reduce' of undefined", "BRdescription": "\n When creating a model using AutoML with Multi Classification.\n Getting this error from tensorflowjs when running\n  const model = await tf.automl.loadImageClassification('/model/model.json');\n <denchmark-code>tfjs:17 Uncaught (in promise) TypeError: Cannot read property 'reduce' of undefined\n     at e.t.transformGraph (tfjs:17)\n     at e.t.loadSync (tfjs:17)\n     at e.<anonymous> (tfjs:17)\n     at u (tfjs:17)\n     at Generator._invoke (tfjs:17)\n     at Generator.forEach.e.<computed> [as next] (tfjs:17)\n     at Um (tfjs:17)\n     at o (tfjs:17)\n </denchmark-code>\n \n html code:\n <denchmark-code><script src=\"https://unpkg.com/@tensorflow/tfjs\"></script>\n <script src=\"https://unpkg.com/@tensorflow/tfjs-automl\"></script>\n <img id=\"daisy\" src=\"test2.jpg\">\n <script>\n     async function run() {\n         const model = await tf.automl.loadImageClassification('/model/model.json');\n         const image = document.getElementById('daisy');\n         const predictions = await model.classify(image);\n         console.log(predictions);\n         // Show the resulting object on the page.\n         const pre = document.createElement('pre');\n         pre.textContent = JSON.stringify(predictions, null, 2);\n         document.body.append(pre);\n     }\n     run();\n </script>\n </denchmark-code>\n \n Model Multi-Classification, Edge, Exported for Tensorflowjs\n Nothing crazy here just a simple export and run from browser. The model works fine when deployed in GCP with \"Test&Use\".\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "ghafran", "commentT": "2020-10-21T18:09:00Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/pyu10055>@pyu10055</denchmark-link>\n  Not sure if this falls in your court :)\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "ghafran", "commentT": "2020-10-21T18:56:26Z", "comment_text": "\n \t\tJust tried this on models that were working previously. Looks like something changed during the model export or creation process on AutoML that is causing this issue.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "ghafran", "commentT": "2020-10-22T20:48:14Z", "comment_text": "\n \t\tThis seems to be fixed today. I retrained the models this morning and exported. Worked as expected. I love voodoo magic self healing :)\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "ghafran", "commentT": "2020-10-22T20:48:16Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tfjs/issues/4105>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tfjs/issues/4105>No</denchmark-link>\n \n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "ghafran", "commentT": "2020-11-22T01:27:39Z", "comment_text": "\n \t\tThis issue popped up again :(\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "ghafran", "commentT": "2020-11-23T17:08:23Z", "comment_text": "\n \t\tcc <denchmark-link:https://github.com/pyu10055>@pyu10055</denchmark-link>\n  <denchmark-link:https://github.com/tafsiri>@tafsiri</denchmark-link>\n \n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "ghafran", "commentT": "2020-11-23T22:43:31Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ghafran>@ghafran</denchmark-link>\n  can you share your model file? thanks\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "ghafran", "commentT": "2020-11-24T00:25:07Z", "comment_text": "\n \t\tAttached. Just exported it from AutoML Multi-classification using edge, faster performance.\n Getting same error.\n <denchmark-link:https://github.com/pyu10055>@pyu10055</denchmark-link>\n \n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "ghafran", "commentT": "2020-11-25T03:33:47Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/pyu10055>@pyu10055</denchmark-link>\n  thanks for posting the fix. Your a life saver!\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "ghafran", "commentT": "2020-11-25T16:22:16Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/pyu10055>@pyu10055</denchmark-link>\n  I see the fix has been completed. Can I regenerate the model now or do we need to wait for a production push?\n Thanks.\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "ghafran", "commentT": "2020-11-25T16:56:35Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tfjs/issues/4105>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tfjs/issues/4105>No</denchmark-link>\n \n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "ghafran", "commentT": "2020-11-30T18:40:45Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/pyu10055>@pyu10055</denchmark-link>\n  This issues still seems to be happening. Do we know when the fix will be deployed?\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "ghafran", "commentT": "2020-12-01T04:08:19Z", "comment_text": "\n \t\tEven I am also facing the same issue :(\n The model I exported about 3 weeks ago is working perfectly fine but the model I exported yesterday is not working and showing the error \"cannot read property reduce of undefined\" :(\n \t\t"}, "comments_13": {"comment_id": 14, "comment_author": "ghafran", "commentT": "2020-12-02T13:34:00Z", "comment_text": "\n \t\tOur customers are getting agitated. Do have an estimate of when this will be pushed?\n \t\t"}, "comments_14": {"comment_id": 15, "comment_author": "ghafran", "commentT": "2020-12-02T17:37:17Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ghafran>@ghafran</denchmark-link>\n  The fix will be available in the next release, but meanwhile you can lock your tfjs version to 2.6.0, that should temporarily solve your problem.\n \t\t"}, "comments_15": {"comment_id": 16, "comment_author": "ghafran", "commentT": "2020-12-02T17:52:42Z", "comment_text": "\n \t\tI think I found a solution\n In your model.json file just remove this line:-\n \"modelInitializer\": {\"versions\": {}},.\n <denchmark-link:https://github.com/ghafran>@ghafran</denchmark-link>\n   so here is the modified model.json\n <denchmark-link:https://github.com/tensorflow/tfjs/files/5631115/model_json.zip>model_json.zip</denchmark-link>\n \n Replace your model.json with the above file\n So, this should work even with the latest tfjs version\n \t\t"}, "comments_16": {"comment_id": 17, "comment_author": "ghafran", "commentT": "2020-12-02T17:59:18Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/Vivek1907>@Vivek1907</denchmark-link>\n  that work around fixes it! Thank you!\n \t\t"}, "comments_17": {"comment_id": 18, "comment_author": "ghafran", "commentT": "2020-12-02T18:26:00Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/Vivek1907>@Vivek1907</denchmark-link>\n  Worked for me too. Thanks!\n \t\t"}, "comments_18": {"comment_id": 19, "comment_author": "ghafran", "commentT": "2020-12-22T01:26:05Z", "comment_text": "\n \t\tJust trained, exported, and ran the models with latest versions. All is good now.\n \t\t"}, "comments_19": {"comment_id": 20, "comment_author": "ghafran", "commentT": "2020-12-22T01:26:07Z", "comment_text": "\n \t\tAre you satisfied with the resolution of your issue?\n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=Yes&entry.2137816233=https://github.com/tensorflow/tfjs/issues/4105>Yes</denchmark-link>\n \n <denchmark-link:https://docs.google.com/forms/d/e/1FAIpQLSfaP12TRhd9xSxjXZjcZFNXPGk4kc1-qMdv3gc6bEP90vY1ew/viewform?entry.85265664=No&entry.2137816233=https://github.com/tensorflow/tfjs/issues/4105>No</denchmark-link>\n \n \t\t"}, "comments_20": {"comment_id": 21, "comment_author": "ghafran", "commentT": "2020-12-22T20:44:15Z", "comment_text": "\n \t\tDoes anyone here have any insight about the problem described at the bottom of this stackoverflow post: <denchmark-link:https://stackoverflow.com/questions/65402617/tensorflow-automl-model-in-react>https://stackoverflow.com/questions/65402617/tensorflow-automl-model-in-react</denchmark-link>\n \n \t\t"}}}, "commit": {"commit_id": "630effd27e1105a35cec52714e44665a602a2337", "commit_author": "Ping Yu", "commitT": "2020-11-25 08:56:33-08:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "tfjs-converter\\src\\executor\\graph_model.ts", "file_new_name": "tfjs-converter\\src\\executor\\graph_model.ts", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "164,165", "deleted_lines": "164", "method_info": {"method_name": "loadSync", "method_params": "ModelArtifacts", "method_startline": "138", "method_endline": "178"}}}}}}}