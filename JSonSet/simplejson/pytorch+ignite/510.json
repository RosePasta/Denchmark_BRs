{"BR": {"BR_id": "510", "BR_author": "philip-bl", "BRopenT": "2019-05-01T21:40:23Z", "BRcloseT": "2019-05-02T13:45:11Z", "BR_text": {"BRsummary": "dcgan.py: `df.plot(x=np.array([1, 101, 201]))` doesn't work", "BRdescription": "\n Line <denchmark-link:https://github.com/pytorch/ignite/blob/master/examples/gan/dcgan.py#L393>https://github.com/pytorch/ignite/blob/master/examples/gan/dcgan.py#L393</denchmark-link>\n  fails with an error,saying that nothing in  is in  (or something like that). To fix it, set index of the dataframe instead of passing  argument.\n Replace this:\n df = pd.read_csv(os.path.join(output_dir, LOGS_FNAME), delimiter='\\t')\n x = np.arange(1, engine.state.iteration + 1, PRINT_FREQ)\n _ = df.plot(x=x, subplots=True, figsize=(20, 20))\n with this\n df = pd.read_csv(os.path.join(output_dir, LOGS_FNAME), delimiter='\\t') \\\n     .set_index(np.arange(1, engine.state.iteration + 1, PRINT_FREQ))\n _ = df.plot(subplots=True, figsize=(20, 20))\n My python version is 3.7, pandas is 0.24.2.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "philip-bl", "commentT": "2019-05-01T21:48:48Z", "comment_text": "\n \t\tI have tested that the modified file works by running dcgan.py to completion on lfw dataset once.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "philip-bl", "commentT": "2019-05-01T21:55:10Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/philip-bl>@philip-bl</denchmark-link>\n  yes, I reproduce the problem too. However, I would prefer to improve the written  file. Currently, it looks like\n <denchmark-code>errD    errG    D_x     D_G_z1  D_G_z2\n 1.65096 6.79936 0.66887 0.63026 0.00156\n 0.58172 13.08555        0.85667 0.18992 0.00104\n 0.5255  6.71655 0.83787 0.16335 0.01601\n 0.45577 7.49637 0.8753  0.11774 0.00778\n 0.22892 7.91881 0.92359 0.07014 0.00368\n 0.36326 6.71926 0.89081 0.10043 0.0104\n 0.44686 5.09332 0.85201 0.13819 0.03282\n 0.74268 4.46701 0.78121 0.21232 0.06204\n </denchmark-code>\n \n and we have no idea on which iteration we have logged data. IMO it worth to add iteration at the first column iteration and while loading the csv set index to iteration column... What do you think ?\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "philip-bl", "commentT": "2019-05-01T22:03:04Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/vfdev-5>@vfdev-5</denchmark-link>\n  Yes, that sounds better. Just to be clear, I don't want to do be the person responsible for implementing that change.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "philip-bl", "commentT": "2019-05-01T22:04:38Z", "comment_text": "\n \t\tIt's not a big deal as change :) But as you wish. Anyway thanks for reporting.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "philip-bl", "commentT": "2019-05-01T22:12:59Z", "comment_text": "\n \t\tActually scratch that. This fixes it:\n <denchmark-code>1,2d0\n <\n <\n 328,329c326,327\n <             columns = list(engine.state.metrics.keys())\n <             values = [str(round(value, 5)) for value in list(engine.state.metrics.values())]\n ---\n >             columns = [\"iteration\"] + list(engine.state.metrics.keys())\n >             values = [str(engine.state.iteration)] + [str(round(value, 5)) for value in list(engine.state.metrics.values())]\n 391,392c389\n <             df = pd.read_csv(os.path.join(output_dir, LOGS_FNAME), delimiter='\\t') \\\n <                 .set_index(np.arange(1, engine.state.iteration + 1, PRINT_FREQ))\n ---\n >             df = pd.read_csv(os.path.join(output_dir, LOGS_FNAME), delimiter='\\t', index_col=\"iteration\")\n </denchmark-code>\n \n Have tested that it works by running on lfw once. Apply this patch AFTER applying the changes I suggested in the original post.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "philip-bl", "commentT": "2019-05-01T22:15:00Z", "comment_text": "\n \t\tAlso I wonder if there's a good reason why this script implements tsv formatting on its own instead of using csv.writer.\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "philip-bl", "commentT": "2019-05-01T22:16:12Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/philip-bl>@philip-bl</denchmark-link>\n  you still do not want to send a PR with a better code ? :)\n \n Also I wonder if there's a good reason why this script implements tsv formatting on its own instead of using csv.writer.\n \n I would say no reason. If you can improve it, go ahead !\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "philip-bl", "commentT": "2019-05-01T22:28:09Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/vfdev-5>@vfdev-5</denchmark-link>\n  Not really. Overhead of doing , setting up remote repositories, applying patch there, pushing, creating a PR - it's too much.\n \t\t"}}}, "commit": {"commit_id": "ec881241ed716fc7127c3818a8c997ab2f6e1155", "commit_author": "vfdev", "commitT": "2019-05-02 06:45:10-07:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": ".travis.yml", "file_new_name": ".travis.yml", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "41", "deleted_lines": "41"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "examples\\gan\\dcgan.py", "file_new_name": "examples\\gan\\dcgan.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "328,329,330", "deleted_lines": "328,329", "method_info": {"method_name": "print_logs", "method_params": "engine", "method_startline": "325", "method_endline": "344"}}, "hunk_1": {"Ismethod": 1, "added_lines": "392,393", "deleted_lines": "391,392,393", "method_info": {"method_name": "create_plots", "method_params": "engine", "method_startline": "379", "method_endline": "398"}}}}}}}