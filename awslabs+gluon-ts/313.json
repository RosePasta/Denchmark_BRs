{"BR": {"BR_id": "313", "BR_author": "lotsoffood", "BRopenT": "2019-09-15T22:14:49Z", "BRcloseT": "2019-09-17T12:15:34Z", "BR_text": {"BRsummary": "Can't load a serialized predictor and utilize the GPU", "BRdescription": "\n <denchmark-h:h2>Description</denchmark-h>\n \n I trained a model with , and saved the resulting . Using directions from the documentation, I get the error described in <denchmark-link:https://github.com/awslabs/gluon-ts/issues/213>#213</denchmark-link>\n .\n If I run the code mentioned in the above issue, the predictor loads, but only predicts using the CPU. Setting ctx='gpu' in the code below results in the same error, and therefore I'm unable to save a trained model and load it back while being able to retain the ability to predict with the GPU.\n <denchmark-code>predictor = RepresentableBlockPredictor.deserialize(Path(\"models/\"))\n predictor.ctx = mx.Context('cpu')\n </denchmark-code>\n \n <denchmark-h:h2>To Reproduce</denchmark-h>\n \n Same as described here: <denchmark-link:https://github.com/awslabs/gluon-ts/issues/213>#213</denchmark-link>\n \n <denchmark-h:h2>Error Message</denchmark-h>\n \n RuntimeError: Parameter 'deeparpredictionnetwork0_featureembedder0_cat_0_embedding_weight' was not initialized on context gpu(0). It was only initialized on [cpu(0)].\n Any thoughts on being able to save out a predictor object, and load it back in and still be able to utilize GPU acceleration for inference?\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "lotsoffood", "commentT": "2019-09-16T08:12:25Z", "comment_text": "\n \t\tCan you try\n with mx.Context(mx.gpu(0)):\n     predictor = Predictor.deserialize(Path(model_dir))\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "lotsoffood", "commentT": "2019-09-16T12:59:51Z", "comment_text": "\n \t\tThis works - INFO:root:Using GPU when the model is loaded, and it looks like it is using the GPU for predictions. Thank you!\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "lotsoffood", "commentT": "2019-09-17T12:15:34Z", "comment_text": "\n \t\tClosing since this was also properly addressed in <denchmark-link:https://github.com/awslabs/gluon-ts/pull/318>#318</denchmark-link>\n  -- <denchmark-link:https://github.com/lotsoffood>@lotsoffood</denchmark-link>\n  feel free to ask further question, or reopen the issue if the problem persists!\n \t\t"}}}, "commit": {"commit_id": "515c45cb4ad52362b73abd389a979cd3c1e2e1d6", "commit_author": "Valentin Flunkert", "commitT": "2019-09-16 23:40:40+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "src\\gluonts\\model\\predictor.py", "file_new_name": "src\\gluonts\\model\\predictor.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "518,519,535", "deleted_lines": "518,519,535,542,543", "method_info": {"method_name": "deserialize", "method_params": "cls,Path,None", "method_startline": "518", "method_endline": "543"}}, "hunk_1": {"Ismethod": 1, "added_lines": "114,115", "deleted_lines": "114,115", "method_info": {"method_name": "deserialize", "method_params": "cls,Path,None", "method_startline": "114", "method_endline": "115"}}, "hunk_2": {"Ismethod": 1, "added_lines": "119,120,121,122,123,124,125,126,127,128,129,130", "deleted_lines": "119,120,121,122,123,124,125,126,127,137", "method_info": {"method_name": "deserialize", "method_params": "cls,Path", "method_startline": "119", "method_endline": "137"}}, "hunk_3": {"Ismethod": 1, "added_lines": "109,110,111", "deleted_lines": "109,110,111", "method_info": {"method_name": "serialize", "method_params": "self,Path", "method_startline": "108", "method_endline": "111"}}}}}}}