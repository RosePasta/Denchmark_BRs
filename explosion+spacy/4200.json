{"BR": {"BR_id": "4200", "BR_author": "phayllia", "BRopenT": "2019-08-26T22:08:51Z", "BRcloseT": "2019-09-09T14:32:33Z", "BR_text": {"BRsummary": "text color dont working after spacy in jupyter notebook", "BRdescription": "\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n In a new jupyter notebook, print '\\033[34mtest\\033[0m' produces the text in blue as expected.\n \n \n import spacy\n print '\\033[34mtest\\033[0m'\n After importing, the text color print doesn't work anymore\n \n \n <denchmark-h:h2>Your Environment</denchmark-h>\n \n \n Operating System: Windows\n Python Version Used: 2.7\n spaCy Version Used: 2.0.9\n Environment Information:\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "phayllia", "commentT": "2019-08-27T08:06:08Z", "comment_text": "\n \t\tYes, I can confirm that this happens indeed (also with Python 3); Something in the  installation is preventing the color to print. <denchmark-link:https://github.com/ines>@ines</denchmark-link>\n  : any idea why this happens?\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "phayllia", "commentT": "2019-08-27T08:35:23Z", "comment_text": "\n \t\tJust testing it \u2013 I really hope this won't be too difficult to track down. The thing is, this could happen in any dependency. In spaCy and our libraries, we typically avoid setting anything in the global scope (and of course never monkeypatch built-ins) for reasons like this.\n The most related dependency is my package <denchmark-link:https://github.com/ines/wasabi>wasabi</denchmark-link>\n , but it shouldn't be doing anything on import \n Edit: I can't seem to reproduce this? Running the lastest version in a notebook on Python 3.6.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "phayllia", "commentT": "2019-08-27T08:42:24Z", "comment_text": "\n \t\tHere I'm using Python 3.7.0 on a windows:\n <denchmark-link:https://user-images.githubusercontent.com/8796347/63755653-590b6480-c8b7-11e9-9cc1-6a415c7f6e6b.png></denchmark-link>\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "phayllia", "commentT": "2019-08-27T08:44:04Z", "comment_text": "\n \t\tI can take this on if you can't reproduce!\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "phayllia", "commentT": "2019-08-27T08:48:04Z", "comment_text": "\n \t\tAhh, maybe it's a Windows thing? Okay, here are some things to try:\n import wasabi\n print(\"\\033[34mtest\\033[0m\")\n If the above works fine:\n from wasabi import Printer\n msg = Printer()\n print(\"\\033[34mtest\\033[0m\")\n If those work, it's most likely not in wasabi where we actually handle the related printing stuff.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "phayllia", "commentT": "2019-08-27T08:49:50Z", "comment_text": "\n \t\tIt's not wasabi  - the color stays blue. Let me try out a few other spaCy dependencies ;-)\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "phayllia", "commentT": "2019-08-27T08:50:30Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/phayllia>@phayllia</denchmark-link>\n  : are you running this on a Windows?\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "phayllia", "commentT": "2019-08-27T08:53:13Z", "comment_text": "\n \t\t(Sorry, misclicked!) Thanks for checking. And damn, I was hoping it'd be wasabi, since it's a super small zero-dependency codebase and ours, so it would have been easy to resolve. Still hope it's in one of our dependencies so we can just fix it, and not in a third-party package.\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "phayllia", "commentT": "2019-08-27T09:01:04Z", "comment_text": "\n \t\tI can't pin it on one of the dependencies :(\n \t\t"}, "comments_9": {"comment_id": 10, "comment_author": "phayllia", "commentT": "2019-08-27T09:08:06Z", "comment_text": "\n \t\tDamn... so if none of the dependencies have an impact at import, I guess next would be to check what spaCy creates in the global scope and what runs when you import spacy. Luckily, all the language data is out because that's lazy-loaded. And there shouldn't be that much, because we really try to avoid it.\n \t\t"}, "comments_10": {"comment_id": 11, "comment_author": "phayllia", "commentT": "2019-09-09T09:54:50Z", "comment_text": "\n \t\tAfter first thoroughly inspecting spaCy's codebase, I finally found the root cause somewhere else: not a direct dependency of spaCy but a standard Python package .... tqdm !\n <denchmark-link:https://user-images.githubusercontent.com/8796347/64521358-253d2f80-d2f8-11e9-85b3-d002a8a5c1ce.png></denchmark-link>\n \n The relevant issue is here: <denchmark-link:https://github.com/tqdm/tqdm/issues/678>tqdm/tqdm#678</denchmark-link>\n  - not fixed yet. I would suggest upvoting it.\n \t\t"}, "comments_11": {"comment_id": 12, "comment_author": "phayllia", "commentT": "2019-09-09T10:00:29Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/ines>@ines</denchmark-link>\n : we're only using  in the ,  and  scripts. We could import it within the functions to potentially fix this bug?\n \t\t"}, "comments_12": {"comment_id": 13, "comment_author": "phayllia", "commentT": "2019-09-09T11:25:37Z", "comment_text": "\n \t\tHa, I knew it'd be something along those lines! Thanks for tracking this down.\n \n We could import it within the functions to potentially fix this bug?\n \n Yes, that sounds like an okay workaround for now. Maybe just add a quick inline comment pointing to this issue \u2013 and then we just need to remember to change it back once the problem is resolved.\n \t\t"}, "comments_13": {"comment_id": 14, "comment_author": "phayllia", "commentT": "2019-10-09T14:42:55Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "482c7cd1b94d9fab299635bc9ee12d8b31b8706a", "commit_author": "Sofie Van Landeghem", "commitT": "2019-09-09 16:32:11+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "bin\\ud\\ud_run_test.py", "file_new_name": "bin\\ud\\ud_run_test.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": null, "deleted_lines": "8"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "bin\\ud\\ud_train.py", "file_new_name": "bin\\ud\\ud_train.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "464,465,466", "deleted_lines": "8"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "examples\\training\\conllu.py", "file_new_name": "examples\\training\\conllu.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "395,396,397", "deleted_lines": null, "method_info": {"method_name": "main", "method_params": "ud_dir,parses_dir,config,corpus,limit", "method_startline": "394", "method_endline": "434"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 2, "file_old_name": "examples\\training\\pretrain_textcat.py", "file_new_name": "examples\\training\\pretrain_textcat.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "109,110,111", "deleted_lines": null, "method_info": {"method_name": "train_tensorizer", "method_params": "nlp,texts,dropout,n_iter", "method_startline": "108", "method_endline": "121"}}, "hunk_1": {"Ismethod": 1, "added_lines": "125,126,127", "deleted_lines": null, "method_info": {"method_name": "train_textcat", "method_params": "nlp,n_texts,n_iter", "method_startline": "124", "method_endline": "162"}}}}, "file_4": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "examples\\vectors_tensorboard.py", "file_new_name": "examples\\vectors_tensorboard.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "38,39,40", "deleted_lines": null, "method_info": {"method_name": "main", "method_params": "vectors_loc,out_loc,name", "method_startline": "37", "method_endline": "103"}}}}, "file_5": {"file_change_type": "MODIFY", "file_Nmethod": 4, "file_old_name": "spacy\\cli\\init_model.py", "file_new_name": "spacy\\cli\\init_model.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "210,211,212", "deleted_lines": null, "method_info": {"method_name": "read_freqs", "method_params": "freqs_loc,max_length,min_doc_freq,min_freq", "method_startline": "209", "method_endline": "238"}}, "hunk_1": {"Ismethod": 1, "added_lines": "191,192,193", "deleted_lines": null, "method_info": {"method_name": "read_vectors", "method_params": "vectors_loc", "method_startline": "190", "method_endline": "206"}}, "hunk_2": {"Ismethod": 1, "added_lines": "111,112,113", "deleted_lines": null, "method_info": {"method_name": "read_attrs_from_deprecated", "method_params": "freqs_loc,clusters_loc", "method_startline": "110", "method_endline": "138"}}, "hunk_3": {"Ismethod": 1, "added_lines": "242,243,244", "deleted_lines": null, "method_info": {"method_name": "read_clusters", "method_params": "clusters_loc", "method_startline": "241", "method_endline": "270"}}}}, "file_6": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\cli\\profile.py", "file_new_name": "spacy\\cli\\profile.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "50,51,52", "deleted_lines": null, "method_info": {"method_name": "parse_texts", "method_params": "nlp,texts", "method_startline": "49", "method_endline": "54"}}}}, "file_7": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\cli\\train.py", "file_new_name": "spacy\\cli\\train.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "396,397,398", "deleted_lines": null, "method_info": {"method_name": "_create_progress_bar", "method_params": "total", "method_startline": "395", "method_endline": "403"}}}}}}}