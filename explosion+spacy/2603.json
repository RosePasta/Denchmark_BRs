{"BR": {"BR_id": "2603", "BR_author": "pommedeterresautee", "BRopenT": "2018-07-26T15:44:04Z", "BRcloseT": "2019-02-27T10:19:02Z", "BR_text": {"BRsummary": "Documentation of missing value (NER)", "BRdescription": "\n Hi,\n In the documentation, it s said that it is possible for NER to have a token with \"missing value\".\n In this case, loss is not applied on the token.\n In the documentation it is said that it will happen when offset doesn't match a word boundary.\n However it is not said how, as a user, we can declare ourself a token as missing value, for instance because we know there is a risk this token is part of an entity but we are not sure.\n In particular, when declaring offset directly as a tuple?\n Can you please complete the documentation on this point?\n <denchmark-h:h2>Which page or section is this issue related to?</denchmark-h>\n \n <denchmark-link:https://spacy.io/usage/linguistic-features>https://spacy.io/usage/linguistic-features</denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "pommedeterresautee", "commentT": "2018-08-05T14:32:46Z", "comment_text": "\n \t\tHey,\n There's a way to do this, but the API around it isn't quite perfect. There's two ways to specify the NER labels: either as (start, end, label) offsets, or as the BILUO tags for each token. If you use the BILUO tags, you can set some values to None to indicate the value is missing. There's no equivalent way to do this with the tuples, unfortunately.\n You can also write the None values to the gold.ner list after creating the GoldParse object.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "pommedeterresautee", "commentT": "2018-08-05T15:29:11Z", "comment_text": "\n \t\tJust to confirm, you say that in biluo annotations, unknown tag is None. I ask because I have noticed that when offsets are wrong (because not matching word boundaries) spacy use \"-\" to indicate unknown entity. \"-\" is the same as None for spacy?\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "pommedeterresautee", "commentT": "2018-08-07T09:34:21Z", "comment_text": "\n \t\tThis is a bit inconsistent in spaCy unfortunately, and I'm always going back and rechecking it myself to be honest. In the early days I had a few different ways to indicate missing values, but I've been trying to standardise on None as the right way to do it, as we've been steadily trying to improve the API around the GoldParse class and the data formats in general.\n I expect None to work, and it'll be the recommended way going forward. If it seems to not, please do let me know and I'll try to fix that.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "pommedeterresautee", "commentT": "2018-08-07T22:33:44Z", "comment_text": "\n \t\tI think there is a bug when the first item is None.\n from spacy.gold import GoldParse\n # other import\n ...\n # build empty Spacy French model (internal function of this project)\n nlp = get_empty_model(load_labels_for_training=True)\n doc: Doc = nlp.make_doc(\"Ceci est un test.\")\n # works\n GoldParse(doc, entities=['O', 'O', 'O', 'O'])\n # works\n GoldParse(doc, entities=['O', 'O', 'O', None, 'O'])\n # crash\n GoldParse(doc, entities=[None, 'O', 'O', 'O', 'O'])\n Traceback (most recent call last):\n   File \"<input>\", line 1, in <module>\n   File \"gold.pyx\", line 422, in spacy.gold.GoldParse.__init__\n   File \"gold.pyx\", line 524, in spacy.gold.biluo_tags_from_offsets\n TypeError: 'NoneType' object is not iterable\n I know - doesn't crash in my code.\n If I use it, is it assimilated to 'O' tag or to unknown tag?\n FYI, I m using v2.0.12\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "pommedeterresautee", "commentT": "2019-02-24T21:25:04Z", "comment_text": "\n \t\tJust looking at this again sorry. I think you're right and there's a bug here. We have:\n <denchmark-code>462         elif not isinstance(entities[0], basestring):\n </denchmark-code>\n \n Which will fail if None is provided as the first value. I think the implementation is easier if all the values are strings, but the API is better if we pass None. So a good solution is probably to translate the None values into - or '' internally near the start of the function.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "pommedeterresautee", "commentT": "2019-03-29T10:42:42Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "f1d77eb14037676b92c63928ca01ac92d1d46992", "commit_author": "Matthew Honnibal", "commitT": "2019-02-27 12:06:32+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\gold.pyx", "file_new_name": "spacy\\gold.pyx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "459,462,463,464,465,466,467,468", "deleted_lines": "459,462,463,464"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\syntax\\ner.pyx", "file_new_name": "spacy\\syntax\\ner.pyx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "144", "deleted_lines": "144"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 1, "file_old_name": "spacy\\tests\\test_gold.py", "file_new_name": "spacy\\tests\\test_gold.py", "hunks": {"hunk_0": {"Ismethod": 1, "added_lines": "66,67,68,69", "deleted_lines": null, "method_info": {"method_name": "test_gold_ner_missing_tags", "method_params": "en_tokenizer", "method_startline": "66", "method_endline": "69"}}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "website\\docs\\api\\goldparse.md", "file_new_name": "website\\docs\\api\\goldparse.md", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "24", "deleted_lines": "24"}}}}}}