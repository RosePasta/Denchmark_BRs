{"BR": {"BR_id": "4538", "BR_author": "kabirkhan", "BRopenT": "2019-10-28T04:50:34Z", "BRcloseT": "2019-10-28T15:16:53Z", "BR_text": {"BRsummary": "Backport memory leak fix to patch spacy 2.0 and 2.1", "BRdescription": "\n <denchmark-h:h2>Feature description</denchmark-h>\n \n My team (and I assume a lot of other companies) are using spacy 2.0 and 2.1 in various places. We have A LOT of trained models in spacy 2.0 and 2.1. It would be great to have the fix <denchmark-link:https://github.com/adrianeboyd>@adrianeboyd</denchmark-link>\n  made here <denchmark-link:https://github.com/explosion/spaCy/pull/4486>#4486</denchmark-link>\n  for the memory leak ported back to the older versions as well since it's a really small change with a pretty huge impact.\n i.e. It's much easier to upgrade to spacy 2.1.9 from 2.1.8 rather than 2.2.2 and retrain all the models we have.\n Thanks!\n And not sure this counts as a feature request but didn't seem like a bug either haha.\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "kabirkhan", "commentT": "2019-10-28T08:29:08Z", "comment_text": "\n \t\tIt would be easy to backport this to 2.1. I'm less sure about 2.0 but I will look into it.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "kabirkhan", "commentT": "2019-10-28T08:49:03Z", "comment_text": "\n \t\tI had to double-check to be sure, but 2.0 is not affected by this bug. A quick analysis didn't find any similar memory leaks in 2.0.\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "kabirkhan", "commentT": "2019-10-28T11:19:40Z", "comment_text": "\n \t\tHere's a v2.1.x branch that we can add this to and release from: <denchmark-link:https://github.com/explosion/spaCy/tree/v2.1.x>https://github.com/explosion/spaCy/tree/v2.1.x</denchmark-link>\n \n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "kabirkhan", "commentT": "2019-10-28T11:20:56Z", "comment_text": "\n \t\tDefinitely happy to support this. Do you see any other patches you want while you're there?\n Btw, a feature we haven't really advertised, but might be helpful for you: if you type \"make\" in the repo you'll get a dist/spacy.pex file. This is an executable that only depends on the Python interpreter on the system. When you run it it basically unzips a virtualenv and runs it --- it's like a jar file. So if you're using spaCy's CLI, it's a nice way to deploy.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "kabirkhan", "commentT": "2019-10-28T15:16:53Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/kabirkhan>@kabirkhan</denchmark-link>\n  See <denchmark-link:https://github.com/explosion/spaCy/pull/4542>#4542</denchmark-link>\n . v2.1.9 should be up soon \u2013 just building the sdist and wheels \n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "kabirkhan", "commentT": "2019-10-28T17:17:43Z", "comment_text": "\n \t\t...meant to comment here not the PR:\n Haha, our time difference is pretty evident here. Thank you all for the quick responses and for getting this out. Really appreciate the fast turnaround!\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "kabirkhan", "commentT": "2019-11-27T17:55:26Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "d677f89c81d05adf4bead39806a95e08addbb1a0", "commit_author": "adrianeboyd", "commitT": "2019-10-28 16:15:26+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "requirements.txt", "file_new_name": "requirements.txt", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "18", "deleted_lines": "18"}}}, "file_1": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\syntax\\_parser_model.pxd", "file_new_name": "spacy\\syntax\\_parser_model.pxd", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "39,40,41", "deleted_lines": "39"}}}, "file_2": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\syntax\\_parser_model.pyx", "file_new_name": "spacy\\syntax\\_parser_model.pyx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "65,66,67,68,69,70,71,72,73,74,75,76,77,78,79", "deleted_lines": null}}}, "file_3": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\syntax\\nn_parser.pyx", "file_new_name": "spacy\\syntax\\nn_parser.pyx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "30,31,310,324", "deleted_lines": "30,309,310"}}}}}}