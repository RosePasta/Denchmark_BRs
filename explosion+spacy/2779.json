{"BR": {"BR_id": "2779", "BR_author": "imaurer", "BRopenT": "2018-09-20T11:39:07Z", "BRcloseT": "2018-12-19T01:15:06Z", "BR_text": {"BRsummary": "EntityRuler throws Segmentation Fault in complex pattern case", "BRdescription": "\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n import spacy\n nlp = spacy.load(\"en_core_web_lg\")\n ruler = nlp.create_pipe('entity_ruler')\n nlp.add_pipe(ruler, before=\"ner\")\n ruler.add_patterns([{\"label\": \"PRODUCT\", \"pattern\": [{\"lower\": \"arial\"}, {\"lower\": \"(\"}, {\"lower\": \"ab987\"}, {\"lower\": \")\"}, {\"lower\": \"foo\"}, {\"lower\": \"bar\"}, {\"lower\": \"baz\"}, {\"lower\": \"boo\"}]}])\n nlp(\"Arial (ab987) foo bar baz boo\")\n Results in:Segmentation fault: 11\n <denchmark-h:h2>Your Environment</denchmark-h>\n \n \n Operating System: Mac OS X (10.13.6)\n Python Version Used: 3.6.6\n spaCy Version Used: 2.1.0a1\n Environment Information: built from commit 1759abf on develop branch\n \n Related to Issue <denchmark-link:https://github.com/explosion/spaCy/pull/2513>#2513</denchmark-link>\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "imaurer", "commentT": "2018-09-20T11:50:39Z", "comment_text": "\n \t\tThanks a lot \u2013 also for testing the entity ruler with a real-world use case! This is really helpful. I suspect this case might have something to do with how the entity recognizer handles existing entities in this particular case.\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "imaurer", "commentT": "2018-10-03T18:47:47Z", "comment_text": "\n \t\tHi,\n I too am getting a segmentation fault on this example (which is a common pattern we are using). (I just installed the nightly build using pip install spacy-nightly)\n <denchmark-code>import spacy\n nlp = spacy.load(\"en_core_web_lg\")\n ruler = nlp.create_pipe('entity_ruler')\n nlp.add_pipe(ruler, before=\"ner\")\n ruler.add_patterns([{\"label\": \"Age\", \"pattern\":[{\"IS_DIGIT\":True},{\"LOWER\":\"years\"}]}])\n nlp(\"10 years\")\n </denchmark-code>\n \n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "imaurer", "commentT": "2018-12-19T01:15:06Z", "comment_text": "\n \t\tThanks for the report! Fixed on develop now. Will be out in the next nightly.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "imaurer", "commentT": "2019-01-18T01:57:33Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "e24f94ce3942f4055514b30df8e05095cd8b5fb6", "commit_author": "Matthew Honnibal", "commitT": "2018-12-19 02:13:31+01:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\syntax\\nn_parser.pyx", "file_new_name": "spacy\\syntax\\nn_parser.pyx", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "245,246,247,248,249,265,266,267,268,269,431,432,433,434,435", "deleted_lines": "244,260,426"}}}}}}