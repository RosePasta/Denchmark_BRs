{"BR": {"BR_id": "5799", "BR_author": "fcggamou", "BRopenT": "2020-07-22T14:30:08Z", "BRcloseT": "2020-07-24T07:26:27Z", "BR_text": {"BRsummary": "\"cudaErrorInvalidDevice: invalid device ordinal\" when attempting to pretrain", "BRdescription": "\n <denchmark-h:h2>How to reproduce the behaviour</denchmark-h>\n \n When trying to pretrain a model using the CLI pretrain command, I'm getting the following error:\n cupy.cuda.runtime.CUDARuntimeError: cudaErrorInvalidDevice: invalid device ordinal\n The command I'm running is:\n !python -m spacy pretrain \"train.jsonl\" 'es_core_news_md' 'pre_trained' -i=1\n I think it's totally unrelated to my data.\n <denchmark-h:h2>Your Environment</denchmark-h>\n \n I'm working on Google Colab.\n \n spaCy version: 2.3.2\n Platform: Linux-4.19.104+-x86_64-with-Ubuntu-18.04-bionic\n Python version: 3.6.9\n \n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "fcggamou", "commentT": "2020-07-23T11:46:41Z", "comment_text": "\n \t\tThanks for the report! I think this accidentally got hard-coded in some of the experimental updates for v2.3.2. We'll fix it for the next patch release of spacy v2.3.\n In the meanwhile, you can find this line in spacy/cli/pretrain.py and edit it to take out gpu_id=1 or provide the right ID:\n \n \n \n spaCy/spacy/cli/pretrain.py\n \n \n          Line 128\n       in\n       6d4d5c0\n \n \n \n \n \n \n  has_gpu = prefer_gpu(gpu_id=1) \n \n \n \n \n \n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "fcggamou", "commentT": "2020-08-19T12:19:30Z", "comment_text": "\n \t\tFor others stuck on this, until the v2.3.3 patch is released, this solved my problem:\n pip install -U spacy==2.3.1\n \t\t"}}}, "commit": {"commit_id": "19dc42776af33ee209c256c739303f27aa458144", "commit_author": "Adriane Boyd", "commitT": "2020-07-24 09:26:26+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\cli\\pretrain.py", "file_new_name": "spacy\\cli\\pretrain.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "128", "deleted_lines": "128"}}}}}}