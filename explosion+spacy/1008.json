{"BR": {"BR_id": "1008", "BR_author": "xiapoy", "BRopenT": "2017-04-23T13:39:43Z", "BRcloseT": "2017-06-05T23:49:21Z", "BR_text": {"BRsummary": "Error when using spacy CLI train command", "BRdescription": "\n I tried to train a tagger and parser using the spacy CLI train command:\n python -m spacy train <lang> . <lang>-train.json --no-ner\n The script breaks at the end of the training; here is the output:\n Itn.\tN weight\tN feats\tUAS\tNER F.\tTag %\tToken %\n 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1455/1455 [01:11<00:00, 20.37it/s]\n Traceback (most recent call last):\n   File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n     \"__main__\", fname, loader, pkg_name)\n   File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\n     exec code in run_globals\n   File \"/home/ubuntu/spaCy/spacy/__main__.py\", line 133, in <module>\n     plac.Interpreter.call(CLI)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 1142, in call\n     print(out)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 914, in __exit__\n     self.close(exctype, exc, tb)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 952, in close\n     self._interpreter.throw(exctype, exc, tb)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 964, in _make_interpreter\n     arglist = yield task\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 1139, in call\n     raise_(task.etype, task.exc, task.tb)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 380, in _wrap\n     for value in genobj:\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 95, in gen_exc\n     raise_(etype, exc, tb)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 966, in _make_interpreter\n     cmd, result = self.parser.consume(arglist)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_core.py\", line 207, in consume\n     return cmd, self.func(*(args + varargs + extraopts), **kwargs)\n   File \"/home/ubuntu/spaCy/spacy/__main__.py\", line 95, in train\n     not no_parser, not no_ner, parser_L1)\n   File \"/home/ubuntu/spaCy/spacy/cli/train.py\", line 39, in train\n     entity_cfg, n_iter)\n   File \"/home/ubuntu/spaCy/spacy/cli/train.py\", line 68, in train_model\n     **dev_scores.scores)\n AttributeError: 'list' object has no attribute 'scores'\n My current environment is:\n     Info about spaCy\n \n     Python version     2.7.12         \n     Platform           Linux-4.4.0 Ubuntu-16.04\n     spaCy version      1.8.0          \n     Installed models                   \n     Location           /home/ubuntu/spaCy/spacy\n \t"}, "comments": {"comments_0": {"comment_id": 1, "comment_author": "xiapoy", "commentT": "2017-04-23T13:55:33Z", "comment_text": "\n \t\tThanks for the report \u2013 fixing!\n (Looks like the main problem here is the dev scores not being passed to print_progress correctly when using the command without dev_data. So yeah, it failed on... printing \ud83d\ude09 Sorry about that.)\n \t\t"}, "comments_1": {"comment_id": 2, "comment_author": "xiapoy", "commentT": "2017-04-23T20:18:23Z", "comment_text": "\n \t\tThanks for your quick answer. I re-compiled spaCy from source and tried to re-train the models, but got a new error. Here is the output:\n <denchmark-code>Itn.\tN weight\tN feats\tUAS\tNER F.\tTag %\tToken %\n 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1455/1455 [01:09<00:00, 23.41it/s]\n Traceback (most recent call last):\n   File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n     \"__main__\", fname, loader, pkg_name)\n   File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\n     exec code in run_globals\n   File \"/home/ubuntu/spaCy/spacy/__main__.py\", line 133, in <module>\n     plac.Interpreter.call(CLI)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 1142, in call\n     print(out)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 914, in __exit__\n     self.close(exctype, exc, tb)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 952, in close\n     self._interpreter.throw(exctype, exc, tb)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 964, in _make_interpreter\n     arglist = yield task\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 1139, in call\n     raise_(task.etype, task.exc, task.tb)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 380, in _wrap\n     for value in genobj:\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 95, in gen_exc\n     raise_(etype, exc, tb)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_ext.py\", line 966, in _make_interpreter\n     cmd, result = self.parser.consume(arglist)\n   File \"/home/ubuntu/spaCy/.env/local/lib/python2.7/site-packages/plac_core.py\", line 207, in consume\n     return cmd, self.func(*(args + varargs + extraopts), **kwargs)\n   File \"/home/ubuntu/spaCy/spacy/__main__.py\", line 95, in train\n     not no_parser, not no_ner, parser_L1)\n   File \"/home/ubuntu/spaCy/spacy/cli/train.py\", line 39, in train\n     entity_cfg, n_iter)\n   File \"/home/ubuntu/spaCy/spacy/cli/train.py\", line 68, in train_model\n     **dev_scores)\n   File \"/home/ubuntu/spaCy/spacy/cli/train.py\", line 101, in print_progress\n     print(tpl.format(itn, nr_weight, nr_active_feat, **scores))\n KeyError: u'uas'\n </denchmark-code>\n \n I am using the same environment. Did I miss something?\n \t\t"}, "comments_2": {"comment_id": 3, "comment_author": "xiapoy", "commentT": "2017-04-23T20:27:41Z", "comment_text": "\n \t\tSorry this was my fault. Try again? Just made another tweak.\n \t\t"}, "comments_3": {"comment_id": 4, "comment_author": "xiapoy", "commentT": "2017-04-24T19:09:44Z", "comment_text": "\n \t\t<denchmark-link:https://github.com/honnibal>@honnibal</denchmark-link>\n  I tried again with the last spaCy version (1.8.1) and got the same error.\n \t\t"}, "comments_4": {"comment_id": 5, "comment_author": "xiapoy", "commentT": "2017-04-25T08:52:14Z", "comment_text": "\n \t\t@naileakim Sorry, I think we didn't v1.8.1 still contains the same error (didn't test properly), but it should be fixed on master.\n \t\t"}, "comments_5": {"comment_id": 6, "comment_author": "xiapoy", "commentT": "2017-04-26T20:10:56Z", "comment_text": "\n \t\tI confirm you that I still got that error while using latest master updates. I could finally succeed to train the model by adding the dev_data.\n \t\t"}, "comments_6": {"comment_id": 7, "comment_author": "xiapoy", "commentT": "2017-06-05T23:49:21Z", "comment_text": "\n \t\tThis is finally fixed in <denchmark-link:https://github.com/explosion/spaCy/releases/tag/v2.0.0-alpha>v2.0.0 alpha</denchmark-link>\n !\n \t\t"}, "comments_7": {"comment_id": 8, "comment_author": "xiapoy", "commentT": "2017-07-31T13:23:27Z", "comment_text": "\n \t\thow about 1.9.0, <denchmark-link:https://github.com/ines>@ines</denchmark-link>\n  ?\n \t\t"}, "comments_8": {"comment_id": 9, "comment_author": "xiapoy", "commentT": "2018-05-08T18:27:43Z", "comment_text": "\n \t\tThis thread has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs.\n \t\t"}}}, "commit": {"commit_id": "3a9710f35698a55822d80ded5d66239e6dcdba8a", "commit_author": "ines", "commitT": "2017-04-23 15:58:40+02:00", "changed_files": {"file_0": {"file_change_type": "MODIFY", "file_Nmethod": 0, "file_old_name": "spacy\\cli\\train.py", "file_new_name": "spacy\\cli\\train.py", "hunks": {"hunk_0": {"Ismethod": 0, "added_lines": "65,68", "deleted_lines": "65,68"}}}}}}